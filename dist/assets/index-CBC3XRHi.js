const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/PublicCompanyPage-DtTWxmA6.js","assets/js/react-KXT1Riez.js","assets/css/react-DOfe2hmq.css","assets/js/firebase-DYTOaTLw.js","assets/js/vendor-B27hBV_J.js","assets/js/ResultatsAgencePage-Cd4vbHJX.js","assets/js/ReservationClientPage-CDDS50Wv.js","assets/js/ClientMesReservationsPage-B31-67bu.js","assets/js/ReceiptEnLignePage-DMAa9l8O.js","assets/js/ticketMessages-3kq_IPVw.js","assets/js/jspdf.es.min-z1sh-bkM.js","assets/js/html2canvas-iRN4OxZ6.js","assets/js/UploadPreuvePage-bxRJo9Pn.js","assets/js/HomePage-ChSM26Rq.js","assets/js/clsx-B-dksMZM.js","assets/js/PlatformSearchResultsPage-DOXhP8UQ.js","assets/js/LoginPage-BULUW3g0.js","assets/js/Register-SFQspjtj.js","assets/js/ListeVillesPage-XsMnynGf.js","assets/js/AcceptInvitationPage-DX5eDzJA.js","assets/js/AgenceRapportsPage-db5tPp4h.js","assets/js/AdminSidebarLayout-ngbwCGqS.js","assets/js/AdminDashboard-_zra0wsw.js","assets/js/generateCategoricalChart-BbxwyVEQ.js","assets/js/CartesianGrid-Cw598Xwk.js","assets/js/AdminCompagniesPage-BsEWH0GD.js","assets/js/AdminModifierCompagniePage-BWEgmuD9.js","assets/js/AdminStatistiquesPage-BYpBHaKl.js","assets/js/LineChart-BQT43Qvh.js","assets/js/BarChart-CTd7zi-K.js","assets/js/AdminReservationsPage-Co6W20DI.js","assets/js/AdminFinancesPage-Dm0QK_DT.js","assets/js/AdminCompagnieAjouterPage-BWXQ0Nwj.js","assets/js/CompagnieLayout-DXfLNPec.js","assets/js/CompagnieDashboard-B0hdwixK.js","assets/js/skeleton-CKJa9pMg.js","assets/js/CompagnieAgencesPage-DGoGrbpK.js","assets/css/CompagnieAgencesPage-Dgihpmma.css","assets/js/CompagnieParametresTabsPage-CPs-fzqK.js","assets/js/ParametresPlan-DlxOOg5H.js","assets/js/CompagnieReservationsPage-C4AcuRoA.js","assets/js/CompagnieComptabilitePage-DUL0NSQm.js","assets/js/BibliothequeImagesPage-BfISW9RA.js","assets/js/UploadImageCloudinary-B0II4DGr.js","assets/js/CompanyPaymentSettingsPage-RclLeTod.js","assets/js/AvisModerationPage-b3kYbhCe.js","assets/js/DashboardAgencePage-Bw0lN4bd.js","assets/js/PieChart-HCzgfpfU.js","assets/js/AgenceReservationsPage-wq6YFicu.js","assets/js/AgenceGuichetPage-CtUlARcZ.js","assets/js/useActiveShift-Bq7jzZpU.js","assets/js/ReceiptModal-BfEnEHzt.js","assets/js/AgenceTrajetsPage-D9BGFoFx.js","assets/js/jspdf.plugin.autotable-CtA5BUKo.js","assets/js/AgenceFinancesPage-DBY5gsHE.js","assets/js/AgenceRecettesPage-CWlQUQSB.js","assets/js/xlsx-D_0l8YDs.js","assets/js/AgencePersonnelPage-DtlYGnxe.js","assets/js/ReceiptGuichetPage-kh8Nzdc1.js","assets/js/MediaPage-COM6jxxx.js","assets/js/AgenceShiftHistoryPage-D2Bt_ZVo.js","assets/js/AgenceComptabilitePage-DmgZmDxD.js","assets/js/AgenceShiftPage-ot3lc7um.js","assets/js/AffectationVehiculePage-AZS3L9VD.js","assets/js/AgenceShellPage-y2qft3hY.js"])))=>i.map(i=>d[i]);
var Wf=Object.defineProperty;var Xf=(r,e,t)=>e in r?Wf(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Cs=(r,e,t)=>Xf(r,typeof e!="symbol"?e+"":e,t);import{r as N,j as u,u as Ur,N as ir,F as bt,a as m,b as tr,d as _r,R as Lt,e as ja,C as qn,f as or,h as qf,L as Ja,X as vr,i as Yf,k as Kf,l as Bt,U as No,H as Zf,M as Fi,T as Qf,m as yu,n as br,o as Yn,p as sr,q as Jf,S as eh,A as Fn,I as Ea,G as Kn,P as th,s as _s,t as rh,v as nh,w as ah,Y as ih,x as oh,y as Es,z as ei,B as Ns,D as sh,Z as lh,E as xu,J as wr,K as So,O as ga,Q as Ua,V as ar,W as bu,_ as ch,$ as uh,a0 as Zt,a1 as qt,a2 as dh,a3 as Bi,a4 as Vi,a5 as Io,a6 as To,a7 as fh,a8 as Bn,a9 as ji,aa as wu,ab as Au,ac as Cu,ad as hh,ae as Ui,af as _u,ag as ph,ah as mh,ai as ti,aj as gh,ak as G,al as vh,am as yh,an as xh,ao as bh}from"./js/react-KXT1Riez.js";import{g as wh,a as Ah,i as Ch,b as _h,c as Eh,m as Nh,p as Sh,s as Ih,d as Th,e as Rh,f as Eu,h as Oh,j as Dh,k as Ph,l as Mh,n as Lh,R as kh,o as le,q as pt,r as Pe,w as me,t as ce,u as xe,v as $a,x as it,y as sn,z as Fh,A as Bh,B as Vh,C as jh,T as He,D as lr,E as cr,F as Uh,G as Nu,H as Ss,I as Is,J as dn,K as $h,L as Su,M as Ts,N as Hh,O as Gh,P as zh}from"./js/firebase-DYTOaTLw.js";import{f as Iu}from"./js/vendor-B27hBV_J.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const Wh={apiKey:"AIzaSyB9sGzgvdzhxxhIshtPprPix7oBfCB2OuM",authDomain:"monbillet-95b77.firebaseapp.com",projectId:"monbillet-95b77",storageBucket:"monbillet-95b77.appspot.com",messagingSenderId:"337289733382",appId:"1:337289733382:web:bb99ee8f48861b47226a87",measurementId:"G-G96GYRYS76"},Zn=wh().length?Ah():Ch(Wh);var lu,cu;const Rs=(cu=(lu=import.meta)==null?void 0:lu.env)==null?void 0:cu.VITE_RECAPTCHA_V3_KEY;var uu,du;if(typeof window<"u"){if(((du=(uu=import.meta)==null?void 0:uu.env)==null?void 0:du.VITE_APPCHECK_DEBUG)==="true"&&["localhost","127.0.0.1"].includes(window.location.hostname)){self.FIREBASE_APPCHECK_DEBUG_TOKEN=!0;try{localStorage.setItem("FIREBASE_APPCHECK_DEBUG_TOKEN","true")}catch{}}Rs&&_h(Zn,{provider:new kh(Rs),isTokenAutoRefreshEnabled:!0})}var fu,hu;const Os=((hu=(fu=import.meta)==null?void 0:fu.env)==null?void 0:hu.VITE_FIRESTORE_FORCE_LONG_POLLING)==="true";var pu,mu;const Xh=((mu=(pu=import.meta)==null?void 0:pu.env)==null?void 0:mu.VITE_FIRESTORE_DISABLE_PERSISTENCE)==="true",j=Eh(Zn,{localCache:Xh?Nh():Sh({tabManager:Oh()}),ignoreUndefinedProperties:!0,experimentalAutoDetectLongPolling:!Os,experimentalForceLongPolling:Os});Ih("error");const Ht=Th(Zn),qh=Rh(Zn),Yh=Eu(Zn,"europe-west1");var gu,vu;const Kh=((vu=(gu=import.meta)==null?void 0:gu.env)==null?void 0:vu.VITE_USE_EMULATORS)==="true",Zh=typeof window<"u"&&["localhost","127.0.0.1"].includes(window.location.hostname),Qh=Kh&&Zh;async function Jh(){try{Qh?(console.info("âš¡ Connexion aux Ã©mulateurs Firebaseâ€¦"),Dh(j,"127.0.0.1",8080),Ph(Ht,"http://127.0.0.1:9099",{disableWarnings:!0}),Mh(qh,"127.0.0.1",9199),Lh(Yh,"127.0.0.1",5001),console.info("ðŸ”¥ Ã‰mulateurs connectÃ©s.")):console.info("â„¹ï¸ Emulateurs dÃ©sactivÃ©s (mode cloud).")}catch(r){console.warn("âš ï¸ initFirebase() erreur :",r)}}const e0=(async()=>{})(),t0={admin_platforme:["dashboard","statistiques","parametres"],admin_compagnie:["dashboard","statistiques","agences","personnel","parametres"],financial_director:["dashboard","reservations","finances","depenses","statistiques"],company_accountant:["dashboard","reservations","finances","depenses","statistiques"],chefAgence:["dashboard","reservations","finances","guichet","embarquement","personnel"],agency_accountant:["dashboard","finances","depenses","statistiques"],guichetier:["guichet","reservations"],embarquement:["embarquement","reservations"],user:[]},Tu=N.createContext(null),ri=r=>{if(!r)return"user";const e=r.trim().toLowerCase();console.log("ðŸ” AuthContext normalizeRole - raw input:",e);const n={admin_platforme:"admin_platforme","admin platforme":"admin_platforme",admin:"admin_platforme",admin_compagnie:"admin_compagnie",compagnie:"admin_compagnie","admin compagnie":"admin_compagnie",ceo:"admin_compagnie",directeur:"admin_compagnie",company_accountant:"company_accountant",comptable_compagnie:"company_accountant","comptable compagnie":"company_accountant",comptable:"company_accountant","chef comptable":"company_accountant",chef_comptable:"company_accountant",financial_director:"financial_director",daf:"financial_director",directeur_financier:"financial_director","directeur financier":"financial_director",agency_accountant:"agency_accountant",comptable_agence:"agency_accountant","comptable agence":"agency_accountant",chefagence:"chefAgence",chef_agence:"chefAgence","chef agence":"chefAgence",superviseur:"chefAgence",agentcourrier:"chefAgence",agent_courrier:"chefAgence",guichetier:"guichetier",embarquement:"embarquement",user:"user"}[e]??"user";return console.log("ðŸ” AuthContext normalizeRole - result:",n),n},r0=r=>{if(!r)return null;if(r instanceof Date)return r;if(r instanceof He)return r.toDate();const e=new Date(r);return isNaN(e.getTime())?null:e},Ru=r=>Array.isArray(r)?r:[r].filter(Boolean),Ir=(r,e)=>Ru(r).some(t=>e.includes(String(t))),n0=r=>{const e=Ru(r).map(String);return console.log("ðŸŽ¯ AuthContext landingTargetForRoles - rÃ´les reÃ§us:",e),Ir(e,["company_accountant","financial_director"])?(console.log("ðŸŽ¯ Redirection vers: /chef-comptable"),"/chef-comptable"):Ir(e,["agency_accountant"])?(console.log("ðŸŽ¯ Redirection vers: /agence/comptabilite"),"/agence/comptabilite"):Ir(e,["guichetier"])?(console.log("ðŸŽ¯ Redirection vers: /agence/guichet"),"/agence/guichet"):Ir(e,["chefAgence","embarquement"])?(console.log("ðŸŽ¯ Redirection vers: /agence/dashboard"),"/agence/dashboard"):Ir(e,["admin_compagnie"])?(console.log("ðŸŽ¯ Redirection vers: /compagnie/dashboard"),"/compagnie/dashboard"):Ir(e,["admin_platforme"])?(console.log("ðŸŽ¯ Redirection vers: /admin/dashboard"),"/admin/dashboard"):Ir(e,["compagnie"])?(console.log("ðŸŽ¯ Redirection (compatibilitÃ©) vers: /compagnie/dashboard"),"/compagnie/dashboard"):(console.log("ðŸŽ¯ Aucun rÃ´le spÃ©cifique dÃ©tectÃ©, redirection vers: /login"),"/login")},a0=({children:r})=>{const[e,t]=N.useState(null),[n,a]=N.useState(null),[i,o]=N.useState(!0),[s,l]=N.useState(!1),c=N.useRef(!1),d=N.useCallback(async x=>{if(s||!x.email)return;const v=le(j,"users",x.uid);if((await pt(v)).exists())return;const _=Pe(ce(j,"invitations"),me("email","==",x.email),me("status","==","pending")),w=await xe(_);if(w.empty)return;const A=w.docs[0],C=A.data();await $a(v,{uid:x.uid,email:x.email,role:C.role??"chefAgence",companyId:C.companyId,agencyId:C.agencyId??"",nom:C.fullName??"",createdAt:it(),lastLogin:it()}),await sn(A.ref,{status:"accepted",uid:x.uid,acceptedAt:it()})},[s]),f=N.useCallback(async x=>{if(s)return;await d(x);const v=le(j,"users",x.uid),b=await pt(v);if(!b.exists()){t({uid:x.uid,email:x.email||"",role:"user",companyId:"",nom:""}),a(null);return}const _=b.data(),w=ri(_.role);console.log("ðŸ“Š AuthContext - DonnÃ©es utilisateur Firestore:",{rawRole:_.role,normalizedRole:w,companyId:_.companyId,agencyId:_.agencyId,email:_.email});const A=Array.from(new Set([..._.permissions||[],...t0[w]||[]])),C={uid:x.uid,email:x.email||_.email||"",displayName:x.displayName||_.nom||"",companyId:_.companyId||"",role:w,nom:_.nom||"",ville:_.ville||"",agencyId:_.agencyId||"",agencyName:_.agencyName,lastLogin:r0(_.lastLogin),permissions:A,companyLogo:_.companyLogo,companyColor:_.companyColor,agencyTelephone:_.agencyTelephone,agencyNom:_.agencyNom,agencyLogoUrl:_.agencyLogoUrl};if(console.log("âœ… AuthContext - Utilisateur crÃ©Ã©:",{role:C.role,companyId:C.companyId,agencyId:C.agencyId,target:n0(C.role)}),t(C),C.companyId){const I=await pt(le(j,"companies",C.companyId));a(I.exists()?{...I.data(),id:I.id}:null)}else a(null)},[d,s]),h=N.useCallback(async()=>{Ht.currentUser&&!s&&await f(Ht.currentUser)},[f,s]),p=N.useCallback(async()=>{l(!0),t(null),a(null);try{await Fh(Ht)}finally{l(!1)}},[]),g=N.useCallback(x=>{var v;return e?ri(e.role)==="admin_platforme"?!0:!!((v=e.permissions)!=null&&v.includes(x)):!1},[e]);N.useEffect(()=>{c.current||(c.current=!0,Bh(Ht,Vh).then(()=>{jh(Ht,async x=>{if(!s){if(o(!0),!x){console.log("ðŸšª AuthContext - Utilisateur dÃ©connectÃ©"),t(null),a(null),o(!1);return}console.log("ðŸ” AuthContext - Nouvel utilisateur dÃ©tectÃ©:",x.email);try{await f(x)}catch(v){(v==null?void 0:v.code)!=="permission-denied"&&console.error("âŒ AuthContext error:",v)}finally{o(!1)}}})}))},[f,s]);const y=N.useMemo(()=>ri(e==null?void 0:e.role)==="admin_platforme",[e]);return u(Tu.Provider,{value:{user:e,loading:i,logout:p,refreshUser:h,hasPermission:g,companyId:(e==null?void 0:e.companyId)||null,company:n,isPlatformAdmin:y,isLoggingOut:s},children:r})},Tt=()=>N.useContext(Tu),i0="modulepreload",o0=function(r){return"/"+r},Ds={},ne=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(t.map(l=>{if(l=o0(l),l in Ds)return;Ds[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":i0,c||(f.as="script"),f.crossOrigin="",f.href=l,s&&f.setAttribute("nonce",s),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return a.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})},s0=r=>{if(!r)return"user";const e=String(r).trim().toLowerCase();console.log("ðŸ” PrivateRoute normalizeRole - raw input:",e);const n={admin_platforme:"admin_platforme","admin platforme":"admin_platforme",admin_compagnie:"admin_compagnie",compagnie:"admin_compagnie","admin compagnie":"admin_compagnie",company_accountant:"company_accountant",comptable_compagnie:"company_accountant","comptable compagnie":"company_accountant",comptable:"company_accountant","chef comptable":"company_accountant",financial_director:"financial_director",daf:"financial_director",chefagence:"chefAgence",chef_agence:"chefAgence","chef agence":"chefAgence",superviseur:"chefAgence",agentcourrier:"chefAgence",agent_courrier:"chefAgence",agency_accountant:"agency_accountant",comptable_agence:"agency_accountant","comptable agence":"agency_accountant",guichetier:"guichetier",embarquement:"embarquement",user:"user"}[e]??"user";return console.log("ðŸ” PrivateRoute normalizeRole - result:",n),n},l0={admin_platforme:"/admin/dashboard",admin_compagnie:"/compagnie/dashboard",company_accountant:"/comptable",financial_director:"/comptable",chefAgence:"/agence/dashboard",agency_accountant:"/agence/comptabilite",guichetier:"/agence/guichet",embarquement:"/agence/embarquement",user:"/"},c0=r=>Array.isArray(r)?r.map(String):r?[String(r)]:[],nr=({children:r,allowedRoles:e})=>{const{user:t,loading:n}=Tt(),a=Ur();if(console.log("ðŸ” PrivateRoute - DÃ©but"),console.log("ðŸ” PrivateRoute - location.pathname:",a.pathname),console.log("ðŸ” PrivateRoute - user:",t),console.log("ðŸ” PrivateRoute - user?.role:",t==null?void 0:t.role),console.log("ðŸ” PrivateRoute - allowedRoles:",e),n)return console.log("ðŸ” PrivateRoute - loading state"),u("div",{className:"p-6 text-center text-gray-600",children:"VÃ©rification de l'authentification..."});if(!t)return console.log("ðŸ” PrivateRoute - Pas d'utilisateur, redirection vers /login"),u(ir,{to:"/login",replace:!0,state:{from:a}});const i=c0(t.role).map(s0);console.log("ðŸ” PrivateRoute - userRoles aprÃ¨s normalisation:",i);const o=i.some(s=>e.includes(s));if(console.log("ðŸ” PrivateRoute - isAllowed:",o),!o){console.log("ðŸ” PrivateRoute - AccÃ¨s refusÃ©, calcul du fallback...");const s=i.map(l=>l0[l]).find(Boolean)||"/";return console.log("ðŸ” PrivateRoute - fallback calculÃ©:",s),u(ir,{to:s,replace:!0})}return console.log("ðŸ” PrivateRoute - AccÃ¨s autorisÃ©, affichage des enfants"),u(bt,{children:r})};function Vn({fullScreen:r=!1}){return m(({children:t})=>r?u("div",{style:{position:"fixed",inset:0,background:"#f97316",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t}):u("div",{style:{padding:"2rem"},children:t}),{children:[m("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",color:"white"},children:[u("img",{src:"/images/teliya-logo.jpg",alt:"Teliya",width:72,height:72,style:{borderRadius:"50%",animation:"pulse 1.2s ease-in-out infinite"}}),u("div",{style:{marginTop:10,opacity:.95},children:"Chargementâ€¦"})]}),u("style",{children:`
        @keyframes pulse {
          0%{transform:scale(1);opacity:1}
          50%{transform:scale(1.12);opacity:.92}
          100%{transform:scale(1);opacity:1}
        }
      `})]})}const Ps=()=>u("div",{className:"text-center text-red-600 p-8",children:"404 â€“ Page introuvable"}),$i=N.forwardRef(({className:r="",variant:e="default",size:t="default",...n},a)=>{const i={default:"bg-blue-600 text-white hover:bg-blue-700",outline:"border border-gray-300 text-gray-700 bg-white hover:bg-gray-50",ghost:"bg-transparent text-gray-700 hover:bg-gray-100",link:"text-blue-600 underline hover:text-blue-800"}[e],o={default:"h-10 px-4 py-2 text-sm",sm:"h-8 px-3 text-sm",lg:"h-12 px-6 text-base",icon:"h-10 w-10"}[t];return u("button",{ref:a,className:`inline-flex items-center justify-center rounded-md font-medium transition ${i} ${o} ${r}`,...n})});$i.displayName="Button";function Hi({error:r}){const e=tr();return m("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 text-center",children:[u("h2",{className:"text-2xl font-bold mb-4",children:"Erreur Technique"}),u("p",{className:"mb-6",children:(r==null?void 0:r.message)||"Une erreur est survenue"}),m("div",{className:"flex gap-4",children:[u($i,{onClick:()=>window.location.reload(),children:"RÃ©essayer"}),u($i,{variant:"outline",onClick:()=>e("/"),children:"Retour Ã  l'accueil"})]})]})}class u0 extends N.Component{constructor(){super(...arguments);Cs(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0,error:t}}render(){return this.state.hasError?this.props.fallback||u(Hi,{error:this.state.error}):this.props.children}}const d0=N.lazy(()=>ne(()=>import("./js/PublicCompanyPage-DtTWxmA6.js"),__vite__mapDeps([0,1,2,3,4]))),f0=N.lazy(()=>ne(()=>import("./js/ResultatsAgencePage-Cd4vbHJX.js"),__vite__mapDeps([5,1,2,3,4]))),h0=N.lazy(()=>ne(()=>import("./js/ReservationClientPage-CDDS50Wv.js"),__vite__mapDeps([6,1,2,3,4]))),p0=N.lazy(()=>ne(()=>import("./js/ClientMesReservationsPage-B31-67bu.js"),__vite__mapDeps([7,1,2,3,4]))),m0=N.lazy(()=>ne(()=>Promise.resolve().then(()=>I0),void 0)),g0=N.lazy(()=>ne(()=>Promise.resolve().then(()=>T0),void 0)),v0=N.lazy(()=>ne(()=>import("./js/ReceiptEnLignePage-DMAa9l8O.js"),__vite__mapDeps([8,1,2,3,9,10,11,4]))),y0=N.lazy(()=>ne(()=>import("./js/UploadPreuvePage-bxRJo9Pn.js"),__vite__mapDeps([12,1,2,3,4]))),x0=N.lazy(()=>ne(()=>Promise.resolve().then(()=>hb),void 0)),b0=new Set(["login","register","admin","agence","villes","reservation","contact","compagnie"]),ni=new Map;function w0(){const{pathname:r}=Ur(),e=N.useMemo(()=>r.split("/").filter(Boolean),[r]),t=e[0]??null,n=e[1]??null,[a,i]=N.useState(null),[o,s]=N.useState(null),[l,c]=N.useState(!0),[d,f]=N.useState(!1),[h,p]=N.useState(null),g=N.useMemo(()=>typeof window<"u"&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768),[]);if(N.useEffect(()=>{let _=!0,w=null;async function A(){var I;if(c(!0),p(null),f(!1),i(null),s(null),!t||b0.has(t.toLowerCase())){if(!_)return;f(!0),c(!1);return}const C=ni.get(t);if(C){if(!_)return;i(C),s(C.id),c(!1)}if(!C)try{const R=sessionStorage.getItem(`company-${t}`);if(R){const F=JSON.parse(R);if(ni.set(t,F),!_)return;i(F),s(F.id),c(!1)}}catch{}try{let R=null;if(!C&&!o){const F=Pe(ce(j,"companies"),me("slug","==",t)),T=await xe(F);if(!T.empty)R=T.docs[0].id;else{const U=await pt(le(j,"companies",t));U.exists()&&(R=U.id)}}else R=((I=C||a)==null?void 0:I.id)||o;if(!R){if(!_)return;f(!0),c(!1);return}w=lr(le(j,"companies",R),F=>{if(!_)return;if(!F.exists()){f(!0),i(null),s(null);return}const T=A0(R,t,F.data());s(R),i(T),ni.set(t,T);try{sessionStorage.setItem(`company-${t}`,JSON.stringify(T))}catch{}c(!1)},F=>{_&&(p(F instanceof Error?F:new Error("Erreur chargement compagnie")),f(!0),c(!1))})}catch(R){if(!_)return;p(R instanceof Error?R:new Error("Erreur chargement compagnie")),f(!0),c(!1)}}return A(),()=>{_=!1,w&&w()}},[t]),l)return u(Vn,{fullScreen:!0});if(h)return u(Hi,{error:h});if(d||!a)return u(Ps,{});if(a.publicPageEnabled===!1)return m("div",{className:"min-h-screen flex flex-col items-center justify-center p-6",children:[u("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Site dÃ©sactivÃ©"}),u("p",{className:"text-gray-700 text-center max-w-xl",children:"Cette compagnie nâ€™a pas de page publique active avec son plan actuel. Veuillez rÃ©server directement au guichet."})]});if(!a.onlineBookingEnabled&&(n==="booking"||n==="receipt"||n==="confirmation"||n==="upload-preuve"||n==="reservation"||n==="details"))return m("div",{className:"min-h-screen flex flex-col items-center justify-center p-6",children:[u("h1",{className:"text-2xl font-bold text-orange-600 mb-4",children:"RÃ©servation en ligne indisponible"}),u("p",{className:"text-gray-700 text-center max-w-xl",children:"La rÃ©servation en ligne nâ€™est pas incluse dans le plan actuel de cette compagnie. Vous pouvez vous rendre au guichet pour effectuer votre rÃ©servation."})]});const v={company:a};let b;switch(n){case"resultats":b=u(f0,{...v});break;case"booking":b=u(h0,{});break;case"mes-reservations":b=u(p0,{});break;case"mentions":b=u(m0,{});break;case"confidentialite":b=u(g0,{});break;case"receipt":case"confirmation":b=u(v0,{});break;case"upload-preuve":b=u(y0,{});break;case"details":case"reservation":b=u(x0,{});break;case null:b=u(d0,{...v,isMobile:g});break;default:b=u(Ps,{})}return u(u0,{fallback:u(Hi,{}),children:u(N.Suspense,{fallback:u(Vn,{fullScreen:!0}),children:b})})}function A0(r,e,t){var n;if(!t||typeof t!="object")throw new Error("DonnÃ©es compagnie invalides");return{id:r,slug:e,nom:t.nom??"Compagnie",themeStyle:t.themeStyle??"clair",imagesSlider:Array.isArray(t.imagesSlider)?t.imagesSlider:[],footerConfig:{customLinks:Array.isArray((n=t.footerConfig)==null?void 0:n.customLinks)?t.footerConfig.customLinks.map(a=>({label:(a==null?void 0:a.label)??"Lien",url:(a==null?void 0:a.url)??"#",external:!!(a!=null&&a.external)})):[]},...t}}function C0(r=[],e=2500){return r.length?new Promise(t=>{let n=!1;const a=setTimeout(()=>{n||(n=!0,t())},e);let i=0,o=r.length;const s=()=>{!n&&++i>=o&&(n=!0,clearTimeout(a),t())};r.forEach(l=>{const c=new Image;c.onload=s,c.onerror=s,c.src=l})}):Promise.resolve()}const _0=({children:r,logo:e,minMs:t=900,maxMs:n=1800,extraHoldMs:a=600,sizePx:i=140,ringWidthPx:o=2,ringOpacity:s=.55,spinnerSpeedMs:l=900,preload:c=[]})=>{const[d,f]=N.useState(!1),[h,p]=N.useState(!1),g=N.useRef(performance.now());N.useEffect(()=>{let x=!1;return(async()=>{const b=performance.now()-g.current,_=Math.max(0,t-b);await new Promise(C=>setTimeout(C,_)),await C0(c),a>0&&await new Promise(C=>setTimeout(C,a));const w=performance.now()-g.current,A=Math.max(0,n-w);A>0&&await new Promise(C=>setTimeout(C,A)),!x&&(p(!0),setTimeout(()=>{x||f(!0)},260))})(),()=>{x=!0}},[t,n,a,c]);const y=i+18;return m(bt,{children:[r,!d&&m("div",{"aria-hidden":"true",style:{position:"fixed",inset:0,background:"#f97316",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2147483e3,transition:"opacity 240ms ease",opacity:h?0:1,pointerEvents:"none"},children:[m("div",{style:{position:"relative",width:y,height:y},children:[u("div",{style:{position:"absolute",inset:0,borderRadius:"9999px",border:`${o}px solid rgba(255,255,255,${s})`,borderTopColor:"#ffffff",animation:`teliya-spin ${l}ms linear infinite`}}),u("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:i,height:i,borderRadius:"9999px",background:"white",display:"grid",placeItems:"center",boxShadow:"0 4px 18px rgba(0,0,0,.12)"},children:u("img",{src:e,alt:"Teliya",style:{width:"70%",height:"70%",objectFit:"contain",borderRadius:"50%",userSelect:"none",pointerEvents:"none"},decoding:"async",loading:"eager"})})]}),u("style",{children:`
            @keyframes teliya-spin {
              to { transform: rotate(360deg); }
            }
          `})]})]})},ai=new Intl.NumberFormat("fr-FR");function E0(){const{companyId:r}=_r(),e=tr(),[t,n]=N.useState(!0),[a,i]=N.useState(!1),[o,s]=N.useState(null),[l,c]=N.useState([]),[d,f]=N.useState({}),[h,p]=N.useState(""),g=N.useMemo(()=>h?d[h]??null:null,[h,d]);N.useEffect(()=>{if(!r)return;const x=[],v=lr(le(j,"companies",r),w=>{if(w.exists()){const A={id:w.id,...w.data()};s(A),p(C=>C||A.planId||"")}else s(null);n(!1)});x.push(v);const b=Pe(ce(j,"plans"),cr("priceMonthly","asc")),_=lr(b,w=>{const A=[],C={};w.docs.forEach(I=>{const R=I.data();A.push({id:I.id,name:R.name||I.id}),C[I.id]=R}),c(A),f(C)});return x.push(_),()=>x.forEach(w=>w())},[r]);async function y(){if(!r||!h)return;const x=d[h];if(!x)return;const v=!!x.features.publicPage||!!x.features.onlineBooking;i(!0);try{await sn(le(j,"companies",r),{planId:h,plan:x.name,publicPageEnabled:v,onlineBookingEnabled:!!x.features.onlineBooking,guichetEnabled:!!x.features.guichet,commissionOnline:x.features.onlineBooking?Number(x.commissionOnline||0):0,feeGuichet:x.features.guichet?Number(x.feeGuichet||0):0,minimumMonthly:Number(x.minimumMonthly||0),maxAgences:Number(x.maxAgences||0),updatedAt:it()}),alert("Plan appliquÃ© Ã  la compagnie âœ…"),e(-1)}finally{i(!1)}}return t||!o?u("div",{className:"p-6",children:"Chargementâ€¦"}):m("div",{className:"p-6 max-w-3xl mx-auto space-y-5",children:[m("h1",{className:"text-xl font-bold",children:["Plan & options â€” ",o.nom||"Compagnie"]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m("label",{className:"text-sm",children:["Plan (modÃ¨le)",m("select",{value:h,onChange:x=>p(x.target.value),className:"mt-1 w-full border p-2 rounded",children:[u("option",{value:"",children:"â€” SÃ©lectionner â€”"}),l.map(x=>u("option",{value:x.id,children:x.name},x.id))]})]}),m("div",{className:"text-sm",children:[u("div",{className:"text-gray-600 mb-1",children:"Plan actuel"}),u("div",{className:"px-3 py-2 border rounded bg-gray-50",children:o.plan?o.plan:"â€”"})]})]}),g&&m("div",{className:"border rounded-xl p-4 bg-white",children:[u("h3",{className:"font-semibold mb-2",children:"AperÃ§u du plan sÃ©lectionnÃ©"}),m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[m("div",{className:"border rounded p-3",children:[u("div",{className:"text-gray-500",children:"Nom"}),u("div",{className:"font-semibold",children:g.name}),u("div",{className:"text-gray-500 mt-2",children:"Mensuel"}),m("div",{className:"font-semibold",children:[ai.format(g.priceMonthly)," FCFA"]})]}),m("div",{className:"border rounded p-3",children:[u("div",{className:"text-gray-500",children:"Agences max"}),u("div",{className:"font-semibold",children:g.maxAgences}),u("div",{className:"text-gray-500 mt-2",children:"Minimum mensuel"}),u("div",{className:"font-semibold",children:g.minimumMonthly?ai.format(g.minimumMonthly)+" FCFA":"â€”"})]}),m("div",{className:"border rounded p-3",children:[u("div",{className:"text-gray-500",children:"Tarifs"}),m("div",{children:["Guichet :"," ",u("b",{children:g.features.guichet?ai.format(g.feeGuichet)+" FCFA/billet":"â€”"})]}),m("div",{children:["Online :"," ",u("b",{children:g.features.onlineBooking?Math.round((g.commissionOnline||0)*100)+" %":"â€”"})]})]})]}),m("div",{className:"text-xs text-gray-600 mt-3",children:["FonctionnalitÃ©s :"," ",m("b",{children:[g.features.publicPage?"Vitrine":"â€”",","," ",g.features.onlineBooking?"RÃ©servation en ligne":"â€”",","," ",g.features.guichet?"Guichet":"â€”"]})]})]}),m("div",{className:"flex gap-3",children:[u("button",{onClick:()=>e(-1),className:"px-3 py-2 rounded border",children:"Annuler"}),u("button",{onClick:y,disabled:!h||a,className:`px-3 py-2 rounded text-white ${a?"bg-orange-300":"bg-orange-600 hover:bg-orange-700"}`,children:a?"Applicationâ€¦":"Appliquer ce plan"})]})]})}const ia={name:"",priceMonthly:0,quotaReservations:0,overagePerReservation:0,commissionOnline:0,feeGuichet:0,minimumMonthly:0,maxAgences:1,features:{publicPage:!0,onlineBooking:!1,guichet:!0}},yn=new Intl.NumberFormat("fr-FR");function N0(){const[r,e]=N.useState([]),[t,n]=N.useState(ia),[a,i]=N.useState(!1),o=async()=>{var h,p;try{const g=Pe(ce(j,"plans"),cr("priceMonthly","asc")),y=await xe(g);console.log("Plans.size =",y.size,"projectId =",j.app.options.projectId,"useEmulators =",(p=(h=import.meta)==null?void 0:h.env)==null?void 0:p.VITE_USE_EMULATORS);const x=y.docs.map(v=>{var _,w,A;const b=v.data();return{id:v.id,...b,name:b.name??b.nom??"",maxAgences:b.maxAgences??b.maxAgencies??1,features:{publicPage:((_=b.features)==null?void 0:_.publicPage)??b.publicPage??!1,onlineBooking:((w=b.features)==null?void 0:w.onlineBooking)??b.onlineBooking??!1,guichet:((A=b.features)==null?void 0:A.guichet)??b.guichet??!1}}});e(x)}catch(g){console.error("Erreur lecture plans:",g),alert("Impossible de charger les plans (voir console)."),e([])}};N.useEffect(()=>{(async()=>(await e0,await o()))()},[]);const s=N.useMemo(()=>!!t.id,[t.id]),l=h=>h.name.trim()?h.features.onlineBooking&&!h.features.publicPage?"IncohÃ©rence : la rÃ©servation en ligne nÃ©cessite une page publique.":"":"Le nom du plan est requis.",c=async h=>{h.preventDefault(),i(!0);try{const p={...t,name:t.name.trim(),priceMonthly:Number(t.priceMonthly)||0,quotaReservations:Number(t.quotaReservations)||0,overagePerReservation:Number(t.overagePerReservation)||0,commissionOnline:Number(t.commissionOnline)||0,feeGuichet:Number(t.feeGuichet)||0,minimumMonthly:Number(t.minimumMonthly)||0,maxAgences:Number(t.maxAgences)||0,features:{...t.features},updatedAt:it()},g=l(p);if(g){alert(g);return}t.id?await $a(le(j,"plans",t.id),p,{merge:!0}):await Uh(ce(j,"plans"),{...p,createdAt:it()}),n(ia),await o()}finally{i(!1)}},d=async h=>{confirm("Supprimer ce plan ?")&&(await Nu(le(j,"plans",h)),await o())},f=(h,p)=>{n(h==="onlineBooking"&&p?g=>({...g,features:{...g.features,onlineBooking:!0,publicPage:!0}}):g=>({...g,features:{...g.features,[h]:p}}))};return m("div",{className:"p-6 space-y-6",children:[m("div",{className:"flex items-center justify-between",children:[u("h1",{className:"text-2xl font-bold",children:"Plans & tarifs"}),u("button",{className:"px-3 py-2 rounded bg-orange-600 text-white",onClick:()=>n(ia),children:"+ Nouveau plan"})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.map(h=>m("div",{className:"rounded-2xl border shadow-sm p-5 bg-white flex flex-col",children:[m("div",{className:"flex items-center justify-between mb-2",children:[u("h3",{className:"font-semibold text-lg",children:h.name}),m("span",{className:"text-sm font-bold",children:[yn.format(h.priceMonthly)," FCFA",u("span",{className:"text-gray-500 text-xs font-normal",children:" /mois"})]})]}),m("ul",{className:"text-sm text-gray-700 space-y-1 mb-4",children:[h.quotaReservations>0&&m("li",{children:["Quota mensuel inclus : ",u("b",{children:yn.format(h.quotaReservations)})]}),h.overagePerReservation>0&&m("li",{children:["DÃ©passement : ",m("b",{children:[yn.format(h.overagePerReservation)," FCFA"]})," ","/ rÃ©servation"]}),h.features.guichet&&m("li",{children:["Frais guichet : ",m("b",{children:[yn.format(h.feeGuichet)," FCFA"]})," / billet"]}),h.features.onlineBooking&&m("li",{children:["Commission online :"," ",m("b",{children:[Math.round((h.commissionOnline||0)*100),"%"]})]}),h.minimumMonthly>0&&m("li",{children:["Minimum mensuel : ",m("b",{children:[yn.format(h.minimumMonthly)," FCFA"]})]}),m("li",{children:["Agences max : ",u("b",{children:h.maxAgences})]}),m("li",{className:"flex flex-wrap gap-2 pt-1",children:[h.features.publicPage&&u("span",{className:"px-2 py-0.5 rounded-full text-xs bg-orange-100 text-orange-700",children:"Page publique"}),h.features.onlineBooking&&u("span",{className:"px-2 py-0.5 rounded-full text-xs bg-green-100 text-green-700",children:"RÃ©servation en ligne"}),h.features.guichet&&u("span",{className:"px-2 py-0.5 rounded-full text-xs bg-blue-100 text-blue-700",children:"Guichet"})]})]}),m("div",{className:"mt-auto flex gap-3",children:[u("button",{className:"px-3 py-1.5 rounded border",onClick:()=>n(h),children:"Ã‰diter"}),u("button",{className:"px-3 py-1.5 rounded border border-red-300 text-red-600",onClick:()=>h.id&&d(h.id),children:"Supprimer"})]})]},h.id)),r.length===0&&u("div",{className:"text-sm text-gray-500",children:"Aucun plan crÃ©Ã© pour le moment."})]}),m("form",{onSubmit:c,className:"bg-white rounded-2xl border shadow-sm p-5 grid grid-cols-1 md:grid-cols-3 gap-4",children:[u("h2",{className:"md:col-span-3 font-semibold text-lg",children:s?"Modifier le plan":"CrÃ©er un plan"}),m("label",{className:"text-sm",children:["Nom du plan",u("input",{className:"border rounded p-2 mt-1 w-full",placeholder:"Starter, Pro, Enterpriseâ€¦",value:t.name,onChange:h=>n({...t,name:h.target.value})})]}),m("label",{className:"text-sm",children:["Prix mensuel (FCFA)",u("input",{className:"border rounded p-2 mt-1 w-full",type:"number",value:t.priceMonthly,onChange:h=>n({...t,priceMonthly:Number(h.target.value)})})]}),m("label",{className:"text-sm",children:["Agences maximum",u("input",{className:"border rounded p-2 mt-1 w-full",type:"number",value:t.maxAgences,onChange:h=>n({...t,maxAgences:Number(h.target.value)})})]}),m("label",{className:"text-sm",children:["Quota de rÃ©servations / mois (global)",u("input",{className:"border rounded p-2 mt-1 w-full",type:"number",value:t.quotaReservations,onChange:h=>n({...t,quotaReservations:Number(h.target.value)})})]}),m("label",{className:"text-sm",children:["DÃ©passement (FCFA) / rÃ©servation",u("input",{className:"border rounded p-2 mt-1 w-full",type:"number",value:t.overagePerReservation,onChange:h=>n({...t,overagePerReservation:Number(h.target.value)})})]}),m("label",{className:"text-sm",children:["Minimum mensuel (FCFA) â€” optionnel",u("input",{className:"border rounded p-2 mt-1 w-full",type:"number",value:t.minimumMonthly,onChange:h=>n({...t,minimumMonthly:Number(h.target.value)})})]}),m("label",{className:"text-sm",children:["Commission en ligne (%) ",t.features.onlineBooking?"":"(dÃ©sactivÃ©)",u("input",{className:"border rounded p-2 mt-1 w-full disabled:opacity-50",type:"number",step:"0.1",disabled:!t.features.onlineBooking,value:t.features.onlineBooking?(t.commissionOnline||0)*100:0,onChange:h=>n({...t,commissionOnline:Number(h.target.value)/100})})]}),m("label",{className:"text-sm",children:["Frais guichet (FCFA / billet) ",t.features.guichet?"":"(dÃ©sactivÃ©)",u("input",{className:"border rounded p-2 mt-1 w-full disabled:opacity-50",type:"number",disabled:!t.features.guichet,value:t.features.guichet?t.feeGuichet:0,onChange:h=>n({...t,feeGuichet:Number(h.target.value)})})]}),m("div",{className:"md:col-span-3 flex items-center gap-6",children:[m("label",{className:"flex items-center gap-2",children:[u("input",{type:"checkbox",checked:t.features.publicPage,onChange:h=>f("publicPage",h.target.checked)}),"Page publique (site vitrine)"]}),m("label",{className:"flex items-center gap-2",children:[u("input",{type:"checkbox",checked:t.features.onlineBooking,onChange:h=>f("onlineBooking",h.target.checked)}),"RÃ©servation en ligne"]}),m("label",{className:"flex items-center gap-2",children:[u("input",{type:"checkbox",checked:t.features.guichet,onChange:h=>f("guichet",h.target.checked)}),"Guichet (vente au comptoir)"]})]}),m("div",{className:"md:col-span-3 flex gap-2",children:[u("button",{className:"px-3 py-2 rounded bg-orange-600 text-white disabled:opacity-50",disabled:a,children:a?"Enregistrement...":s?"Enregistrer":"CrÃ©er"}),s&&u("button",{type:"button",className:"px-3 py-2 rounded border",onClick:()=>n(ia),children:"Annuler"})]})]})]})}const Ou=Lt.createContext(void 0),Ms={},S0=({children:r})=>{const[e,t]=Lt.useState(Ms),n=Lt.useCallback(o=>{t(o||{})},[]),a=Lt.useCallback(()=>{t(Ms)},[]),i=Lt.useMemo(()=>({header:e,setHeader:n,resetHeader:a}),[e,n,a]);return u(Ou.Provider,{value:i,children:r})},p3=()=>{const r=Lt.useContext(Ou);if(!r)throw new Error("usePageHeader must be used within PageHeaderProvider");return r},Mt=(r,e=1)=>{const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;r=r.replace(t,(s,l,c,d)=>l+l+c+c+d+d);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);if(!n)return`rgba(0, 0, 0, ${e})`;const[a,i,o]=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)];return`rgba(${a}, ${i}, ${o}, ${e})`},Et=r=>{const e=r.replace("#","");if(e.length!==6)return"#1e293b";const t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16),i=(.299*t+.587*n+.114*a)/255,o=i>.6?"#1e293b":"#FFFFFF";return o==="#FFFFFF"&&i>.8?"#1e293b":o},Du=()=>{var f;const{slug:r}=_r(),e=tr(),{i18n:t}=ja(),n=t.language==="en"?"en":"fr",[a,i]=N.useState(null),[o,s]=N.useState(!0);if(N.useEffect(()=>{(async()=>{const p=Pe(ce(j,"companies"),me("slug","==",r)),g=await xe(p);if(!g.empty){const y=g.docs[0].data();i({id:g.docs[0].id,name:y.name,couleurPrimaire:y.couleurPrimaire||"#3B82F6",logoUrl:y.logoUrl,mentionsLegales:y.mentionsLegales})}s(!1)})()},[r]),o)return u("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Chargement..."});const l=(a==null?void 0:a.couleurPrimaire)||"#3B82F6",c=Et(l),d=((f=a==null?void 0:a.mentionsLegales)==null?void 0:f[n])||"Mentions lÃ©gales indisponibles.";return m("div",{className:"min-h-screen bg-gray-50",children:[u("header",{className:"px-6 py-4 shadow-sm",style:{backgroundColor:l,color:c},children:m("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[m("div",{className:"flex items-center",children:[u("button",{onClick:()=>e(`/${r}`),className:"mr-4 text-white hover:text-gray-200",title:"Retour Ã  la page d'accueil",children:u(qn,{className:"w-5 h-5"})}),u("h1",{className:"text-xl font-bold",children:"Mentions lÃ©gales"})]}),(a==null?void 0:a.logoUrl)&&u("img",{src:a.logoUrl,alt:"Logo",className:"h-10 w-10 object-contain rounded-full border bg-white",style:{borderColor:Mt(l,.2)}})]})}),u("main",{className:"max-w-4xl mx-auto px-6 py-8 text-gray-800",children:u("p",{className:"whitespace-pre-wrap leading-relaxed text-justify text-sm md:text-base",children:d})})]})},I0=Object.freeze(Object.defineProperty({__proto__:null,default:Du},Symbol.toStringTag,{value:"Module"})),Pu=()=>{var f;const{slug:r}=_r(),e=tr(),{i18n:t}=ja(),n=t.language==="en"?"en":"fr",[a,i]=N.useState(null),[o,s]=N.useState(!0);if(N.useEffect(()=>{(async()=>{const p=Pe(ce(j,"companies"),me("slug","==",r)),g=await xe(p);if(!g.empty){const y=g.docs[0].data();i({id:g.docs[0].id,name:y.name,couleurPrimaire:y.couleurPrimaire||"#3B82F6",logoUrl:y.logoUrl,politiqueConfidentialite:y.politiqueConfidentialite})}s(!1)})()},[r]),o)return u("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Chargement..."});const l=(a==null?void 0:a.couleurPrimaire)||"#3B82F6",c=Et(l),d=((f=a==null?void 0:a.politiqueConfidentialite)==null?void 0:f[n])||"Politique de confidentialitÃ© indisponible.";return m("div",{className:"min-h-screen bg-gray-50",children:[u("header",{className:"px-6 py-4 shadow-sm",style:{backgroundColor:l,color:c},children:m("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[m("div",{className:"flex items-center",children:[u("button",{onClick:()=>e(`/${r}`),className:"mr-4 text-white hover:text-gray-200",title:"Retour Ã  la page d'accueil",children:u(qn,{className:"w-5 h-5"})}),u("h1",{className:"text-xl font-bold",children:"Politique de confidentialitÃ©"})]}),(a==null?void 0:a.logoUrl)&&u("img",{src:a.logoUrl,alt:"Logo",className:"h-10 w-10 object-contain rounded-full border bg-white",style:{borderColor:Mt(l,.2)}})]})}),u("main",{className:"max-w-4xl mx-auto px-6 py-8 text-gray-800",children:u("p",{className:"whitespace-pre-wrap leading-relaxed text-justify text-sm md:text-base",children:d})})]})},T0=Object.freeze(Object.defineProperty({__proto__:null,default:Pu},Symbol.toStringTag,{value:"Module"})),R0=()=>{var f;const{slug:r}=_r(),e=tr(),{i18n:t}=ja(),n=t.language==="en"?"en":"fr",[a,i]=N.useState(null),[o,s]=N.useState(!0);if(N.useEffect(()=>{(async()=>{const p=Pe(ce(j,"companies"),me("slug","==",r)),g=await xe(p);if(!g.empty){const y=g.docs[0].data();i({id:g.docs[0].id,name:y.name,couleurPrimaire:y.couleurPrimaire||"#3B82F6",logoUrl:y.logoUrl,conditionsUtilisation:y.conditionsUtilisation})}s(!1)})()},[r]),o)return u("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Chargement..."});const l=(a==null?void 0:a.couleurPrimaire)||"#3B82F6",c=Et(l),d=((f=a==null?void 0:a.conditionsUtilisation)==null?void 0:f[n])||"Conditions gÃ©nÃ©rales non disponibles.";return m("div",{className:"min-h-screen bg-gray-50",children:[u("header",{className:"px-6 py-4 shadow-sm",style:{backgroundColor:l,color:c},children:m("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[m("div",{className:"flex items-center",children:[u("button",{onClick:()=>e(`/${r}`),className:"mr-4 text-white hover:text-gray-200",title:"Retour Ã  la page d'accueil",children:u(qn,{className:"w-5 h-5"})}),u("h1",{className:"text-xl font-bold",children:"Conditions gÃ©nÃ©rales"})]}),(a==null?void 0:a.logoUrl)&&u("img",{src:a.logoUrl,alt:"Logo",className:"h-10 w-10 object-contain rounded-full border bg-white",style:{borderColor:Mt(l,.2)}})]})}),u("main",{className:"max-w-4xl mx-auto px-6 py-8 text-gray-800",children:u("p",{className:"whitespace-pre-wrap leading-relaxed text-justify text-sm md:text-base",children:d})})]})},O0=()=>{var f;const{slug:r}=_r(),e=tr(),{i18n:t}=ja(),n=t.language==="en"?"en":"fr",[a,i]=N.useState(null),[o,s]=N.useState(!0);if(N.useEffect(()=>{(async()=>{const p=Pe(ce(j,"companies"),me("slug","==",r)),g=await xe(p);if(!g.empty){const y=g.docs[0].data();i({id:g.docs[0].id,name:y.name,couleurPrimaire:y.couleurPrimaire||"#3B82F6",logoUrl:y.logoUrl,politiqueCookies:y.politiqueCookies})}s(!1)})()},[r]),o)return u("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Chargement..."});const l=(a==null?void 0:a.couleurPrimaire)||"#3B82F6",c=Et(l),d=((f=a==null?void 0:a.politiqueCookies)==null?void 0:f[n])||"Politique de cookies non disponible.";return m("div",{className:"min-h-screen bg-gray-50",children:[u("header",{className:"px-6 py-4 shadow-sm",style:{backgroundColor:l,color:c},children:m("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[m("div",{className:"flex items-center",children:[u("button",{onClick:()=>e(`/${r}`),className:"mr-4 text-white hover:text-gray-200",title:"Retour Ã  la page d'accueil",children:u(qn,{className:"w-5 h-5"})}),u("h1",{className:"text-xl font-bold",children:"Politique des cookies"})]}),(a==null?void 0:a.logoUrl)&&u("img",{src:a.logoUrl,alt:"Logo",className:"h-10 w-10 object-contain rounded-full border bg-white",style:{borderColor:Mt(l,.2)}})]})}),u("main",{className:"max-w-4xl mx-auto px-6 py-8 text-gray-800",children:u("p",{className:"whitespace-pre-wrap leading-relaxed text-justify text-sm md:text-base",children:d})})]})};function D0(r,e){var t=Object.setPrototypeOf;t?t(r,e):r.__proto__=e}function P0(r,e){e===void 0&&(e=r.constructor);var t=Error.captureStackTrace;t&&t(r,e)}var M0=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(a[o]=i[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),L0=function(r){M0(e,r);function e(t,n){var a=this.constructor,i=r.call(this,t,n)||this;return Object.defineProperty(i,"name",{value:a.name,enumerable:!1,configurable:!0}),D0(i,a.prototype),P0(i),i}return e}(Error),k0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),It=function(r){k0(e,r);function e(t){t===void 0&&(t=void 0);var n=r.call(this,t)||this;return n.message=t,n}return e.prototype.getKind=function(){var t=this.constructor;return t.kind},e.kind="Exception",e}(L0),F0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xe=function(r){F0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArgumentException",e}(It),B0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),re=function(r){B0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(It),Mu=function(){function r(e){if(this.binarizer=e,e===null)throw new re("Binarizer must be non-null.")}return r.prototype.getWidth=function(){return this.binarizer.getWidth()},r.prototype.getHeight=function(){return this.binarizer.getHeight()},r.prototype.getBlackRow=function(e,t){return this.binarizer.getBlackRow(e,t)},r.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},r.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},r.prototype.crop=function(e,t,n,a){var i=this.binarizer.getLuminanceSource().crop(e,t,n,a);return new r(this.binarizer.createBinarizer(i))},r.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},r.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new r(this.binarizer.createBinarizer(e))},r.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new r(this.binarizer.createBinarizer(e))},r.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},r}(),V0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ye=function(r){V0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(It),j0=function(){function r(e){this.source=e}return r.prototype.getLuminanceSource=function(){return this.source},r.prototype.getWidth=function(){return this.source.getWidth()},r.prototype.getHeight=function(){return this.source.getHeight()},r}(),Oe=function(){function r(){}return r.arraycopy=function(e,t,n,a,i){for(;i--;)n[a++]=e[t++]},r.currentTimeMillis=function(){return Date.now()},r}(),U0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ro=function(r){U0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(It),$0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ls=function(r){$0(e,r);function e(t,n){t===void 0&&(t=void 0),n===void 0&&(n=void 0);var a=r.call(this,n)||this;return a.index=t,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(Ro),H0=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},et=function(){function r(){}return r.fill=function(e,t){for(var n=0,a=e.length;n<a;n++)e[n]=t},r.fillWithin=function(e,t,n,a){r.rangeCheck(e.length,t,n);for(var i=t;i<n;i++)e[i]=a},r.rangeCheck=function(e,t,n){if(t>n)throw new re("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new Ls(t);if(n>e)throw new Ls(n)},r.asList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},r.create=function(e,t,n){var a=Array.from({length:e});return a.map(function(i){return Array.from({length:t}).fill(n)})},r.createInt32Array=function(e,t,n){var a=Array.from({length:e});return a.map(function(i){return Int32Array.from({length:t}).fill(n)})},r.equals=function(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==t[n])return!1;return!0},r.hashCode=function(e){var t,n;if(e===null)return 0;var a=1;try{for(var i=H0(e),o=i.next();!o.done;o=i.next()){var s=o.value;a=31*a+s}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a},r.fillUint8Array=function(e,t){for(var n=0;n!==e.length;n++)e[n]=t},r.copyOf=function(e,t){return e.slice(0,t)},r.copyOfUint8Array=function(e,t){if(e.length<=t){var n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)},r.copyOfRange=function(e,t,n){var a=n-t,i=new Int32Array(a);return Oe.arraycopy(e,t,i,0,a),i},r.binarySearch=function(e,t,n){n===void 0&&(n=r.numberComparator);for(var a=0,i=e.length-1;a<=i;){var o=i+a>>1,s=n(t,e[o]);if(s>0)a=o+1;else if(s<0)i=o-1;else return o}return-a-1},r.numberComparator=function(e,t){return e-t},r}(),he=function(){function r(){}return r.numberOfTrailingZeros=function(e){var t;if(e===0)return 32;var n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)},r.numberOfLeadingZeros=function(e){if(e===0)return 32;var t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t},r.toHexString=function(e){return e.toString(16)},r.toBinaryString=function(e){return String(parseInt(String(e),2))},r.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},r.truncDivision=function(e,t){return Math.trunc(e/t)},r.parseInt=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r.MIN_VALUE_32_BITS=-2147483648,r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),ot=function(){function r(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=r.makeArray(e):this.bits=t)}return r.prototype.getSize=function(){return this.size},r.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},r.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var t=r.makeArray(e);Oe.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}},r.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},r.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},r.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},r.prototype.getNextSet=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,a=Math.floor(e/32),i=n[a];i&=~((1<<(e&31))-1);for(var o=n.length;i===0;){if(++a===o)return t;i=n[a]}var s=a*32+he.numberOfTrailingZeros(i);return s>t?t:s},r.prototype.getNextUnset=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,a=Math.floor(e/32),i=~n[a];i&=~((1<<(e&31))-1);for(var o=n.length;i===0;){if(++a===o)return t;i=~n[a]}var s=a*32+he.numberOfTrailingZeros(i);return s>t?t:s},r.prototype.setBulk=function(e,t){this.bits[Math.floor(e/32)]=t},r.prototype.setRange=function(e,t){if(t<e||e<0||t>this.size)throw new re;if(t!==e){t--;for(var n=Math.floor(e/32),a=Math.floor(t/32),i=this.bits,o=n;o<=a;o++){var s=o>n?0:e&31,l=o<a?31:t&31,c=(2<<l)-(1<<s);i[o]|=c}}},r.prototype.clear=function(){for(var e=this.bits.length,t=this.bits,n=0;n<e;n++)t[n]=0},r.prototype.isRange=function(e,t,n){if(t<e||e<0||t>this.size)throw new re;if(t===e)return!0;t--;for(var a=Math.floor(e/32),i=Math.floor(t/32),o=this.bits,s=a;s<=i;s++){var l=s>a?0:e&31,c=s<i?31:t&31,d=(2<<c)-(1<<l)&4294967295;if((o[s]&d)!==(n?d:0))return!1}return!0},r.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},r.prototype.appendBits=function(e,t){if(t<0||t>32)throw new re("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(var n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)},r.prototype.appendBitArray=function(e){var t=e.size;this.ensureCapacity(this.size+t);for(var n=0;n<t;n++)this.appendBit(e.get(n))},r.prototype.xor=function(e){if(this.size!==e.size)throw new re("Sizes don't match");for(var t=this.bits,n=0,a=t.length;n<a;n++)t[n]^=e.bits[n]},r.prototype.toBytes=function(e,t,n,a){for(var i=0;i<a;i++){for(var o=0,s=0;s<8;s++)this.get(e)&&(o|=1<<7-s),e++;t[n+i]=o}},r.prototype.getBitArray=function(){return this.bits},r.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,a=this.bits,i=0;i<n;i++){var o=a[i];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[t-i]=o}if(this.size!==n*32){for(var s=n*32-this.size,l=e[0]>>>s,i=1;i<n;i++){var c=e[i];l|=c<<32-s,e[i-1]=l,l=c>>>s}e[n-1]=l}this.bits=e},r.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.size===t.size&&et.equals(this.bits,t.bits)},r.prototype.hashCode=function(){return 31*this.size+et.hashCode(this.bits)},r.prototype.toString=function(){for(var e="",t=0,n=this.size;t<n;t++)t&7||(e+=" "),e+=this.get(t)?"X":".";return e},r.prototype.clone=function(){return new r(this.size,this.bits.slice())},r.prototype.toArray=function(){for(var e=[],t=0,n=this.size;t<n;t++)e.push(this.get(t));return e},r}(),Gi;(function(r){r[r.OTHER=0]="OTHER",r[r.PURE_BARCODE=1]="PURE_BARCODE",r[r.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",r[r.TRY_HARDER=3]="TRY_HARDER",r[r.CHARACTER_SET=4]="CHARACTER_SET",r[r.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",r[r.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",r[r.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",r[r.ASSUME_GS1=8]="ASSUME_GS1",r[r.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",r[r.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",r[r.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(Gi||(Gi={}));const De=Gi;var G0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$=function(r){G0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(It),z0=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Se;(function(r){r[r.Cp437=0]="Cp437",r[r.ISO8859_1=1]="ISO8859_1",r[r.ISO8859_2=2]="ISO8859_2",r[r.ISO8859_3=3]="ISO8859_3",r[r.ISO8859_4=4]="ISO8859_4",r[r.ISO8859_5=5]="ISO8859_5",r[r.ISO8859_6=6]="ISO8859_6",r[r.ISO8859_7=7]="ISO8859_7",r[r.ISO8859_8=8]="ISO8859_8",r[r.ISO8859_9=9]="ISO8859_9",r[r.ISO8859_10=10]="ISO8859_10",r[r.ISO8859_11=11]="ISO8859_11",r[r.ISO8859_13=12]="ISO8859_13",r[r.ISO8859_14=13]="ISO8859_14",r[r.ISO8859_15=14]="ISO8859_15",r[r.ISO8859_16=15]="ISO8859_16",r[r.SJIS=16]="SJIS",r[r.Cp1250=17]="Cp1250",r[r.Cp1251=18]="Cp1251",r[r.Cp1252=19]="Cp1252",r[r.Cp1256=20]="Cp1256",r[r.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",r[r.UTF8=22]="UTF8",r[r.ASCII=23]="ASCII",r[r.Big5=24]="Big5",r[r.GB18030=25]="GB18030",r[r.EUC_KR=26]="EUC_KR"})(Se||(Se={}));var Je=function(){function r(e,t,n){for(var a,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=o,r.VALUE_IDENTIFIER_TO_ECI.set(e,this),r.NAME_TO_ECI.set(n,this);for(var l=this.values,c=0,d=l.length;c!==d;c++){var f=l[c];r.VALUES_TO_ECI.set(f,this)}try{for(var h=z0(o),p=h.next();!p.done;p=h.next()){var g=p.value;r.NAME_TO_ECI.set(g,this)}}catch(y){a={error:y}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}}return r.prototype.getValueIdentifier=function(){return this.valueIdentifier},r.prototype.getName=function(){return this.name},r.prototype.getValue=function(){return this.values[0]},r.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new $("incorect value");var t=r.VALUES_TO_ECI.get(e);if(t===void 0)throw new $("incorect value");return t},r.getCharacterSetECIByName=function(e){var t=r.NAME_TO_ECI.get(e);if(t===void 0)throw new $("incorect value");return t},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.getName()===t.getName()},r.VALUE_IDENTIFIER_TO_ECI=new Map,r.VALUES_TO_ECI=new Map,r.NAME_TO_ECI=new Map,r.Cp437=new r(Se.Cp437,Int32Array.from([0,2]),"Cp437"),r.ISO8859_1=new r(Se.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),r.ISO8859_2=new r(Se.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),r.ISO8859_3=new r(Se.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),r.ISO8859_4=new r(Se.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),r.ISO8859_5=new r(Se.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),r.ISO8859_6=new r(Se.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),r.ISO8859_7=new r(Se.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),r.ISO8859_8=new r(Se.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),r.ISO8859_9=new r(Se.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),r.ISO8859_10=new r(Se.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),r.ISO8859_11=new r(Se.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),r.ISO8859_13=new r(Se.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),r.ISO8859_14=new r(Se.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),r.ISO8859_15=new r(Se.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),r.ISO8859_16=new r(Se.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),r.SJIS=new r(Se.SJIS,20,"SJIS","Shift_JIS"),r.Cp1250=new r(Se.Cp1250,21,"Cp1250","windows-1250"),r.Cp1251=new r(Se.Cp1251,22,"Cp1251","windows-1251"),r.Cp1252=new r(Se.Cp1252,23,"Cp1252","windows-1252"),r.Cp1256=new r(Se.Cp1256,24,"Cp1256","windows-1256"),r.UnicodeBigUnmarked=new r(Se.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),r.UTF8=new r(Se.UTF8,26,"UTF8","UTF-8"),r.ASCII=new r(Se.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),r.Big5=new r(Se.Big5,28,"Big5"),r.GB18030=new r(Se.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),r.EUC_KR=new r(Se.EUC_KR,30,"EUC_KR","EUC-KR"),r}(),W0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),va=function(r){W0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(It),Vt=function(){function r(){}return r.decode=function(e,t){var n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},r.shouldDecodeOnFallback=function(e){return!r.isBrowser()&&e==="ISO-8859-1"},r.encode=function(e,t){var n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},r.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},r.encodingName=function(e){return typeof e=="string"?e:e.getName()},r.encodingCharacterSet=function(e){return e instanceof Je?e:Je.getCharacterSetECIByName(e)},r.decodeFallback=function(e,t){var n=this.encodingCharacterSet(t);if(r.isDecodeFallbackSupported(n)){for(var a="",i=0,o=e.length;i<o;i++){var s=e[i].toString(16);s.length<2&&(s="0"+s),a+="%"+s}return decodeURIComponent(a)}if(n.equals(Je.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new va("Encoding "+this.encodingName(t)+" not supported by fallback.")},r.isDecodeFallbackSupported=function(e){return e.equals(Je.UTF8)||e.equals(Je.ISO8859_1)||e.equals(Je.ASCII)},r.encodeFallback=function(e){for(var t=btoa(unescape(encodeURIComponent(e))),n=t.split(""),a=[],i=0;i<n.length;i++)a.push(n[i].charCodeAt(0));return new Uint8Array(a)},r}(),ve=function(){function r(){}return r.castAsNonUtf8Char=function(e,t){t===void 0&&(t=null);var n=t?t.getName():this.ISO88591;return Vt.decode(new Uint8Array([e]),n)},r.guessEncoding=function(e,t){if(t!=null&&t.get(De.CHARACTER_SET)!==void 0)return t.get(De.CHARACTER_SET).toString();for(var n=e.length,a=!0,i=!0,o=!0,s=0,l=0,c=0,d=0,f=0,h=0,p=0,g=0,y=0,x=0,v=0,b=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,_=0;_<n&&(a||i||o);_++){var w=e[_]&255;o&&(s>0?w&128?s--:o=!1:w&128&&(w&64?(s++,w&32?(s++,w&16?(s++,w&8?o=!1:d++):c++):l++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),i&&(f>0?w<64||w===127||w>252?i=!1:f--:w===128||w===160||w>239?i=!1:w>160&&w<224?(h++,g=0,p++,p>y&&(y=p)):w>127?(f++,p=0,g++,g>x&&(x=g)):(p=0,g=0))}return o&&s>0&&(o=!1),i&&f>0&&(i=!1),o&&(b||l+c+d>0)?r.UTF8:i&&(r.ASSUME_SHIFT_JIS||y>=3||x>=3)?r.SHIFT_JIS:a&&i?y===2&&h===2||v*10>=n?r.SHIFT_JIS:r.ISO88591:a?r.ISO88591:i?r.SHIFT_JIS:o?r.UTF8:r.PLATFORM_DEFAULT_ENCODING},r.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=-1;function i(s,l,c,d,f,h){if(s==="%%")return"%";if(t[++a]!==void 0){s=d?parseInt(d.substr(1)):void 0;var p=f?parseInt(f.substr(1)):void 0,g;switch(h){case"s":g=t[a];break;case"c":g=t[a][0];break;case"f":g=parseFloat(t[a]).toFixed(s);break;case"p":g=parseFloat(t[a]).toPrecision(s);break;case"e":g=parseFloat(t[a]).toExponential(s);break;case"x":g=parseInt(t[a]).toString(p||16);break;case"d":g=parseFloat(parseInt(t[a],p||10).toPrecision(s)).toFixed(0);break}g=typeof g=="object"?JSON.stringify(g):(+g).toString(p);for(var y=parseInt(c),x=c&&c[0]+""=="0"?"0":" ";g.length<y;)g=l!==void 0?g+x:x+g;return g}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,i)},r.getBytes=function(e,t){return Vt.encode(e,t)},r.getCharCode=function(e,t){return t===void 0&&(t=0),e.charCodeAt(t)},r.getCharAt=function(e){return String.fromCharCode(e)},r.SHIFT_JIS=Je.SJIS.getName(),r.GB2312="GB2312",r.ISO88591=Je.ISO8859_1.getName(),r.EUC_JP="EUC_JP",r.UTF8=Je.UTF8.getName(),r.PLATFORM_DEFAULT_ENCODING=r.UTF8,r.ASSUME_SHIFT_JIS=!1,r}(),de=function(){function r(e){e===void 0&&(e=""),this.value=e}return r.prototype.enableDecoding=function(e){return this.encoding=e,this},r.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=ve.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},r.prototype.appendChars=function(e,t,n){for(var a=t;t<t+n;a++)this.append(e[a]);return this},r.prototype.length=function(){return this.value.length},r.prototype.charAt=function(e){return this.value.charAt(e)},r.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},r.prototype.setCharAt=function(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)},r.prototype.substring=function(e,t){return this.value.substring(e,t)},r.prototype.setLengthToZero=function(){this.value=""},r.prototype.toString=function(){return this.value},r.prototype.insert=function(e,t){this.value=this.value.substring(0,e)+t+this.value.substring(e)},r}(),er=function(){function r(e,t,n,a){if(this.width=e,this.height=t,this.rowSize=n,this.bits=a,t==null&&(t=e),this.height=t,e<1||t<1)throw new re("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return r.parseFromBooleanArray=function(e){for(var t=e.length,n=e[0].length,a=new r(n,t),i=0;i<t;i++)for(var o=e[i],s=0;s<n;s++)o[s]&&a.set(s,i);return a},r.parseFromString=function(e,t,n){if(e===null)throw new re("stringRepresentation cannot be null");for(var a=new Array(e.length),i=0,o=0,s=-1,l=0,c=0;c<e.length;)if(e.charAt(c)===`
`||e.charAt(c)==="\r"){if(i>o){if(s===-1)s=i-o;else if(i-o!==s)throw new re("row lengths do not match");o=i,l++}c++}else if(e.substring(c,c+t.length)===t)c+=t.length,a[i]=!0,i++;else if(e.substring(c,c+n.length)===n)c+=n.length,a[i]=!1,i++;else throw new re("illegal character encountered: "+e.substring(c));if(i>o){if(s===-1)s=i-o;else if(i-o!==s)throw new re("row lengths do not match");l++}for(var d=new r(s,l),f=0;f<i;f++)a[f]&&d.set(Math.floor(f%s),Math.floor(f/s));return d},r.prototype.get=function(e,t){var n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},r.prototype.set=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},r.prototype.unset=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},r.prototype.flip=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},r.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new re("input matrix dimensions do not match");for(var t=new ot(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,i=0,o=this.height;i<o;i++)for(var s=i*n,l=e.getRow(i,t).getBitArray(),c=0;c<n;c++)a[s+c]^=l[c]},r.prototype.clear=function(){for(var e=this.bits,t=e.length,n=0;n<t;n++)e[n]=0},r.prototype.setRegion=function(e,t,n,a){if(t<0||e<0)throw new re("Left and top must be nonnegative");if(a<1||n<1)throw new re("Height and width must be at least 1");var i=e+n,o=t+a;if(o>this.height||i>this.width)throw new re("The region must fit inside the matrix");for(var s=this.rowSize,l=this.bits,c=t;c<o;c++)for(var d=c*s,f=e;f<i;f++)l[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},r.prototype.getRow=function(e,t){t==null||t.getSize()<this.width?t=new ot(this.width):t.clear();for(var n=this.rowSize,a=this.bits,i=e*n,o=0;o<n;o++)t.setBulk(o*32,a[i+o]);return t},r.prototype.setRow=function(e,t){Oe.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},r.prototype.rotate180=function(){for(var e=this.getWidth(),t=this.getHeight(),n=new ot(e),a=new ot(e),i=0,o=Math.floor((t+1)/2);i<o;i++)n=this.getRow(i,n),a=this.getRow(t-1-i,a),n.reverse(),a.reverse(),this.setRow(i,a),this.setRow(t-1-i,n)},r.prototype.getEnclosingRectangle=function(){for(var e=this.width,t=this.height,n=this.rowSize,a=this.bits,i=e,o=t,s=-1,l=-1,c=0;c<t;c++)for(var d=0;d<n;d++){var f=a[c*n+d];if(f!==0){if(c<o&&(o=c),c>l&&(l=c),d*32<i){for(var h=0;!(f<<31-h&4294967295);)h++;d*32+h<i&&(i=d*32+h)}if(d*32+31>s){for(var h=31;!(f>>>h);)h--;d*32+h>s&&(s=d*32+h)}}}return s<i||l<o?null:Int32Array.from([i,o,s-i+1,l-o+1])},r.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,t=this.bits,n=0;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;for(var a=n/e,i=n%e*32,o=t[n],s=0;!(o<<31-s&4294967295);)s++;return i+=s,Int32Array.from([i,a])},r.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,t=this.bits,n=t.length-1;n>=0&&t[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),i=Math.floor(n%e)*32,o=t[n],s=31;!(o>>>s);)s--;return i+=s,Int32Array.from([i,a])},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRowSize=function(){return this.rowSize},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&et.equals(this.bits,t.bits)},r.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+et.hashCode(this.bits),e},r.prototype.toString=function(e,t,n){return e===void 0&&(e="X "),t===void 0&&(t="  "),n===void 0&&(n=`
`),this.buildToString(e,t,n)},r.prototype.buildToString=function(e,t,n){for(var a=new de,i=0,o=this.height;i<o;i++){for(var s=0,l=this.width;s<l;s++)a.append(this.get(s,i)?e:t);a.append(n)}return a.toString()},r.prototype.clone=function(){return new r(this.width,this.height,this.rowSize,this.bits.slice())},r}(),X0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),k=function(r){X0(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(It),q0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Y0=function(r){q0(e,r);function e(t){var n=r.call(this,t)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(t,n){var a=this.getLuminanceSource(),i=a.getWidth();n==null||n.getSize()<i?n=new ot(i):n.clear(),this.initArrays(i);for(var o=a.getRow(t,this.luminances),s=this.buckets,l=0;l<i;l++)s[(o[l]&255)>>e.LUMINANCE_SHIFT]++;var c=e.estimateBlackPoint(s);if(i<3)for(var l=0;l<i;l++)(o[l]&255)<c&&n.set(l);else for(var d=o[0]&255,f=o[1]&255,l=1;l<i-1;l++){var h=o[l+1]&255;(f*4-d-h)/2<c&&n.set(l),d=f,f=h}return n},e.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),n=t.getWidth(),a=t.getHeight(),i=new er(n,a);this.initArrays(n);for(var o=this.buckets,s=1;s<5;s++)for(var l=Math.floor(a*s/5),c=t.getRow(l,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var h=c[f]&255;o[h>>e.LUMINANCE_SHIFT]++}for(var p=e.estimateBlackPoint(o),g=t.getMatrix(),s=0;s<a;s++)for(var y=s*n,f=0;f<n;f++){var h=g[y+f]&255;h<p&&i.set(f,s)}return i},e.prototype.createBinarizer=function(t){return new e(t)},e.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(t){for(var n=t.length,a=0,i=0,o=0,s=0;s<n;s++)t[s]>o&&(i=s,o=t[s]),t[s]>a&&(a=t[s]);for(var l=0,c=0,s=0;s<n;s++){var d=s-i,f=t[s]*d*d;f>c&&(l=s,c=f)}if(i>l){var h=i;i=l,l=h}if(l-i<=n/16)throw new k;for(var p=l-1,g=-1,s=l-1;s>i;s--){var y=s-i,f=y*y*(l-s)*(a-t[s]);f>g&&(p=s,g=f)}return p<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(j0),K0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Lu=function(r){K0(e,r);function e(t){var n=r.call(this,t)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var t=this.getLuminanceSource(),n=t.getWidth(),a=t.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var i=t.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var s=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&s++;var l=e.calculateBlackPoints(i,o,s,n,a),c=new er(n,a);e.calculateThresholdForBlock(i,o,s,n,a,l,c),this.matrix=c}else this.matrix=r.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(t){return new e(t)},e.calculateThresholdForBlock=function(t,n,a,i,o,s,l){for(var c=o-e.BLOCK_SIZE,d=i-e.BLOCK_SIZE,f=0;f<a;f++){var h=f<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var p=e.cap(f,2,a-3),g=0;g<n;g++){var y=g<<e.BLOCK_SIZE_POWER;y>d&&(y=d);for(var x=e.cap(g,2,n-3),v=0,b=-2;b<=2;b++){var _=s[p+b];v+=_[x-2]+_[x-1]+_[x]+_[x+1]+_[x+2]}var w=v/25;e.thresholdBlock(t,y,h,w,i,l)}}},e.cap=function(t,n,a){return t<n?n:t>a?a:t},e.thresholdBlock=function(t,n,a,i,o,s){for(var l=0,c=a*o+n;l<e.BLOCK_SIZE;l++,c+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(t[c+d]&255)<=i&&s.set(n+d,a+l)},e.calculateBlackPoints=function(t,n,a,i,o){for(var s=o-e.BLOCK_SIZE,l=i-e.BLOCK_SIZE,c=new Array(a),d=0;d<a;d++){c[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>s&&(f=s);for(var h=0;h<n;h++){var p=h<<e.BLOCK_SIZE_POWER;p>l&&(p=l);for(var g=0,y=255,x=0,v=0,b=f*i+p;v<e.BLOCK_SIZE;v++,b+=i){for(var _=0;_<e.BLOCK_SIZE;_++){var w=t[b+_]&255;g+=w,w<y&&(y=w),w>x&&(x=w)}if(x-y>e.MIN_DYNAMIC_RANGE)for(v++,b+=i;v<e.BLOCK_SIZE;v++,b+=i)for(var _=0;_<e.BLOCK_SIZE;_++)g+=t[b+_]&255}var A=g>>e.BLOCK_SIZE_POWER*2;if(x-y<=e.MIN_DYNAMIC_RANGE&&(A=y/2,d>0&&h>0)){var C=(c[d-1][h]+2*c[d][h-1]+c[d-1][h-1])/4;y<C&&(A=C)}c[d][h]=A}}return c},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(Y0),Qn=function(){function r(e,t){this.width=e,this.height=t}return r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.isCropSupported=function(){return!1},r.prototype.crop=function(e,t,n,a){throw new va("This luminance source does not support cropping.")},r.prototype.isRotateSupported=function(){return!1},r.prototype.rotateCounterClockwise=function(){throw new va("This luminance source does not support rotation by 90 degrees.")},r.prototype.rotateCounterClockwise45=function(){throw new va("This luminance source does not support rotation by 45 degrees.")},r.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),t=new de,n=0;n<this.height;n++){for(var a=this.getRow(n,e),i=0;i<this.width;i++){var o=a[i]&255,s=void 0;o<64?s="#":o<128?s="+":o<192?s=".":s=" ",t.append(s)}t.append(`
`)}return t.toString()},r}(),Z0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ha=function(r){Z0(e,r);function e(t){var n=r.call(this,t.getWidth(),t.getHeight())||this;return n.delegate=t,n}return e.prototype.getRow=function(t,n){for(var a=this.delegate.getRow(t,n),i=this.getWidth(),o=0;o<i;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var t=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),i=0;i<n;i++)a[i]=255-(t[i]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(t,n,a,i){return new e(this.delegate.crop(t,n,a,i))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Qn),Q0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),J0=function(r){Q0(e,r);function e(t,n){n===void 0&&(n=!1);var a=r.call(this,t.width,t.height)||this;return a.canvas=t,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(t,n),a}return e.makeBufferFromCanvasImageData=function(t,n){n===void 0&&(n=!1);var a=t.getContext("2d").getImageData(0,0,t.width,t.height);return e.toGrayscaleBuffer(a.data,t.width,t.height,n)},e.toGrayscaleBuffer=function(t,n,a,i){i===void 0&&(i=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!i)for(var s=0,l=0,c=t.length;s<c;s+=4,l++){var d=void 0,f=t[s+3];if(f===0)d=255;else{var h=t[s],p=t[s+1],g=t[s+2];d=306*h+601*p+117*g+512>>10}o[l]=d}else for(var s=0,l=0,y=t.length;s<y;s+=4,l++){var d=void 0,f=t[s+3];if(f===0)d=255;else{var h=t[s],p=t[s+1],g=t[s+2];d=306*h+601*p+117*g+512>>10}o[l]=255-d}return o},e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new re("Requested row is outside the image: "+t);var a=this.getWidth(),i=t*a;return n===null?n=this.buffer.slice(i,i+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(i,i+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return r.prototype.crop.call(this,t,n,a,i),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement},e.prototype.rotate=function(t){var n=this.getTempCanvasElement(),a=n.getContext("2d"),i=t*e.DEGREE_TO_RADIANS,o=this.canvas.width,s=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(i))*o+Math.abs(Math.sin(i))*s),c=Math.ceil(Math.abs(Math.sin(i))*o+Math.abs(Math.cos(i))*s);return n.width=l,n.height=c,a.translate(l/2,c/2),a.rotate(i),a.drawImage(this.canvas,o/-2,s/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new Ha(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Qn),ep=function(){function r(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}return r.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},r}(),vt=function(r,e,t,n){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?i(d.value):a(d.value).then(s,l)}c((n=n.apply(r,e||[])).next())})},yt=function(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,a=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],a=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},tp=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fn=function(){function r(e,t,n){t===void 0&&(t=500),this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(r.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),r.prototype.listVideoInputDevices=function(){return vt(this,void 0,void 0,function(){var e,t,n,a,i,o,s,l,c,d,f,h;return yt(this,function(p){switch(p.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=p.sent(),t=[];try{for(n=tp(e),a=n.next();!a.done;a=n.next())i=a.value,o=i.kind==="video"?"videoinput":i.kind,o==="videoinput"&&(s=i.deviceId||i.id,l=i.label||"Video device "+(t.length+1),c=i.groupId,d={deviceId:s,label:l,kind:o,groupId:c},t.push(d))}catch(g){f={error:g}}finally{try{a&&!a.done&&(h=n.return)&&h.call(n)}finally{if(f)throw f.error}}return[2,t]}})})},r.prototype.getVideoInputDevices=function(){return vt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=t.sent(),[2,e.map(function(n){return new ep(n.deviceId,n.label)})]}})})},r.prototype.findDeviceById=function(e){return vt(this,void 0,void 0,function(){var t;return yt(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return t=n.sent(),t?[2,t.find(function(a){return a.deviceId===e})]:[2,null]}})})},r.prototype.decodeFromInputVideoDevice=function(e,t){return vt(this,void 0,void 0,function(){return yt(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,t)];case 1:return[2,n.sent()]}})})},r.prototype.decodeOnceFromVideoDevice=function(e,t){return vt(this,void 0,void 0,function(){var n,a;return yt(this,function(i){switch(i.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,t)];case 1:return[2,i.sent()]}})})},r.prototype.decodeOnceFromConstraints=function(e,t){return vt(this,void 0,void 0,function(){var n;return yt(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,a.sent()]}})})},r.prototype.decodeOnceFromStream=function(e,t){return vt(this,void 0,void 0,function(){var n,a;return yt(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return n=i.sent(),[4,this.decodeOnce(n)];case 2:return a=i.sent(),[2,a]}})})},r.prototype.decodeFromInputVideoDeviceContinuously=function(e,t,n){return vt(this,void 0,void 0,function(){return yt(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,t,n)];case 1:return[2,a.sent()]}})})},r.prototype.decodeFromVideoDevice=function(e,t,n){return vt(this,void 0,void 0,function(){var a,i;return yt(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},i={video:a},[4,this.decodeFromConstraints(i,t,n)];case 1:return[2,o.sent()]}})})},r.prototype.decodeFromConstraints=function(e,t,n){return vt(this,void 0,void 0,function(){var a;return yt(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=i.sent(),[4,this.decodeFromStream(a,t,n)];case 2:return[2,i.sent()]}})})},r.prototype.decodeFromStream=function(e,t,n){return vt(this,void 0,void 0,function(){var a;return yt(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return a=i.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,i.sent()]}})})},r.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},r.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},r.prototype.attachStreamToVideo=function(e,t){return vt(this,void 0,void 0,function(){var n;return yt(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(t),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},r.prototype.playVideoOnLoadAsync=function(e){var t=this;return new Promise(function(n,a){return t.playVideoOnLoad(e,function(){return n()})})},r.prototype.playVideoOnLoad=function(e,t){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)},r.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},r.prototype.tryPlayVideo=function(e){return vt(this,void 0,void 0,function(){return yt(this,function(t){switch(t.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.play()];case 2:return t.sent(),[3,4];case 3:return t.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},r.prototype.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new Xe("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new Xe("element with id '"+e+"' must be an "+t+" element");return n},r.prototype.decodeFromImage=function(e,t){if(!e&&!t)throw new Xe("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)},r.prototype.decodeFromVideo=function(e,t){if(!e&&!t)throw new Xe("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)},r.prototype.decodeFromVideoContinuously=function(e,t,n){if(e===void 0&&t===void 0)throw new Xe("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)},r.prototype.decodeFromImageElement=function(e){if(!e)throw new Xe("An image element must be provided.");this.reset();var t=this.prepareImageElement(e);this.imageElement=t;var n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n},r.prototype.decodeFromVideoElement=function(e){var t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)},r.prototype.decodeFromVideoElementContinuously=function(e,t){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)},r.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Xe("A video element must be provided.");this.reset();var t=this.prepareVideoElement(e);return this.videoElement=t,t},r.prototype.decodeFromImageUrl=function(e){if(!e)throw new Xe("An URL must be provided.");this.reset();var t=this.prepareImageElement();this.imageElement=t;var n=this._decodeOnLoadImage(t);return t.src=e,n},r.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Xe("An URL must be provided.");this.reset();var t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n},r.prototype.decodeFromVideoUrlContinuously=function(e,t){if(!e)throw new Xe("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,t);return n.src=e,a},r.prototype._decodeOnLoadImage=function(e){var t=this;return new Promise(function(n,a){t.imageLoadedListener=function(){return t.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",t.imageLoadedListener)})},r.prototype._decodeOnLoadVideo=function(e){return vt(this,void 0,void 0,function(){return yt(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},r.prototype._decodeOnLoadVideoContinuously=function(e,t){return vt(this,void 0,void 0,function(){return yt(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,t),[2]}})})},r.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},r.prototype.prepareImageElement=function(e){var t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t},r.prototype.prepareVideoElement=function(e){var t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},r.prototype.decodeOnce=function(e,t,n){var a=this;t===void 0&&(t=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var i=function(o,s){if(a._stopAsyncDecode){s(new k("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var l=a.decode(e);o(l)}catch(h){var c=t&&h instanceof k,d=h instanceof Ye||h instanceof $,f=d&&n;if(c||f)return setTimeout(i,a._timeBetweenDecodingAttempts,o,s);s(h)}};return new Promise(function(o,s){return i(o,s)})},r.prototype.decodeContinuously=function(e,t){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var i=n.decode(e);t(i,null),setTimeout(a,n.timeBetweenScansMillis)}catch(l){t(null,l);var o=l instanceof Ye||l instanceof $,s=l instanceof k;(o||s)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},r.prototype.decode=function(e){var t=this.createBinaryBitmap(e);return this.decodeBitmap(t)},r.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var t=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),t=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new J0(n,t),i=new Lu(a);return new Mu(i)},r.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var t=this.getCaptureCanvas(e),n=void 0;try{n=t.getContext("2d",{willReadFrequently:!0})}catch{n=t.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},r.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas},r.prototype.drawFrameOnCanvas=function(e,t,n){t===void 0&&(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.drawImageOnCanvas=function(e,t,n){t===void 0&&(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},r.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var t=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=a+"px",t.width=n,t.height=a,t},r.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},r.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},r.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},r.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},r.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},r.prototype.addVideoSource=function(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}},r.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},r}(),gt=function(){function r(e,t,n,a,i,o){n===void 0&&(n=t==null?0:8*t.length),o===void 0&&(o=Oe.currentTimeMillis()),this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=a,this.format=i,this.timestamp=o,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=a,this.format=i,this.resultMetadata=null,o==null?this.timestamp=Oe.currentTimeMillis():this.timestamp=o}return r.prototype.getText=function(){return this.text},r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.getBarcodeFormat=function(){return this.format},r.prototype.getResultMetadata=function(){return this.resultMetadata},r.prototype.putMetadata=function(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)},r.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},r.prototype.addResultPoints=function(e){var t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(t.length+e.length);Oe.arraycopy(t,0,n,0,t.length),Oe.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.toString=function(){return this.text},r}(),zi;(function(r){r[r.AZTEC=0]="AZTEC",r[r.CODABAR=1]="CODABAR",r[r.CODE_39=2]="CODE_39",r[r.CODE_93=3]="CODE_93",r[r.CODE_128=4]="CODE_128",r[r.DATA_MATRIX=5]="DATA_MATRIX",r[r.EAN_8=6]="EAN_8",r[r.EAN_13=7]="EAN_13",r[r.ITF=8]="ITF",r[r.MAXICODE=9]="MAXICODE",r[r.PDF_417=10]="PDF_417",r[r.QR_CODE=11]="QR_CODE",r[r.RSS_14=12]="RSS_14",r[r.RSS_EXPANDED=13]="RSS_EXPANDED",r[r.UPC_A=14]="UPC_A",r[r.UPC_E=15]="UPC_E",r[r.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(zi||(zi={}));const te=zi;var Wi;(function(r){r[r.OTHER=0]="OTHER",r[r.ORIENTATION=1]="ORIENTATION",r[r.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",r[r.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",r[r.ISSUE_NUMBER=4]="ISSUE_NUMBER",r[r.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",r[r.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",r[r.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",r[r.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",r[r.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",r[r.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Wi||(Wi={}));const dt=Wi;var Ga=function(){function r(e,t,n,a,i,o){i===void 0&&(i=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.setNumBits=function(e){this.numBits=e},r.prototype.getText=function(){return this.text},r.prototype.getByteSegments=function(){return this.byteSegments},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getErrorsCorrected=function(){return this.errorsCorrected},r.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},r.prototype.getErasures=function(){return this.erasures},r.prototype.setErasures=function(e){this.erasures=e},r.prototype.getOther=function(){return this.other},r.prototype.setOther=function(e){this.other=e},r.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},r.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},r.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},r}(),Sn=function(){function r(){}return r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new re;return this.logTable[e]},r.addOrSubtract=function(e,t){return e^t},r}(),yr=function(){function r(e,t){if(t.length===0)throw new re;this.field=e;var n=t.length;if(n>1&&t[0]===0){for(var a=1;a<n&&t[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),Oe.arraycopy(t,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var t=this.coefficients,n;if(e===1){n=0;for(var a=0,i=t.length;a!==i;a++){var o=t[a];n=Sn.addOrSubtract(n,o)}return n}n=t[0];for(var s=t.length,l=this.field,a=1;a<s;a++)n=Sn.addOrSubtract(l.multiply(e,n),t[a]);return n},r.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new re("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var a=t;t=n,n=a}var i=new Int32Array(n.length),o=n.length-t.length;Oe.arraycopy(n,0,i,0,o);for(var s=o;s<n.length;s++)i[s]=Sn.addOrSubtract(t[s-o],n[s]);return new r(this.field,i)},r.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new re("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var t=this.coefficients,n=t.length,a=e.coefficients,i=a.length,o=new Int32Array(n+i-1),s=this.field,l=0;l<n;l++)for(var c=t[l],d=0;d<i;d++)o[l+d]=Sn.addOrSubtract(o[l+d],s.multiply(c,a[d]));return new r(s,o)},r.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var t=this.coefficients.length,n=this.field,a=new Int32Array(t),i=this.coefficients,o=0;o<t;o++)a[o]=n.multiply(i[o],e);return new r(n,a)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new re;if(t===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,i=new Int32Array(a+e),o=this.field,s=0;s<a;s++)i[s]=o.multiply(n[s],t);return new r(o,i)},r.prototype.divide=function(e){if(!this.field.equals(e.field))throw new re("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new re("Divide by 0");for(var t=this.field,n=t.getZero(),a=this,i=e.getCoefficient(e.getDegree()),o=t.inverse(i);a.getDegree()>=e.getDegree()&&!a.isZero();){var s=a.getDegree()-e.getDegree(),l=t.multiply(a.getCoefficient(a.getDegree()),o),c=e.multiplyByMonomial(s,l),d=t.buildMonomial(s,l);n=n.addOrSubtract(d),a=a.addOrSubtract(c)}return[n,a]},r.prototype.toString=function(){for(var e="",t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e},r}(),rp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ku=function(r){rp(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(It),np=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Nt=function(r){np(e,r);function e(t,n,a){var i=r.call(this)||this;i.primitive=t,i.size=n,i.generatorBase=a;for(var o=new Int32Array(n),s=1,l=0;l<n;l++)o[l]=s,s*=2,s>=n&&(s^=t,s&=n-1);i.expTable=o;for(var c=new Int32Array(n),l=0;l<n-1;l++)c[o[l]]=l;return i.logTable=c,i.zero=new yr(i,Int32Array.from([0])),i.one=new yr(i,Int32Array.from([1])),i}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,n){if(t<0)throw new re;if(n===0)return this.zero;var a=new Int32Array(t+1);return a[0]=n,new yr(this,a)},e.prototype.inverse=function(t){if(t===0)throw new ku;return this.expTable[this.size-this.logTable[t]-1]},e.prototype.multiply=function(t,n){return t===0||n===0?0:this.expTable[(this.logTable[t]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+he.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(t){return t===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(Sn),ap=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),oa=function(r){ap(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(It),ip=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jn=function(r){ip(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(It),za=function(){function r(e){this.field=e}return r.prototype.decode=function(e,t){for(var n=this.field,a=new yr(n,e),i=new Int32Array(t),o=!0,s=0;s<t;s++){var l=a.evaluateAt(n.exp(s+n.getGeneratorBase()));i[i.length-1-s]=l,l!==0&&(o=!1)}if(!o)for(var c=new yr(n,i),d=this.runEuclideanAlgorithm(n.buildMonomial(t,1),c,t),f=d[0],h=d[1],p=this.findErrorLocations(f),g=this.findErrorMagnitudes(h,p),s=0;s<p.length;s++){var y=e.length-1-n.log(p[s]);if(y<0)throw new oa("Bad error location");e[y]=Nt.addOrSubtract(e[y],g[s])}},r.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var a=e;e=t,t=a}for(var i=this.field,o=e,s=t,l=i.getZero(),c=i.getOne();s.getDegree()>=(n/2|0);){var d=o,f=l;if(o=s,l=c,o.isZero())throw new oa("r_{i-1} was zero");s=d;for(var h=i.getZero(),p=o.getCoefficient(o.getDegree()),g=i.inverse(p);s.getDegree()>=o.getDegree()&&!s.isZero();){var y=s.getDegree()-o.getDegree(),x=i.multiply(s.getCoefficient(s.getDegree()),g);h=h.addOrSubtract(i.buildMonomial(y,x)),s=s.addOrSubtract(o.multiplyByMonomial(y,x))}if(c=h.multiply(l).addOrSubtract(f),s.getDegree()>=o.getDegree())throw new Jn("Division algorithm failed to reduce polynomial?")}var v=c.getCoefficient(0);if(v===0)throw new oa("sigmaTilde(0) was zero");var b=i.inverse(v),_=c.multiplyScalar(b),w=s.multiplyScalar(b);return[_,w]},r.prototype.findErrorLocations=function(e){var t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(t),a=0,i=this.field,o=1;o<i.getSize()&&a<t;o++)e.evaluateAt(o)===0&&(n[a]=i.inverse(o),a++);if(a!==t)throw new oa("Error locator degree does not match number of roots");return n},r.prototype.findErrorMagnitudes=function(e,t){for(var n=t.length,a=new Int32Array(n),i=this.field,o=0;o<n;o++){for(var s=i.inverse(t[o]),l=1,c=0;c<n;c++)if(o!==c){var d=i.multiply(t[c],s),f=d&1?d&-2:d|1;l=i.multiply(l,f)}a[o]=i.multiply(e.evaluateAt(s),i.inverse(l)),i.getGeneratorBase()!==0&&(a[o]=i.multiply(a[o],s))}return a},r}(),lt;(function(r){r[r.UPPER=0]="UPPER",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.DIGIT=3]="DIGIT",r[r.PUNCT=4]="PUNCT",r[r.BINARY=5]="BINARY"})(lt||(lt={}));var ks=function(){function r(){}return r.prototype.decode=function(e){this.ddata=e;var t=e.getBits(),n=this.extractBits(t),a=this.correctBits(n),i=r.convertBoolArrayToByteArray(a),o=r.getEncodedData(a),s=new Ga(i,o,null,null);return s.setNumBits(a.length),s},r.highLevelDecode=function(e){return this.getEncodedData(e)},r.getEncodedData=function(e){for(var t=e.length,n=lt.UPPER,a=lt.UPPER,i="",o=0;o<t;)if(a===lt.BINARY){if(t-o<5)break;var s=r.readCode(e,o,5);if(o+=5,s===0){if(t-o<11)break;s=r.readCode(e,o,11)+31,o+=11}for(var l=0;l<s;l++){if(t-o<8){o=t;break}var c=r.readCode(e,o,8);i+=ve.castAsNonUtf8Char(c),o+=8}a=n}else{var d=a===lt.DIGIT?4:5;if(t-o<d)break;var c=r.readCode(e,o,d);o+=d;var f=r.getCharacter(a,c);f.startsWith("CTRL_")?(n=a,a=r.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(i+=f,a=n)}return i},r.getTable=function(e){switch(e){case"L":return lt.LOWER;case"P":return lt.PUNCT;case"M":return lt.MIXED;case"D":return lt.DIGIT;case"B":return lt.BINARY;case"U":default:return lt.UPPER}},r.getCharacter=function(e,t){switch(e){case lt.UPPER:return r.UPPER_TABLE[t];case lt.LOWER:return r.LOWER_TABLE[t];case lt.MIXED:return r.MIXED_TABLE[t];case lt.PUNCT:return r.PUNCT_TABLE[t];case lt.DIGIT:return r.DIGIT_TABLE[t];default:throw new Jn("Bad table")}},r.prototype.correctBits=function(e){var t,n;this.ddata.getNbLayers()<=2?(n=6,t=Nt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=Nt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=Nt.AZTEC_DATA_10):(n=12,t=Nt.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),i=e.length/n;if(i<a)throw new $;for(var o=e.length%n,s=new Int32Array(i),l=0;l<i;l++,o+=n)s[l]=r.readCode(e,o,n);try{var c=new za(t);c.decode(s,i-a)}catch(x){throw new $(x)}for(var d=(1<<n)-1,f=0,l=0;l<a;l++){var h=s[l];if(h===0||h===d)throw new $;(h===1||h===d-1)&&f++}for(var p=new Array(a*n-f),g=0,l=0;l<a;l++){var h=s[l];if(h===1||h===d-1)p.fill(h>1,g,g+n-1),g+=n-1;else for(var y=n-1;y>=0;--y)p[g++]=(h&1<<y)!==0}return p},r.prototype.extractBits=function(e){var t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(t?11:14)+n*4,i=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,t));if(t)for(var s=0;s<i.length;s++)i[s]=s;else for(var l=a+1+2*he.truncDivision(he.truncDivision(a,2)-1,15),c=a/2,d=he.truncDivision(l,2),s=0;s<c;s++){var f=s+he.truncDivision(s,15);i[c-s-1]=d-f-1,i[c+s]=d+f+1}for(var s=0,h=0;s<n;s++){for(var p=(n-s)*4+(t?9:12),g=s*2,y=a-1-g,x=0;x<p;x++)for(var v=x*2,b=0;b<2;b++)o[h+v+b]=e.get(i[g+b],i[g+x]),o[h+2*p+v+b]=e.get(i[g+x],i[y-b]),o[h+4*p+v+b]=e.get(i[y-b],i[y-x]),o[h+6*p+v+b]=e.get(i[y-x],i[g+b]);h+=p*8}return o},r.readCode=function(e,t,n){for(var a=0,i=t;i<t+n;i++)a<<=1,e[i]&&(a|=1);return a},r.readByte=function(e,t){var n=e.length-t;return n>=8?r.readCode(e,t,8):r.readCode(e,t,n)<<8-n},r.convertBoolArrayToByteArray=function(e){for(var t=new Uint8Array((e.length+7)/8),n=0;n<t.length;n++)t[n]=r.readByte(e,8*n);return t},r.prototype.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],r.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],r.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],r.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],r.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],r}(),we=function(){function r(){}return r.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},r.distance=function(e,t,n,a){var i=e-n,o=t-a;return Math.sqrt(i*i+o*o)},r.sum=function(e){for(var t=0,n=0,a=e.length;n!==a;n++){var i=e[n];t+=i}return t},r}(),Xi=function(){function r(){}return r.floatToIntBits=function(e){return e},r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),q=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r.prototype.equals=function(e){if(e instanceof r){var t=e;return this.x===t.x&&this.y===t.y}return!1},r.prototype.hashCode=function(){return 31*Xi.floatToIntBits(this.x)+Xi.floatToIntBits(this.y)},r.prototype.toString=function(){return"("+this.x+","+this.y+")"},r.orderBestPatterns=function(e){var t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),i,o,s;if(n>=t&&n>=a?(o=e[0],i=e[1],s=e[2]):a>=n&&a>=t?(o=e[1],i=e[0],s=e[2]):(o=e[2],i=e[0],s=e[1]),this.crossProductZ(i,o,s)<0){var l=i;i=s,s=l}e[0]=i,e[1]=o,e[2]=s},r.distance=function(e,t){return we.distance(e.x,e.y,t.x,t.y)},r.crossProductZ=function(e,t,n){var a=t.x,i=t.y;return(n.x-a)*(e.y-i)-(n.y-i)*(e.x-a)},r}(),Oo=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),op=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),sp=function(r){op(e,r);function e(t,n,a,i,o){var s=r.call(this,t,n)||this;return s.compact=a,s.nbDatablocks=i,s.nbLayers=o,s}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(Oo),qi=function(){function r(e,t,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=r.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var i=t/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=a-i,this.downInit=a+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new k}return r.prototype.detect=function(){for(var e=this.leftInit,t=this.rightInit,n=this.upInit,a=this.downInit,i=!1,o=!0,s=!1,l=!1,c=!1,d=!1,f=!1,h=this.width,p=this.height;o;){o=!1;for(var g=!0;(g||!l)&&t<h;)g=this.containsBlackPoint(n,a,t,!1),g?(t++,o=!0,l=!0):l||t++;if(t>=h){i=!0;break}for(var y=!0;(y||!c)&&a<p;)y=this.containsBlackPoint(e,t,a,!0),y?(a++,o=!0,c=!0):c||a++;if(a>=p){i=!0;break}for(var x=!0;(x||!d)&&e>=0;)x=this.containsBlackPoint(n,a,e,!1),x?(e--,o=!0,d=!0):d||e--;if(e<0){i=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,t,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){i=!0;break}o&&(s=!0)}if(!i&&s){for(var b=t-e,_=null,w=1;_===null&&w<b;w++)_=this.getBlackPointOnSegment(e,a-w,e+w,a);if(_==null)throw new k;for(var A=null,w=1;A===null&&w<b;w++)A=this.getBlackPointOnSegment(e,n+w,e+w,n);if(A==null)throw new k;for(var C=null,w=1;C===null&&w<b;w++)C=this.getBlackPointOnSegment(t,n+w,t-w,n);if(C==null)throw new k;for(var I=null,w=1;I===null&&w<b;w++)I=this.getBlackPointOnSegment(t,a-w,t-w,a);if(I==null)throw new k;return this.centerEdges(I,_,C,A)}else throw new k},r.prototype.getBlackPointOnSegment=function(e,t,n,a){for(var i=we.round(we.distance(e,t,n,a)),o=(n-e)/i,s=(a-t)/i,l=this.image,c=0;c<i;c++){var d=we.round(e+c*o),f=we.round(t+c*s);if(l.get(d,f))return new q(d,f)}return null},r.prototype.centerEdges=function(e,t,n,a){var i=e.getX(),o=e.getY(),s=t.getX(),l=t.getY(),c=n.getX(),d=n.getY(),f=a.getX(),h=a.getY(),p=r.CORR;return i<this.width/2?[new q(f-p,h+p),new q(s+p,l+p),new q(c-p,d-p),new q(i+p,o-p)]:[new q(f+p,h+p),new q(s+p,l-p),new q(c-p,d+p),new q(i-p,o-p)]},r.prototype.containsBlackPoint=function(e,t,n,a){var i=this.image;if(a){for(var o=e;o<=t;o++)if(i.get(o,n))return!0}else for(var s=e;s<=t;s++)if(i.get(n,s))return!0;return!1},r.INIT_SIZE=10,r.CORR=1,r}(),Fs=function(){function r(){}return r.checkAndNudgePoints=function(e,t){for(var n=e.getWidth(),a=e.getHeight(),i=!0,o=0;o<t.length&&i;o+=2){var s=Math.floor(t[o]),l=Math.floor(t[o+1]);if(s<-1||s>n||l<-1||l>a)throw new k;i=!1,s===-1?(t[o]=0,i=!0):s===n&&(t[o]=n-1,i=!0),l===-1?(t[o+1]=0,i=!0):l===a&&(t[o+1]=a-1,i=!0)}i=!0;for(var o=t.length-2;o>=0&&i;o-=2){var s=Math.floor(t[o]),l=Math.floor(t[o+1]);if(s<-1||s>n||l<-1||l>a)throw new k;i=!1,s===-1?(t[o]=0,i=!0):s===n&&(t[o]=n-1,i=!0),l===-1?(t[o+1]=0,i=!0):l===a&&(t[o+1]=a-1,i=!0)}},r}(),Fu=function(){function r(e,t,n,a,i,o,s,l,c){this.a11=e,this.a21=t,this.a31=n,this.a12=a,this.a22=i,this.a32=o,this.a13=s,this.a23=l,this.a33=c}return r.quadrilateralToQuadrilateral=function(e,t,n,a,i,o,s,l,c,d,f,h,p,g,y,x){var v=r.quadrilateralToSquare(e,t,n,a,i,o,s,l),b=r.squareToQuadrilateral(c,d,f,h,p,g,y,x);return b.times(v)},r.prototype.transformPoints=function(e){for(var t=e.length,n=this.a11,a=this.a12,i=this.a13,o=this.a21,s=this.a22,l=this.a23,c=this.a31,d=this.a32,f=this.a33,h=0;h<t;h+=2){var p=e[h],g=e[h+1],y=i*p+l*g+f;e[h]=(n*p+o*g+c)/y,e[h+1]=(a*p+s*g+d)/y}},r.prototype.transformPointsWithValues=function(e,t){for(var n=this.a11,a=this.a12,i=this.a13,o=this.a21,s=this.a22,l=this.a23,c=this.a31,d=this.a32,f=this.a33,h=e.length,p=0;p<h;p++){var g=e[p],y=t[p],x=i*g+l*y+f;e[p]=(n*g+o*y+c)/x,t[p]=(a*g+s*y+d)/x}},r.squareToQuadrilateral=function(e,t,n,a,i,o,s,l){var c=e-n+i-s,d=t-a+o-l;if(c===0&&d===0)return new r(n-e,i-n,e,a-t,o-a,t,0,0,1);var f=n-i,h=s-i,p=a-o,g=l-o,y=f*g-h*p,x=(c*g-h*d)/y,v=(f*d-c*p)/y;return new r(n-e+x*n,s-e+v*s,e,a-t+x*a,l-t+v*l,t,x,v,1)},r.quadrilateralToSquare=function(e,t,n,a,i,o,s,l){return r.squareToQuadrilateral(e,t,n,a,i,o,s,l).buildAdjoint()},r.prototype.buildAdjoint=function(){return new r(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},r.prototype.times=function(e){return new r(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},r}(),lp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cp=function(r){lp(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.sampleGrid=function(t,n,a,i,o,s,l,c,d,f,h,p,g,y,x,v,b,_,w){var A=Fu.quadrilateralToQuadrilateral(i,o,s,l,c,d,f,h,p,g,y,x,v,b,_,w);return this.sampleGridWithTransform(t,n,a,A)},e.prototype.sampleGridWithTransform=function(t,n,a,i){if(n<=0||a<=0)throw new k;for(var o=new er(n,a),s=new Float32Array(2*n),l=0;l<a;l++){for(var c=s.length,d=l+.5,f=0;f<c;f+=2)s[f]=f/2+.5,s[f+1]=d;i.transformPoints(s),Fs.checkAndNudgePoints(t,s);try{for(var f=0;f<c;f+=2)t.get(Math.floor(s[f]),Math.floor(s[f+1]))&&o.set(f/2,l)}catch{throw new k}}return o},e}(Fs),Do=function(){function r(){}return r.setGridSampler=function(e){r.gridSampler=e},r.getInstance=function(){return r.gridSampler},r.gridSampler=new cp,r}(),Ct=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.toResultPoint=function(){return new q(this.getX(),this.getY())},r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r}(),up=function(){function r(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return r.prototype.detect=function(){return this.detectMirror(!1)},r.prototype.detectMirror=function(e){var t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var i=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new sp(i,o,this.compact,this.nbDataBlocks,this.nbLayers)},r.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new k;var t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);for(var a=0,i=0;i<4;i++){var o=n[(this.shift+i)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var s=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(s>>6)+1,this.nbDataBlocks=(s&63)+1):(this.nbLayers=(s>>11)+1,this.nbDataBlocks=(s&2047)+1)},r.prototype.getRotation=function(e,t){var n=0;e.forEach(function(i,o,s){var l=(i>>t-2<<1)+(i&1);n=(n<<3)+l}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(he.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new k},r.prototype.getCorrectedParameterData=function(e,t){var n,a;t?(n=7,a=2):(n=10,a=4);for(var i=n-a,o=new Int32Array(n),s=n-1;s>=0;--s)o[s]=e&15,e>>=4;try{var l=new za(Nt.AZTEC_PARAM);l.decode(o,i)}catch{throw new k}for(var c=0,s=0;s<a;s++)c=(c<<4)+o[s];return c},r.prototype.getBullsEyeCorners=function(e){var t=e,n=e,a=e,i=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var s=this.getFirstDifferent(t,o,1,-1),l=this.getFirstDifferent(n,o,1,1),c=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,s)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(s,l,c,d))break}t=s,n=l,a=c,i=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new k;this.compact=this.nbCenterLayers===5;var h=new q(t.getX()+.5,t.getY()-.5),p=new q(n.getX()+.5,n.getY()+.5),g=new q(a.getX()-.5,a.getY()+.5),y=new q(i.getX()-.5,i.getY()-.5);return this.expandSquare([h,p,g,y],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},r.prototype.getMatrixCenter=function(){var e,t,n,a;try{var i=new qi(this.image).detect();e=i[0],t=i[1],n=i[2],a=i[3]}catch{var o=this.image.getWidth()/2,s=this.image.getHeight()/2;e=this.getFirstDifferent(new Ct(o+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Ct(o+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Ct(o-7,s+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Ct(o-7,s-7),!1,-1,-1).toResultPoint()}var l=we.round((e.getX()+a.getX()+t.getX()+n.getX())/4),c=we.round((e.getY()+a.getY()+t.getY()+n.getY())/4);try{var i=new qi(this.image,15,l,c).detect();e=i[0],t=i[1],n=i[2],a=i[3]}catch{e=this.getFirstDifferent(new Ct(l+7,c-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Ct(l+7,c+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Ct(l-7,c+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Ct(l-7,c-7),!1,-1,-1).toResultPoint()}return l=we.round((e.getX()+a.getX()+t.getX()+n.getX())/4),c=we.round((e.getY()+a.getY()+t.getY()+n.getY())/4),new Ct(l,c)},r.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},r.prototype.sampleGrid=function(e,t,n,a,i){var o=Do.getInstance(),s=this.getDimension(),l=s/2-this.nbCenterLayers,c=s/2+this.nbCenterLayers;return o.sampleGrid(e,s,s,l,l,c,l,c,c,l,c,t.getX(),t.getY(),n.getX(),n.getY(),a.getX(),a.getY(),i.getX(),i.getY())},r.prototype.sampleLine=function(e,t,n){for(var a=0,i=this.distanceResultPoint(e,t),o=i/n,s=e.getX(),l=e.getY(),c=o*(t.getX()-e.getX())/i,d=o*(t.getY()-e.getY())/i,f=0;f<n;f++)this.image.get(we.round(s+f*c),we.round(l+f*d))&&(a|=1<<n-f-1);return a},r.prototype.isWhiteOrBlackRectangle=function(e,t,n,a){var i=3;e=new Ct(e.getX()-i,e.getY()+i),t=new Ct(t.getX()-i,t.getY()-i),n=new Ct(n.getX()+i,n.getY()-i),a=new Ct(a.getX()+i,a.getY()+i);var o=this.getColor(a,e);if(o===0)return!1;var s=this.getColor(e,t);return s!==o||(s=this.getColor(t,n),s!==o)?!1:(s=this.getColor(n,a),s===o)},r.prototype.getColor=function(e,t){for(var n=this.distancePoint(e,t),a=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,o=0,s=e.getX(),l=e.getY(),c=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)s+=a,l+=i,this.image.get(we.round(s),we.round(l))!==c&&o++;var h=o/n;return h>.1&&h<.9?0:h<=.1===c?1:-1},r.prototype.getFirstDifferent=function(e,t,n,a){for(var i=e.getX()+n,o=e.getY()+a;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=n,o+=a;for(i-=n,o-=a;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=n;for(i-=n;this.isValid(i,o)&&this.image.get(i,o)===t;)o+=a;return o-=a,new Ct(i,o)},r.prototype.expandSquare=function(e,t,n){var a=n/(2*t),i=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),s=(e[0].getX()+e[2].getX())/2,l=(e[0].getY()+e[2].getY())/2,c=new q(s+a*i,l+a*o),d=new q(s-a*i,l-a*o);i=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),s=(e[1].getX()+e[3].getX())/2,l=(e[1].getY()+e[3].getY())/2;var f=new q(s+a*i,l+a*o),h=new q(s-a*i,l-a*o),p=[c,f,d,h];return p},r.prototype.isValid=function(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()},r.prototype.isValidPoint=function(e){var t=we.round(e.getX()),n=we.round(e.getY());return this.isValid(t,n)},r.prototype.distancePoint=function(e,t){return we.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.distanceResultPoint=function(e,t){return we.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(he.truncDivision(this.nbLayers-4,8)+1)+15},r}(),Na=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n=null,a=new up(e.getBlackMatrix()),i=null,o=null;try{var s=a.detectMirror(!1);i=s.getPoints(),this.reportFoundResultPoints(t,i),o=new ks().decode(s)}catch(f){n=f}if(o==null)try{var s=a.detectMirror(!0);i=s.getPoints(),this.reportFoundResultPoints(t,i),o=new ks().decode(s)}catch(f){throw n??f}var l=new gt(o.getText(),o.getRawBytes(),o.getNumBits(),i,te.AZTEC,Oe.currentTimeMillis()),c=o.getByteSegments();c!=null&&l.putMetadata(dt.BYTE_SEGMENTS,c);var d=o.getECLevel();return d!=null&&l.putMetadata(dt.ERROR_CORRECTION_LEVEL,d),l},r.prototype.reportFoundResultPoints=function(e,t){if(e!=null){var n=e.get(De.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach(function(a,i,o){n.foundPossibleResultPoint(a)})}},r.prototype.reset=function(){},r}(),dp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){dp(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Na,t)||this}return e})(fn);var tt=function(){function r(){}return r.prototype.decode=function(e,t){try{return this.doDecode(e,t)}catch{var n=t&&t.get(De.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),i=this.doDecode(a,t),o=i.getResultMetadata(),s=270;o!==null&&o.get(dt.ORIENTATION)===!0&&(s=s+o.get(dt.ORIENTATION)%360),i.putMetadata(dt.ORIENTATION,s);var l=i.getResultPoints();if(l!==null)for(var c=a.getHeight(),d=0;d<l.length;d++)l[d]=new q(c-l[d].getY()-1,l[d].getX());return i}else throw new k}},r.prototype.reset=function(){},r.prototype.doDecode=function(e,t){var n=e.getWidth(),a=e.getHeight(),i=new ot(n),o=t&&t.get(De.TRY_HARDER)===!0,s=Math.max(1,a>>(o?8:5)),l;o?l=a:l=15;for(var c=Math.trunc(a/2),d=0;d<l;d++){var f=Math.trunc((d+1)/2),h=(d&1)===0,p=c+s*(h?f:-f);if(p<0||p>=a)break;try{i=e.getBlackRow(p,i)}catch{continue}for(var g=function(b){if(b===1&&(i.reverse(),t&&t.get(De.NEED_RESULT_POINT_CALLBACK)===!0)){var _=new Map;t.forEach(function(C,I){return _.set(I,C)}),_.delete(De.NEED_RESULT_POINT_CALLBACK),t=_}try{var w=y.decodeRow(p,i,t);if(b===1){w.putMetadata(dt.ORIENTATION,180);var A=w.getResultPoints();A!==null&&(A[0]=new q(n-A[0].getX()-1,A[0].getY()),A[1]=new q(n-A[1].getX()-1,A[1].getY()))}return{value:w}}catch{}},y=this,x=0;x<2;x++){var v=g(x);if(typeof v=="object")return v.value}}throw new k},r.recordPattern=function(e,t,n){for(var a=n.length,i=0;i<a;i++)n[i]=0;var o=e.getSize();if(t>=o)throw new k;for(var s=!e.get(t),l=0,c=t;c<o;){if(e.get(c)!==s)n[l]++;else{if(++l===a)break;n[l]=1,s=!s}c++}if(!(l===a||l===a-1&&c===o))throw new k},r.recordPatternInReverse=function(e,t,n){for(var a=n.length,i=e.get(t);t>0&&a>=0;)e.get(--t)!==i&&(a--,i=!i);if(a>=0)throw new k;r.recordPattern(e,t+1,n)},r.patternMatchVariance=function(e,t,n){for(var a=e.length,i=0,o=0,s=0;s<a;s++)i+=e[s],o+=t[s];if(i<o)return Number.POSITIVE_INFINITY;var l=i/o;n*=l;for(var c=0,d=0;d<a;d++){var f=e[d],h=t[d]*l,p=f>h?f-h:h-f;if(p>n)return Number.POSITIVE_INFINITY;c+=p}return c/i},r}(),fp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bs=function(r){fp(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.findStartPattern=function(t){for(var n=t.getSize(),a=t.getNextSet(0),i=0,o=Int32Array.from([0,0,0,0,0,0]),s=a,l=!1,c=6,d=a;d<n;d++)if(t.get(d)!==l)o[i]++;else{if(i===c-1){for(var f=e.MAX_AVG_VARIANCE,h=-1,p=e.CODE_START_A;p<=e.CODE_START_C;p++){var g=tt.patternMatchVariance(o,e.CODE_PATTERNS[p],e.MAX_INDIVIDUAL_VARIANCE);g<f&&(f=g,h=p)}if(h>=0&&t.isRange(Math.max(0,s-(d-s)/2),s,!1))return Int32Array.from([s,d,h]);s+=o[0]+o[1],o=o.slice(2,o.length),o[i-1]=0,o[i]=0,i--}else i++;o[i]=1,l=!l}throw new k},e.decodeCode=function(t,n,a){tt.recordPattern(t,a,n);for(var i=e.MAX_AVG_VARIANCE,o=-1,s=0;s<e.CODE_PATTERNS.length;s++){var l=e.CODE_PATTERNS[s],c=this.patternMatchVariance(n,l,e.MAX_INDIVIDUAL_VARIANCE);c<i&&(i=c,o=s)}if(o>=0)return o;throw new k},e.prototype.decodeRow=function(t,n,a){var i=a&&a.get(De.ASSUME_GS1)===!0,o=e.findStartPattern(n),s=o[2],l=0,c=new Uint8Array(20);c[l++]=s;var d;switch(s){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new $}for(var f=!1,h=!1,p="",g=o[0],y=o[1],x=Int32Array.from([0,0,0,0,0,0]),v=0,b=0,_=s,w=0,A=!0,C=!1,I=!1;!f;){var R=h;switch(h=!1,v=b,b=e.decodeCode(n,x,y),c[l++]=b,b!==e.CODE_STOP&&(A=!0),b!==e.CODE_STOP&&(w++,_+=w*b),g=y,y+=x.reduce(function(W,X){return W+X},0),b){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new $}switch(d){case e.CODE_CODE_A:if(b<64)I===C?p+=String.fromCharCode(32+b):p+=String.fromCharCode(32+b+128),I=!1;else if(b<96)I===C?p+=String.fromCharCode(b-64):p+=String.fromCharCode(b+64),I=!1;else switch(b!==e.CODE_STOP&&(A=!1),b){case e.CODE_FNC_1:i&&(p.length===0?p+="]C1":p+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!C&&I?(C=!0,I=!1):C&&I?(C=!1,I=!1):I=!0;break;case e.CODE_SHIFT:h=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(b<96)I===C?p+=String.fromCharCode(32+b):p+=String.fromCharCode(32+b+128),I=!1;else switch(b!==e.CODE_STOP&&(A=!1),b){case e.CODE_FNC_1:i&&(p.length===0?p+="]C1":p+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!C&&I?(C=!0,I=!1):C&&I?(C=!1,I=!1):I=!0;break;case e.CODE_SHIFT:h=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(b<100)b<10&&(p+="0"),p+=b;else switch(b!==e.CODE_STOP&&(A=!1),b){case e.CODE_FNC_1:i&&(p.length===0?p+="]C1":p+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}R&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var F=y-g;if(y=n.getNextUnset(y),!n.isRange(y,Math.min(n.getSize(),y+(y-g)/2),!1))throw new k;if(_-=w*v,_%103!==v)throw new Ye;var T=p.length;if(T===0)throw new k;T>0&&A&&(d===e.CODE_CODE_C?p=p.substring(0,T-2):p=p.substring(0,T-1));for(var U=(o[1]+o[0])/2,L=g+F/2,B=c.length,H=new Uint8Array(B),Q=0;Q<B;Q++)H[Q]=c[Q];var ae=[new q(U,t),new q(L,t)];return new gt(p,H,0,ae,te.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(tt),hp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ii=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vs=function(r){hp(e,r);function e(t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var a=r.call(this)||this;return a.usingCheckDigit=t,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(t,n,a){var i,o,s,l,c=this.counters;c.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,c),f=n.getNextSet(d[1]),h=n.getSize(),p,g;do{e.recordPattern(n,f,c);var y=e.toNarrowWidePattern(c);if(y<0)throw new k;p=e.patternToChar(y),this.decodeRowResult+=p,g=f;try{for(var x=(i=void 0,ii(c)),v=x.next();!v.done;v=x.next()){var b=v.value;f+=b}}catch(B){i={error:B}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(i)throw i.error}}f=n.getNextSet(f)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var _=0;try{for(var w=ii(c),A=w.next();!A.done;A=w.next()){var b=A.value;_+=b}}catch(B){s={error:B}}finally{try{A&&!A.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}var C=f-g-_;if(f!==h&&C*2<_)throw new k;if(this.usingCheckDigit){for(var I=this.decodeRowResult.length-1,R=0,F=0;F<I;F++)R+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(F));if(this.decodeRowResult.charAt(I)!==e.ALPHABET_STRING.charAt(R%43))throw new Ye;this.decodeRowResult=this.decodeRowResult.substring(0,I)}if(this.decodeRowResult.length===0)throw new k;var T;this.extendedMode?T=e.decodeExtended(this.decodeRowResult):T=this.decodeRowResult;var U=(d[1]+d[0])/2,L=g+_/2;return new gt(T,null,0,[new q(U,t),new q(L,t)],te.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(t,n){for(var a=t.getSize(),i=t.getNextSet(0),o=0,s=i,l=!1,c=n.length,d=i;d<a;d++)if(t.get(d)!==l)n[o]++;else{if(o===c-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&t.isRange(Math.max(0,s-Math.floor((d-s)/2)),s,!1))return[s,d];s+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,l=!l}throw new k},e.toNarrowWidePattern=function(t){var n,a,i=t.length,o=0,s;do{var l=2147483647;try{for(var c=(n=void 0,ii(t)),d=c.next();!d.done;d=c.next()){var f=d.value;f<l&&f>o&&(l=f)}}catch(y){n={error:y}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}o=l,s=0;for(var h=0,p=0,g=0;g<i;g++){var f=t[g];f>o&&(p|=1<<i-1-g,s++,h+=f)}if(s===3){for(var g=0;g<i&&s>0;g++){var f=t[g];if(f>o&&(s--,f*2>=h))return-1}return p}}while(s>3);return-1},e.patternToChar=function(t){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===t)return e.ALPHABET_STRING.charAt(n);if(t===e.ASTERISK_ENCODING)return"*";throw new k},e.decodeExtended=function(t){for(var n=t.length,a="",i=0;i<n;i++){var o=t.charAt(i);if(o==="+"||o==="$"||o==="%"||o==="/"){var s=t.charAt(i+1),l="\0";switch(o){case"+":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)+32);else throw new $;break;case"$":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)-64);else throw new $;break;case"%":if(s>="A"&&s<="E")l=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")l=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")l=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")l="\0";else if(s==="V")l="@";else if(s==="W")l="`";else if(s==="X"||s==="Y"||s==="Z")l="";else throw new $;break;case"/":if(s>="A"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")l=":";else throw new $;break}a+=l,i++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(tt),pp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),oi=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},js=function(r){pp(e,r);function e(){var t=r.call(this)||this;return t.decodeRowResult="",t.counters=new Int32Array(6),t}return e.prototype.decodeRow=function(t,n,a){var i,o,s,l,c=this.findAsteriskPattern(n),d=n.getNextSet(c[1]),f=n.getSize(),h=this.counters;h.fill(0),this.decodeRowResult="";var p,g;do{e.recordPattern(n,d,h);var y=this.toPattern(h);if(y<0)throw new k;p=this.patternToChar(y),this.decodeRowResult+=p,g=d;try{for(var x=(i=void 0,oi(h)),v=x.next();!v.done;v=x.next()){var b=v.value;d+=b}}catch(F){i={error:F}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(i)throw i.error}}d=n.getNextSet(d)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var _=0;try{for(var w=oi(h),A=w.next();!A.done;A=w.next()){var b=A.value;_+=b}}catch(F){s={error:F}}finally{try{A&&!A.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}if(d===f||!n.get(d))throw new k;if(this.decodeRowResult.length<2)throw new k;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var C=this.decodeExtended(this.decodeRowResult),I=(c[1]+c[0])/2,R=g+_/2;return new gt(C,null,0,[new q(I,t),new q(R,t)],te.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(t){var n=t.getSize(),a=t.getNextSet(0);this.counters.fill(0);for(var i=this.counters,o=a,s=!1,l=i.length,c=0,d=a;d<n;d++)if(t.get(d)!==s)i[c]++;else{if(c===l-1){if(this.toPattern(i)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=i[0]+i[1],i.copyWithin(0,2,2+c-1),i[c-1]=0,i[c]=0,c--}else c++;i[c]=1,s=!s}throw new k},e.prototype.toPattern=function(t){var n,a,i=0;try{for(var o=oi(t),s=o.next();!s.done;s=o.next()){var l=s.value;i+=l}}catch(g){n={error:g}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var c=0,d=t.length,f=0;f<d;f++){var h=Math.round(t[f]*9/i);if(h<1||h>4)return-1;if(f&1)c<<=h;else for(var p=0;p<h;p++)c=c<<1|1}return c},e.prototype.patternToChar=function(t){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===t)return e.ALPHABET_STRING.charAt(n);throw new k},e.prototype.decodeExtended=function(t){for(var n=t.length,a="",i=0;i<n;i++){var o=t.charAt(i);if(o>="a"&&o<="d"){if(i>=n-1)throw new $;var s=t.charAt(i+1),l="\0";switch(o){case"d":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)+32);else throw new $;break;case"a":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)-64);else throw new $;break;case"b":if(s>="A"&&s<="E")l=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")l=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")l=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")l="\0";else if(s==="V")l="@";else if(s==="W")l="`";else if(s>="X"&&s<="Z")l="";else throw new $;break;case"c":if(s>="A"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")l=":";else throw new $;break}a+=l,i++}else a+=o}return a},e.prototype.checkChecksums=function(t){var n=t.length;this.checkOneChecksum(t,n-2,20),this.checkOneChecksum(t,n-1,15)},e.prototype.checkOneChecksum=function(t,n,a){for(var i=1,o=0,s=n-1;s>=0;s--)o+=i*e.ALPHABET_STRING.indexOf(t.charAt(s)),++i>a&&(i=1);if(t.charAt(n)!==e.ALPHABET_STRING[o%47])throw new Ye},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(tt),mp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),gp=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Us=function(r){mp(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.narrowLineWidth=-1,t}return e.prototype.decodeRow=function(t,n,a){var i,o,s=this.decodeStart(n),l=this.decodeEnd(n),c=new de;e.decodeMiddle(n,s[1],l[0],c);var d=c.toString(),f=null;a!=null&&(f=a.get(De.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var h=d.length,p=!1,g=0;try{for(var y=gp(f),x=y.next();!x.done;x=y.next()){var v=x.value;if(h===v){p=!0;break}v>g&&(g=v)}}catch(w){i={error:w}}finally{try{x&&!x.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}if(!p&&h>g&&(p=!0),!p)throw new $;var b=[new q(s[1],t),new q(l[0],t)],_=new gt(d,null,0,b,te.ITF,new Date().getTime());return _},e.decodeMiddle=function(t,n,a,i){var o=new Int32Array(10),s=new Int32Array(5),l=new Int32Array(5);for(o.fill(0),s.fill(0),l.fill(0);n<a;){tt.recordPattern(t,n,o);for(var c=0;c<5;c++){var d=2*c;s[c]=o[d],l[c]=o[d+1]}var f=e.decodeDigit(s);i.append(f.toString()),f=this.decodeDigit(l),i.append(f.toString()),o.forEach(function(h){n+=h})}},e.prototype.decodeStart=function(t){var n=e.skipWhiteSpace(t),a=e.findGuardPattern(t,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(t,a[0]),a},e.prototype.validateQuietZone=function(t,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var i=n-1;a>0&&i>=0&&!t.get(i);i--)a--;if(a!==0)throw new k},e.skipWhiteSpace=function(t){var n=t.getSize(),a=t.getNextSet(0);if(a===n)throw new k;return a},e.prototype.decodeEnd=function(t){t.reverse();try{var n=e.skipWhiteSpace(t),a=void 0;try{a=e.findGuardPattern(t,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof k&&(a=e.findGuardPattern(t,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,a[0]);var i=a[0];return a[0]=t.getSize()-a[1],a[1]=t.getSize()-i,a}finally{t.reverse()}},e.findGuardPattern=function(t,n,a){var i=a.length,o=new Int32Array(i),s=t.getSize(),l=!1,c=0,d=n;o.fill(0);for(var f=n;f<s;f++)if(t.get(f)!==l)o[c]++;else{if(c===i-1){if(tt.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],Oe.arraycopy(o,2,o,0,c-1),o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,l=!l}throw new k},e.decodeDigit=function(t){for(var n=e.MAX_AVG_VARIANCE,a=-1,i=e.PATTERNS.length,o=0;o<i;o++){var s=e.PATTERNS[o],l=tt.patternMatchVariance(t,s,e.MAX_INDIVIDUAL_VARIANCE);l<n?(n=l,a=o):l===n&&(a=-1)}if(a>=0)return a%10;throw new k},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(tt),vp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ln=function(r){vp(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.decodeRowStringBuffer="",t}return e.findStartGuardPattern=function(t){for(var n=!1,a,i=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(t,i,!1,this.START_END_PATTERN,o);var s=a[0];i=a[1];var l=s-(i-s);l>=0&&(n=t.isRange(l,s,!1))}return a},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var n=t.length;if(n===0)return!1;var a=parseInt(t.charAt(n-1),10);return e.getStandardUPCEANChecksum(t.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(t){for(var n=t.length,a=0,i=n-1;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new $;a+=o}a*=3;for(var i=n-2;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new $;a+=o}return(1e3-a)%10},e.decodeEnd=function(t,n){return e.findGuardPattern(t,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(t,n,a,i){return this.findGuardPattern(t,n,a,i,new Int32Array(i.length))},e.findGuardPattern=function(t,n,a,i,o){var s=t.getSize();n=a?t.getNextUnset(n):t.getNextSet(n);for(var l=0,c=n,d=i.length,f=a,h=n;h<s;h++)if(t.get(h)!==f)o[l]++;else{if(l===d-1){if(tt.patternMatchVariance(o,i,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([c,h]);c+=o[0]+o[1];for(var p=o.slice(2,o.length),g=0;g<l-1;g++)o[g]=p[g];o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,f=!f}throw new k},e.decodeDigit=function(t,n,a,i){this.recordPattern(t,a,n);for(var o=this.MAX_AVG_VARIANCE,s=-1,l=i.length,c=0;c<l;c++){var d=i[c],f=tt.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,s=c)}if(s>=0)return s;throw new k},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(tt),yp=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xp=function(){function r(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,n){var a=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,a),o=a.toString(),s=r.parseExtensionString(o),l=[new q((n[0]+n[1])/2,e),new q(i,e)],c=new gt(o,null,0,l,te.UPC_EAN_EXTENSION,new Date().getTime());return s!=null&&c.putAllMetadata(s),c},r.prototype.decodeMiddle=function(e,t,n){var a,i,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=e.getSize(),l=t[1],c=0,d=0;d<5&&l<s;d++){var f=ln.decodeDigit(e,o,l,ln.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var h=(a=void 0,yp(o)),p=h.next();!p.done;p=h.next()){var g=p.value;l+=g}}catch(x){a={error:x}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}f>=10&&(c|=1<<4-d),d!==4&&(l=e.getNextSet(l),l=e.getNextUnset(l))}if(n.length!==5)throw new k;var y=this.determineCheckDigit(c);if(r.extensionChecksum(n.toString())!==y)throw new k;return l},r.extensionChecksum=function(e){for(var t=e.length,n=0,a=t-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=t-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},r.prototype.determineCheckDigit=function(e){for(var t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new k},r.parseExtensionString=function(e){if(e.length!==5)return null;var t=r.parseExtension5String(e);return t==null?null:new Map([[dt.SUGGESTED_PRICE,t]])},r.parseExtension5String=function(e){var t;switch(e.charAt(0)){case"0":t="Â£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),i=n%100,o=i<10?"0"+i:i.toString();return t+a+"."+o},r}(),bp=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wp=function(){function r(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,n){var a=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,a),o=a.toString(),s=r.parseExtensionString(o),l=[new q((n[0]+n[1])/2,e),new q(i,e)],c=new gt(o,null,0,l,te.UPC_EAN_EXTENSION,new Date().getTime());return s!=null&&c.putAllMetadata(s),c},r.prototype.decodeMiddle=function(e,t,n){var a,i,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=e.getSize(),l=t[1],c=0,d=0;d<2&&l<s;d++){var f=ln.decodeDigit(e,o,l,ln.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var h=(a=void 0,bp(o)),p=h.next();!p.done;p=h.next()){var g=p.value;l+=g}}catch(y){a={error:y}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}f>=10&&(c|=1<<1-d),d!==1&&(l=e.getNextSet(l),l=e.getNextUnset(l))}if(n.length!==2)throw new k;if(parseInt(n.toString())%4!==c)throw new k;return l},r.parseExtensionString=function(e){return e.length!==2?null:new Map([[dt.ISSUE_NUMBER,parseInt(e)]])},r}(),Ap=function(){function r(){}return r.decodeRow=function(e,t,n){var a=ln.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var i=new xp;return i.decodeRow(e,t,a)}catch{var o=new wp;return o.decodeRow(e,t,a)}},r.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),r}(),Cp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qe=function(r){Cp(e,r);function e(){var t=r.call(this)||this;t.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(s){return Int32Array.from(s)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],i=new Int32Array(a.length),o=0;o<a.length;o++)i[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=i}return t}return e.prototype.decodeRow=function(t,n,a){var i=e.findStartGuardPattern(n),o=a==null?null:a.get(De.NEED_RESULT_POINT_CALLBACK);if(o!=null){var s=new q((i[0]+i[1])/2,t);o.foundPossibleResultPoint(s)}var l=this.decodeMiddle(n,i,this.decodeRowStringBuffer),c=l.rowOffset,d=l.resultString;if(o!=null){var f=new q(c,t);o.foundPossibleResultPoint(f)}var h=e.decodeEnd(n,c);if(o!=null){var p=new q((h[0]+h[1])/2,t);o.foundPossibleResultPoint(p)}var g=h[1],y=g+(g-h[0]);if(y>=n.getSize()||!n.isRange(g,y,!1))throw new k;var x=d.toString();if(x.length<8)throw new $;if(!e.checkChecksum(x))throw new Ye;var v=(i[1]+i[0])/2,b=(h[1]+h[0])/2,_=this.getBarcodeFormat(),w=[new q(v,t),new q(b,t)],A=new gt(x,null,0,w,_,new Date().getTime()),C=0;try{var I=Ap.decodeRow(t,n,h[1]);A.putMetadata(dt.UPC_EAN_EXTENSION,I.getText()),A.putAllMetadata(I.getResultMetadata()),A.addResultPoints(I.getResultPoints()),C=I.getText().length}catch{}var R=a==null?null:a.get(De.ALLOWED_EAN_EXTENSIONS);if(R!=null){var F=!1;for(var T in R)if(C.toString()===T){F=!0;break}if(!F)throw new k}return _===te.EAN_13||te.UPC_A,A},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var n=t.length;if(n===0)return!1;var a=parseInt(t.charAt(n-1),10);return e.getStandardUPCEANChecksum(t.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(t){for(var n=t.length,a=0,i=n-1;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new $;a+=o}a*=3;for(var i=n-2;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new $;a+=o}return(1e3-a)%10},e.decodeEnd=function(t,n){return e.findGuardPattern(t,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(ln),_p=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$s=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Yi=function(r){_p(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,n,a){var i,o,s,l,c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;for(var d=t.getSize(),f=n[1],h=0,p=0;p<6&&f<d;p++){var g=Qe.decodeDigit(t,c,f,Qe.L_AND_G_PATTERNS);a+=String.fromCharCode(48+g%10);try{for(var y=(i=void 0,$s(c)),x=y.next();!x.done;x=y.next()){var v=x.value;f+=v}}catch(A){i={error:A}}finally{try{x&&!x.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}g>=10&&(h|=1<<5-p)}a=e.determineFirstDigit(a,h);var b=Qe.findGuardPattern(t,f,!0,Qe.MIDDLE_PATTERN,new Int32Array(Qe.MIDDLE_PATTERN.length).fill(0));f=b[1];for(var p=0;p<6&&f<d;p++){var g=Qe.decodeDigit(t,c,f,Qe.L_PATTERNS);a+=String.fromCharCode(48+g);try{for(var _=(s=void 0,$s(c)),w=_.next();!w.done;w=_.next()){var v=w.value;f+=v}}catch(I){s={error:I}}finally{try{w&&!w.done&&(l=_.return)&&l.call(_)}finally{if(s)throw s.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return te.EAN_13},e.determineFirstDigit=function(t,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return t=String.fromCharCode(48+a)+t,t;throw new k},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(Qe),Ep=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hs=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Gs=function(r){Ep(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,n,a){var i,o,s,l,c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;for(var d=t.getSize(),f=n[1],h=0;h<4&&f<d;h++){var p=Qe.decodeDigit(t,c,f,Qe.L_PATTERNS);a+=String.fromCharCode(48+p);try{for(var g=(i=void 0,Hs(c)),y=g.next();!y.done;y=g.next()){var x=y.value;f+=x}}catch(w){i={error:w}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}}var v=Qe.findGuardPattern(t,f,!0,Qe.MIDDLE_PATTERN,new Int32Array(Qe.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var h=0;h<4&&f<d;h++){var p=Qe.decodeDigit(t,c,f,Qe.L_PATTERNS);a+=String.fromCharCode(48+p);try{for(var b=(s=void 0,Hs(c)),_=b.next();!_.done;_=b.next()){var x=_.value;f+=x}}catch(C){s={error:C}}finally{try{_&&!_.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return te.EAN_8},e}(Qe),Np=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zs=function(r){Np(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ean13Reader=new Yi,t}return e.prototype.getBarcodeFormat=function(){return te.UPC_A},e.prototype.decode=function(t,n){return this.maybeReturnResult(this.ean13Reader.decode(t))},e.prototype.decodeRow=function(t,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,n,a))},e.prototype.decodeMiddle=function(t,n,a){return this.ean13Reader.decodeMiddle(t,n,a)},e.prototype.maybeReturnResult=function(t){var n=t.getText();if(n.charAt(0)==="0"){var a=new gt(n.substring(1),null,null,t.getResultPoints(),te.UPC_A);return t.getResultMetadata()!=null&&a.putAllMetadata(t.getResultMetadata()),a}else throw new k},e.prototype.reset=function(){this.ean13Reader.reset()},e}(Qe),Sp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ip=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ws=function(r){Sp(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=new Int32Array(4),t}return e.prototype.decodeMiddle=function(t,n,a){var i,o,s=this.decodeMiddleCounters.map(function(x){return x});s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var l=t.getSize(),c=n[1],d=0,f=0;f<6&&c<l;f++){var h=e.decodeDigit(t,s,c,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+h%10);try{for(var p=(i=void 0,Ip(s)),g=p.next();!g.done;g=p.next()){var y=g.value;c+=y}}catch(x){i={error:x}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}h>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new de(a),d),c},e.prototype.decodeEnd=function(t,n){return e.findGuardPatternWithoutCounters(t,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(t){return Qe.checkChecksum(e.convertUPCEtoUPCA(t))},e.determineNumSysAndCheckDigit=function(t,n){for(var a=0;a<=1;a++)for(var i=0;i<10;i++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][i]){t.insert(0,"0"+a),t.append("0"+i);return}throw k.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return te.UPC_E},e.convertUPCEtoUPCA=function(t){var n=t.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new de;a.append(t.charAt(0));var i=n[5];switch(i){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(i),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(i);break}return t.length>=8&&a.append(t.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(Qe),Tp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xs=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},si=function(r){Tp(e,r);function e(t){var n=r.call(this)||this,a=t==null?null:t.get(De.POSSIBLE_FORMATS),i=[];return a!=null&&(a.indexOf(te.EAN_13)>-1&&i.push(new Yi),a.indexOf(te.UPC_A)>-1&&i.push(new zs),a.indexOf(te.EAN_8)>-1&&i.push(new Gs),a.indexOf(te.UPC_E)>-1&&i.push(new Ws)),i.length===0&&(i.push(new Yi),i.push(new zs),i.push(new Gs),i.push(new Ws)),n.readers=i,n}return e.prototype.decodeRow=function(t,n,a){var i,o;try{for(var s=Xs(this.readers),l=s.next();!l.done;l=s.next()){var c=l.value;try{var d=c.decodeRow(t,n,a),f=d.getBarcodeFormat()===te.EAN_13&&d.getText().charAt(0)==="0",h=a==null?null:a.get(De.POSSIBLE_FORMATS),p=h==null||h.includes(te.UPC_A);if(f&&p){var g=d.getRawBytes(),y=new gt(d.getText().substring(1),g,g?g.length:null,d.getResultPoints(),te.UPC_A);return y.putAllMetadata(d.getResultMetadata()),y}return d}catch{}}}catch(x){i={error:x}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}throw new k},e.prototype.reset=function(){var t,n;try{for(var a=Xs(this.readers),i=a.next();!i.done;i=a.next()){var o=i.value;o.reset()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},e}(tt),Rp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Op=function(r){Rp(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},t}return e.prototype.decodeRow=function(t,n,a){var i=this.getValidRowData(n);if(!i)throw new k;var o=this.codaBarDecodeRow(i.row);if(!o)throw new k;return new gt(o,null,0,[new q(i.left,t),new q(i.right,t)],te.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(t){var n=t.toArray(),a=n.indexOf(!0);if(a===-1)return null;var i=n.lastIndexOf(!0);if(i<=a)return null;n=n.slice(a,i+1);for(var o=[],s=n[0],l=1,c=1;c<n.length;c++)n[c]===s?l++:(s=n[c],o.push(l),l=1);return o.push(l),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:i}},e.prototype.codaBarDecodeRow=function(t){for(var n=[],a=Math.ceil(t.reduce(function(l,c){return(l+c)/2},0));t.length>0;){var i=t.splice(0,8).splice(0,7),o=i.map(function(l){return l<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var s=n.join("");return this.validCodaBarString(s)?s:null},e.prototype.validCodaBarString=function(t){var n=/^[A-D].{1,}[A-D]$/;return n.test(t)},e}(tt),Dp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Pp=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Pr=function(r){Dp(e,r);function e(){var t=r.call(this)||this;return t.decodeFinderCounters=new Int32Array(4),t.dataCharacterCounters=new Int32Array(8),t.oddRoundingErrors=new Array(4),t.evenRoundingErrors=new Array(4),t.oddCounts=new Array(t.dataCharacterCounters.length/2),t.evenCounts=new Array(t.dataCharacterCounters.length/2),t}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(t,n){for(var a=0;a<n.length;a++)if(tt.patternMatchVariance(t,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new k},e.count=function(t){return we.sum(new Int32Array(t))},e.increment=function(t,n){for(var a=0,i=n[0],o=1;o<t.length;o++)n[o]>i&&(i=n[o],a=o);t[a]++},e.decrement=function(t,n){for(var a=0,i=n[0],o=1;o<t.length;o++)n[o]<i&&(i=n[o],a=o);t[a]--},e.isFinderPattern=function(t){var n,a,i=t[0]+t[1],o=i+t[2]+t[3],s=i/o;if(s>=e.MIN_FINDER_PATTERN_RATIO&&s<=e.MAX_FINDER_PATTERN_RATIO){var l=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;try{for(var d=Pp(t),f=d.next();!f.done;f=d.next()){var h=f.value;h>c&&(c=h),h<l&&(l=h)}}catch(p){n={error:p}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return c<10*l}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(tt),Sa=function(){function r(e,t){this.value=e,this.checksumPortion=t}return r.prototype.getValue=function(){return this.value},r.prototype.getChecksumPortion=function(){return this.checksumPortion},r.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion},r.prototype.hashCode=function(){return this.value^this.checksumPortion},r}(),Bu=function(){function r(e,t,n,a,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new q(n,i)),this.resultPoints.push(new q(a,i))}return r.prototype.getValue=function(){return this.value},r.prototype.getStartEnd=function(){return this.startEnd},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.hashCode=function(){return this.value},r}(),Mp=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Yr=function(){function r(){}return r.getRSSvalue=function(e,t,n){var a,i,o=0;try{for(var s=Mp(e),l=s.next();!l.done;l=s.next()){var c=l.value;o+=c}}catch(b){a={error:b}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}for(var d=0,f=0,h=e.length,p=0;p<h-1;p++){var g=void 0;for(g=1,f|=1<<p;g<e[p];g++,f&=~(1<<p)){var y=r.combins(o-g-1,h-p-2);if(n&&f===0&&o-g-(h-p-1)>=h-p-1&&(y-=r.combins(o-g-(h-p),h-p-2)),h-p-1>1){for(var x=0,v=o-g-(h-p-2);v>t;v--)x+=r.combins(o-g-v-1,h-p-3);y-=x*(h-1-p)}else o-g>t&&y--;d+=y}o-=g}return d},r.combins=function(e,t){var n,a;e-t>t?(a=t,n=e-t):(a=e-t,n=t);for(var i=1,o=1,s=e;s>n;s--)i*=s,o<=a&&(i/=o,o++);for(;o<=a;)i/=o,o++;return i},r}(),Lp=function(){function r(){}return r.buildBitArray=function(e){var t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);for(var n=12*t,a=new ot(n),i=0,o=e[0],s=o.getRightChar().getValue(),l=11;l>=0;--l)s&1<<l&&a.set(i),i++;for(var l=1;l<e.length;++l){for(var c=e[l],d=c.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(i),i++;if(c.getRightChar()!==null)for(var h=c.getRightChar().getValue(),f=11;f>=0;--f)h&1<<f&&a.set(i),i++}return a},r}(),Tr=function(){function r(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}return r.prototype.getDecodedInformation=function(){return this.decodedInformation},r.prototype.isFinished=function(){return this.finished},r}(),Po=function(){function r(e){this.newPosition=e}return r.prototype.getNewPosition=function(){return this.newPosition},r}(),kp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ut=function(r){kp(e,r);function e(t,n){var a=r.call(this,t)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(Po),Fp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Rr=function(r){Fp(e,r);function e(t,n,a){var i=r.call(this,t)||this;return a?(i.remaining=!0,i.remainingValue=i.remainingValue):(i.remaining=!1,i.remainingValue=0),i.newString=n,i}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(Po),Bp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$r=function(r){Bp(e,r);function e(t,n,a){var i=r.call(this,t)||this;if(n<0||n>10||a<0||a>10)throw new $;return i.firstDigit=n,i.secondDigit=a,i}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(Po),sa=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vp=function(){function r(){}return r.parseFieldsInGeneralPurpose=function(e){var t,n,a,i,o,s,l,c;if(!e)return null;if(e.length<2)throw new k;var d=e.substring(0,2);try{for(var f=sa(r.TWO_DIGIT_DATA_LENGTH),h=f.next();!h.done;h=f.next()){var p=h.value;if(p[0]===d)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(2,p[2],e):r.processFixedAI(2,p[1],e)}}catch(C){t={error:C}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}if(e.length<3)throw new k;var g=e.substring(0,3);try{for(var y=sa(r.THREE_DIGIT_DATA_LENGTH),x=y.next();!x.done;x=y.next()){var p=x.value;if(p[0]===g)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(3,p[2],e):r.processFixedAI(3,p[1],e)}}catch(C){a={error:C}}finally{try{x&&!x.done&&(i=y.return)&&i.call(y)}finally{if(a)throw a.error}}try{for(var v=sa(r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),b=v.next();!b.done;b=v.next()){var p=b.value;if(p[0]===g)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,p[2],e):r.processFixedAI(4,p[1],e)}}catch(C){o={error:C}}finally{try{b&&!b.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new k;var _=e.substring(0,4);try{for(var w=sa(r.FOUR_DIGIT_DATA_LENGTH),A=w.next();!A.done;A=w.next()){var p=A.value;if(p[0]===_)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,p[2],e):r.processFixedAI(4,p[1],e)}}catch(C){l={error:C}}finally{try{A&&!A.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}throw new k},r.processFixedAI=function(e,t,n){if(n.length<e)throw new k;var a=n.substring(0,e);if(n.length<e+t)throw new k;var i=n.substring(e,e+t),o=n.substring(e+t),s="("+a+")"+i,l=r.parseFieldsInGeneralPurpose(o);return l==null?s:s+l},r.processVariableAI=function(e,t,n){var a=n.substring(0,e),i;n.length<e+t?i=n.length:i=e+t;var o=n.substring(e,i),s=n.substring(i),l="("+a+")"+o,c=r.parseFieldsInGeneralPurpose(s);return c==null?l:l+c},r.VARIABLE_LENGTH=[],r.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",r.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",r.VARIABLE_LENGTH,20],["22",r.VARIABLE_LENGTH,29],["30",r.VARIABLE_LENGTH,8],["37",r.VARIABLE_LENGTH,8],["90",r.VARIABLE_LENGTH,30],["91",r.VARIABLE_LENGTH,30],["92",r.VARIABLE_LENGTH,30],["93",r.VARIABLE_LENGTH,30],["94",r.VARIABLE_LENGTH,30],["95",r.VARIABLE_LENGTH,30],["96",r.VARIABLE_LENGTH,30],["97",r.VARIABLE_LENGTH,3],["98",r.VARIABLE_LENGTH,30],["99",r.VARIABLE_LENGTH,30]],r.THREE_DIGIT_DATA_LENGTH=[["240",r.VARIABLE_LENGTH,30],["241",r.VARIABLE_LENGTH,30],["242",r.VARIABLE_LENGTH,6],["250",r.VARIABLE_LENGTH,30],["251",r.VARIABLE_LENGTH,30],["253",r.VARIABLE_LENGTH,17],["254",r.VARIABLE_LENGTH,20],["400",r.VARIABLE_LENGTH,30],["401",r.VARIABLE_LENGTH,30],["402",17],["403",r.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",r.VARIABLE_LENGTH,20],["421",r.VARIABLE_LENGTH,15],["422",3],["423",r.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",r.VARIABLE_LENGTH,15],["391",r.VARIABLE_LENGTH,18],["392",r.VARIABLE_LENGTH,15],["393",r.VARIABLE_LENGTH,18],["703",r.VARIABLE_LENGTH,30]],r.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",r.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",r.VARIABLE_LENGTH,20],["8003",r.VARIABLE_LENGTH,30],["8004",r.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",r.VARIABLE_LENGTH,30],["8008",r.VARIABLE_LENGTH,12],["8018",18],["8020",r.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",r.VARIABLE_LENGTH,70],["8200",r.VARIABLE_LENGTH,70]],r}(),ya=function(){function r(e){this.buffer=new de,this.information=e}return r.prototype.decodeAllCodes=function(e,t){var n=t,a=null;do{var i=this.decodeGeneralPurposeField(n,a),o=Vp.parseFieldsInGeneralPurpose(i.getNewString());if(o!=null&&e.append(o),i.isRemaining()?a=""+i.getRemainingValue():a=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return e.toString()},r.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)},r.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var t=this.extractNumericValueFromBitArray(e,4);return t===0?new $r(this.information.getSize(),$r.FNC1,$r.FNC1):new $r(this.information.getSize(),t-1,$r.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,i=(n-8)%11;return new $r(e+7,a,i)},r.prototype.extractNumericValueFromBitArray=function(e,t){return r.extractNumericValueFromBitArray(this.information,e,t)},r.extractNumericValueFromBitArray=function(e,t,n){for(var a=0,i=0;i<n;++i)e.get(t+i)&&(a|=1<<n-i-1);return a},r.prototype.decodeGeneralPurposeField=function(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new Rr(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Rr(this.current.getPosition(),this.buffer.toString())},r.prototype.parseBlocks=function(){var e,t;do{var n=this.current.getPosition();this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return t.getDecodedInformation()},r.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var t=void 0;return e.isSecondDigitFNC1()?t=new Rr(this.current.getPosition(),this.buffer.toString()):t=new Rr(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Tr(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var t=new Rr(this.current.getPosition(),this.buffer.toString());return new Tr(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Tr(!1)},r.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new Rr(this.current.getPosition(),this.buffer.toString());return new Tr(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Tr(!1)},r.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new Rr(this.current.getPosition(),this.buffer.toString());return new Tr(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Tr(!1)},r.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},r.prototype.decodeIsoIec646=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new Ut(e+5,Ut.FNC1);if(t>=5&&t<15)return new Ut(e+5,"0"+(t-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new Ut(e+7,""+(n+1));if(n>=90&&n<116)return new Ut(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),i;switch(a){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new $}return new Ut(e+8,i)},r.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},r.prototype.decodeAlphanumeric=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new Ut(e+5,Ut.FNC1);if(t>=5&&t<15)return new Ut(e+5,"0"+(t-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new Ut(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new Jn("Decoding invalid alphanumeric value: "+n)}return new Ut(e+6,a)},r.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0},r.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0},r.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0},r}(),Vu=function(){function r(e){this.information=e,this.generalDecoder=new ya(e)}return r.prototype.getInformation=function(){return this.information},r.prototype.getGeneralDecoder=function(){return this.generalDecoder},r}(),jp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gt=function(r){jp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedGtin=function(t,n){t.append("(01)");var a=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(t,n,a){for(var i=0;i<4;++i){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*i,10);o/100===0&&t.append("0"),o/10===0&&t.append("0"),t.append(o)}e.appendCheckDigit(t,a)},e.appendCheckDigit=function(t,n){for(var a=0,i=0;i<13;i++){var o=t.charAt(i+n).charCodeAt(0)-48;a+=i&1?o:3*o}a=10-a%10,a===10&&(a=0),t.append(a)},e.GTIN_SIZE=40,e}(Vu),Up=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$p=function(r){Up(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new de;t.append("(01)");var n=t.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return t.append(a),this.encodeCompressedGtinWithoutAI(t,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(Gt),Hp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gp=function(r){Hp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new de;return this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(Vu),zp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),xa=function(r){zp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedWeight=function(t,n,a){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(t,i);for(var o=this.checkWeight(i),s=1e5,l=0;l<5;++l)o/s===0&&t.append("0"),s/=10;t.append(o)},e}(Gt),Wp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ju=function(r){Wp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+xa.GTIN_SIZE+e.WEIGHT_SIZE)throw new k;var t=new de;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+xa.GTIN_SIZE,e.WEIGHT_SIZE),t.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(xa),Xp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),qp=function(r){Xp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,n){t.append("(3103)")},e.prototype.checkWeight=function(t){return t},e}(ju),Yp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Kp=function(r){Yp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,n){n<1e4?t.append("(3202)"):t.append("(3203)")},e.prototype.checkWeight=function(t){return t<1e4?t:t-1e4},e}(ju),Zp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qp=function(r){Zp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+Gt.GTIN_SIZE)throw new k;var t=new de;this.encodeCompressedGtin(t,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Gt.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(392"),t.append(n),t.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+Gt.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return t.append(a.getNewString()),t.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(Gt),Jp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),e1=function(r){Jp(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+Gt.GTIN_SIZE)throw new k;var t=new de;this.encodeCompressedGtin(t,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Gt.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(393"),t.append(n),t.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Gt.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&t.append("0"),a/10===0&&t.append("0"),t.append(a);var i=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+Gt.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return t.append(i.getNewString()),t.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(Gt),t1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fr=function(r){t1(e,r);function e(t,n,a){var i=r.call(this,t)||this;return i.dateCode=a,i.firstAIdigits=n,i}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new k;var t=new de;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(t,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),t.toString()},e.prototype.encodeCompressedDate=function(t,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){t.append("("),t.append(this.dateCode),t.append(")");var i=a%32;a/=32;var o=a%12+1;a/=12;var s=a;s/10===0&&t.append("0"),t.append(s),o/10===0&&t.append("0"),t.append(o),i/10===0&&t.append("0"),t.append(i)}},e.prototype.addWeightCode=function(t,n){t.append("("),t.append(this.firstAIdigits),t.append(n/1e5),t.append(")")},e.prototype.checkWeight=function(t){return t%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(xa);function r1(r){try{if(r.get(1))return new $p(r);if(!r.get(2))return new Gp(r);var e=ya.extractNumericValueFromBitArray(r,1,4);switch(e){case 4:return new qp(r);case 5:return new Kp(r)}var t=ya.extractNumericValueFromBitArray(r,1,5);switch(t){case 12:return new Qp(r);case 13:return new e1(r)}var n=ya.extractNumericValueFromBitArray(r,1,7);switch(n){case 56:return new fr(r,"310","11");case 57:return new fr(r,"320","11");case 58:return new fr(r,"310","13");case 59:return new fr(r,"320","13");case 60:return new fr(r,"310","15");case 61:return new fr(r,"320","15");case 62:return new fr(r,"310","17");case 63:return new fr(r,"320","17")}}catch(a){throw console.log(a),new Jn("unknown decoder: "+r)}}var qs=function(){function r(e,t,n,a){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=a}return r.prototype.mayBeLast=function(){return this.maybeLast},r.prototype.getLeftChar=function(){return this.leftchar},r.prototype.getRightChar=function(){return this.rightchar},r.prototype.getFinderPattern=function(){return this.finderpattern},r.prototype.mustBeLast=function(){return this.rightchar==null},r.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},r.equals=function(e,t){return e instanceof r?r.equalsOrNull(e.leftchar,t.leftchar)&&r.equalsOrNull(e.rightchar,t.rightchar)&&r.equalsOrNull(e.finderpattern,t.finderpattern):!1},r.equalsOrNull=function(e,t){return e===null?t===null:r.equals(e,t)},r.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},r}(),n1=function(){function r(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}return r.prototype.getPairs=function(){return this.pairs},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.isReversed=function(){return this.wasReversed},r.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},r.prototype.toString=function(){return"{ "+this.pairs+" }"},r.prototype.equals=function(e,t){return e instanceof r?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1},r.prototype.checkEqualitity=function(e,t){if(!(!e||!t)){var n;return e.forEach(function(a,i){t.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},r}(),a1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hr=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i1=function(r){a1(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.pairs=new Array(e.MAX_PAIRS),t.rows=new Array,t.startEnd=[2],t}return e.prototype.decodeRow=function(t,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(t,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(t,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(t,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,t))}catch(s){if(s instanceof k){if(!this.pairs.length)throw new k;a=!0}}if(this.checkChecksum())return this.pairs;var i;if(this.rows.length?i=!0:i=!1,this.storeRow(t,!1),i){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new k},e.prototype.checkRowsBoolean=function(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return t&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(t,n){for(var a,i,o=n;o<this.rows.length;o++){var s=this.rows[o];this.pairs.length=0;try{for(var l=(a=void 0,hr(t)),c=l.next();!c.done;c=l.next()){var d=c.value;this.pairs.push(d.getPairs())}}catch(h){a={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}if(this.pairs.push(s.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(t);f.push(s);try{return this.checkRows(f,o+1)}catch(h){console.log(h)}}}throw new k},e.isValidSequence=function(t){var n,a;try{for(var i=hr(e.FINDER_PATTERN_SEQUENCES),o=i.next();!o.done;o=i.next()){var s=o.value;if(!(t.length>s.length)){for(var l=!0,c=0;c<t.length;c++)if(t[c].getFinderPattern().getValue()!==s[c]){l=!1;break}if(l)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(t,n){for(var a=0,i=!1,o=!1;a<this.rows.length;){var s=this.rows[a];if(s.getRowNumber()>t){o=s.isEquivalent(this.pairs);break}i=s.isEquivalent(this.pairs),a++}o||i||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new n1(this.pairs,t,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(t,n){var a,i,o,s,l,c;try{for(var d=hr(n),f=d.next();!f.done;f=d.next()){var h=f.value;if(h.getPairs().length!==t.length){var p=!0;try{for(var g=(o=void 0,hr(h.getPairs())),y=g.next();!y.done;y=g.next()){var x=y.value,v=!1;try{for(var b=(l=void 0,hr(t)),_=b.next();!_.done;_=b.next()){var w=_.value;if(qs.equals(x,w)){v=!0;break}}}catch(A){l={error:A}}finally{try{_&&!_.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}v||(p=!1)}}catch(A){o={error:A}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}}}}catch(A){a={error:A}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(t,n){var a,i,o,s,l,c;try{for(var d=hr(n),f=d.next();!f.done;f=d.next()){var h=f.value,p=!0;try{for(var g=(o=void 0,hr(t)),y=g.next();!y.done;y=g.next()){var x=y.value,v=!1;try{for(var b=(l=void 0,hr(h.getPairs())),_=b.next();!_.done;_=b.next()){var w=_.value;if(x.equals(w)){v=!0;break}}}catch(A){l={error:A}}finally{try{_&&!_.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}if(!v){p=!1;break}}}catch(A){o={error:A}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}if(p)return!0}}catch(A){a={error:A}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(t){var n=Lp.buildBitArray(t),a=r1(n),i=a.parseInformation(),o=t[0].getFinderPattern().getResultPoints(),s=t[t.length-1].getFinderPattern().getResultPoints(),l=[o[0],o[1],s[0],s[1]];return new gt(i,null,null,l,te.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var t=this.pairs.get(0),n=t.getLeftChar(),a=t.getRightChar();if(a===null)return!1;for(var i=a.getChecksumPortion(),o=2,s=1;s<this.pairs.size();++s){var l=this.pairs.get(s);i+=l.getLeftChar().getChecksumPortion(),o++;var c=l.getRightChar();c!=null&&(i+=c.getChecksumPortion(),o++)}i%=211;var d=211*(o-4)+i;return d===n.getValue()},e.getNextSecondBar=function(t,n){var a;return t.get(n)?(a=t.getNextUnset(n),a=t.getNextSet(a)):(a=t.getNextSet(n),a=t.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(t,n,a){var i=n.length%2===0;this.startFromEven&&(i=!i);var o,s=!0,l=-1;do this.findNextPair(t,n,l),o=this.parseFoundFinderPattern(t,a,i),o===null?l=e.getNextSecondBar(t,this.startEnd[0]):s=!1;while(s);var c=this.decodeDataCharacter(t,o,i,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new k;var d;try{d=this.decodeDataCharacter(t,o,i,!1)}catch(f){d=null,console.log(f)}return new qs(c,d,o,!0)},e.prototype.isEmptyPair=function(t){return t.length===0},e.prototype.findNextPair=function(t,n,a){var i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;var o=t.getSize(),s;if(a>=0)s=a;else if(this.isEmptyPair(n))s=0;else{var l=n[n.length-1];s=l.getFinderPattern().getStartEnd()[1]}var c=n.length%2!==0;this.startFromEven&&(c=!c);for(var d=!1;s<o&&(d=!t.get(s),!!d);)s++;for(var f=0,h=s,p=s;p<o;p++)if(t.get(p)!==d)i[f]++;else{if(f===3){if(c&&e.reverseCounters(i),e.isFinderPattern(i)){this.startEnd[0]=h,this.startEnd[1]=p;return}c&&e.reverseCounters(i),h+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,f--}else f++;i[f]=1,d=!d}throw new k},e.reverseCounters=function(t){for(var n=t.length,a=0;a<n/2;++a){var i=t[a];t[a]=t[n-a-1],t[n-a-1]=i}},e.prototype.parseFoundFinderPattern=function(t,n,a){var i,o,s;if(a){for(var l=this.startEnd[0]-1;l>=0&&!t.get(l);)l--;l++,i=this.startEnd[0]-l,o=l,s=this.startEnd[1]}else o=this.startEnd[0],s=t.getNextUnset(this.startEnd[1]+1),i=s-this.startEnd[1];var c=this.getDecodeFinderCounters();Oe.arraycopy(c,0,c,1,c.length-1),c[0]=i;var d;try{d=this.parseFinderValue(c,e.FINDER_PATTERNS)}catch{return null}return new Bu(d,[o,s],o,s,n)},e.prototype.decodeDataCharacter=function(t,n,a,i){for(var o=this.getDataCharacterCounters(),s=0;s<o.length;s++)o[s]=0;if(i)e.recordPatternInReverse(t,n.getStartEnd()[0],o);else{e.recordPattern(t,n.getStartEnd()[1],o);for(var l=0,c=o.length-1;l<c;l++,c--){var d=o[l];o[l]=o[c],o[c]=d}}var f=17,h=we.sum(new Int32Array(o))/f,p=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(h-p)/p>.3)throw new k;for(var g=this.getOddCounts(),y=this.getEvenCounts(),x=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),l=0;l<o.length;l++){var b=1*o[l]/h,_=b+.5;if(_<1){if(b<.3)throw new k;_=1}else if(_>8){if(b>8.7)throw new k;_=8}var w=l/2;l&1?(y[w]=_,v[w]=b-_):(g[w]=_,x[w]=b-_)}this.adjustOddEvenCounts(f);for(var A=4*n.getValue()+(a?0:2)+(i?0:1)-1,C=0,I=0,l=g.length-1;l>=0;l--){if(e.isNotA1left(n,a,i)){var R=e.WEIGHTS[A][2*l];I+=g[l]*R}C+=g[l]}for(var F=0,l=y.length-1;l>=0;l--)if(e.isNotA1left(n,a,i)){var R=e.WEIGHTS[A][2*l+1];F+=y[l]*R}var T=I+F;if(C&1||C>13||C<4)throw new k;var U=(13-C)/2,L=e.SYMBOL_WIDEST[U],B=9-L,H=Yr.getRSSvalue(g,L,!0),Q=Yr.getRSSvalue(y,B,!1),ae=e.EVEN_TOTAL_SUBSET[U],W=e.GSUM[U],X=H*ae+Q+W;return new Sa(X,T)},e.isNotA1left=function(t,n,a){return!(t.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(t){var n=we.sum(new Int32Array(this.getOddCounts())),a=we.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1;n>13?o=!0:n<4&&(i=!0);var s=!1,l=!1;a>13?l=!0:a<4&&(s=!0);var c=n+a-t,d=(n&1)===1,f=(a&1)===0;if(c===1)if(d){if(f)throw new k;o=!0}else{if(!f)throw new k;l=!0}else if(c===-1)if(d){if(f)throw new k;i=!0}else{if(!f)throw new k;s=!0}else if(c===0){if(d){if(!f)throw new k;n<a?(i=!0,l=!0):(o=!0,s=!0)}else if(f)throw new k}else throw new k;if(i){if(o)throw new k;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(l)throw new k;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}l&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(Pr),o1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),s1=function(r){o1(e,r);function e(t,n,a){var i=r.call(this,t,n)||this;return i.count=0,i.finderPattern=a,i}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(Sa),l1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),li=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ys=function(r){l1(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.possibleLeftPairs=[],t.possibleRightPairs=[],t}return e.prototype.decodeRow=function(t,n,a){var i,o,s,l,c=this.decodePair(n,!1,t,a);e.addOrTally(this.possibleLeftPairs,c),n.reverse();var d=this.decodePair(n,!0,t,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=li(this.possibleLeftPairs),h=f.next();!h.done;h=f.next()){var p=h.value;if(p.getCount()>1)try{for(var g=(s=void 0,li(this.possibleRightPairs)),y=g.next();!y.done;y=g.next()){var x=y.value;if(x.getCount()>1&&e.checkChecksum(p,x))return e.constructResult(p,x)}}catch(v){s={error:v}}finally{try{y&&!y.done&&(l=g.return)&&l.call(g)}finally{if(s)throw s.error}}}}catch(v){i={error:v}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}throw new k},e.addOrTally=function(t,n){var a,i;if(n!=null){var o=!1;try{for(var s=li(t),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.getValue()===n.getValue()){c.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}o||t.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(t,n){for(var a=4537077*t.getValue()+n.getValue(),i=new String(a).toString(),o=new de,s=13-i.length;s>0;s--)o.append("0");o.append(i);for(var l=0,s=0;s<13;s++){var c=o.charAt(s).charCodeAt(0)-48;l+=s&1?c:3*c}l=10-l%10,l===10&&(l=0),o.append(l.toString());var d=t.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new gt(o.toString(),null,0,[d[0],d[1],f[0],f[1]],te.RSS_14,new Date().getTime())},e.checkChecksum=function(t,n){var a=(t.getChecksumPortion()+16*n.getChecksumPortion())%79,i=9*t.getFinderPattern().getValue()+n.getFinderPattern().getValue();return i>72&&i--,i>8&&i--,a===i},e.prototype.decodePair=function(t,n,a,i){try{var o=this.findFinderPattern(t,n),s=this.parseFoundFinderPattern(t,a,n,o),l=i==null?null:i.get(De.NEED_RESULT_POINT_CALLBACK);if(l!=null){var c=(o[0]+o[1])/2;n&&(c=t.getSize()-1-c),l.foundPossibleResultPoint(new q(c,a))}var d=this.decodeDataCharacter(t,s,!0),f=this.decodeDataCharacter(t,s,!1);return new s1(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),s)}catch{return null}},e.prototype.decodeDataCharacter=function(t,n,a){for(var i=this.getDataCharacterCounters(),o=0;o<i.length;o++)i[o]=0;if(a)tt.recordPatternInReverse(t,n.getStartEnd()[0],i);else{tt.recordPattern(t,n.getStartEnd()[1]+1,i);for(var s=0,l=i.length-1;s<l;s++,l--){var c=i[s];i[s]=i[l],i[l]=c}}for(var d=a?16:15,f=we.sum(new Int32Array(i))/d,h=this.getOddCounts(),p=this.getEvenCounts(),g=this.getOddRoundingErrors(),y=this.getEvenRoundingErrors(),s=0;s<i.length;s++){var x=i[s]/f,v=Math.floor(x+.5);v<1?v=1:v>8&&(v=8);var b=Math.floor(s/2);s&1?(p[b]=v,y[b]=x-v):(h[b]=v,g[b]=x-v)}this.adjustOddEvenCounts(a,d);for(var _=0,w=0,s=h.length-1;s>=0;s--)w*=9,w+=h[s],_+=h[s];for(var A=0,C=0,s=p.length-1;s>=0;s--)A*=9,A+=p[s],C+=p[s];var I=w+3*A;if(a){if(_&1||_>12||_<4)throw new k;var R=(12-_)/2,F=e.OUTSIDE_ODD_WIDEST[R],T=9-F,U=Yr.getRSSvalue(h,F,!1),L=Yr.getRSSvalue(p,T,!0),B=e.OUTSIDE_EVEN_TOTAL_SUBSET[R],H=e.OUTSIDE_GSUM[R];return new Sa(U*B+L+H,I)}else{if(C&1||C>10||C<4)throw new k;var R=(10-C)/2,F=e.INSIDE_ODD_WIDEST[R],T=9-F,U=Yr.getRSSvalue(h,F,!0),L=Yr.getRSSvalue(p,T,!1),Q=e.INSIDE_ODD_TOTAL_SUBSET[R],H=e.INSIDE_GSUM[R];return new Sa(L*Q+U+H,I)}},e.prototype.findFinderPattern=function(t,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var i=t.getSize(),o=!1,s=0;s<i&&(o=!t.get(s),n!==o);)s++;for(var l=0,c=s,d=s;d<i;d++)if(t.get(d)!==o)a[l]++;else{if(l===3){if(Pr.isFinderPattern(a))return[c,d];c+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,l--}else l++;a[l]=1,o=!o}throw new k},e.prototype.parseFoundFinderPattern=function(t,n,a,i){for(var o=t.get(i[0]),s=i[0]-1;s>=0&&o!==t.get(s);)s--;s++;var l=i[0]-s,c=this.getDecodeFinderCounters(),d=new Int32Array(c.length);Oe.arraycopy(c,0,d,1,c.length-1),d[0]=l;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),h=s,p=i[1];return a&&(h=t.getSize()-1-h,p=t.getSize()-1-p),new Bu(f,[s,i[1]],h,p,n)},e.prototype.adjustOddEvenCounts=function(t,n){var a=we.sum(new Int32Array(this.getOddCounts())),i=we.sum(new Int32Array(this.getEvenCounts())),o=!1,s=!1,l=!1,c=!1;t?(a>12?s=!0:a<4&&(o=!0),i>12?c=!0:i<4&&(l=!0)):(a>11?s=!0:a<5&&(o=!0),i>10?c=!0:i<4&&(l=!0));var d=a+i-n,f=(a&1)===(t?1:0),h=(i&1)===1;if(d===1)if(f){if(h)throw new k;s=!0}else{if(!h)throw new k;c=!0}else if(d===-1)if(f){if(h)throw new k;o=!0}else{if(!h)throw new k;l=!0}else if(d===0){if(f){if(!h)throw new k;a<i?(o=!0,c=!0):(s=!0,l=!0)}else if(h)throw new k}else throw new k;if(o){if(s)throw new k;Pr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&Pr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new k;Pr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&Pr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(Pr),c1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Kr=function(r){c1(e,r);function e(t){var n=r.call(this)||this;n.readers=[];var a=t?t.get(De.POSSIBLE_FORMATS):null,i=t&&t.get(De.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=t&&t.get(De.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(te.EAN_13)||a.includes(te.UPC_A)||a.includes(te.EAN_8)||a.includes(te.UPC_E))&&n.readers.push(new si(t)),a.includes(te.CODE_39)&&n.readers.push(new Vs(i,o)),a.includes(te.CODE_93)&&n.readers.push(new js),a.includes(te.CODE_128)&&n.readers.push(new Bs),a.includes(te.ITF)&&n.readers.push(new Us),a.includes(te.CODABAR)&&n.readers.push(new Op),a.includes(te.RSS_14)&&n.readers.push(new Ys),a.includes(te.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new i1))),n.readers.length===0&&(n.readers.push(new si(t)),n.readers.push(new Vs),n.readers.push(new js),n.readers.push(new si(t)),n.readers.push(new Bs),n.readers.push(new Us),n.readers.push(new Ys)),n}return e.prototype.decodeRow=function(t,n,a){for(var i=0;i<this.readers.length;i++)try{return this.readers[i].decodeRow(t,n,a)}catch{}throw new k},e.prototype.reset=function(){this.readers.forEach(function(t){return t.reset()})},e}(tt),u1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){u1(e,r);function e(t,n){return t===void 0&&(t=500),r.call(this,new Kr(n),t,n)||this}return e})(fn);var Ks=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_e=function(){function r(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}return r.prototype.getECCodewords=function(){return this.ecCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),Ae=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),d1=function(){function r(e,t,n,a,i,o){var s,l;this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=i,this.ecBlocks=o;var c=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var h=Ks(f),p=h.next();!p.done;p=h.next()){var g=p.value;c+=g.getCount()*(g.getDataCodewords()+d)}}catch(y){s={error:y}}finally{try{p&&!p.done&&(l=h.return)&&l.call(h)}finally{if(s)throw s.error}}this.totalCodewords=c}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},r.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},r.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},r.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r.getVersionForDimensions=function(e,t){var n,a;if(e&1||t&1)throw new $;try{for(var i=Ks(r.VERSIONS),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.symbolSizeRows===e&&s.symbolSizeColumns===t)return s}}catch(l){n={error:l}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}throw new $},r.prototype.toString=function(){return""+this.versionNumber},r.buildVersions=function(){return[new r(1,10,10,8,8,new _e(5,new Ae(1,3))),new r(2,12,12,10,10,new _e(7,new Ae(1,5))),new r(3,14,14,12,12,new _e(10,new Ae(1,8))),new r(4,16,16,14,14,new _e(12,new Ae(1,12))),new r(5,18,18,16,16,new _e(14,new Ae(1,18))),new r(6,20,20,18,18,new _e(18,new Ae(1,22))),new r(7,22,22,20,20,new _e(20,new Ae(1,30))),new r(8,24,24,22,22,new _e(24,new Ae(1,36))),new r(9,26,26,24,24,new _e(28,new Ae(1,44))),new r(10,32,32,14,14,new _e(36,new Ae(1,62))),new r(11,36,36,16,16,new _e(42,new Ae(1,86))),new r(12,40,40,18,18,new _e(48,new Ae(1,114))),new r(13,44,44,20,20,new _e(56,new Ae(1,144))),new r(14,48,48,22,22,new _e(68,new Ae(1,174))),new r(15,52,52,24,24,new _e(42,new Ae(2,102))),new r(16,64,64,14,14,new _e(56,new Ae(2,140))),new r(17,72,72,16,16,new _e(36,new Ae(4,92))),new r(18,80,80,18,18,new _e(48,new Ae(4,114))),new r(19,88,88,20,20,new _e(56,new Ae(4,144))),new r(20,96,96,22,22,new _e(68,new Ae(4,174))),new r(21,104,104,24,24,new _e(56,new Ae(6,136))),new r(22,120,120,18,18,new _e(68,new Ae(6,175))),new r(23,132,132,20,20,new _e(62,new Ae(8,163))),new r(24,144,144,22,22,new _e(62,new Ae(8,156),new Ae(2,155))),new r(25,8,18,6,16,new _e(7,new Ae(1,5))),new r(26,8,32,6,14,new _e(11,new Ae(1,10))),new r(27,12,26,10,24,new _e(14,new Ae(1,16))),new r(28,12,36,10,16,new _e(18,new Ae(1,22))),new r(29,16,36,14,16,new _e(24,new Ae(1,32))),new r(30,16,48,14,22,new _e(28,new Ae(1,49)))]},r.VERSIONS=r.buildVersions(),r}(),f1=function(){function r(e){var t=e.getHeight();if(t<8||t>144||t&1)throw new $;this.version=r.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new er(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return r.prototype.getVersion=function(){return this.version},r.readVersion=function(e){var t=e.getHeight(),n=e.getWidth();return d1.getVersionForDimensions(t,n)},r.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),t=0,n=4,a=0,i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),s=!1,l=!1,c=!1,d=!1;do if(n===i&&a===0&&!s)e[t++]=this.readCorner1(i,o)&255,n-=2,a+=2,s=!0;else if(n===i-2&&a===0&&o&3&&!l)e[t++]=this.readCorner2(i,o)&255,n-=2,a+=2,l=!0;else if(n===i+4&&a===2&&!(o&7)&&!c)e[t++]=this.readCorner3(i,o)&255,n-=2,a+=2,c=!0;else if(n===i-2&&a===0&&(o&7)===4&&!d)e[t++]=this.readCorner4(i,o)&255,n-=2,a+=2,d=!0;else{do n<i&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[t++]=this.readUtah(n,a,i,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[t++]=this.readUtah(n,a,i,o)&255),n+=2,a-=2;while(n<i&&a>=0);n+=3,a+=1}while(n<i||a<o);if(t!==this.version.getTotalCodewords())throw new $;return e},r.prototype.readModule=function(e,t,n,a){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)},r.prototype.readUtah=function(e,t,n,a){var i=0;return this.readModule(e-2,t-2,n,a)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,a)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,a)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,a)&&(i|=1),i<<=1,this.readModule(e-1,t,n,a)&&(i|=1),i<<=1,this.readModule(e,t-2,n,a)&&(i|=1),i<<=1,this.readModule(e,t-1,n,a)&&(i|=1),i<<=1,this.readModule(e,t,n,a)&&(i|=1),i},r.prototype.readCorner1=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},r.prototype.readCorner2=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},r.prototype.readCorner3=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},r.prototype.readCorner4=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},r.prototype.extractDataRegion=function(e){var t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new re("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=t/a|0,s=n/i|0,l=o*a,c=s*i,d=new er(c,l),f=0;f<o;++f)for(var h=f*a,p=0;p<s;++p)for(var g=p*i,y=0;y<a;++y)for(var x=f*(a+2)+1+y,v=h+y,b=0;b<i;++b){var _=p*(i+2)+1+b;if(e.get(_,x)){var w=g+b;d.set(w,v)}}return d},r}(),Zs=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h1=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t){var n,a,i,o,s=t.getECBlocks(),l=0,c=s.getECBlocks();try{for(var d=Zs(c),f=d.next();!f.done;f=d.next()){var h=f.value;l+=h.getCount()}}catch(H){n={error:H}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var p=new Array(l),g=0;try{for(var y=Zs(c),x=y.next();!x.done;x=y.next())for(var h=x.value,v=0;v<h.getCount();v++){var b=h.getDataCodewords(),_=s.getECCodewords()+b;p[g++]=new r(b,new Uint8Array(_))}}catch(H){i={error:H}}finally{try{x&&!x.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}for(var w=p[0].codewords.length,A=w-s.getECCodewords(),C=A-1,I=0,v=0;v<C;v++)for(var R=0;R<g;R++)p[R].codewords[v]=e[I++];for(var F=t.getVersionNumber()===24,T=F?8:g,R=0;R<T;R++)p[R].codewords[A-1]=e[I++];for(var U=p[0].codewords.length,v=A;v<U;v++)for(var R=0;R<g;R++){var L=F?(R+8)%g:R,B=F&&L>7?v-1:v;p[L].codewords[B]=e[I++]}if(I!==e.length)throw new re;return p},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),Uu=function(){function r(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return r.prototype.getBitOffset=function(){return this.bitOffset},r.prototype.getByteOffset=function(){return this.byteOffset},r.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new re(""+e);var t=0,n=this.bitOffset,a=this.byteOffset,i=this.bytes;if(n>0){var o=8-n,s=e<o?e:o,l=o-s,c=255>>8-s<<l;t=(i[a]&c)>>l,e-=s,n+=s,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)t=t<<8|i[a]&255,a++,e-=8;if(e>0){var l=8-e,c=255>>l<<l;t=t<<e|(i[a]&c)>>l,n+=e}}return this.bitOffset=n,this.byteOffset=a,t},r.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},r}(),Ke;(function(r){r[r.PAD_ENCODE=0]="PAD_ENCODE",r[r.ASCII_ENCODE=1]="ASCII_ENCODE",r[r.C40_ENCODE=2]="C40_ENCODE",r[r.TEXT_ENCODE=3]="TEXT_ENCODE",r[r.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",r[r.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",r[r.BASE256_ENCODE=6]="BASE256_ENCODE"})(Ke||(Ke={}));var p1=function(){function r(){}return r.decode=function(e){var t=new Uu(e),n=new de,a=new de,i=new Array,o=Ke.ASCII_ENCODE;do if(o===Ke.ASCII_ENCODE)o=this.decodeAsciiSegment(t,n,a);else{switch(o){case Ke.C40_ENCODE:this.decodeC40Segment(t,n);break;case Ke.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case Ke.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case Ke.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case Ke.BASE256_ENCODE:this.decodeBase256Segment(t,n,i);break;default:throw new $}o=Ke.ASCII_ENCODE}while(o!==Ke.PAD_ENCODE&&t.available()>0);return a.length()>0&&n.append(a.toString()),new Ga(e,n.toString(),i.length===0?null:i,null)},r.decodeAsciiSegment=function(e,t,n){var a=!1;do{var i=e.readBits(8);if(i===0)throw new $;if(i<=128)return a&&(i+=128),t.append(String.fromCharCode(i-1)),Ke.ASCII_ENCODE;if(i===129)return Ke.PAD_ENCODE;if(i<=229){var o=i-130;o<10&&t.append("0"),t.append(""+o)}else switch(i){case 230:return Ke.C40_ENCODE;case 231:return Ke.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return Ke.ANSIX12_ENCODE;case 239:return Ke.TEXT_ENCODE;case 240:return Ke.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new $;break}}while(e.available()>0);return Ke.ASCII_ENCODE},r.decodeC40Segment=function(e,t){var n=!1,a=[],i=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var s=0;s<3;s++){var l=a[s];switch(i){case 0:if(l<3)i=l+1;else if(l<this.C40_BASIC_SET_CHARS.length){var c=this.C40_BASIC_SET_CHARS[l];n?(t.append(String.fromCharCode(c.charCodeAt(0)+128)),n=!1):t.append(c)}else throw new $;break;case 1:n?(t.append(String.fromCharCode(l+128)),n=!1):t.append(String.fromCharCode(l)),i=0;break;case 2:if(l<this.C40_SHIFT2_SET_CHARS.length){var c=this.C40_SHIFT2_SET_CHARS[l];n?(t.append(String.fromCharCode(c.charCodeAt(0)+128)),n=!1):t.append(c)}else switch(l){case 27:t.append("");break;case 30:n=!0;break;default:throw new $}i=0;break;case 3:n?(t.append(String.fromCharCode(l+224)),n=!1):t.append(String.fromCharCode(l+96)),i=0;break;default:throw new $}}}while(e.available()>0)},r.decodeTextSegment=function(e,t){var n=!1,a=[],i=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var s=0;s<3;s++){var l=a[s];switch(i){case 0:if(l<3)i=l+1;else if(l<this.TEXT_BASIC_SET_CHARS.length){var c=this.TEXT_BASIC_SET_CHARS[l];n?(t.append(String.fromCharCode(c.charCodeAt(0)+128)),n=!1):t.append(c)}else throw new $;break;case 1:n?(t.append(String.fromCharCode(l+128)),n=!1):t.append(String.fromCharCode(l)),i=0;break;case 2:if(l<this.TEXT_SHIFT2_SET_CHARS.length){var c=this.TEXT_SHIFT2_SET_CHARS[l];n?(t.append(String.fromCharCode(c.charCodeAt(0)+128)),n=!1):t.append(c)}else switch(l){case 27:t.append("");break;case 30:n=!0;break;default:throw new $}i=0;break;case 3:if(l<this.TEXT_SHIFT3_SET_CHARS.length){var c=this.TEXT_SHIFT3_SET_CHARS[l];n?(t.append(String.fromCharCode(c.charCodeAt(0)+128)),n=!1):t.append(c),i=0}else throw new $;break;default:throw new $}}}while(e.available()>0)},r.decodeAnsiX12Segment=function(e,t){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var i=0;i<3;i++){var o=n[i];switch(o){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(o<14)t.append(String.fromCharCode(o+44));else if(o<40)t.append(String.fromCharCode(o+51));else throw new $;break}}}while(e.available()>0)},r.parseTwoBytes=function(e,t,n){var a=(e<<8)+t-1,i=Math.floor(a/1600);n[0]=i,a-=i*1600,i=Math.floor(a/40),n[1]=i,n[2]=a-i*40},r.decodeEdifactSegment=function(e,t){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var i=8-e.getBitOffset();i!==8&&e.readBits(i);return}a&32||(a|=64),t.append(String.fromCharCode(a))}}while(e.available()>0)},r.decodeBase256Segment=function(e,t,n){var a=1+e.getByteOffset(),i=this.unrandomize255State(e.readBits(8),a++),o;if(i===0?o=e.available()/8|0:i<250?o=i:o=250*(i-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new $;for(var s=new Uint8Array(o),l=0;l<o;l++){if(e.available()<8)throw new $;s[l]=this.unrandomize255State(e.readBits(8),a++)}n.push(s);try{t.append(Vt.decode(s,ve.ISO88591))}catch(c){throw new Jn("Platform does not support required encoding: "+c.message)}},r.unrandomize255State=function(e,t){var n=149*t%255+1,a=e-n;return a>=0?a:a+256},r.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],r.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],r.TEXT_SHIFT2_SET_CHARS=r.C40_SHIFT2_SET_CHARS,r.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],r}(),m1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},g1=function(){function r(){this.rsDecoder=new za(Nt.DATA_MATRIX_FIELD_256)}return r.prototype.decode=function(e){var t,n,a=new f1(e),i=a.getVersion(),o=a.readCodewords(),s=h1.getDataBlocks(o,i),l=0;try{for(var c=m1(s),d=c.next();!d.done;d=c.next()){var f=d.value;l+=f.getNumDataCodewords()}}catch(_){t={error:_}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}for(var h=new Uint8Array(l),p=s.length,g=0;g<p;g++){var y=s[g],x=y.getCodewords(),v=y.getNumDataCodewords();this.correctErrors(x,v);for(var b=0;b<v;b++)h[b*p+g]=x[b]}return p1.decode(h)},r.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new Ye}for(var a=0;a<t;a++)e[a]=n[a]},r}(),v1=function(){function r(e){this.image=e,this.rectangleDetector=new qi(this.image)}return r.prototype.detect=function(){var e=this.rectangleDetector.detect(),t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new k;t=this.shiftToModuleCenter(t);var n=t[0],a=t[1],i=t[2],o=t[3],s=this.transitionsBetween(n,o)+1,l=this.transitionsBetween(i,o)+1;(s&1)===1&&(s+=1),(l&1)===1&&(l+=1),4*s<7*l&&4*l<7*s&&(s=l=Math.max(s,l));var c=r.sampleGrid(this.image,n,a,i,o,s,l);return new Oo(c,[n,a,i,o])},r.shiftPoint=function(e,t,n){var a=(t.getX()-e.getX())/(n+1),i=(t.getY()-e.getY())/(n+1);return new q(e.getX()+a,e.getY()+i)},r.moveAway=function(e,t,n){var a=e.getX(),i=e.getY();return a<t?a-=1:a+=1,i<n?i-=1:i+=1,new q(a,i)},r.prototype.detectSolid1=function(e){var t=e[0],n=e[1],a=e[3],i=e[2],o=this.transitionsBetween(t,n),s=this.transitionsBetween(n,a),l=this.transitionsBetween(a,i),c=this.transitionsBetween(i,t),d=o,f=[i,t,n,a];return d>s&&(d=s,f[0]=t,f[1]=n,f[2]=a,f[3]=i),d>l&&(d=l,f[0]=n,f[1]=a,f[2]=i,f[3]=t),d>c&&(f[0]=a,f[1]=i,f[2]=t,f[3]=n),f},r.prototype.detectSolid2=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=this.transitionsBetween(t,i),s=r.shiftPoint(n,a,(o+1)*4),l=r.shiftPoint(a,n,(o+1)*4),c=this.transitionsBetween(s,t),d=this.transitionsBetween(l,i);return c<d?(e[0]=t,e[1]=n,e[2]=a,e[3]=i):(e[0]=n,e[1]=a,e[2]=i,e[3]=t),e},r.prototype.correctTopRight=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=this.transitionsBetween(t,i),s=this.transitionsBetween(n,i),l=r.shiftPoint(t,n,(s+1)*4),c=r.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(l,i),s=this.transitionsBetween(c,i);var d=new q(i.getX()+(a.getX()-n.getX())/(o+1),i.getY()+(a.getY()-n.getY())/(o+1)),f=new q(i.getX()+(t.getX()-n.getX())/(s+1),i.getY()+(t.getY()-n.getY())/(s+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var h=this.transitionsBetween(l,d)+this.transitionsBetween(c,d),p=this.transitionsBetween(l,f)+this.transitionsBetween(c,f);return h>p?d:f},r.prototype.shiftToModuleCenter=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=this.transitionsBetween(t,i)+1,s=this.transitionsBetween(a,i)+1,l=r.shiftPoint(t,n,s*4),c=r.shiftPoint(a,n,o*4);o=this.transitionsBetween(l,i)+1,s=this.transitionsBetween(c,i)+1,(o&1)===1&&(o+=1),(s&1)===1&&(s+=1);var d=(t.getX()+n.getX()+a.getX()+i.getX())/4,f=(t.getY()+n.getY()+a.getY()+i.getY())/4;t=r.moveAway(t,d,f),n=r.moveAway(n,d,f),a=r.moveAway(a,d,f),i=r.moveAway(i,d,f);var h,p;return l=r.shiftPoint(t,n,s*4),l=r.shiftPoint(l,i,o*4),h=r.shiftPoint(n,t,s*4),h=r.shiftPoint(h,a,o*4),c=r.shiftPoint(a,i,s*4),c=r.shiftPoint(c,n,o*4),p=r.shiftPoint(i,a,s*4),p=r.shiftPoint(p,t,o*4),[l,h,c,p]},r.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},r.sampleGrid=function(e,t,n,a,i,o,s){var l=Do.getInstance();return l.sampleGrid(e,o,s,.5,.5,o-.5,.5,o-.5,s-.5,.5,s-.5,t.getX(),t.getY(),i.getX(),i.getY(),a.getX(),a.getY(),n.getX(),n.getY())},r.prototype.transitionsBetween=function(e,t){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),i=Math.trunc(t.getX()),o=Math.trunc(t.getY()),s=Math.abs(o-a)>Math.abs(i-n);if(s){var l=n;n=a,a=l,l=i,i=o,o=l}for(var c=Math.abs(i-n),d=Math.abs(o-a),f=-c/2,h=a<o?1:-1,p=n<i?1:-1,g=0,y=this.image.get(s?a:n,s?n:a),x=n,v=a;x!==i;x+=p){var b=this.image.get(s?v:x,s?x:v);if(b!==y&&(g++,y=b),f+=d,f>0){if(v===o)break;v+=h,f-=c}}return g},r}(),Ia=function(){function r(){this.decoder=new g1}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n,a;if(t!=null&&t.has(De.PURE_BARCODE)){var i=r.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(i),a=r.NO_POINTS}else{var o=new v1(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var s=n.getRawBytes(),l=new gt(n.getText(),s,8*s.length,a,te.DATA_MATRIX,Oe.currentTimeMillis()),c=n.getByteSegments();c!=null&&l.putMetadata(dt.BYTE_SEGMENTS,c);var d=n.getECLevel();return d!=null&&l.putMetadata(dt.ERROR_CORRECTION_LEVEL,d),l},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new k;var a=this.moduleSize(t,e),i=t[1],o=n[1],s=t[0],l=n[0],c=(l-s+1)/a,d=(o-i+1)/a;if(c<=0||d<=0)throw new k;var f=a/2;i+=f,s+=f;for(var h=new er(c,d),p=0;p<d;p++)for(var g=i+p*a,y=0;y<c;y++)e.get(s+y*a,g)&&h.set(y,p);return h},r.moduleSize=function(e,t){for(var n=t.getWidth(),a=e[0],i=e[1];a<n&&t.get(a,i);)a++;if(a===n)throw new k;var o=a-e[0];if(o===0)throw new k;return o},r.NO_POINTS=[],r}(),y1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){y1(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Ia,t)||this}return e})(fn);var Zr;(function(r){r[r.L=0]="L",r[r.M=1]="M",r[r.Q=2]="Q",r[r.H=3]="H"})(Zr||(Zr={}));var x1=function(){function r(e,t,n){this.value=e,this.stringValue=t,this.bits=n,r.FOR_BITS.set(n,this),r.FOR_VALUE.set(e,this)}return r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.fromString=function(e){switch(e){case"L":return r.L;case"M":return r.M;case"Q":return r.Q;case"H":return r.H;default:throw new Xe(e+"not available")}},r.prototype.toString=function(){return this.stringValue},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.forBits=function(e){if(e<0||e>=r.FOR_BITS.size)throw new re;return r.FOR_BITS.get(e)},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.L=new r(Zr.L,"L",1),r.M=new r(Zr.M,"M",0),r.Q=new r(Zr.Q,"Q",3),r.H=new r(Zr.H,"H",2),r}(),b1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$u=function(){function r(e){this.errorCorrectionLevel=x1.forBits(e>>3&3),this.dataMask=e&7}return r.numBitsDiffering=function(e,t){return he.bitCount(e^t)},r.decodeFormatInformation=function(e,t){var n=r.doDecodeFormatInformation(e,t);return n!==null?n:r.doDecodeFormatInformation(e^r.FORMAT_INFO_MASK_QR,t^r.FORMAT_INFO_MASK_QR)},r.doDecodeFormatInformation=function(e,t){var n,a,i=Number.MAX_SAFE_INTEGER,o=0;try{for(var s=b1(r.FORMAT_INFO_DECODE_LOOKUP),l=s.next();!l.done;l=s.next()){var c=l.value,d=c[0];if(d===e||d===t)return new r(c[1]);var f=r.numBitsDiffering(e,d);f<i&&(o=c[1],i=f),e!==t&&(f=r.numBitsDiffering(t,d),f<i&&(o=c[1],i=f))}}catch(h){n={error:h}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return i<=3?new r(o):null},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getDataMask=function(){return this.dataMask},r.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask},r.FORMAT_INFO_MASK_QR=21522,r.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],r}(),w1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D=function(){function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=t}return r.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},r.prototype.getNumBlocks=function(){var e,t,n=0,a=this.ecBlocks;try{for(var i=w1(a),o=i.next();!o.done;o=i.next()){var s=o.value;n+=s.getCount()}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},r.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),S=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),A1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Br=function(){function r(e,t){for(var n,a,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=i;var s=0,l=i[0].getECCodewordsPerBlock(),c=i[0].getECBlocks();try{for(var d=A1(c),f=d.next();!f.done;f=d.next()){var h=f.value;s+=h.getCount()*(h.getDataCodewords()+l)}}catch(p){n={error:p}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=s}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},r.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},r.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new $;try{return this.getVersionForNumber((e-17)/4)}catch{throw new $}},r.getVersionForNumber=function(e){if(e<1||e>40)throw new re;return r.VERSIONS[e-1]},r.decodeVersionInformation=function(e){for(var t=Number.MAX_SAFE_INTEGER,n=0,a=0;a<r.VERSION_DECODE_INFO.length;a++){var i=r.VERSION_DECODE_INFO[a];if(i===e)return r.getVersionForNumber(a+7);var o=$u.numBitsDiffering(e,i);o<t&&(n=a+7,t=o)}return t<=3?r.getVersionForNumber(n):null},r.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),t=new er(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var i=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},r.prototype.toString=function(){return""+this.versionNumber},r.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),r.VERSIONS=[new r(1,new Int32Array(0),new D(7,new S(1,19)),new D(10,new S(1,16)),new D(13,new S(1,13)),new D(17,new S(1,9))),new r(2,Int32Array.from([6,18]),new D(10,new S(1,34)),new D(16,new S(1,28)),new D(22,new S(1,22)),new D(28,new S(1,16))),new r(3,Int32Array.from([6,22]),new D(15,new S(1,55)),new D(26,new S(1,44)),new D(18,new S(2,17)),new D(22,new S(2,13))),new r(4,Int32Array.from([6,26]),new D(20,new S(1,80)),new D(18,new S(2,32)),new D(26,new S(2,24)),new D(16,new S(4,9))),new r(5,Int32Array.from([6,30]),new D(26,new S(1,108)),new D(24,new S(2,43)),new D(18,new S(2,15),new S(2,16)),new D(22,new S(2,11),new S(2,12))),new r(6,Int32Array.from([6,34]),new D(18,new S(2,68)),new D(16,new S(4,27)),new D(24,new S(4,19)),new D(28,new S(4,15))),new r(7,Int32Array.from([6,22,38]),new D(20,new S(2,78)),new D(18,new S(4,31)),new D(18,new S(2,14),new S(4,15)),new D(26,new S(4,13),new S(1,14))),new r(8,Int32Array.from([6,24,42]),new D(24,new S(2,97)),new D(22,new S(2,38),new S(2,39)),new D(22,new S(4,18),new S(2,19)),new D(26,new S(4,14),new S(2,15))),new r(9,Int32Array.from([6,26,46]),new D(30,new S(2,116)),new D(22,new S(3,36),new S(2,37)),new D(20,new S(4,16),new S(4,17)),new D(24,new S(4,12),new S(4,13))),new r(10,Int32Array.from([6,28,50]),new D(18,new S(2,68),new S(2,69)),new D(26,new S(4,43),new S(1,44)),new D(24,new S(6,19),new S(2,20)),new D(28,new S(6,15),new S(2,16))),new r(11,Int32Array.from([6,30,54]),new D(20,new S(4,81)),new D(30,new S(1,50),new S(4,51)),new D(28,new S(4,22),new S(4,23)),new D(24,new S(3,12),new S(8,13))),new r(12,Int32Array.from([6,32,58]),new D(24,new S(2,92),new S(2,93)),new D(22,new S(6,36),new S(2,37)),new D(26,new S(4,20),new S(6,21)),new D(28,new S(7,14),new S(4,15))),new r(13,Int32Array.from([6,34,62]),new D(26,new S(4,107)),new D(22,new S(8,37),new S(1,38)),new D(24,new S(8,20),new S(4,21)),new D(22,new S(12,11),new S(4,12))),new r(14,Int32Array.from([6,26,46,66]),new D(30,new S(3,115),new S(1,116)),new D(24,new S(4,40),new S(5,41)),new D(20,new S(11,16),new S(5,17)),new D(24,new S(11,12),new S(5,13))),new r(15,Int32Array.from([6,26,48,70]),new D(22,new S(5,87),new S(1,88)),new D(24,new S(5,41),new S(5,42)),new D(30,new S(5,24),new S(7,25)),new D(24,new S(11,12),new S(7,13))),new r(16,Int32Array.from([6,26,50,74]),new D(24,new S(5,98),new S(1,99)),new D(28,new S(7,45),new S(3,46)),new D(24,new S(15,19),new S(2,20)),new D(30,new S(3,15),new S(13,16))),new r(17,Int32Array.from([6,30,54,78]),new D(28,new S(1,107),new S(5,108)),new D(28,new S(10,46),new S(1,47)),new D(28,new S(1,22),new S(15,23)),new D(28,new S(2,14),new S(17,15))),new r(18,Int32Array.from([6,30,56,82]),new D(30,new S(5,120),new S(1,121)),new D(26,new S(9,43),new S(4,44)),new D(28,new S(17,22),new S(1,23)),new D(28,new S(2,14),new S(19,15))),new r(19,Int32Array.from([6,30,58,86]),new D(28,new S(3,113),new S(4,114)),new D(26,new S(3,44),new S(11,45)),new D(26,new S(17,21),new S(4,22)),new D(26,new S(9,13),new S(16,14))),new r(20,Int32Array.from([6,34,62,90]),new D(28,new S(3,107),new S(5,108)),new D(26,new S(3,41),new S(13,42)),new D(30,new S(15,24),new S(5,25)),new D(28,new S(15,15),new S(10,16))),new r(21,Int32Array.from([6,28,50,72,94]),new D(28,new S(4,116),new S(4,117)),new D(26,new S(17,42)),new D(28,new S(17,22),new S(6,23)),new D(30,new S(19,16),new S(6,17))),new r(22,Int32Array.from([6,26,50,74,98]),new D(28,new S(2,111),new S(7,112)),new D(28,new S(17,46)),new D(30,new S(7,24),new S(16,25)),new D(24,new S(34,13))),new r(23,Int32Array.from([6,30,54,78,102]),new D(30,new S(4,121),new S(5,122)),new D(28,new S(4,47),new S(14,48)),new D(30,new S(11,24),new S(14,25)),new D(30,new S(16,15),new S(14,16))),new r(24,Int32Array.from([6,28,54,80,106]),new D(30,new S(6,117),new S(4,118)),new D(28,new S(6,45),new S(14,46)),new D(30,new S(11,24),new S(16,25)),new D(30,new S(30,16),new S(2,17))),new r(25,Int32Array.from([6,32,58,84,110]),new D(26,new S(8,106),new S(4,107)),new D(28,new S(8,47),new S(13,48)),new D(30,new S(7,24),new S(22,25)),new D(30,new S(22,15),new S(13,16))),new r(26,Int32Array.from([6,30,58,86,114]),new D(28,new S(10,114),new S(2,115)),new D(28,new S(19,46),new S(4,47)),new D(28,new S(28,22),new S(6,23)),new D(30,new S(33,16),new S(4,17))),new r(27,Int32Array.from([6,34,62,90,118]),new D(30,new S(8,122),new S(4,123)),new D(28,new S(22,45),new S(3,46)),new D(30,new S(8,23),new S(26,24)),new D(30,new S(12,15),new S(28,16))),new r(28,Int32Array.from([6,26,50,74,98,122]),new D(30,new S(3,117),new S(10,118)),new D(28,new S(3,45),new S(23,46)),new D(30,new S(4,24),new S(31,25)),new D(30,new S(11,15),new S(31,16))),new r(29,Int32Array.from([6,30,54,78,102,126]),new D(30,new S(7,116),new S(7,117)),new D(28,new S(21,45),new S(7,46)),new D(30,new S(1,23),new S(37,24)),new D(30,new S(19,15),new S(26,16))),new r(30,Int32Array.from([6,26,52,78,104,130]),new D(30,new S(5,115),new S(10,116)),new D(28,new S(19,47),new S(10,48)),new D(30,new S(15,24),new S(25,25)),new D(30,new S(23,15),new S(25,16))),new r(31,Int32Array.from([6,30,56,82,108,134]),new D(30,new S(13,115),new S(3,116)),new D(28,new S(2,46),new S(29,47)),new D(30,new S(42,24),new S(1,25)),new D(30,new S(23,15),new S(28,16))),new r(32,Int32Array.from([6,34,60,86,112,138]),new D(30,new S(17,115)),new D(28,new S(10,46),new S(23,47)),new D(30,new S(10,24),new S(35,25)),new D(30,new S(19,15),new S(35,16))),new r(33,Int32Array.from([6,30,58,86,114,142]),new D(30,new S(17,115),new S(1,116)),new D(28,new S(14,46),new S(21,47)),new D(30,new S(29,24),new S(19,25)),new D(30,new S(11,15),new S(46,16))),new r(34,Int32Array.from([6,34,62,90,118,146]),new D(30,new S(13,115),new S(6,116)),new D(28,new S(14,46),new S(23,47)),new D(30,new S(44,24),new S(7,25)),new D(30,new S(59,16),new S(1,17))),new r(35,Int32Array.from([6,30,54,78,102,126,150]),new D(30,new S(12,121),new S(7,122)),new D(28,new S(12,47),new S(26,48)),new D(30,new S(39,24),new S(14,25)),new D(30,new S(22,15),new S(41,16))),new r(36,Int32Array.from([6,24,50,76,102,128,154]),new D(30,new S(6,121),new S(14,122)),new D(28,new S(6,47),new S(34,48)),new D(30,new S(46,24),new S(10,25)),new D(30,new S(2,15),new S(64,16))),new r(37,Int32Array.from([6,28,54,80,106,132,158]),new D(30,new S(17,122),new S(4,123)),new D(28,new S(29,46),new S(14,47)),new D(30,new S(49,24),new S(10,25)),new D(30,new S(24,15),new S(46,16))),new r(38,Int32Array.from([6,32,58,84,110,136,162]),new D(30,new S(4,122),new S(18,123)),new D(28,new S(13,46),new S(32,47)),new D(30,new S(48,24),new S(14,25)),new D(30,new S(42,15),new S(32,16))),new r(39,Int32Array.from([6,26,54,82,110,138,166]),new D(30,new S(20,117),new S(4,118)),new D(28,new S(40,47),new S(7,48)),new D(30,new S(43,24),new S(22,25)),new D(30,new S(10,15),new S(67,16))),new r(40,Int32Array.from([6,30,58,86,114,142,170]),new D(30,new S(19,118),new S(6,119)),new D(28,new S(18,47),new S(31,48)),new D(30,new S(34,24),new S(34,25)),new D(30,new S(20,15),new S(61,16)))],r}(),nt;(function(r){r[r.DATA_MASK_000=0]="DATA_MASK_000",r[r.DATA_MASK_001=1]="DATA_MASK_001",r[r.DATA_MASK_010=2]="DATA_MASK_010",r[r.DATA_MASK_011=3]="DATA_MASK_011",r[r.DATA_MASK_100=4]="DATA_MASK_100",r[r.DATA_MASK_101=5]="DATA_MASK_101",r[r.DATA_MASK_110=6]="DATA_MASK_110",r[r.DATA_MASK_111=7]="DATA_MASK_111"})(nt||(nt={}));var Qs=function(){function r(e,t){this.value=e,this.isMasked=t}return r.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var a=0;a<t;a++)this.isMasked(n,a)&&e.flip(a,n)},r.values=new Map([[nt.DATA_MASK_000,new r(nt.DATA_MASK_000,function(e,t){return(e+t&1)===0})],[nt.DATA_MASK_001,new r(nt.DATA_MASK_001,function(e,t){return(e&1)===0})],[nt.DATA_MASK_010,new r(nt.DATA_MASK_010,function(e,t){return t%3===0})],[nt.DATA_MASK_011,new r(nt.DATA_MASK_011,function(e,t){return(e+t)%3===0})],[nt.DATA_MASK_100,new r(nt.DATA_MASK_100,function(e,t){return(Math.floor(e/2)+Math.floor(t/3)&1)===0})],[nt.DATA_MASK_101,new r(nt.DATA_MASK_101,function(e,t){return e*t%6===0})],[nt.DATA_MASK_110,new r(nt.DATA_MASK_110,function(e,t){return e*t%6<3})],[nt.DATA_MASK_111,new r(nt.DATA_MASK_111,function(e,t){return(e+t+e*t%3&1)===0})]]),r}(),C1=function(){function r(e){var t=e.getHeight();if(t<21||(t&3)!==1)throw new $;this.bitMatrix=e}return r.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),i=0,o=a-7,n=a-1;n>=o;n--)i=this.copyBit(8,n,i);for(var t=a-8;t<a;t++)i=this.copyBit(t,8,i);if(this.parsedFormatInfo=$u.decodeFormatInformation(e,i),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new $},r.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Br.getVersionForNumber(t);for(var n=0,a=e-11,i=5;i>=0;i--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,i,n);var s=Br.decodeVersionInformation(n);if(s!==null&&s.getDimensionForVersion()===e)return this.parsedVersion=s,s;n=0;for(var o=5;o>=0;o--)for(var i=e-9;i>=a;i--)n=this.copyBit(o,i,n);if(s=Br.decodeVersionInformation(n),s!==null&&s.getDimensionForVersion()===e)return this.parsedVersion=s,s;throw new $},r.prototype.copyBit=function(e,t,n){var a=this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t);return a?n<<1|1:n<<1},r.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=Qs.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var i=t.buildFunctionPattern(),o=!0,s=new Uint8Array(t.getTotalCodewords()),l=0,c=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var h=0;h<a;h++)for(var p=o?a-1-h:h,g=0;g<2;g++)i.get(f-g,p)||(d++,c<<=1,this.bitMatrix.get(f-g,p)&&(c|=1),d===8&&(s[l++]=c,d=0,c=0));o=!o}if(l!==t.getTotalCodewords())throw new $;return s},r.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=Qs.values.get(this.parsedFormatInfo.getDataMask()),t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}},r.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},r.prototype.mirror=function(){for(var e=this.bitMatrix,t=0,n=e.getWidth();t<n;t++)for(var a=t+1,i=e.getHeight();a<i;a++)e.get(t,a)!==e.get(a,t)&&(e.flip(a,t),e.flip(t,a))},r}(),Js=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_1=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t,n){var a,i,o,s;if(e.length!==t.getTotalCodewords())throw new re;var l=t.getECBlocksForLevel(n),c=0,d=l.getECBlocks();try{for(var f=Js(d),h=f.next();!h.done;h=f.next()){var p=h.value;c+=p.getCount()}}catch(B){a={error:B}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}var g=new Array(c),y=0;try{for(var x=Js(d),v=x.next();!v.done;v=x.next())for(var p=v.value,b=0;b<p.getCount();b++){var _=p.getDataCodewords(),w=l.getECCodewordsPerBlock()+_;g[y++]=new r(_,new Uint8Array(w))}}catch(B){o={error:B}}finally{try{v&&!v.done&&(s=x.return)&&s.call(x)}finally{if(o)throw o.error}}for(var A=g[0].codewords.length,C=g.length-1;C>=0;){var I=g[C].codewords.length;if(I===A)break;C--}C++;for(var R=A-l.getECCodewordsPerBlock(),F=0,b=0;b<R;b++)for(var T=0;T<y;T++)g[T].codewords[b]=e[F++];for(var T=C;T<y;T++)g[T].codewords[R]=e[F++];for(var U=g[0].codewords.length,b=R;b<U;b++)for(var T=0;T<y;T++){var L=T<C?b:b+1;g[T].codewords[L]=e[F++]}return g},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),Ot;(function(r){r[r.TERMINATOR=0]="TERMINATOR",r[r.NUMERIC=1]="NUMERIC",r[r.ALPHANUMERIC=2]="ALPHANUMERIC",r[r.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",r[r.BYTE=4]="BYTE",r[r.ECI=5]="ECI",r[r.KANJI=6]="KANJI",r[r.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",r[r.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",r[r.HANZI=9]="HANZI"})(Ot||(Ot={}));var ke=function(){function r(e,t,n,a){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=a,r.FOR_BITS.set(a,this),r.FOR_VALUE.set(e,this)}return r.forBits=function(e){var t=r.FOR_BITS.get(e);if(t===void 0)throw new re;return t},r.prototype.getCharacterCountBits=function(e){var t=e.getVersionNumber(),n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]},r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.toString=function(){return this.stringValue},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.TERMINATOR=new r(Ot.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),r.NUMERIC=new r(Ot.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),r.ALPHANUMERIC=new r(Ot.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),r.STRUCTURED_APPEND=new r(Ot.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),r.BYTE=new r(Ot.BYTE,"BYTE",Int32Array.from([8,16,16]),4),r.ECI=new r(Ot.ECI,"ECI",Int32Array.from([0,0,0]),7),r.KANJI=new r(Ot.KANJI,"KANJI",Int32Array.from([8,10,12]),8),r.FNC1_FIRST_POSITION=new r(Ot.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),r.FNC1_SECOND_POSITION=new r(Ot.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),r.HANZI=new r(Ot.HANZI,"HANZI",Int32Array.from([8,10,12]),13),r}(),E1=function(){function r(){}return r.decode=function(e,t,n,a){var i=new Uu(e),o=new de,s=new Array,l=-1,c=-1;try{var d=null,f=!1,h=void 0;do{if(i.available()<4)h=ke.TERMINATOR;else{var p=i.readBits(4);h=ke.forBits(p)}switch(h){case ke.TERMINATOR:break;case ke.FNC1_FIRST_POSITION:case ke.FNC1_SECOND_POSITION:f=!0;break;case ke.STRUCTURED_APPEND:if(i.available()<16)throw new $;l=i.readBits(8),c=i.readBits(8);break;case ke.ECI:var g=r.parseECIValue(i);if(d=Je.getCharacterSetECIByValue(g),d===null)throw new $;break;case ke.HANZI:var y=i.readBits(4),x=i.readBits(h.getCharacterCountBits(t));y===r.GB2312_SUBSET&&r.decodeHanziSegment(i,o,x);break;default:var v=i.readBits(h.getCharacterCountBits(t));switch(h){case ke.NUMERIC:r.decodeNumericSegment(i,o,v);break;case ke.ALPHANUMERIC:r.decodeAlphanumericSegment(i,o,v,f);break;case ke.BYTE:r.decodeByteSegment(i,o,v,d,s,a);break;case ke.KANJI:r.decodeKanjiSegment(i,o,v);break;default:throw new $}break}}while(h!==ke.TERMINATOR)}catch{throw new $}return new Ga(e,o.toString(),s.length===0?null:s,n===null?null:n.toString(),l,c)},r.decodeHanziSegment=function(e,t,n){if(n*13>e.available())throw new $;for(var a=new Uint8Array(2*n),i=0;n>0;){var o=e.readBits(13),s=o/96<<8&4294967295|o%96;s<959?s+=41377:s+=42657,a[i]=s>>8&255,a[i+1]=s&255,i+=2,n--}try{t.append(Vt.decode(a,ve.GB2312))}catch(l){throw new $(l)}},r.decodeKanjiSegment=function(e,t,n){if(n*13>e.available())throw new $;for(var a=new Uint8Array(2*n),i=0;n>0;){var o=e.readBits(13),s=o/192<<8&4294967295|o%192;s<7936?s+=33088:s+=49472,a[i]=s>>8,a[i+1]=s,i+=2,n--}try{t.append(Vt.decode(a,ve.SHIFT_JIS))}catch(l){throw new $(l)}},r.decodeByteSegment=function(e,t,n,a,i,o){if(8*n>e.available())throw new $;for(var s=new Uint8Array(n),l=0;l<n;l++)s[l]=e.readBits(8);var c;a===null?c=ve.guessEncoding(s,o):c=a.getName();try{t.append(Vt.decode(s,c))}catch(d){throw new $(d)}i.push(s)},r.toAlphaNumericChar=function(e){if(e>=r.ALPHANUMERIC_CHARS.length)throw new $;return r.ALPHANUMERIC_CHARS[e]},r.decodeAlphanumericSegment=function(e,t,n,a){for(var i=t.length();n>1;){if(e.available()<11)throw new $;var o=e.readBits(11);t.append(r.toAlphaNumericChar(Math.floor(o/45))),t.append(r.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new $;t.append(r.toAlphaNumericChar(e.readBits(6)))}if(a)for(var s=i;s<t.length();s++)t.charAt(s)==="%"&&(s<t.length()-1&&t.charAt(s+1)==="%"?t.deleteCharAt(s+1):t.setCharAt(s,""))},r.decodeNumericSegment=function(e,t,n){for(;n>=3;){if(e.available()<10)throw new $;var a=e.readBits(10);if(a>=1e3)throw new $;t.append(r.toAlphaNumericChar(Math.floor(a/100))),t.append(r.toAlphaNumericChar(Math.floor(a/10)%10)),t.append(r.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new $;var i=e.readBits(7);if(i>=100)throw new $;t.append(r.toAlphaNumericChar(Math.floor(i/10))),t.append(r.toAlphaNumericChar(i%10))}else if(n===1){if(e.available()<4)throw new $;var o=e.readBits(4);if(o>=10)throw new $;t.append(r.toAlphaNumericChar(o))}},r.parseECIValue=function(e){var t=e.readBits(8);if(!(t&128))return t&127;if((t&192)===128){var n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){var a=e.readBits(16);return(t&31)<<16&4294967295|a}throw new $},r.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r.GB2312_SUBSET=1,r}(),Hu=function(){function r(e){this.mirrored=e}return r.prototype.isMirrored=function(){return this.mirrored},r.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var t=e[0];e[0]=e[2],e[2]=t}},r}(),el=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},N1=function(){function r(){this.rsDecoder=new za(Nt.QR_CODE_FIELD_256)}return r.prototype.decodeBooleanArray=function(e,t){return this.decodeBitMatrix(er.parseFromBooleanArray(e),t)},r.prototype.decodeBitMatrix=function(e,t){var n=new C1(e),a=null;try{return this.decodeBitMatrixParser(n,t)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var i=this.decodeBitMatrixParser(n,t);return i.setOther(new Hu(!0)),i}catch(o){throw a!==null?a:o}},r.prototype.decodeBitMatrixParser=function(e,t){var n,a,i,o,s=e.readVersion(),l=e.readFormatInformation().getErrorCorrectionLevel(),c=e.readCodewords(),d=_1.getDataBlocks(c,s,l),f=0;try{for(var h=el(d),p=h.next();!p.done;p=h.next()){var g=p.value;f+=g.getNumDataCodewords()}}catch(C){n={error:C}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}var y=new Uint8Array(f),x=0;try{for(var v=el(d),b=v.next();!b.done;b=v.next()){var g=b.value,_=g.getCodewords(),w=g.getNumDataCodewords();this.correctErrors(_,w);for(var A=0;A<w;A++)y[x++]=_[A]}}catch(C){i={error:C}}finally{try{b&&!b.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}return E1.decode(y,s,l,t)},r.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new Ye}for(var a=0;a<t;a++)e[a]=n[a]},r}(),S1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),I1=function(r){S1(e,r);function e(t,n,a){var i=r.call(this,t,n)||this;return i.estimatedModuleSize=a,i}return e.prototype.aboutEquals=function(t,n,a){if(Math.abs(n-this.getY())<=t&&Math.abs(a-this.getX())<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,n,a){var i=(this.getX()+n)/2,o=(this.getY()+t)/2,s=(this.estimatedModuleSize+a)/2;return new e(i,o,s)},e}(q),T1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},R1=function(){function r(e,t,n,a,i,o,s){this.image=e,this.startX=t,this.startY=n,this.width=a,this.height=i,this.moduleSize=o,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return r.prototype.find=function(){for(var e=this.startX,t=this.height,n=this.width,a=e+n,i=this.startY+t/2,o=new Int32Array(3),s=this.image,l=0;l<t;l++){var c=i+(l&1?-Math.floor((l+1)/2):Math.floor((l+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!s.get(d,c);)d++;for(var f=0;d<a;){if(s.get(d,c))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var h=this.handlePossibleCenter(o,c,d);if(h!==null)return h}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var h=this.handlePossibleCenter(o,c,a);if(h!==null)return h}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new k},r.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},r.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,a=0;a<3;a++)if(Math.abs(t-e[a])>=n)return!1;return!0},r.prototype.crossCheckVertical=function(e,t,n,a){var i=this.image,o=i.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var l=e;l>=0&&i.get(t,l)&&s[1]<=n;)s[1]++,l--;if(l<0||s[1]>n)return NaN;for(;l>=0&&!i.get(t,l)&&s[0]<=n;)s[0]++,l--;if(s[0]>n)return NaN;for(l=e+1;l<o&&i.get(t,l)&&s[1]<=n;)s[1]++,l++;if(l===o||s[1]>n)return NaN;for(;l<o&&!i.get(t,l)&&s[2]<=n;)s[2]++,l++;if(s[2]>n)return NaN;var c=s[0]+s[1]+s[2];return 5*Math.abs(c-a)>=2*a?NaN:this.foundPatternCross(s)?r.centerFromEnd(s,l):NaN},r.prototype.handlePossibleCenter=function(e,t,n){var a,i,o=e[0]+e[1]+e[2],s=r.centerFromEnd(e,n),l=this.crossCheckVertical(t,s,2*e[1],o);if(!isNaN(l)){var c=(e[0]+e[1]+e[2])/3;try{for(var d=T1(this.possibleCenters),f=d.next();!f.done;f=d.next()){var h=f.value;if(h.aboutEquals(c,l,s))return h.combineEstimate(l,s,c)}}catch(g){a={error:g}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}var p=new I1(s,l,c);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null},r}(),O1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),D1=function(r){O1(e,r);function e(t,n,a,i){var o=r.call(this,t,n)||this;return o.estimatedModuleSize=a,o.count=i,i===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(t,n,a){if(Math.abs(n-this.getY())<=t&&Math.abs(a-this.getX())<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,n,a){var i=this.count+1,o=(this.count*this.getX()+n)/i,s=(this.count*this.getY()+t)/i,l=(this.count*this.estimatedModuleSize+a)/i;return new e(o,s,l,i)},e}(q),P1=function(){function r(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r}(),xn=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},M1=function(){function r(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}return r.prototype.getImage=function(){return this.image},r.prototype.getPossibleCenters=function(){return this.possibleCenters},r.prototype.find=function(e){var t=e!=null&&e.get(De.TRY_HARDER)!==void 0,n=e!=null&&e.get(De.PURE_BARCODE)!==void 0,a=this.image,i=a.getHeight(),o=a.getWidth(),s=Math.floor(3*i/(4*r.MAX_MODULES));(s<r.MIN_SKIP||t)&&(s=r.MIN_SKIP);for(var l=!1,c=new Int32Array(5),d=s-1;d<i&&!l;d+=s){c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0;for(var f=0,h=0;h<o;h++)if(a.get(h,d))(f&1)===1&&f++,c[f]++;else if(f&1)c[f]++;else if(f===4)if(r.foundPatternCross(c)){var p=this.handlePossibleCenter(c,d,h,n);if(p===!0)if(s=2,this.hasSkipped===!0)l=this.haveMultiplyConfirmedCenters();else{var g=this.findRowSkip();g>c[2]&&(d+=g-c[2]-s,h=o-1)}else{c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,f=3;continue}f=0,c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0}else c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,f=3;else c[++f]++;if(r.foundPatternCross(c)){var p=this.handlePossibleCenter(c,d,o,n);p===!0&&(s=c[0],this.hasSkipped&&(l=this.haveMultiplyConfirmedCenters()))}}var y=this.selectBestPatterns();return q.orderBestPatterns(y),new P1(y)},r.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},r.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;t+=a}if(t<7)return!1;var i=t/7,o=i/2;return Math.abs(i-e[0])<o&&Math.abs(i-e[1])<o&&Math.abs(3*i-e[2])<3*o&&Math.abs(i-e[3])<o&&Math.abs(i-e[4])<o},r.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},r.prototype.crossCheckDiagonal=function(e,t,n,a){for(var i=this.getCrossCheckStateCount(),o=0,s=this.image;e>=o&&t>=o&&s.get(t-o,e-o);)i[2]++,o++;if(e<o||t<o)return!1;for(;e>=o&&t>=o&&!s.get(t-o,e-o)&&i[1]<=n;)i[1]++,o++;if(e<o||t<o||i[1]>n)return!1;for(;e>=o&&t>=o&&s.get(t-o,e-o)&&i[0]<=n;)i[0]++,o++;if(i[0]>n)return!1;var l=s.getHeight(),c=s.getWidth();for(o=1;e+o<l&&t+o<c&&s.get(t+o,e+o);)i[2]++,o++;if(e+o>=l||t+o>=c)return!1;for(;e+o<l&&t+o<c&&!s.get(t+o,e+o)&&i[3]<n;)i[3]++,o++;if(e+o>=l||t+o>=c||i[3]>=n)return!1;for(;e+o<l&&t+o<c&&s.get(t+o,e+o)&&i[4]<n;)i[4]++,o++;if(i[4]>=n)return!1;var d=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(d-a)<2*a&&r.foundPatternCross(i)},r.prototype.crossCheckVertical=function(e,t,n,a){for(var i=this.image,o=i.getHeight(),s=this.getCrossCheckStateCount(),l=e;l>=0&&i.get(t,l);)s[2]++,l--;if(l<0)return NaN;for(;l>=0&&!i.get(t,l)&&s[1]<=n;)s[1]++,l--;if(l<0||s[1]>n)return NaN;for(;l>=0&&i.get(t,l)&&s[0]<=n;)s[0]++,l--;if(s[0]>n)return NaN;for(l=e+1;l<o&&i.get(t,l);)s[2]++,l++;if(l===o)return NaN;for(;l<o&&!i.get(t,l)&&s[3]<n;)s[3]++,l++;if(l===o||s[3]>=n)return NaN;for(;l<o&&i.get(t,l)&&s[4]<n;)s[4]++,l++;if(s[4]>=n)return NaN;var c=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(c-a)>=2*a?NaN:r.foundPatternCross(s)?r.centerFromEnd(s,l):NaN},r.prototype.crossCheckHorizontal=function(e,t,n,a){for(var i=this.image,o=i.getWidth(),s=this.getCrossCheckStateCount(),l=e;l>=0&&i.get(l,t);)s[2]++,l--;if(l<0)return NaN;for(;l>=0&&!i.get(l,t)&&s[1]<=n;)s[1]++,l--;if(l<0||s[1]>n)return NaN;for(;l>=0&&i.get(l,t)&&s[0]<=n;)s[0]++,l--;if(s[0]>n)return NaN;for(l=e+1;l<o&&i.get(l,t);)s[2]++,l++;if(l===o)return NaN;for(;l<o&&!i.get(l,t)&&s[3]<n;)s[3]++,l++;if(l===o||s[3]>=n)return NaN;for(;l<o&&i.get(l,t)&&s[4]<n;)s[4]++,l++;if(s[4]>=n)return NaN;var c=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(c-a)>=a?NaN:r.foundPatternCross(s)?r.centerFromEnd(s,l):NaN},r.prototype.handlePossibleCenter=function(e,t,n,a){var i=e[0]+e[1]+e[2]+e[3]+e[4],o=r.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(o),e[2],i);if(!isNaN(s)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(s),e[2],i),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(s),Math.floor(o),e[2],i)))){for(var l=i/7,c=!1,d=this.possibleCenters,f=0,h=d.length;f<h;f++){var p=d[f];if(p.aboutEquals(l,s,o)){d[f]=p.combineEstimate(s,o,l),c=!0;break}}if(!c){var g=new D1(o,s,l);d.push(g),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(g)}return!0}return!1},r.prototype.findRowSkip=function(){var e,t,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var i=xn(this.possibleCenters),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.getCount()>=r.CENTER_QUORUM)if(a==null)a=s;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-s.getX())-Math.abs(a.getY()-s.getY()))/2)}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return 0},r.prototype.haveMultiplyConfirmedCenters=function(){var e,t,n,a,i=0,o=0,s=this.possibleCenters.length;try{for(var l=xn(this.possibleCenters),c=l.next();!c.done;c=l.next()){var d=c.value;d.getCount()>=r.CENTER_QUORUM&&(i++,o+=d.getEstimatedModuleSize())}}catch(y){e={error:y}}finally{try{c&&!c.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}if(i<3)return!1;var f=o/s,h=0;try{for(var p=xn(this.possibleCenters),g=p.next();!g.done;g=p.next()){var d=g.value;h+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(y){n={error:y}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(n)throw n.error}}return h<=.05*o},r.prototype.selectBestPatterns=function(){var e,t,n,a,i=this.possibleCenters.length;if(i<3)throw new k;var o=this.possibleCenters,s;if(i>3){var l=0,c=0;try{for(var d=xn(this.possibleCenters),f=d.next();!f.done;f=d.next()){var h=f.value,p=h.getEstimatedModuleSize();l+=p,c+=p*p}}catch(A){e={error:A}}finally{try{f&&!f.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}s=l/i;var g=Math.sqrt(c/i-s*s);o.sort(function(A,C){var I=Math.abs(C.getEstimatedModuleSize()-s),R=Math.abs(A.getEstimatedModuleSize()-s);return I<R?-1:I>R?1:0});for(var y=Math.max(.2*s,g),x=0;x<o.length&&o.length>3;x++){var v=o[x];Math.abs(v.getEstimatedModuleSize()-s)>y&&(o.splice(x,1),x--)}}if(o.length>3){var l=0;try{for(var b=xn(o),_=b.next();!_.done;_=b.next()){var w=_.value;l+=w.getEstimatedModuleSize()}}catch(C){n={error:C}}finally{try{_&&!_.done&&(a=b.return)&&a.call(b)}finally{if(n)throw n.error}}s=l/o.length,o.sort(function(C,I){if(I.getCount()===C.getCount()){var R=Math.abs(I.getEstimatedModuleSize()-s),F=Math.abs(C.getEstimatedModuleSize()-s);return R<F?1:R>F?-1:0}else return I.getCount()-C.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},r.CENTER_QUORUM=2,r.MIN_SKIP=3,r.MAX_MODULES=57,r}(),L1=function(){function r(e){this.image=e}return r.prototype.getImage=function(){return this.image},r.prototype.getResultPointCallback=function(){return this.resultPointCallback},r.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(De.NEED_RESULT_POINT_CALLBACK);var t=new M1(this.image,this.resultPointCallback),n=t.find(e);return this.processFinderPatternInfo(n)},r.prototype.processFinderPatternInfo=function(e){var t=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),i=this.calculateModuleSize(t,n,a);if(i<1)throw new k("No pattern found in proccess finder.");var o=r.computeDimension(t,n,a,i),s=Br.getProvisionalVersionForDimension(o),l=s.getDimensionForVersion()-7,c=null;if(s.getAlignmentPatternCenters().length>0)for(var d=n.getX()-t.getX()+a.getX(),f=n.getY()-t.getY()+a.getY(),h=1-3/l,p=Math.floor(t.getX()+h*(d-t.getX())),g=Math.floor(t.getY()+h*(f-t.getY())),y=4;y<=16;y<<=1)try{c=this.findAlignmentInRegion(i,p,g,y);break}catch(_){if(!(_ instanceof k))throw _}var x=r.createTransform(t,n,a,c,o),v=r.sampleGrid(this.image,x,o),b;return c===null?b=[a,t,n]:b=[a,t,n,c],new Oo(v,b)},r.createTransform=function(e,t,n,a,i){var o=i-3.5,s,l,c,d;return a!==null?(s=a.getX(),l=a.getY(),c=o-3,d=c):(s=t.getX()-e.getX()+n.getX(),l=t.getY()-e.getY()+n.getY(),c=o,d=o),Fu.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,c,d,3.5,o,e.getX(),e.getY(),t.getX(),t.getY(),s,l,n.getX(),n.getY())},r.sampleGrid=function(e,t,n){var a=Do.getInstance();return a.sampleGridWithTransform(e,n,n,t)},r.computeDimension=function(e,t,n,a){var i=we.round(q.distance(e,t)/a),o=we.round(q.distance(e,n)/a),s=Math.floor((i+o)/2)+7;switch(s&3){case 0:s++;break;case 2:s--;break;case 3:throw new k("Dimensions could be not found.")}return s},r.prototype.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},r.prototype.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},r.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,a){var i=this.sizeOfBlackWhiteBlackRun(e,t,n,a),o=1,s=e-(n-e);s<0?(o=e/(e-s),s=0):s>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(s-e),s=this.image.getWidth()-1);var l=Math.floor(t-(a-t)*o);return o=1,l<0?(o=t/(t-l),l=0):l>=this.image.getHeight()&&(o=(this.image.getHeight()-1-t)/(l-t),l=this.image.getHeight()-1),s=Math.floor(e+(s-e)*o),i+=this.sizeOfBlackWhiteBlackRun(e,t,s,l),i-1},r.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,a){var i=Math.abs(a-t)>Math.abs(n-e);if(i){var o=e;e=t,t=o,o=n,n=a,a=o}for(var s=Math.abs(n-e),l=Math.abs(a-t),c=-s/2,d=e<n?1:-1,f=t<a?1:-1,h=0,p=n+d,g=e,y=t;g!==p;g+=d){var x=i?y:g,v=i?g:y;if(h===1===this.image.get(x,v)){if(h===2)return we.distance(g,y,e,t);h++}if(c+=l,c>0){if(y===a)break;y+=f,c-=s}}return h===2?we.distance(n+d,a,e,t):NaN},r.prototype.findAlignmentInRegion=function(e,t,n,a){var i=Math.floor(a*e),o=Math.max(0,t-i),s=Math.min(this.image.getWidth()-1,t+i);if(s-o<e*3)throw new k("Alignment top exceeds estimated module size.");var l=Math.max(0,n-i),c=Math.min(this.image.getHeight()-1,n+i);if(c-l<e*3)throw new k("Alignment bottom exceeds estimated module size.");var d=new R1(this.image,o,l,s-o,c-l,e,this.resultPointCallback);return d.find()},r}(),Ta=function(){function r(){this.decoder=new N1}return r.prototype.getDecoder=function(){return this.decoder},r.prototype.decode=function(e,t){var n,a;if(t!=null&&t.get(De.PURE_BARCODE)!==void 0){var i=r.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(i,t),a=r.NO_POINTS}else{var o=new L1(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(o.getBits(),t),a=o.getPoints()}n.getOther()instanceof Hu&&n.getOther().applyMirroredCorrection(a);var s=new gt(n.getText(),n.getRawBytes(),void 0,a,te.QR_CODE,void 0),l=n.getByteSegments();l!==null&&s.putMetadata(dt.BYTE_SEGMENTS,l);var c=n.getECLevel();return c!==null&&s.putMetadata(dt.ERROR_CORRECTION_LEVEL,c),n.hasStructuredAppend()&&(s.putMetadata(dt.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),s.putMetadata(dt.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),s},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new k;var a=this.moduleSize(t,e),i=t[1],o=n[1],s=t[0],l=n[0];if(s>=l||i>=o)throw new k;if(o-i!==l-s&&(l=s+(o-i),l>=e.getWidth()))throw new k;var c=Math.round((l-s+1)/a),d=Math.round((o-i+1)/a);if(c<=0||d<=0)throw new k;if(d!==c)throw new k;var f=Math.floor(a/2);i+=f,s+=f;var h=s+Math.floor((c-1)*a)-l;if(h>0){if(h>f)throw new k;s-=h}var p=i+Math.floor((d-1)*a)-o;if(p>0){if(p>f)throw new k;i-=p}for(var g=new er(c,d),y=0;y<d;y++)for(var x=i+Math.floor(y*a),v=0;v<c;v++)e.get(s+Math.floor(v*a),x)&&g.set(v,y);return g},r.moduleSize=function(e,t){for(var n=t.getHeight(),a=t.getWidth(),i=e[0],o=e[1],s=!0,l=0;i<a&&o<n;){if(s!==t.get(i,o)){if(++l===5)break;s=!s}i++,o++}if(i===a||o===n)throw new k;return(i-e[0])/7},r.NO_POINTS=new Array,r}(),k1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ye=function(){function r(){}return r.prototype.PDF417Common=function(){},r.getBitCountSum=function(e){return we.sum(e)},r.toIntArray=function(e){var t,n;if(e==null||!e.length)return r.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),i=0;try{for(var o=k1(e),s=o.next();!s.done;s=o.next()){var l=s.value;a[i++]=l}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a},r.getCodeword=function(e){var t=et.binarySearch(r.SYMBOL_TABLE,e&262143);return t<0?-1:(r.CODEWORD_TABLE[t]-1)%r.NUMBER_OF_CODEWORDS},r.NUMBER_OF_CODEWORDS=929,r.MAX_CODEWORDS_IN_BARCODE=r.NUMBER_OF_CODEWORDS-1,r.MIN_ROWS_IN_BARCODE=3,r.MAX_ROWS_IN_BARCODE=90,r.MODULES_IN_CODEWORD=17,r.MODULES_IN_STOP_PATTERN=18,r.BARS_IN_MODULE=8,r.EMPTY_INT_ARRAY=new Int32Array([]),r.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),r.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),r}(),F1=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),B1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},V1=function(){function r(){}return r.detectMultiple=function(e,t,n){var a=e.getBlackMatrix(),i=r.detect(n,a);return i.length||(a=a.clone(),a.rotate180(),i=r.detect(n,a)),new F1(a,i)},r.detect=function(e,t){for(var n,a,i=new Array,o=0,s=0,l=!1;o<t.getHeight();){var c=r.findVertices(t,o,s);if(c[0]==null&&c[3]==null){if(!l)break;l=!1,s=0;try{for(var d=(n=void 0,B1(i)),f=d.next();!f.done;f=d.next()){var h=f.value;h[1]!=null&&(o=Math.trunc(Math.max(o,h[1].getY()))),h[3]!=null&&(o=Math.max(o,Math.trunc(h[3].getY())))}}catch(p){n={error:p}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=r.ROW_STEP;continue}if(l=!0,i.push(c),!e)break;c[2]!=null?(s=Math.trunc(c[2].getX()),o=Math.trunc(c[2].getY())):(s=Math.trunc(c[4].getX()),o=Math.trunc(c[4].getY()))}return i},r.findVertices=function(e,t,n){var a=e.getHeight(),i=e.getWidth(),o=new Array(8);return r.copyToResult(o,r.findRowsWithPattern(e,a,i,t,n,r.START_PATTERN),r.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),t=Math.trunc(o[4].getY())),r.copyToResult(o,r.findRowsWithPattern(e,a,i,t,n,r.STOP_PATTERN),r.INDEXES_STOP_PATTERN),o},r.copyToResult=function(e,t,n){for(var a=0;a<n.length;a++)e[n[a]]=t[a]},r.findRowsWithPattern=function(e,t,n,a,i,o){for(var s=new Array(4),l=!1,c=new Int32Array(o.length);a<t;a+=r.ROW_STEP){var d=r.findGuardPattern(e,i,a,n,!1,o,c);if(d!=null){for(;a>0;){var f=r.findGuardPattern(e,i,--a,n,!1,o,c);if(f!=null)d=f;else{a++;break}}s[0]=new q(d[0],a),s[1]=new q(d[1],a),l=!0;break}}var h=a+1;if(l){for(var p=0,f=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);h<t;h++){var d=r.findGuardPattern(e,f[0],h,n,!1,o,c);if(d!=null&&Math.abs(f[0]-d[0])<r.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<r.MAX_PATTERN_DRIFT)f=d,p=0;else{if(p>r.SKIPPED_ROW_COUNT_MAX)break;p++}}h-=p+1,s[2]=new q(f[0],h),s[3]=new q(f[1],h)}return h-a<r.BARCODE_MIN_HEIGHT&&et.fill(s,null),s},r.findGuardPattern=function(e,t,n,a,i,o,s){et.fillWithin(s,0,s.length,0);for(var l=t,c=0;e.get(l,n)&&l>0&&c++<r.MAX_PIXEL_DRIFT;)l--;for(var d=l,f=0,h=o.length,p=i;d<a;d++){var g=e.get(d,n);if(g!==p)s[f]++;else{if(f===h-1){if(r.patternMatchVariance(s,o,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE)return new Int32Array([l,d]);l+=s[0]+s[1],Oe.arraycopy(s,2,s,0,f-1),s[f-1]=0,s[f]=0,f--}else f++;s[f]=1,p=!p}}return f===h-1&&r.patternMatchVariance(s,o,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE?new Int32Array([l,d-1]):null},r.patternMatchVariance=function(e,t,n){for(var a=e.length,i=0,o=0,s=0;s<a;s++)i+=e[s],o+=t[s];if(i<o)return 1/0;var l=i/o;n*=l;for(var c=0,d=0;d<a;d++){var f=e[d],h=t[d]*l,p=f>h?f-h:h-f;if(p>n)return 1/0;c+=p}return c/i},r.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),r.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),r.MAX_AVG_VARIANCE=.42,r.MAX_INDIVIDUAL_VARIANCE=.8,r.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),r.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),r.MAX_PIXEL_DRIFT=3,r.MAX_PATTERN_DRIFT=5,r.SKIPPED_ROW_COUNT_MAX=25,r.ROW_STEP=5,r.BARCODE_MIN_HEIGHT=10,r}(),j1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Lr=function(){function r(e,t){if(t.length===0)throw new re;this.field=e;var n=t.length;if(n>1&&t[0]===0){for(var a=1;a<n&&t[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),Oe.arraycopy(t,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){var t,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var i=j1(this.coefficients),o=i.next();!o.done;o=i.next()){var s=o.value;a=this.field.add(a,s)}}catch(f){t={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}for(var l=this.coefficients[0],c=this.coefficients.length,d=1;d<c;d++)l=this.field.add(this.field.multiply(e,l),this.coefficients[d]);return l},r.prototype.add=function(e){if(!this.field.equals(e.field))throw new re("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var a=t;t=n,n=a}var i=new Int32Array(n.length),o=n.length-t.length;Oe.arraycopy(n,0,i,0,o);for(var s=o;s<n.length;s++)i[s]=this.field.add(t[s-o],n[s]);return new r(this.field,i)},r.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new re("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},r.prototype.multiply=function(e){return e instanceof r?this.multiplyOther(e):this.multiplyScalar(e)},r.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new re("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new r(this.field,new Int32Array([0]));for(var t=this.coefficients,n=t.length,a=e.coefficients,i=a.length,o=new Int32Array(n+i-1),s=0;s<n;s++)for(var l=t[s],c=0;c<i;c++)o[s+c]=this.field.add(o[s+c],this.field.multiply(l,a[c]));return new r(this.field,o)},r.prototype.negative=function(){for(var e=this.coefficients.length,t=new Int32Array(e),n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new r(this.field,t)},r.prototype.multiplyScalar=function(e){if(e===0)return new r(this.field,new Int32Array([0]));if(e===1)return this;for(var t=this.coefficients.length,n=new Int32Array(t),a=0;a<t;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new r(this.field,n)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new re;if(t===0)return new r(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),i=0;i<n;i++)a[i]=this.field.multiply(this.coefficients[i],t);return new r(this.field,a)},r.prototype.toString=function(){for(var e=new de,t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()},r}(),U1=function(){function r(){}return r.prototype.add=function(e,t){return(e+t)%this.modulus},r.prototype.subtract=function(e,t){return(this.modulus+e-t)%this.modulus},r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new re;return this.logTable[e]},r.prototype.inverse=function(e){if(e===0)throw new ku;return this.expTable[this.modulus-this.logTable[e]-1]},r.prototype.multiply=function(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]},r.prototype.getSize=function(){return this.modulus},r.prototype.equals=function(e){return e===this},r}(),$1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),H1=function(r){$1(e,r);function e(t,n){var a=r.call(this)||this;a.modulus=t,a.expTable=new Int32Array(t),a.logTable=new Int32Array(t);for(var i=1,o=0;o<t;o++)a.expTable[o]=i,i=i*n%t;for(var o=0;o<t-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new Lr(a,new Int32Array([0])),a.one=new Lr(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,n){if(t<0)throw new re;if(n===0)return this.zero;var a=new Int32Array(t+1);return a[0]=n,new Lr(this,a)},e.PDF417_GF=new e(ye.NUMBER_OF_CODEWORDS,3),e}(U1),G1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},z1=function(){function r(){this.field=H1.PDF417_GF}return r.prototype.decode=function(e,t,n){for(var a,i,o=new Lr(this.field,e),s=new Int32Array(t),l=!1,c=t;c>0;c--){var d=o.evaluateAt(this.field.exp(c));s[t-c]=d,d!==0&&(l=!0)}if(!l)return 0;var f=this.field.getOne();if(n!=null)try{for(var h=G1(n),p=h.next();!p.done;p=h.next()){var g=p.value,y=this.field.exp(e.length-1-g),x=new Lr(this.field,new Int32Array([this.field.subtract(0,y),1]));f=f.multiply(x)}}catch(R){a={error:R}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}for(var v=new Lr(this.field,s),b=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),v,t),_=b[0],w=b[1],A=this.findErrorLocations(_),C=this.findErrorMagnitudes(w,_,A),c=0;c<A.length;c++){var I=e.length-1-this.field.log(A[c]);if(I<0)throw Ye.getChecksumInstance();e[I]=this.field.subtract(e[I],C[c])}return A.length},r.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var a=e;e=t,t=a}for(var i=e,o=t,s=this.field.getZero(),l=this.field.getOne();o.getDegree()>=Math.round(n/2);){var c=i,d=s;if(i=o,s=l,i.isZero())throw Ye.getChecksumInstance();o=c;for(var f=this.field.getZero(),h=i.getCoefficient(i.getDegree()),p=this.field.inverse(h);o.getDegree()>=i.getDegree()&&!o.isZero();){var g=o.getDegree()-i.getDegree(),y=this.field.multiply(o.getCoefficient(o.getDegree()),p);f=f.add(this.field.buildMonomial(g,y)),o=o.subtract(i.multiplyByMonomial(g,y))}l=f.multiply(s).subtract(d).negative()}var x=l.getCoefficient(0);if(x===0)throw Ye.getChecksumInstance();var v=this.field.inverse(x),b=l.multiply(v),_=o.multiply(v);return[b,_]},r.prototype.findErrorLocations=function(e){for(var t=e.getDegree(),n=new Int32Array(t),a=0,i=1;i<this.field.getSize()&&a<t;i++)e.evaluateAt(i)===0&&(n[a]=this.field.inverse(i),a++);if(a!==t)throw Ye.getChecksumInstance();return n},r.prototype.findErrorMagnitudes=function(e,t,n){for(var a=t.getDegree(),i=new Int32Array(a),o=1;o<=a;o++)i[a-o]=this.field.multiply(o,t.getCoefficient(o));for(var s=new Lr(this.field,i),l=n.length,c=new Int32Array(l),o=0;o<l;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),h=this.field.inverse(s.evaluateAt(d));c[o]=this.field.multiply(f,h)}return c},r}(),Ki=function(){function r(e,t,n,a,i){e instanceof r?this.constructor_2(e):this.constructor_1(e,t,n,a,i)}return r.prototype.constructor_1=function(e,t,n,a,i){var o=t==null||n==null,s=a==null||i==null;if(o&&s)throw new k;o?(t=new q(0,a.getY()),n=new q(0,i.getY())):s&&(a=new q(e.getWidth()-1,t.getY()),i=new q(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=a,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))},r.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},r.merge=function(e,t){return e==null?t:t==null?e:new r(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)},r.prototype.addMissingRows=function(e,t,n){var a=this.topLeft,i=this.bottomLeft,o=this.topRight,s=this.bottomRight;if(e>0){var l=n?this.topLeft:this.topRight,c=Math.trunc(l.getY()-e);c<0&&(c=0);var d=new q(l.getX(),c);n?a=d:o=d}if(t>0){var f=n?this.bottomLeft:this.bottomRight,h=Math.trunc(f.getY()+t);h>=this.image.getHeight()&&(h=this.image.getHeight()-1);var p=new q(f.getX(),h);n?i=p:s=p}return new r(this.image,a,i,o,s)},r.prototype.getMinX=function(){return this.minX},r.prototype.getMaxX=function(){return this.maxX},r.prototype.getMinY=function(){return this.minY},r.prototype.getMaxY=function(){return this.maxY},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getBottomRight=function(){return this.bottomRight},r}(),W1=function(){function r(e,t,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}return r.prototype.getColumnCount=function(){return this.columnCount},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getRowCount=function(){return this.rowCount},r.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},r.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},r}(),Mo=function(){function r(){this.buffer=""}return r.form=function(e,t){var n=-1;function a(o,s,l,c,d,f){if(o==="%%")return"%";if(t[++n]!==void 0){o=c?parseInt(c.substr(1)):void 0;var h=d?parseInt(d.substr(1)):void 0,p;switch(f){case"s":p=t[n];break;case"c":p=t[n][0];break;case"f":p=parseFloat(t[n]).toFixed(o);break;case"p":p=parseFloat(t[n]).toPrecision(o);break;case"e":p=parseFloat(t[n]).toExponential(o);break;case"x":p=parseInt(t[n]).toString(h||16);break;case"d":p=parseFloat(parseInt(t[n],h||10).toPrecision(o)).toFixed(0);break}p=typeof p=="object"?JSON.stringify(p):(+p).toString(h);for(var g=parseInt(l),y=l&&l[0]+""=="0"?"0":" ";p.length<g;)p=s!==void 0?p+y:y+p;return p}}var i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,a)},r.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.buffer+=r.form(e,t)},r.prototype.toString=function(){return this.buffer},r}(),X1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Gu=function(){function r(e){this.boundingBox=new Ki(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return r.prototype.getCodewordNearby=function(e){var t=this.getCodeword(e);if(t!=null)return t;for(var n=1;n<r.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(t=this.codewords[a],t!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(t=this.codewords[a],t!=null)))return t}return null},r.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},r.prototype.setCodeword=function(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t},r.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.getCodewords=function(){return this.codewords},r.prototype.toString=function(){var e,t,n=new Mo,a=0;try{for(var i=X1(this.codewords),o=i.next();!o.done;o=i.next()){var s=o.value;if(s==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,s.getRowNumber(),s.getValue())}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n.toString()},r.MAX_NEARBY_DISTANCE=5,r}(),q1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y1=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i},In=function(){function r(){this.values=new Map}return r.prototype.setValue=function(e){e=Math.trunc(e);var t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)},r.prototype.getValue=function(){var e,t,n=-1,a=new Array,i=function(f,h){var p={getKey:function(){return f},getValue:function(){return h}};p.getValue()>n?(n=p.getValue(),a=[],a.push(p.getKey())):p.getValue()===n&&a.push(p.getKey())};try{for(var o=q1(this.values.entries()),s=o.next();!s.done;s=o.next()){var l=Y1(s.value,2),c=l[0],d=l[1];i(c,d)}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return ye.toIntArray(a)},r.prototype.getConfidence=function(e){return this.values.get(e)},r}(),K1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ci=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tl=function(r){K1(e,r);function e(t,n){var a=r.call(this,t)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var t,n;try{for(var a=ci(this.getCodewords()),i=a.next();!i.done;i=a.next()){var o=i.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(t){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,t);for(var a=this.getBoundingBox(),i=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),l=this.imageRowToCodewordIndex(Math.trunc(o.getY())),c=-1,d=1,f=0,h=s;h<l;h++)if(n[h]!=null){var p=n[h],g=p.getRowNumber()-c;if(g===0)f++;else if(g===1)d=Math.max(d,f),f=1,c=p.getRowNumber();else if(g<0||p.getRowNumber()>=t.getRowCount()||g>h)n[h]=null;else{var y=void 0;d>2?y=(d-2)*g:y=g;for(var x=y>=h,v=1;v<=y&&!x;v++)x=n[h-v]!=null;x?n[h]=null:(c=p.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var t,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var i=new Int32Array(a.getRowCount());try{for(var o=ci(this.getCodewords()),s=o.next();!s.done;s=o.next()){var l=s.value;if(l!=null){var c=l.getRowNumber();if(c>=i.length)continue;i[c]++}}}catch(d){t={error:d}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(t){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),l=this.getCodewords(),c=-1,d=o;d<s;d++)if(l[d]!=null){var f=l[d];f.setRowNumberAsRowIndicatorColumn();var h=f.getRowNumber()-c;h===0||(h===1?c=f.getRowNumber():f.getRowNumber()>=t.getRowCount()?l[d]=null:c=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var t,n,a=this.getCodewords(),i=new In,o=new In,s=new In,l=new In;try{for(var c=ci(a),d=c.next();!d.done;d=c.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var h=f.getValue()%30,p=f.getRowNumber();switch(this._isLeft||(p+=2),p%3){case 0:o.setValue(h*3+1);break;case 1:l.setValue(h/3),s.setValue(h%3);break;case 2:i.setValue(h+1);break}}}}catch(y){t={error:y}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}if(i.getValue().length===0||o.getValue().length===0||s.getValue().length===0||l.getValue().length===0||i.getValue()[0]<1||o.getValue()[0]+s.getValue()[0]<ye.MIN_ROWS_IN_BARCODE||o.getValue()[0]+s.getValue()[0]>ye.MAX_ROWS_IN_BARCODE)return null;var g=new W1(i.getValue()[0],o.getValue()[0],s.getValue()[0],l.getValue()[0]);return this.removeIncorrectCodewords(a,g),g},e.prototype.removeIncorrectCodewords=function(t,n){for(var a=0;a<t.length;a++){var i=t[a];if(t[a]!=null){var o=i.getValue()%30,s=i.getRowNumber();if(s>n.getRowCount()){t[a]=null;continue}switch(this._isLeft||(s+=2),s%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(t[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(t[a]=null);break;case 2:o+1!==n.getColumnCount()&&(t[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+r.prototype.toString.call(this)},e}(Gu),Z1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q1=function(){function r(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return r.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=ye.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns},r.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},r.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var t=1;t<this.barcodeColumnCount+1;t++)for(var n=this.detectionResultColumns[t].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(t,a,n));return e},r.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},r.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var i=this.detectionResultColumns[a].getCodewords()[n];i!=null&&(i.setRowNumber(e[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},r.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null)for(var a=t[n].getRowNumber(),i=0,o=this.barcodeColumnCount+1;o>0&&i<this.ADJUST_ROW_NUMBER_SKIP;o--){var s=this.detectionResultColumns[o].getCodewords()[n];s!=null&&(i=r.adjustRowNumberIfValid(a,i,s),s.hasValidRowNumber()||e++)}return e},r.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,t=this.detectionResultColumns[0].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null)for(var a=t[n].getRowNumber(),i=0,o=1;o<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;o++){var s=this.detectionResultColumns[o].getCodewords()[n];s!=null&&(i=r.adjustRowNumberIfValid(a,i,s),s.hasValidRowNumber()||e++)}return e},r.adjustRowNumberIfValid=function(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t},r.prototype.adjustRowNumbers=function(e,t,n){var a,i;if(this.detectionResultColumns[e-1]!=null){var o=n[t],s=this.detectionResultColumns[e-1].getCodewords(),l=s;this.detectionResultColumns[e+1]!=null&&(l=this.detectionResultColumns[e+1].getCodewords());var c=new Array(14);c[2]=s[t],c[3]=l[t],t>0&&(c[0]=n[t-1],c[4]=s[t-1],c[5]=l[t-1]),t>1&&(c[8]=n[t-2],c[10]=s[t-2],c[11]=l[t-2]),t<n.length-1&&(c[1]=n[t+1],c[6]=s[t+1],c[7]=l[t+1]),t<n.length-2&&(c[9]=n[t+2],c[12]=s[t+2],c[13]=l[t+2]);try{for(var d=Z1(c),f=d.next();!f.done;f=d.next()){var h=f.value;if(r.adjustRowNumber(o,h))return}}catch(p){a={error:p}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}},r.adjustRowNumber=function(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1},r.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},r.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},r.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},r.prototype.setBoundingBox=function(e){this.boundingBox=e},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.setDetectionResultColumn=function(e,t){this.detectionResultColumns[e]=t},r.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},r.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var t=new Mo,n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){t.format("    |   ");continue}var i=this.detectionResultColumns[a].getCodewords()[n];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()},r}(),J1=function(){function r(e,t,n,a){this.rowNumber=r.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return r.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},r.prototype.isValidRowNumber=function(e){return e!==r.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},r.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},r.prototype.getWidth=function(){return this.endX-this.startX},r.prototype.getStartX=function(){return this.startX},r.prototype.getEndX=function(){return this.endX},r.prototype.getBucket=function(){return this.bucket},r.prototype.getValue=function(){return this.value},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.setRowNumber=function(e){this.rowNumber=e},r.prototype.toString=function(){return this.rowNumber+"|"+this.value},r.BARCODE_ROW_UNKNOWN=-1,r}(),em=function(){function r(){}return r.initialize=function(){for(var e=0;e<ye.SYMBOL_TABLE.length;e++)for(var t=ye.SYMBOL_TABLE[e],n=t&1,a=0;a<ye.BARS_IN_MODULE;a++){for(var i=0;(t&1)===n;)i+=1,t>>=1;n=t&1,r.RATIOS_TABLE[e]||(r.RATIOS_TABLE[e]=new Array(ye.BARS_IN_MODULE)),r.RATIOS_TABLE[e][ye.BARS_IN_MODULE-a-1]=Math.fround(i/ye.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},r.getDecodedValue=function(e){var t=r.getDecodedCodewordValue(r.sampleBitCounts(e));return t!==-1?t:r.getClosestDecodedValue(e)},r.sampleBitCounts=function(e){for(var t=we.sum(e),n=new Int32Array(ye.BARS_IN_MODULE),a=0,i=0,o=0;o<ye.MODULES_IN_CODEWORD;o++){var s=t/(2*ye.MODULES_IN_CODEWORD)+o*t/ye.MODULES_IN_CODEWORD;i+e[a]<=s&&(i+=e[a],a++),n[a]++}return n},r.getDecodedCodewordValue=function(e){var t=r.getBitValue(e);return ye.getCodeword(t)===-1?-1:t},r.getBitValue=function(e){for(var t=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)},r.getClosestDecodedValue=function(e){var t=we.sum(e),n=new Array(ye.BARS_IN_MODULE);if(t>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/t);var i=Xi.MAX_VALUE,o=-1;this.bSymbolTableReady||r.initialize();for(var s=0;s<r.RATIOS_TABLE.length;s++){for(var l=0,c=r.RATIOS_TABLE[s],d=0;d<ye.BARS_IN_MODULE;d++){var f=Math.fround(c[d]-n[d]);if(l+=Math.fround(f*f),l>=i)break}l<i&&(i=l,o=ye.SYMBOL_TABLE[s])}return o},r.bSymbolTableReady=!1,r.RATIOS_TABLE=new Array(ye.SYMBOL_TABLE.length).map(function(e){return new Array(ye.BARS_IN_MODULE)}),r}(),tm=function(){function r(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return r.prototype.getSegmentIndex=function(){return this.segmentIndex},r.prototype.setSegmentIndex=function(e){this.segmentIndex=e},r.prototype.getFileId=function(){return this.fileId},r.prototype.setFileId=function(e){this.fileId=e},r.prototype.getOptionalData=function(){return this.optionalData},r.prototype.setOptionalData=function(e){this.optionalData=e},r.prototype.isLastSegment=function(){return this.lastSegment},r.prototype.setLastSegment=function(e){this.lastSegment=e},r.prototype.getSegmentCount=function(){return this.segmentCount},r.prototype.setSegmentCount=function(e){this.segmentCount=e},r.prototype.getSender=function(){return this.sender||null},r.prototype.setSender=function(e){this.sender=e},r.prototype.getAddressee=function(){return this.addressee||null},r.prototype.setAddressee=function(e){this.addressee=e},r.prototype.getFileName=function(){return this.fileName},r.prototype.setFileName=function(e){this.fileName=e},r.prototype.getFileSize=function(){return this.fileSize},r.prototype.setFileSize=function(e){this.fileSize=e},r.prototype.getChecksum=function(){return this.checksum},r.prototype.setChecksum=function(e){this.checksum=e},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.setTimestamp=function(e){this.timestamp=e},r}(),rl=function(){function r(){}return r.parseLong=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r}(),rm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),nm=function(r){rm(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="NullPointerException",e}(It),am=function(){function r(){}return r.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},r.prototype.writeBytesOffset=function(e,t,n){if(e==null)throw new nm;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new Ro;if(n===0)return;for(var a=0;a<n;a++)this.write(e[t+a])},r.prototype.flush=function(){},r.prototype.close=function(){},r}(),im=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),om=function(r){im(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(It),sm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lm=function(r){sm(e,r);function e(t){t===void 0&&(t=32);var n=r.call(this)||this;if(n.count=0,t<0)throw new re("Negative initial size: "+t);return n.buf=new Uint8Array(t),n}return e.prototype.ensureCapacity=function(t){t-this.buf.length>0&&this.grow(t)},e.prototype.grow=function(t){var n=this.buf.length,a=n<<1;if(a-t<0&&(a=t),a<0){if(t<0)throw new om;a=he.MAX_VALUE}this.buf=et.copyOfUint8Array(this.buf,a)},e.prototype.write=function(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1},e.prototype.writeBytesOffset=function(t,n,a){if(n<0||n>t.length||a<0||n+a-t.length>0)throw new Ro;this.ensureCapacity(this.count+a),Oe.arraycopy(t,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(t){t.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return et.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(t){return new String(this.buf).toString()},e.prototype.toString_number=function(t){return new String(this.buf).toString()},e.prototype.close=function(){},e}(am),Te;(function(r){r[r.ALPHA=0]="ALPHA",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.PUNCT=3]="PUNCT",r[r.ALPHA_SHIFT=4]="ALPHA_SHIFT",r[r.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Te||(Te={}));function zu(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var la;function mr(r){if(typeof la>"u"&&(la=zu()),la===null)throw new Error("BigInt is not supported!");return la(r)}function cm(){var r=[];r[0]=mr(1);var e=mr(900);r[1]=e;for(var t=2;t<16;t++)r[t]=r[t-1]*e;return r}var um=function(){function r(){}return r.decode=function(e,t){var n=new de(""),a=Je.ISO8859_1;n.enableDecoding(a);for(var i=1,o=e[i++],s=new tm;i<e[0];){switch(o){case r.TEXT_COMPACTION_MODE_LATCH:i=r.textCompaction(e,i,n);break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:i=r.byteCompaction(o,e,a,i,n);break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[i++]);break;case r.NUMERIC_COMPACTION_MODE_LATCH:i=r.numericCompaction(e,i,n);break;case r.ECI_CHARSET:Je.getCharacterSetECIByValue(e[i++]);break;case r.ECI_GENERAL_PURPOSE:i+=2;break;case r.ECI_USER_DEFINED:i++;break;case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=r.decodeMacroBlock(e,i,s);break;case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:throw new $;default:i--,i=r.textCompaction(e,i,n);break}if(i<e.length)o=e[i++];else throw $.getFormatInstance()}if(n.length()===0)throw $.getFormatInstance();var l=new Ga(null,n.toString(),null,t);return l.setOther(s),l},r.decodeMacroBlock=function(e,t,n){if(t+r.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw $.getFormatInstance();for(var a=new Int32Array(r.NUMBER_OF_SEQUENCE_CODEWORDS),i=0;i<r.NUMBER_OF_SEQUENCE_CODEWORDS;i++,t++)a[i]=e[t];n.setSegmentIndex(he.parseInt(r.decodeBase900toBase10(a,r.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new de;t=r.textCompaction(e,t,o),n.setFileId(o.toString());var s=-1;for(e[t]===r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=t+1);t<e[0];)switch(e[t]){case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var l=new de;t=r.textCompaction(e,t+1,l),n.setFileName(l.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var c=new de;t=r.textCompaction(e,t+1,c),n.setSender(c.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new de;t=r.textCompaction(e,t+1,d),n.setAddressee(d.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new de;t=r.numericCompaction(e,t+1,f),n.setSegmentCount(he.parseInt(f.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var h=new de;t=r.numericCompaction(e,t+1,h),n.setTimestamp(rl.parseLong(h.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var p=new de;t=r.numericCompaction(e,t+1,p),n.setChecksum(he.parseInt(p.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var g=new de;t=r.numericCompaction(e,t+1,g),n.setFileSize(rl.parseLong(g.toString()));break;default:throw $.getFormatInstance()}break;case r.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw $.getFormatInstance()}if(s!==-1){var y=t-s;n.isLastSegment()&&y--,n.setOptionalData(et.copyOfRange(e,s,s+y))}return t},r.textCompaction=function(e,t,n){for(var a=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),o=0,s=!1;t<e[0]&&!s;){var l=e[t++];if(l<r.TEXT_COMPACTION_MODE_LATCH)a[o]=l/30,a[o+1]=l%30,o+=2;else switch(l){case r.TEXT_COMPACTION_MODE_LATCH:a[o++]=r.TEXT_COMPACTION_MODE_LATCH;break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,s=!0;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,l=e[t++],i[o]=l,o++;break}}return r.decodeTextCompaction(a,i,o,n),t},r.decodeTextCompaction=function(e,t,n,a){for(var i=Te.ALPHA,o=Te.ALPHA,s=0;s<n;){var l=e[s],c="";switch(i){case Te.ALPHA:if(l<26)c=String.fromCharCode(65+l);else switch(l){case 26:c=" ";break;case r.LL:i=Te.LOWER;break;case r.ML:i=Te.MIXED;break;case r.PS:o=i,i=Te.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=Te.ALPHA;break}break;case Te.LOWER:if(l<26)c=String.fromCharCode(97+l);else switch(l){case 26:c=" ";break;case r.AS:o=i,i=Te.ALPHA_SHIFT;break;case r.ML:i=Te.MIXED;break;case r.PS:o=i,i=Te.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=Te.ALPHA;break}break;case Te.MIXED:if(l<r.PL)c=r.MIXED_CHARS[l];else switch(l){case r.PL:i=Te.PUNCT;break;case 26:c=" ";break;case r.LL:i=Te.LOWER;break;case r.AL:i=Te.ALPHA;break;case r.PS:o=i,i=Te.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=Te.ALPHA;break}break;case Te.PUNCT:if(l<r.PAL)c=r.PUNCT_CHARS[l];else switch(l){case r.PAL:i=Te.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=Te.ALPHA;break}break;case Te.ALPHA_SHIFT:if(i=o,l<26)c=String.fromCharCode(65+l);else switch(l){case 26:c=" ";break;case r.TEXT_COMPACTION_MODE_LATCH:i=Te.ALPHA;break}break;case Te.PUNCT_SHIFT:if(i=o,l<r.PAL)c=r.PUNCT_CHARS[l];else switch(l){case r.PAL:i=Te.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=Te.ALPHA;break}break}c!==""&&a.append(c),s++}},r.byteCompaction=function(e,t,n,a,i){var o=new lm,s=0,l=0,c=!1;switch(e){case r.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=t[a++];a<t[0]&&!c;)switch(d[s++]=f,l=900*l+f,f=t[a++],f){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:a--,c=!0;break;default:if(s%5===0&&s>0){for(var h=0;h<6;++h)o.write(Number(mr(l)>>mr(8*(5-h))));l=0,s=0}break}a===t[0]&&f<r.TEXT_COMPACTION_MODE_LATCH&&(d[s++]=f);for(var p=0;p<s;p++)o.write(d[p]);break;case r.BYTE_COMPACTION_MODE_LATCH_6:for(;a<t[0]&&!c;){var g=t[a++];if(g<r.TEXT_COMPACTION_MODE_LATCH)s++,l=900*l+g;else switch(g){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:a--,c=!0;break}if(s%5===0&&s>0){for(var h=0;h<6;++h)o.write(Number(mr(l)>>mr(8*(5-h))));l=0,s=0}}break}return i.append(Vt.decode(o.toByteArray(),n)),a},r.numericCompaction=function(e,t,n){for(var a=0,i=!1,o=new Int32Array(r.MAX_NUMERIC_CODEWORDS);t<e[0]&&!i;){var s=e[t++];if(t===e[0]&&(i=!0),s<r.TEXT_COMPACTION_MODE_LATCH)o[a]=s,a++;else switch(s){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(a%r.MAX_NUMERIC_CODEWORDS===0||s===r.NUMERIC_COMPACTION_MODE_LATCH||i)&&a>0&&(n.append(r.decodeBase900toBase10(o,a)),a=0)}return t},r.decodeBase900toBase10=function(e,t){for(var n=mr(0),a=0;a<t;a++)n+=r.EXP900[t-a-1]*mr(e[a]);var i=n.toString();if(i.charAt(0)!=="1")throw new $;return i.substring(1)},r.TEXT_COMPACTION_MODE_LATCH=900,r.BYTE_COMPACTION_MODE_LATCH=901,r.NUMERIC_COMPACTION_MODE_LATCH=902,r.BYTE_COMPACTION_MODE_LATCH_6=924,r.ECI_USER_DEFINED=925,r.ECI_GENERAL_PURPOSE=926,r.ECI_CHARSET=927,r.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,r.MACRO_PDF417_TERMINATOR=922,r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,r.MAX_NUMERIC_CODEWORDS=15,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,r.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,r.PL=25,r.LL=27,r.AS=27,r.ML=28,r.AL=28,r.PS=29,r.PAL=29,r.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,r.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",r.EXP900=zu()?cm():[],r.NUMBER_OF_SEQUENCE_CODEWORDS=2,r}(),bn=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dm=function(){function r(){}return r.decode=function(e,t,n,a,i,o,s){for(var l=new Ki(e,t,n,a,i),c=null,d=null,f,h=!0;;h=!1){if(t!=null&&(c=r.getRowIndicatorColumn(e,l,t,!0,o,s)),a!=null&&(d=r.getRowIndicatorColumn(e,l,a,!1,o,s)),f=r.merge(c,d),f==null)throw k.getNotFoundInstance();var p=f.getBoundingBox();if(h&&p!=null&&(p.getMinY()<l.getMinY()||p.getMaxY()>l.getMaxY()))l=p;else break}f.setBoundingBox(l);var g=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,c),f.setDetectionResultColumn(g,d);for(var y=c!=null,x=1;x<=g;x++){var v=y?x:g-x;if(f.getDetectionResultColumn(v)===void 0){var b=void 0;v===0||v===g?b=new tl(l,v===0):b=new Gu(l),f.setDetectionResultColumn(v,b);for(var _=-1,w=_,A=l.getMinY();A<=l.getMaxY();A++){if(_=r.getStartColumn(f,v,A,y),_<0||_>l.getMaxX()){if(w===-1)continue;_=w}var C=r.detectCodeword(e,l.getMinX(),l.getMaxX(),y,_,A,o,s);C!=null&&(b.setCodeword(A,C),w=_,o=Math.min(o,C.getWidth()),s=Math.max(s,C.getWidth()))}}}return r.createDecoderResult(f)},r.merge=function(e,t){if(e==null&&t==null)return null;var n=r.getBarcodeMetadata(e,t);if(n==null)return null;var a=Ki.merge(r.adjustBoundingBox(e),r.adjustBoundingBox(t));return new Q1(n,a)},r.adjustBoundingBox=function(e){var t,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var i=r.getMax(a),o=0;try{for(var s=bn(a),l=s.next();!l.done;l=s.next()){var c=l.value;if(o+=i-c,c>0)break}}catch(p){t={error:p}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var h=0,f=a.length-1;f>=0&&(h+=i-a[f],!(a[f]>0));f--);for(var f=d.length-1;h>0&&d[f]==null;f--)h--;return e.getBoundingBox().addMissingRows(o,h,e.isLeft())},r.getMax=function(e){var t,n,a=-1;try{for(var i=bn(e),o=i.next();!o.done;o=i.next()){var s=o.value;a=Math.max(a,s)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a},r.getBarcodeMetadata=function(e,t){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();var a;return t==null||(a=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},r.getRowIndicatorColumn=function(e,t,n,a,i,o){for(var s=new tl(t,a),l=0;l<2;l++)for(var c=l===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=t.getMaxY()&&f>=t.getMinY();f+=c){var h=r.detectCodeword(e,0,e.getWidth(),a,d,f,i,o);h!=null&&(s.setCodeword(f,h),a?d=h.getStartX():d=h.getEndX())}return s},r.adjustCodewordCount=function(e,t){var n=t[0][1],a=n.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-r.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(i<1||i>ye.MAX_CODEWORDS_IN_BARCODE)throw k.getNotFoundInstance();n.setValue(i)}else a[0]!==i&&n.setValue(i)},r.createDecoderResult=function(e){var t=r.createBarcodeMatrix(e);r.adjustCodewordCount(e,t);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],o=new Array,s=0;s<e.getBarcodeRowCount();s++)for(var l=0;l<e.getBarcodeColumnCount();l++){var c=t[s][l+1].getValue(),d=s*e.getBarcodeColumnCount()+l;c.length===0?n.push(d):c.length===1?a[d]=c[0]:(o.push(d),i.push(c))}for(var f=new Array(i.length),h=0;h<f.length;h++)f[h]=i[h];return r.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,ye.toIntArray(n),ye.toIntArray(o),f)},r.createDecoderResultFromAmbiguousValues=function(e,t,n,a,i){for(var o=new Int32Array(a.length),s=100;s-- >0;){for(var l=0;l<o.length;l++)t[a[l]]=i[l][o[l]];try{return r.decodeCodewords(t,e,n)}catch(d){var c=d instanceof Ye;if(!c)throw d}if(o.length===0)throw Ye.getChecksumInstance();for(var l=0;l<o.length;l++)if(o[l]<i[l].length-1){o[l]++;break}else if(o[l]=0,l===o.length-1)throw Ye.getChecksumInstance()}throw Ye.getChecksumInstance()},r.createBarcodeMatrix=function(e){for(var t,n,a,i,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),s=0;s<o.length;s++)for(var l=0;l<o[s].length;l++)o[s][l]=new In;var c=0;try{for(var d=bn(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var h=f.value;if(h!=null)try{for(var p=(a=void 0,bn(h.getCodewords())),g=p.next();!g.done;g=p.next()){var y=g.value;if(y!=null){var x=y.getRowNumber();if(x>=0){if(x>=o.length)continue;o[x][c].setValue(y.getValue())}}}}catch(v){a={error:v}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}}c++}}catch(v){t={error:v}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return o},r.isValidBarcodeColumn=function(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1},r.getStartColumn=function(e,t,n,a){var i,o,s=a?1:-1,l=null;if(r.isValidBarcodeColumn(e,t-s)&&(l=e.getDetectionResultColumn(t-s).getCodeword(n)),l!=null)return a?l.getEndX():l.getStartX();if(l=e.getDetectionResultColumn(t).getCodewordNearby(n),l!=null)return a?l.getStartX():l.getEndX();if(r.isValidBarcodeColumn(e,t-s)&&(l=e.getDetectionResultColumn(t-s).getCodewordNearby(n)),l!=null)return a?l.getEndX():l.getStartX();for(var c=0;r.isValidBarcodeColumn(e,t-s);){t-=s;try{for(var d=(i=void 0,bn(e.getDetectionResultColumn(t).getCodewords())),f=d.next();!f.done;f=d.next()){var h=f.value;if(h!=null)return(a?h.getEndX():h.getStartX())+s*c*(h.getEndX()-h.getStartX())}}catch(p){i={error:p}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}c++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},r.detectCodeword=function(e,t,n,a,i,o,s,l){i=r.adjustCodewordStartColumn(e,t,n,a,i,o);var c=r.getModuleBitCount(e,t,n,a,i,o);if(c==null)return null;var d,f=we.sum(c);if(a)d=i+f;else{for(var h=0;h<c.length/2;h++){var p=c[h];c[h]=c[c.length-1-h],c[c.length-1-h]=p}d=i,i=d-f}if(!r.checkCodewordSkew(f,s,l))return null;var g=em.getDecodedValue(c),y=ye.getCodeword(g);return y===-1?null:new J1(i,d,r.getCodewordBucketNumber(g),y)},r.getModuleBitCount=function(e,t,n,a,i,o){for(var s=i,l=new Int32Array(8),c=0,d=a?1:-1,f=a;(a?s<n:s>=t)&&c<l.length;)e.get(s,o)===f?(l[c]++,s+=d):(c++,f=!f);return c===l.length||s===(a?n:t)&&c===l.length-1?l:null},r.getNumberOfECCodeWords=function(e){return 2<<e},r.adjustCodewordStartColumn=function(e,t,n,a,i,o){for(var s=i,l=a?-1:1,c=0;c<2;c++){for(;(a?s>=t:s<n)&&a===e.get(s,o);){if(Math.abs(i-s)>r.CODEWORD_SKEW_SIZE)return i;s+=l}l=-l,a=!a}return s},r.checkCodewordSkew=function(e,t,n){return t-r.CODEWORD_SKEW_SIZE<=e&&e<=n+r.CODEWORD_SKEW_SIZE},r.decodeCodewords=function(e,t,n){if(e.length===0)throw $.getFormatInstance();var a=1<<t+1,i=r.correctErrors(e,n,a);r.verifyCodewordCount(e,a);var o=um.decode(e,""+t);return o.setErrorsCorrected(i),o.setErasures(n.length),o},r.correctErrors=function(e,t,n){if(t!=null&&t.length>n/2+r.MAX_ERRORS||n<0||n>r.MAX_EC_CODEWORDS)throw Ye.getChecksumInstance();return r.errorCorrection.decode(e,n,t)},r.verifyCodewordCount=function(e,t){if(e.length<4)throw $.getFormatInstance();var n=e[0];if(n>e.length)throw $.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw $.getFormatInstance()},r.getBitCountForCodeword=function(e){for(var t=new Int32Array(8),n=0,a=t.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)t[a]++,e>>=1;return t},r.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},r.getCodewordBucketNumber_number=function(e){return r.getCodewordBucketNumber(r.getBitCountForCodeword(e))},r.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},r.toString=function(e){for(var t=new Mo,n=0;n<e.length;n++){t.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var i=e[n][a];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()},r.CODEWORD_SKEW_SIZE=2,r.MAX_ERRORS=3,r.MAX_EC_CODEWORDS=512,r.errorCorrection=new z1,r}(),fm=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ra=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n=r.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw k.getNotFoundInstance();return n[0]},r.prototype.decodeMultiple=function(e,t){t===void 0&&(t=null);try{return r.decode(e,t,!0)}catch(n){throw n instanceof $||n instanceof Ye?k.getNotFoundInstance():n}},r.decode=function(e,t,n){var a,i,o=new Array,s=V1.detectMultiple(e,t,n);try{for(var l=fm(s.getPoints()),c=l.next();!c.done;c=l.next()){var d=c.value,f=dm.decode(s.getBits(),d[4],d[5],d[6],d[7],r.getMinCodewordWidth(d),r.getMaxCodewordWidth(d)),h=new gt(f.getText(),f.getRawBytes(),void 0,d,te.PDF_417);h.putMetadata(dt.ERROR_CORRECTION_LEVEL,f.getECLevel());var p=f.getOther();p!=null&&h.putMetadata(dt.PDF417_EXTRA_METADATA,p),o.push(h)}}catch(g){a={error:g}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}return o.map(function(g){return g})},r.getMaxWidth=function(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMinWidth=function(e,t){return e==null||t==null?he.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(r.getMaxWidth(e[0],e[4]),r.getMaxWidth(e[6],e[2])*ye.MODULES_IN_CODEWORD/ye.MODULES_IN_STOP_PATTERN),Math.max(r.getMaxWidth(e[1],e[5]),r.getMaxWidth(e[7],e[3])*ye.MODULES_IN_CODEWORD/ye.MODULES_IN_STOP_PATTERN)))},r.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(r.getMinWidth(e[0],e[4]),r.getMinWidth(e[6],e[2])*ye.MODULES_IN_CODEWORD/ye.MODULES_IN_STOP_PATTERN),Math.min(r.getMinWidth(e[1],e[5]),r.getMinWidth(e[7],e[3])*ye.MODULES_IN_CODEWORD/ye.MODULES_IN_STOP_PATTERN)))},r.prototype.reset=function(){},r}(),hm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),nl=function(r){hm(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReaderException",e}(It),al=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Wu=function(){function r(){}return r.prototype.decode=function(e,t){return this.setHints(t),this.decodeInternal(e)},r.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},r.prototype.setHints=function(e){this.hints=e;var t=e!=null&&e.get(De.TRY_HARDER)!==void 0,n=e==null?null:e.get(De.POSSIBLE_FORMATS),a=new Array;if(n!=null){var i=n.some(function(o){return o===te.UPC_A||o===te.UPC_E||o===te.EAN_13||o===te.EAN_8||o===te.CODABAR||o===te.CODE_39||o===te.CODE_93||o===te.CODE_128||o===te.ITF||o===te.RSS_14||o===te.RSS_EXPANDED});i&&!t&&a.push(new Kr(e)),n.includes(te.QR_CODE)&&a.push(new Ta),n.includes(te.DATA_MATRIX)&&a.push(new Ia),n.includes(te.AZTEC)&&a.push(new Na),n.includes(te.PDF_417)&&a.push(new Ra),i&&t&&a.push(new Kr(e))}a.length===0&&(t||a.push(new Kr(e)),a.push(new Ta),a.push(new Ia),a.push(new Na),a.push(new Ra),t&&a.push(new Kr(e))),this.readers=a},r.prototype.reset=function(){var e,t;if(this.readers!==null)try{for(var n=al(this.readers),a=n.next();!a.done;a=n.next()){var i=a.value;i.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},r.prototype.decodeInternal=function(e){var t,n;if(this.readers===null)throw new nl("No readers where selected, nothing can be read.");try{for(var a=al(this.readers),i=a.next();!i.done;i=a.next()){var o=i.value;try{return o.decode(e,this.hints)}catch(s){if(s instanceof nl)continue}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}throw new k("No MultiFormat Readers were able to detect the code.")},r}(),pm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){pm(e,r);function e(t,n){t===void 0&&(t=null),n===void 0&&(n=500);var a=this,i=new Wu;return i.setHints(t),a=r.call(this,i,n)||this,a}return e.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)},e})(fn);var mm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){mm(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Ra,t)||this}return e})(fn);var gm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){gm(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Ta,t)||this}return e})(fn);var Zi;(function(r){r[r.ERROR_CORRECTION=0]="ERROR_CORRECTION",r[r.CHARACTER_SET=1]="CHARACTER_SET",r[r.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",r[r.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",r[r.MIN_SIZE=4]="MIN_SIZE",r[r.MAX_SIZE=5]="MAX_SIZE",r[r.MARGIN=6]="MARGIN",r[r.PDF417_COMPACT=7]="PDF417_COMPACT",r[r.PDF417_COMPACTION=8]="PDF417_COMPACTION",r[r.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",r[r.AZTEC_LAYERS=10]="AZTEC_LAYERS",r[r.QR_VERSION=11]="QR_VERSION",r[r.GS1_FORMAT=12]="GS1_FORMAT",r[r.FORCE_C40=13]="FORCE_C40"})(Zi||(Zi={}));const ca=Zi;var Xu=function(){function r(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new yr(e,Int32Array.from([1])))}return r.prototype.buildGenerator=function(e){var t=this.cachedGenerators;if(e>=t.length)for(var n=t[t.length-1],a=this.field,i=t.length;i<=e;i++){var o=n.multiply(new yr(a,Int32Array.from([1,a.exp(i-1+a.getGeneratorBase())])));t.push(o),n=o}return t[e]},r.prototype.encode=function(e,t){if(t===0)throw new re("No error correction bytes");var n=e.length-t;if(n<=0)throw new re("No data bytes provided");var a=this.buildGenerator(t),i=new Int32Array(n);Oe.arraycopy(e,0,i,0,n);var o=new yr(this.field,i);o=o.multiplyByMonomial(t,1);for(var s=o.divide(a)[1],l=s.getCoefficients(),c=t-l.length,d=0;d<c;d++)e[n+d]=0;Oe.arraycopy(l,0,e,n+c,l.length)},r}(),Tn=function(){function r(){}return r.applyMaskPenaltyRule1=function(e){return r.applyMaskPenaltyRule1Internal(e,!0)+r.applyMaskPenaltyRule1Internal(e,!1)},r.applyMaskPenaltyRule2=function(e){for(var t=0,n=e.getArray(),a=e.getWidth(),i=e.getHeight(),o=0;o<i-1;o++)for(var s=n[o],l=0;l<a-1;l++){var c=s[l];c===s[l+1]&&c===n[o+1][l]&&c===n[o+1][l+1]&&t++}return r.N2*t},r.applyMaskPenaltyRule3=function(e){for(var t=0,n=e.getArray(),a=e.getWidth(),i=e.getHeight(),o=0;o<i;o++)for(var s=0;s<a;s++){var l=n[o];s+6<a&&l[s]===1&&l[s+1]===0&&l[s+2]===1&&l[s+3]===1&&l[s+4]===1&&l[s+5]===0&&l[s+6]===1&&(r.isWhiteHorizontal(l,s-4,s)||r.isWhiteHorizontal(l,s+7,s+11))&&t++,o+6<i&&n[o][s]===1&&n[o+1][s]===0&&n[o+2][s]===1&&n[o+3][s]===1&&n[o+4][s]===1&&n[o+5][s]===0&&n[o+6][s]===1&&(r.isWhiteVertical(n,s,o-4,o)||r.isWhiteVertical(n,s,o+7,o+11))&&t++}return t*r.N3},r.isWhiteHorizontal=function(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(var a=t;a<n;a++)if(e[a]===1)return!1;return!0},r.isWhiteVertical=function(e,t,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var i=n;i<a;i++)if(e[i][t]===1)return!1;return!0},r.applyMaskPenaltyRule4=function(e){for(var t=0,n=e.getArray(),a=e.getWidth(),i=e.getHeight(),o=0;o<i;o++)for(var s=n[o],l=0;l<a;l++)s[l]===1&&t++;var c=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(t*2-c)*10/c);return d*r.N4},r.getDataMaskBit=function(e,t,n){var a,i;switch(e){case 0:a=n+t&1;break;case 1:a=n&1;break;case 2:a=t%3;break;case 3:a=(n+t)%3;break;case 4:a=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:i=n*t,a=(i&1)+i%3;break;case 6:i=n*t,a=(i&1)+i%3&1;break;case 7:i=n*t,a=i%3+(n+t&1)&1;break;default:throw new re("Invalid mask pattern: "+e)}return a===0},r.applyMaskPenaltyRule1Internal=function(e,t){for(var n=0,a=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),o=e.getArray(),s=0;s<a;s++){for(var l=0,c=-1,d=0;d<i;d++){var f=t?o[s][d]:o[d][s];f===c?l++:(l>=5&&(n+=r.N1+(l-5)),l=1,c=f)}l>=5&&(n+=r.N1+(l-5))}return n},r.N1=3,r.N2=3,r.N3=40,r.N4=10,r}(),vm=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ym=function(){function r(e,t){this.width=e,this.height=t;for(var n=new Array(t),a=0;a!==t;a++)n[a]=new Uint8Array(e);this.bytes=n}return r.prototype.getHeight=function(){return this.height},r.prototype.getWidth=function(){return this.width},r.prototype.get=function(e,t){return this.bytes[t][e]},r.prototype.getArray=function(){return this.bytes},r.prototype.setNumber=function(e,t,n){this.bytes[t][e]=n},r.prototype.setBoolean=function(e,t,n){this.bytes[t][e]=n?1:0},r.prototype.clear=function(e){var t,n;try{for(var a=vm(this.bytes),i=a.next();!i.done;i=a.next()){var o=i.value;et.fill(o,e)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var i=this.bytes[n],o=t.bytes[n],s=0,l=this.width;s<l;++s)if(i[s]!==o[s])return!1;return!0},r.prototype.toString=function(){for(var e=new de,t=0,n=this.height;t<n;++t){for(var a=this.bytes[t],i=0,o=this.width;i<o;++i)switch(a[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},r}(),Qi=function(){function r(){this.maskPattern=-1}return r.prototype.getMode=function(){return this.mode},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getVersion=function(){return this.version},r.prototype.getMaskPattern=function(){return this.maskPattern},r.prototype.getMatrix=function(){return this.matrix},r.prototype.toString=function(){var e=new de;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},r.prototype.setMode=function(e){this.mode=e},r.prototype.setECLevel=function(e){this.ecLevel=e},r.prototype.setVersion=function(e){this.version=e},r.prototype.setMaskPattern=function(e){this.maskPattern=e},r.prototype.setMatrix=function(e){this.matrix=e},r.isValidMaskPattern=function(e){return e>=0&&e<r.NUM_MASK_PATTERNS},r.NUM_MASK_PATTERNS=8,r}(),xm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Le=function(r){xm(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="WriterException",e}(It),il=function(){function r(){}return r.clearMatrix=function(e){e.clear(255)},r.buildMatrix=function(e,t,n,a,i){r.clearMatrix(i),r.embedBasicPatterns(n,i),r.embedTypeInfo(t,a,i),r.maybeEmbedVersionInfo(n,i),r.embedDataBits(e,a,i)},r.embedBasicPatterns=function(e,t){r.embedPositionDetectionPatternsAndSeparators(t),r.embedDarkDotAtLeftBottomCorner(t),r.maybeEmbedPositionAdjustmentPatterns(e,t),r.embedTimingPatterns(t)},r.embedTypeInfo=function(e,t,n){var a=new ot;r.makeTypeInfoBits(e,t,a);for(var i=0,o=a.getSize();i<o;++i){var s=a.get(a.getSize()-1-i),l=r.TYPE_INFO_COORDINATES[i],c=l[0],d=l[1];if(n.setBoolean(c,d,s),i<8){var f=n.getWidth()-i-1,h=8;n.setBoolean(f,h,s)}else{var f=8,h=n.getHeight()-7+(i-8);n.setBoolean(f,h,s)}}},r.maybeEmbedVersionInfo=function(e,t){if(!(e.getVersionNumber()<7)){var n=new ot;r.makeVersionInfoBits(e,n);for(var a=6*3-1,i=0;i<6;++i)for(var o=0;o<3;++o){var s=n.get(a);a--,t.setBoolean(i,t.getHeight()-11+o,s),t.setBoolean(t.getHeight()-11+o,i,s)}}},r.embedDataBits=function(e,t,n){for(var a=0,i=-1,o=n.getWidth()-1,s=n.getHeight()-1;o>0;){for(o===6&&(o-=1);s>=0&&s<n.getHeight();){for(var l=0;l<2;++l){var c=o-l;if(r.isEmpty(n.get(c,s))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,t!==255&&Tn.getDataMaskBit(t,c,s)&&(d=!d),n.setBoolean(c,s,d)}}s+=i}i=-i,s+=i,o-=2}if(a!==e.getSize())throw new Le("Not all bits consumed: "+a+"/"+e.getSize())},r.findMSBSet=function(e){return 32-he.numberOfLeadingZeros(e)},r.calculateBCHCode=function(e,t){if(t===0)throw new re("0 polynomial");var n=r.findMSBSet(t);for(e<<=n-1;r.findMSBSet(e)>=n;)e^=t<<r.findMSBSet(e)-n;return e},r.makeTypeInfoBits=function(e,t,n){if(!Qi.isValidMaskPattern(t))throw new Le("Invalid mask pattern");var a=e.getBits()<<3|t;n.appendBits(a,5);var i=r.calculateBCHCode(a,r.TYPE_INFO_POLY);n.appendBits(i,10);var o=new ot;if(o.appendBits(r.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new Le("should not happen but we got: "+n.getSize())},r.makeVersionInfoBits=function(e,t){t.appendBits(e.getVersionNumber(),6);var n=r.calculateBCHCode(e.getVersionNumber(),r.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new Le("should not happen but we got: "+t.getSize())},r.isEmpty=function(e){return e===255},r.embedTimingPatterns=function(e){for(var t=8;t<e.getWidth()-8;++t){var n=(t+1)%2;r.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),r.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}},r.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new Le;e.setNumber(8,e.getHeight()-8,1)},r.embedHorizontalSeparationPattern=function(e,t,n){for(var a=0;a<8;++a){if(!r.isEmpty(n.get(e+a,t)))throw new Le;n.setNumber(e+a,t,0)}},r.embedVerticalSeparationPattern=function(e,t,n){for(var a=0;a<7;++a){if(!r.isEmpty(n.get(e,t+a)))throw new Le;n.setNumber(e,t+a,0)}},r.embedPositionAdjustmentPattern=function(e,t,n){for(var a=0;a<5;++a)for(var i=r.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,t+a,i[o])},r.embedPositionDetectionPattern=function(e,t,n){for(var a=0;a<7;++a)for(var i=r.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,t+a,i[o])},r.embedPositionDetectionPatternsAndSeparators=function(e){var t=r.POSITION_DETECTION_PATTERN[0].length;r.embedPositionDetectionPattern(0,0,e),r.embedPositionDetectionPattern(e.getWidth()-t,0,e),r.embedPositionDetectionPattern(0,e.getWidth()-t,e);var n=8;r.embedHorizontalSeparationPattern(0,n-1,e),r.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),r.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;r.embedVerticalSeparationPattern(a,0,e),r.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),r.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},r.maybeEmbedPositionAdjustmentPatterns=function(e,t){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],i=0,o=a.length;i!==o;i++){var s=a[i];if(s>=0)for(var l=0;l!==o;l++){var c=a[l];c>=0&&r.isEmpty(t.get(c,s))&&r.embedPositionAdjustmentPattern(c-2,s-2,t)}}},r.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),r.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),r.VERSION_INFO_POLY=7973,r.TYPE_INFO_POLY=1335,r.TYPE_INFO_MASK_PATTERN=21522,r}(),bm=function(){function r(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}return r.prototype.getDataBytes=function(){return this.dataBytes},r.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},r}(),ol=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.calculateMaskPenalty=function(e){return Tn.applyMaskPenaltyRule1(e)+Tn.applyMaskPenaltyRule2(e)+Tn.applyMaskPenaltyRule3(e)+Tn.applyMaskPenaltyRule4(e)},r.encode=function(e,t,n){n===void 0&&(n=null);var a=r.DEFAULT_BYTE_MODE_ENCODING,i=n!==null&&n.get(ca.CHARACTER_SET)!==void 0;i&&(a=n.get(ca.CHARACTER_SET).toString());var o=this.chooseMode(e,a),s=new ot;if(o===ke.BYTE&&(i||r.DEFAULT_BYTE_MODE_ENCODING!==a)){var l=Je.getCharacterSetECIByName(a);l!==void 0&&this.appendECI(l,s)}this.appendModeInfo(o,s);var c=new ot;this.appendBytes(e,o,c,a);var d;if(n!==null&&n.get(ca.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(ca.QR_VERSION).toString(),10);d=Br.getVersionForNumber(f);var h=this.calculateBitsNeeded(o,s,c,d);if(!this.willFit(h,d,t))throw new Le("Data too big for requested version")}else d=this.recommendVersion(t,o,s,c);var p=new ot;p.appendBitArray(s);var g=o===ke.BYTE?c.getSizeInBytes():e.length;this.appendLengthInfo(g,d,o,p),p.appendBitArray(c);var y=d.getECBlocksForLevel(t),x=d.getTotalCodewords()-y.getTotalECCodewords();this.terminateBits(x,p);var v=this.interleaveWithECBytes(p,d.getTotalCodewords(),x,y.getNumBlocks()),b=new Qi;b.setECLevel(t),b.setMode(o),b.setVersion(d);var _=d.getDimensionForVersion(),w=new ym(_,_),A=this.chooseMaskPattern(v,t,d,w);return b.setMaskPattern(A),il.buildMatrix(v,t,d,A,w),b.setMatrix(w),b},r.recommendVersion=function(e,t,n,a){var i=this.calculateBitsNeeded(t,n,a,Br.getVersionForNumber(1)),o=this.chooseVersion(i,e),s=this.calculateBitsNeeded(t,n,a,o);return this.chooseVersion(s,e)},r.calculateBitsNeeded=function(e,t,n,a){return t.getSize()+e.getCharacterCountBits(a)+n.getSize()},r.getAlphanumericCode=function(e){return e<r.ALPHANUMERIC_TABLE.length?r.ALPHANUMERIC_TABLE[e]:-1},r.chooseMode=function(e,t){if(t===void 0&&(t=null),Je.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return ke.KANJI;for(var n=!1,a=!1,i=0,o=e.length;i<o;++i){var s=e.charAt(i);if(r.isDigit(s))n=!0;else if(this.getAlphanumericCode(s.charCodeAt(0))!==-1)a=!0;else return ke.BYTE}return a?ke.ALPHANUMERIC:n?ke.NUMERIC:ke.BYTE},r.isOnlyDoubleByteKanji=function(e){var t;try{t=Vt.encode(e,Je.SJIS)}catch{return!1}var n=t.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var i=t[a]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0},r.chooseMaskPattern=function(e,t,n,a){for(var i=Number.MAX_SAFE_INTEGER,o=-1,s=0;s<Qi.NUM_MASK_PATTERNS;s++){il.buildMatrix(e,t,n,s,a);var l=this.calculateMaskPenalty(a);l<i&&(i=l,o=s)}return o},r.chooseVersion=function(e,t){for(var n=1;n<=40;n++){var a=Br.getVersionForNumber(n);if(r.willFit(e,a,t))return a}throw new Le("Data too big")},r.willFit=function(e,t,n){var a=t.getTotalCodewords(),i=t.getECBlocksForLevel(n),o=i.getTotalECCodewords(),s=a-o,l=(e+7)/8;return s>=l},r.terminateBits=function(e,t){var n=e*8;if(t.getSize()>n)throw new Le("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(var a=0;a<4&&t.getSize()<n;++a)t.appendBit(!1);var i=t.getSize()&7;if(i>0)for(var a=i;a<8;a++)t.appendBit(!1);for(var o=e-t.getSizeInBytes(),a=0;a<o;++a)t.appendBits(a&1?17:236,8);if(t.getSize()!==n)throw new Le("Bits size does not equal capacity")},r.getNumDataBytesAndNumECBytesForBlockID=function(e,t,n,a,i,o){if(a>=n)throw new Le("Block ID too large");var s=e%n,l=n-s,c=Math.floor(e/n),d=c+1,f=Math.floor(t/n),h=f+1,p=c-f,g=d-h;if(p!==g)throw new Le("EC bytes mismatch");if(n!==l+s)throw new Le("RS blocks mismatch");if(e!==(f+p)*l+(h+g)*s)throw new Le("Total bytes mismatch");a<l?(i[0]=f,o[0]=p):(i[0]=h,o[0]=g)},r.interleaveWithECBytes=function(e,t,n,a){var i,o,s,l;if(e.getSizeInBytes()!==n)throw new Le("Number of bits and data bytes does not match");for(var c=0,d=0,f=0,h=new Array,p=0;p<a;++p){var g=new Int32Array(1),y=new Int32Array(1);r.getNumDataBytesAndNumECBytesForBlockID(t,n,a,p,g,y);var x=g[0],v=new Uint8Array(x);e.toBytes(8*c,v,0,x);var b=r.generateECBytes(v,y[0]);h.push(new bm(v,b)),d=Math.max(d,x),f=Math.max(f,b.length),c+=g[0]}if(n!==c)throw new Le("Data bytes does not match offset");for(var _=new ot,p=0;p<d;++p)try{for(var w=(i=void 0,ol(h)),A=w.next();!A.done;A=w.next()){var C=A.value,v=C.getDataBytes();p<v.length&&_.appendBits(v[p],8)}}catch(T){i={error:T}}finally{try{A&&!A.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}for(var p=0;p<f;++p)try{for(var I=(s=void 0,ol(h)),R=I.next();!R.done;R=I.next()){var C=R.value,b=C.getErrorCorrectionBytes();p<b.length&&_.appendBits(b[p],8)}}catch(T){s={error:T}}finally{try{R&&!R.done&&(l=I.return)&&l.call(I)}finally{if(s)throw s.error}}if(t!==_.getSizeInBytes())throw new Le("Interleaving error: "+t+" and "+_.getSizeInBytes()+" differ.");return _},r.generateECBytes=function(e,t){for(var n=e.length,a=new Int32Array(n+t),i=0;i<n;i++)a[i]=e[i]&255;new Xu(Nt.QR_CODE_FIELD_256).encode(a,t);for(var o=new Uint8Array(t),i=0;i<t;i++)o[i]=a[n+i];return o},r.appendModeInfo=function(e,t){t.appendBits(e.getBits(),4)},r.appendLengthInfo=function(e,t,n,a){var i=n.getCharacterCountBits(t);if(e>=1<<i)throw new Le(e+" is bigger than "+((1<<i)-1));a.appendBits(e,i)},r.appendBytes=function(e,t,n,a){switch(t){case ke.NUMERIC:r.appendNumericBytes(e,n);break;case ke.ALPHANUMERIC:r.appendAlphanumericBytes(e,n);break;case ke.BYTE:r.append8BitBytes(e,n,a);break;case ke.KANJI:r.appendKanjiBytes(e,n);break;default:throw new Le("Invalid mode: "+t)}},r.getDigit=function(e){return e.charCodeAt(0)-48},r.isDigit=function(e){var t=r.getDigit(e);return t>=0&&t<=9},r.appendNumericBytes=function(e,t){for(var n=e.length,a=0;a<n;){var i=r.getDigit(e.charAt(a));if(a+2<n){var o=r.getDigit(e.charAt(a+1)),s=r.getDigit(e.charAt(a+2));t.appendBits(i*100+o*10+s,10),a+=3}else if(a+1<n){var o=r.getDigit(e.charAt(a+1));t.appendBits(i*10+o,7),a+=2}else t.appendBits(i,4),a++}},r.appendAlphanumericBytes=function(e,t){for(var n=e.length,a=0;a<n;){var i=r.getAlphanumericCode(e.charCodeAt(a));if(i===-1)throw new Le;if(a+1<n){var o=r.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new Le;t.appendBits(i*45+o,11),a+=2}else t.appendBits(i,6),a++}},r.append8BitBytes=function(e,t,n){var a;try{a=Vt.encode(e,n)}catch(l){throw new Le(l)}for(var i=0,o=a.length;i!==o;i++){var s=a[i];t.appendBits(s,8)}},r.appendKanjiBytes=function(e,t){var n;try{n=Vt.encode(e,Je.SJIS)}catch(f){throw new Le(f)}for(var a=n.length,i=0;i<a;i+=2){var o=n[i]&255,s=n[i+1]&255,l=o<<8&4294967295|s,c=-1;if(l>=33088&&l<=40956?c=l-33088:l>=57408&&l<=60351&&(c=l-49472),c===-1)throw new Le("Invalid byte sequence");var d=(c>>8)*192+(c&255);t.appendBits(d,13)}},r.appendECI=function(e,t){t.appendBits(ke.ECI.getBits(),4),t.appendBits(e.getValue(),8)},r.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),r.DEFAULT_BYTE_MODE_ENCODING=Je.UTF8.getName(),r})();var wm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){wm(e,r);function e(t,n,a,i,o,s,l,c){var d=r.call(this,s,l)||this;if(d.yuvData=t,d.dataWidth=n,d.dataHeight=a,d.left=i,d.top=o,i+s>n||o+l>a)throw new re("Crop rectangle does not fit within image data.");return c&&d.reverseHorizontal(s,l),d}return e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new re("Requested row is outside the image: "+t);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var i=(t+this.top)*this.dataWidth+this.left;return Oe.arraycopy(this.yuvData,i,n,0,a),n},e.prototype.getMatrix=function(){var t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=t*n,i=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return Oe.arraycopy(this.yuvData,o,i,0,a),i;for(var s=0;s<n;s++){var l=s*t;Oe.arraycopy(this.yuvData,o,i,l,t),o+=this.dataWidth}return i},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+n,a,i,!1)},e.prototype.renderThumbnail=function(){for(var t=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(t*n),i=this.yuvData,o=this.top*this.dataWidth+this.left,s=0;s<n;s++){for(var l=s*t,c=0;c<t;c++){var d=i[o+c*e.THUMBNAIL_SCALE_FACTOR]&255;a[l+c]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(t,n){for(var a=this.yuvData,i=0,o=this.top*this.dataWidth+this.left;i<n;i++,o+=this.dataWidth)for(var s=o+t/2,l=o,c=o+t-1;l<s;l++,c--){var d=a[l];a[l]=a[c],a[c]=d}},e.prototype.invert=function(){return new Ha(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Qn);var Am=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Am(e,r);function e(t,n,a,i,o,s,l){var c=r.call(this,n,a)||this;if(c.dataWidth=i,c.dataHeight=o,c.left=s,c.top=l,t.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),h=0;h<d;h++){var p=t[h],g=p>>16&255,y=p>>7&510,x=p&255;f[h]=(g+y+x)/4&255}c.luminances=f}else c.luminances=t;if(i===void 0&&(c.dataWidth=n),o===void 0&&(c.dataHeight=a),s===void 0&&(c.left=0),l===void 0&&(c.top=0),c.left+n>c.dataWidth||c.top+a>c.dataHeight)throw new re("Crop rectangle does not fit within image data.");return c}return e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new re("Requested row is outside the image: "+t);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var i=(t+this.top)*this.dataWidth+this.left;return Oe.arraycopy(this.luminances,i,n,0,a),n},e.prototype.getMatrix=function(){var t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=t*n,i=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return Oe.arraycopy(this.luminances,o,i,0,a),i;for(var s=0;s<n;s++){var l=s*t;Oe.arraycopy(this.luminances,o,i,l,t),o+=this.dataWidth}return i},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return new e(this.luminances,a,i,this.dataWidth,this.dataHeight,this.left+t,this.top+n)},e.prototype.invert=function(){return new Ha(this)},e})(Qn);var Cm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_m=function(r){Cm(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.forName=function(t){return this.getCharacterSetECIByName(t)},e}(Je),Em=function(){function r(){}return r.ISO_8859_1=Je.ISO8859_1,r}(),Ji,Nm=301,Sm=function(r,e){for(var t=1,n=0;n<255;n++)e[n]=t,r[t]=n,t*=2,t>=256&&(t^=Nm);return{LOG:r,ALOG:e}};Ji=Sm([],[]),Ji.LOG;Ji.ALOG;var sl;(function(r){r[r.FORCE_NONE=0]="FORCE_NONE",r[r.FORCE_SQUARE=1]="FORCE_SQUARE",r[r.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(sl||(sl={}));var ll=129,qu=230,Im=231,Tm=235,Rm=236,Om=237,Dm=238,Pm=239,Mm=240,ui=254,Lm=254,cl="[)>05",ul="[)>06",dl="",Ie=0,ct=1,xt=2,Ze=3,at=4,ht=5,km=function(){function r(){}return r.prototype.getEncodingMode=function(){return Ie},r.prototype.encode=function(e){var t=zt.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(t>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=zt.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case ht:e.writeCodeword(Im),e.signalEncoderChange(ht);return;case ct:e.writeCodeword(qu),e.signalEncoderChange(ct);return;case Ze:e.writeCodeword(Dm),e.signalEncoderChange(Ze);break;case xt:e.writeCodeword(Pm),e.signalEncoderChange(xt);break;case at:e.writeCodeword(Mm),e.signalEncoderChange(at);break;default:throw new Error("Illegal mode: "+a)}else zt.isExtendedASCII(n)?(e.writeCodeword(Tm),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},r.prototype.encodeASCIIDigits=function(e,t){if(zt.isDigit(e)&&zt.isDigit(t)){var n=(e-48)*10+(t-48);return n+130}throw new Error("not digits: "+e+t)},r}(),Fm=function(){function r(){}return r.prototype.getEncodingMode=function(){return ht},r.prototype.encode=function(e){var t=new de;for(t.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();t.append(n),e.pos++;var a=zt.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(Ie);break}}var i=t.length()-1,o=1,s=e.getCodewordCount()+i+o;e.updateSymbolInfo(s);var l=e.getSymbolInfo().getDataCapacity()-s>0;if(e.hasMoreCharacters()||l)if(i<=249)t.setCharAt(0,ve.getCharAt(i));else if(i<=1555)t.setCharAt(0,ve.getCharAt(Math.floor(i/250)+249)),t.insert(1,ve.getCharAt(i%250));else throw new Error("Message length not in valid ranges: "+i);for(var c=0,n=t.length();c<n;c++)e.writeCodeword(this.randomize255State(t.charAt(c).charCodeAt(0),e.getCodewordCount()+1))},r.prototype.randomize255State=function(e,t){var n=149*t%255+1,a=e+n;return a<=255?a:a-256},r}(),Lo=function(){function r(){}return r.prototype.getEncodingMode=function(){return ct},r.prototype.encodeMaximal=function(e){for(var t=new de,n=0,a=e.pos,i=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,t),t.length()%3===0&&(a=e.pos,i=t.length())}if(i!==t.length()){var s=Math.floor(t.length()/3*2),l=Math.floor(e.getCodewordCount()+s+1);e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l,d=Math.floor(t.length()%3);(d===2&&c!==2||d===1&&(n>3||c!==1))&&(e.pos=a)}t.length()>0&&e.writeCodeword(qu),this.handleEOD(e,t)},r.prototype.encode=function(e){for(var t=new de;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,t),i=Math.floor(t.length()/3)*2,o=e.getCodewordCount()+i;e.updateSymbolInfo(o);var s=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var l=new de;for(t.length()%3===2&&s!==2&&(a=this.backtrackOneCharacter(e,t,l,a));t.length()%3===1&&(a>3||s!==1);)a=this.backtrackOneCharacter(e,t,l,a);break}var c=t.length();if(c%3===0){var d=zt.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(Ie);break}}}this.handleEOD(e,t)},r.prototype.backtrackOneCharacter=function(e,t,n,a){var i=t.length(),o=t.toString().substring(0,i-a);t.setLengthToZero(),t.append(o),e.pos--;var s=e.getCurrentChar();return a=this.encodeChar(s,n),e.resetSymbolInfo(),a},r.prototype.writeNextTriplet=function(e,t){e.writeCodewords(this.encodeToCodewords(t.toString()));var n=t.toString().substring(3);t.setLengthToZero(),t.append(n)},r.prototype.handleEOD=function(e,t){var n=Math.floor(t.length()/3*2),a=t.length()%3,i=e.getCodewordCount()+n;e.updateSymbolInfo(i);var o=e.getSymbolInfo().getDataCapacity()-i;if(a===2){for(t.append("\0");t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(ui)}else if(o===1&&a===1){for(;t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(ui),e.pos--}else if(a===0){for(;t.length()>=3;)this.writeNextTriplet(e,t);(o>0||e.hasMoreCharacters())&&e.writeCodeword(ui)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Ie)},r.prototype.encodeChar=function(e,t){if(e===32)return t.append(3),1;if(e>=48&&e<=57)return t.append(e-48+4),1;if(e>=65&&e<=90)return t.append(e-65+14),1;if(e<32)return t.append(0),t.append(e),2;if(e<=47)return t.append(1),t.append(e-33),2;if(e<=64)return t.append(1),t.append(e-58+15),2;if(e<=95)return t.append(1),t.append(e-91+22),2;if(e<=127)return t.append(2),t.append(e-96),2;t.append("1");var n=2;return n+=this.encodeChar(e-128,t),n},r.prototype.encodeToCodewords=function(e){var t=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=t/256,a=t%256,i=new de;return i.append(n),i.append(a),i.toString()},r}(),Bm=function(){function r(){}return r.prototype.getEncodingMode=function(){return at},r.prototype.encode=function(e){for(var t=new de;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,t),e.pos++;var a=t.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(t.toString()));var i=t.toString().substring(4);t.setLengthToZero(),t.append(i);var o=zt.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Ie);break}}}t.append(ve.getCharAt(31)),this.handleEOD(e,t)},r.prototype.handleEOD=function(e,t){try{var n=t.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),i=e.getRemainingCharacters();if(i>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),i<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,s=this.encodeToCodewords(t.toString()),l=!e.hasMoreCharacters(),c=l&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(c=!1,e.updateSymbolInfo(e.getCodewordCount()+s.length))}c?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(s)}finally{e.signalEncoderChange(Ie)}},r.prototype.encodeChar=function(e,t){e>=32&&e<=63?t.append(e):e>=64&&e<=94?t.append(ve.getCharAt(e-64)):zt.illegalCharacter(ve.getCharAt(e))},r.prototype.encodeToCodewords=function(e){var t=e.length;if(t===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=t>=2?e.charAt(1).charCodeAt(0):0,i=t>=3?e.charAt(2).charCodeAt(0):0,o=t>=4?e.charAt(3).charCodeAt(0):0,s=(n<<18)+(a<<12)+(i<<6)+o,l=s>>16&255,c=s>>8&255,d=s&255,f=new de;return f.append(l),t>=2&&f.append(c),t>=3&&f.append(d),f.toString()},r}(),Vm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jm=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ce=function(){function r(e,t,n,a,i,o,s,l){s===void 0&&(s=0),l===void 0&&(l=0),this.rectangular=e,this.dataCapacity=t,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=i,this.dataRegions=o,this.rsBlockData=s,this.rsBlockError=l}return r.lookup=function(e,t,n,a,i){var o,s;t===void 0&&(t=0),n===void 0&&(n=null),a===void 0&&(a=null),i===void 0&&(i=!0);try{for(var l=jm($m),c=l.next();!c.done;c=l.next()){var d=c.value;if(!(t===1&&d.rectangular)&&!(t===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}if(i)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},r.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},r.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},r.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},r.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},r.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},r.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},r.prototype.getDataCapacity=function(){return this.dataCapacity},r.prototype.getErrorCodewords=function(){return this.errorCodewords},r.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},r.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},r}(),Um=function(r){Vm(e,r);function e(){return r.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(t){return t<=8?156:155},e}(Ce),$m=[new Ce(!1,3,5,8,8,1),new Ce(!1,5,7,10,10,1),new Ce(!0,5,7,16,6,1),new Ce(!1,8,10,12,12,1),new Ce(!0,10,11,14,6,2),new Ce(!1,12,12,14,14,1),new Ce(!0,16,14,24,10,1),new Ce(!1,18,14,16,16,1),new Ce(!1,22,18,18,18,1),new Ce(!0,22,18,16,10,2),new Ce(!1,30,20,20,20,1),new Ce(!0,32,24,16,14,2),new Ce(!1,36,24,22,22,1),new Ce(!1,44,28,24,24,1),new Ce(!0,49,28,22,14,2),new Ce(!1,62,36,14,14,4),new Ce(!1,86,42,16,16,4),new Ce(!1,114,48,18,18,4),new Ce(!1,144,56,20,20,4),new Ce(!1,174,68,22,22,4),new Ce(!1,204,84,24,24,4,102,42),new Ce(!1,280,112,14,14,16,140,56),new Ce(!1,368,144,16,16,16,92,36),new Ce(!1,456,192,18,18,16,114,48),new Ce(!1,576,224,20,20,16,144,56),new Ce(!1,696,272,22,22,16,174,68),new Ce(!1,816,336,24,24,16,136,56),new Ce(!1,1050,408,18,18,36,175,68),new Ce(!1,1304,496,20,20,36,163,62),new Um],Hm=function(){function r(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var t=e.split("").map(function(s){return s.charCodeAt(0)}),n=new de,a=0,i=t.length;a<i;a++){var o=String.fromCharCode(t[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new de,this.newEncoding=-1}return r.prototype.setSymbolShape=function(e){this.shape=e},r.prototype.setSizeConstraints=function(e,t){this.minSize=e,this.maxSize=t},r.prototype.getMessage=function(){return this.msg},r.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},r.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCodewords=function(){return this.codewords},r.prototype.writeCodewords=function(e){this.codewords.append(e)},r.prototype.writeCodeword=function(e){this.codewords.append(e)},r.prototype.getCodewordCount=function(){return this.codewords.length()},r.prototype.getNewEncoding=function(){return this.newEncoding},r.prototype.signalEncoderChange=function(e){this.newEncoding=e},r.prototype.resetEncoderSignal=function(){this.newEncoding=-1},r.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},r.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},r.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},r.prototype.getSymbolInfo=function(){return this.symbolInfo},r.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Ce.lookup(e,this.shape,this.minSize,this.maxSize,!0))},r.prototype.resetSymbolInfo=function(){this.symbolInfo=null},r}(),Gm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zm=function(r){Gm(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return Ze},e.prototype.encode=function(t){for(var n=new de;t.hasMoreCharacters();){var a=t.getCurrentChar();t.pos++,this.encodeChar(a,n);var i=n.length();if(i%3===0){this.writeNextTriplet(t,n);var o=zt.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){t.signalEncoderChange(Ie);break}}}this.handleEOD(t,n)},e.prototype.encodeChar=function(t,n){switch(t){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:t>=48&&t<=57?n.append(t-48+4):t>=65&&t<=90?n.append(t-65+14):zt.illegalCharacter(ve.getCharAt(t));break}return 1},e.prototype.handleEOD=function(t,n){t.updateSymbolInfo();var a=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),i=n.length();t.pos-=i,(t.getRemainingCharacters()>1||a>1||t.getRemainingCharacters()!==a)&&t.writeCodeword(Lm),t.getNewEncoding()<0&&t.signalEncoderChange(Ie)},e}(Lo),Wm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xm=function(r){Wm(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return xt},e.prototype.encodeChar=function(t,n){if(t===32)return n.append(3),1;if(t>=48&&t<=57)return n.append(t-48+4),1;if(t>=97&&t<=122)return n.append(t-97+14),1;if(t<32)return n.append(0),n.append(t),2;if(t<=47)return n.append(1),n.append(t-33),2;if(t<=64)return n.append(1),n.append(t-58+15),2;if(t>=91&&t<=95)return n.append(1),n.append(t-91+22),2;if(t===96)return n.append(2),n.append(0),2;if(t<=90)return n.append(2),n.append(t-65+1),2;if(t<=127)return n.append(2),n.append(t-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(t-128,n),a},e}(Lo),zt=function(){function r(){}return r.randomize253State=function(e){var t=149*e%253+1,n=ll+t;return n<=254?n:n-254},r.encodeHighLevel=function(e,t,n,a,i){t===void 0&&(t=0),n===void 0&&(n=null),a===void 0&&(a=null),i===void 0&&(i=!1);var o=new Lo,s=[new km,o,new Xm,new zm,new Bm,new Fm],l=new Hm(e);l.setSymbolShape(t),l.setSizeConstraints(n,a),e.startsWith(cl)&&e.endsWith(dl)?(l.writeCodeword(Rm),l.setSkipAtEnd(2),l.pos+=cl.length):e.startsWith(ul)&&e.endsWith(dl)&&(l.writeCodeword(Om),l.setSkipAtEnd(2),l.pos+=ul.length);var c=Ie;for(i&&(o.encodeMaximal(l),c=l.getNewEncoding(),l.resetEncoderSignal());l.hasMoreCharacters();)s[c].encode(l),l.getNewEncoding()>=0&&(c=l.getNewEncoding(),l.resetEncoderSignal());var d=l.getCodewordCount();l.updateSymbolInfo();var f=l.getSymbolInfo().getDataCapacity();d<f&&c!==Ie&&c!==ht&&c!==at&&l.writeCodeword("Ã¾");var h=l.getCodewords();for(h.length()<f&&h.append(ll);h.length()<f;)h.append(this.randomize253State(h.length()+1));return l.getCodewords().toString()},r.lookAheadTest=function(e,t,n){var a=this.lookAheadTestIntern(e,t,n);if(n===Ze&&a===Ze){for(var i=Math.min(t+3,e.length),o=t;o<i;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Ie}else if(n===at&&a===at){for(var i=Math.min(t+4,e.length),o=t;o<i;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Ie}return a},r.lookAheadTestIntern=function(e,t,n){if(t>=e.length)return n;var a;n===Ie?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var i=0,o=new Uint8Array(6),s=[];;){if(t+i===e.length){et.fill(o,0),et.fill(s,0);var l=this.findMinimums(a,s,he.MAX_VALUE,o),c=this.getMinimumCount(o);if(s[Ie]===l)return Ie;if(c===1){if(o[ht]>0)return ht;if(o[at]>0)return at;if(o[xt]>0)return xt;if(o[Ze]>0)return Ze}return ct}var d=e.charCodeAt(t+i);if(i++,this.isDigit(d)?a[Ie]+=.5:this.isExtendedASCII(d)?(a[Ie]=Math.ceil(a[Ie]),a[Ie]+=2):(a[Ie]=Math.ceil(a[Ie]),a[Ie]++),this.isNativeC40(d)?a[ct]+=2/3:this.isExtendedASCII(d)?a[ct]+=8/3:a[ct]+=4/3,this.isNativeText(d)?a[xt]+=2/3:this.isExtendedASCII(d)?a[xt]+=8/3:a[xt]+=4/3,this.isNativeX12(d)?a[Ze]+=2/3:this.isExtendedASCII(d)?a[Ze]+=13/3:a[Ze]+=10/3,this.isNativeEDIFACT(d)?a[at]+=3/4:this.isExtendedASCII(d)?a[at]+=17/4:a[at]+=13/4,this.isSpecialB256(d)?a[ht]+=4:a[ht]++,i>=4){if(et.fill(o,0),et.fill(s,0),this.findMinimums(a,s,he.MAX_VALUE,o),s[Ie]<this.min(s[ht],s[ct],s[xt],s[Ze],s[at]))return Ie;if(s[ht]<s[Ie]||s[ht]+1<this.min(s[ct],s[xt],s[Ze],s[at]))return ht;if(s[at]+1<this.min(s[ht],s[ct],s[xt],s[Ze],s[Ie]))return at;if(s[xt]+1<this.min(s[ht],s[ct],s[at],s[Ze],s[Ie]))return xt;if(s[Ze]+1<this.min(s[ht],s[ct],s[at],s[xt],s[Ie]))return Ze;if(s[ct]+1<this.min(s[Ie],s[ht],s[at],s[xt])){if(s[ct]<s[Ze])return ct;if(s[ct]===s[Ze]){for(var f=t+i+1;f<e.length;){var h=e.charCodeAt(f);if(this.isX12TermSep(h))return Ze;if(!this.isNativeX12(h))break;f++}return ct}}}}},r.min=function(e,t,n,a,i){var o=Math.min(e,Math.min(t,Math.min(n,a)));return i===void 0?o:Math.min(o,i)},r.findMinimums=function(e,t,n,a){for(var i=0;i<6;i++){var o=t[i]=Math.ceil(e[i]);n>o&&(n=o,et.fill(a,0)),n===o&&(a[i]=a[i]+1)}return n},r.getMinimumCount=function(e){for(var t=0,n=0;n<6;n++)t+=e[n];return t||0},r.isDigit=function(e){return e>=48&&e<=57},r.isExtendedASCII=function(e){return e>=128&&e<=255},r.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},r.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},r.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},r.isX12TermSep=function(e){return e===13||e===42||e===62},r.isNativeEDIFACT=function(e){return e>=32&&e<=94},r.isSpecialB256=function(e){return!1},r.determineConsecutiveDigitCount=function(e,t){t===void 0&&(t=0);for(var n=e.length,a=t;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-t},r.illegalCharacter=function(e){var t=he.toHexString(e.charCodeAt(0));throw t="0000".substring(0,4-t.length)+t,new Error("Illegal character: "+e+" (0x"+t+")")},r}(),di=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fl=function(){function r(e){this.charset=e,this.name=e.name}return r.prototype.canEncode=function(e){try{return Vt.encode(e,this.charset)!=null}catch{return!1}},r}(),qm=function(){function r(e,t,n){var a,i,o,s,l,c;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(F){return new fl(_m.forName(F))}),this.encoders=[];var d=[];d.push(new fl(Em.ISO_8859_1));for(var f=t!=null&&t.name.startsWith("UTF"),h=0;h<e.length;h++){var p=!1;try{for(var g=(a=void 0,di(d)),y=g.next();!y.done;y=g.next()){var x=y.value,v=e.charAt(h),b=v.charCodeAt(0);if(b===n||x.canEncode(v)){p=!0;break}}}catch(F){a={error:F}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}if(!p)try{for(var _=(o=void 0,di(this.ENCODERS)),w=_.next();!w.done;w=_.next()){var x=w.value;if(x.canEncode(e.charAt(h))){d.push(x),p=!0;break}}}catch(F){o={error:F}}finally{try{w&&!w.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}p||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var A=0;try{for(var C=di(d),I=C.next();!I.done;I=C.next()){var x=I.value;this.encoders[A++]=x}}catch(F){l={error:F}}finally{try{I&&!I.done&&(c=C.return)&&c.call(C)}finally{if(l)throw l.error}}}var R=-1;if(t!=null){for(var h=0;h<this.encoders.length;h++)if(this.encoders[h]!=null&&t.name===this.encoders[h].name){R=h;break}}this.priorityEncoderIndex=R}return r.prototype.length=function(){return this.encoders.length},r.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},r.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},r.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},r.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},r.prototype.canEncode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return!0},r.prototype.encode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return Vt.encode(ve.getCharAt(e),this.encoders[t].name)},r}(),Ym=3,Km=function(){function r(e,t,n){this.fnc1=n;var a=new qm(e,t,n);if(a.length()===1)for(var i=0;i<this.bytes.length;i++){var o=e.charAt(i).charCodeAt(0);this.bytes[i]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return r.prototype.getFNC1Character=function(){return this.fnc1},r.prototype.length=function(){return this.bytes.length},r.prototype.haveNCharacters=function(e,t){if(e+t-1>=this.bytes.length)return!1;for(var n=0;n<t;n++)if(this.isECI(e+n))return!1;return!0},r.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},r.prototype.subSequence=function(e,t){if(e<0||e>t||t>this.length())throw new Error(""+e);for(var n=new de,a=e;a<t;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},r.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},r.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},r.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},r.prototype.addEdge=function(e,t,n){(e[t][n.encoderIndex]==null||e[t][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[t][n.encoderIndex]=n)},r.prototype.addEdges=function(e,t,n,a,i,o){var s=e.charAt(a).charCodeAt(0),l=0,c=t.length();t.getPriorityEncoderIndex()>=0&&(s===o||t.canEncode(s,t.getPriorityEncoderIndex()))&&(l=t.getPriorityEncoderIndex(),c=l+1);for(var d=l;d<c;d++)(s===o||t.canEncode(s,d))&&this.addEdge(n,a+1,new hl(s,t,d,i,o))},r.prototype.encodeMinimally=function(e,t,n){var a=e.length,i=new hl[a+1][t.length()];this.addEdges(e,t,i,0,null,n);for(var o=1;o<=a;o++){for(var s=0;s<t.length();s++)i[o][s]!=null&&o<a&&this.addEdges(e,t,i,o,i[o][s],n);for(var s=0;s<t.length();s++)i[o-1][s]=null}for(var l=-1,c=he.MAX_VALUE,s=0;s<t.length();s++)if(i[a][s]!=null){var d=i[a][s];d.cachedTotalSize<c&&(c=d.cachedTotalSize,l=s)}if(l<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],h=i[a][l];h!=null;){if(h.isFNC1())f.unshift(1e3);else for(var p=t.encode(h.c,h.encoderIndex),o=p.length-1;o>=0;o--)f.unshift(p[o]&255);var g=h.previous===null?0:h.previous.encoderIndex;g!==h.encoderIndex&&f.unshift(256+t.getECIValue(h.encoderIndex)),h=h.previous}for(var y=[],o=0;o<y.length;o++)y[o]=f[o];return y},r}(),hl=function(){function r(e,t,n,a,i){this.c=e,this.encoderSet=t,this.encoderIndex=n,this.previous=a,this.fnc1=i,this.c=e===i?1e3:e;var o=this.isFNC1()?1:t.encode(e,n).length,s=a===null?0:a.encoderIndex;s!==n&&(o+=Ym),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return r.prototype.isFNC1=function(){return this.c===1e3},r}(),Zm=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();var pl;(function(r){r[r.ASCII=0]="ASCII",r[r.C40=1]="C40",r[r.TEXT=2]="TEXT",r[r.X12=3]="X12",r[r.EDF=4]="EDF",r[r.B256=5]="B256"})(pl||(pl={}));(function(r){Zm(e,r);function e(t,n,a,i,o){var s=r.call(this,t,n,a)||this;return s.shape=i,s.macroId=o,s}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(Km);var Qm=function(){function r(){}return r.prototype.isCompact=function(){return this.compact},r.prototype.setCompact=function(e){this.compact=e},r.prototype.getSize=function(){return this.size},r.prototype.setSize=function(e){this.size=e},r.prototype.getLayers=function(){return this.layers},r.prototype.setLayers=function(e){this.layers=e},r.prototype.getCodeWords=function(){return this.codeWords},r.prototype.setCodeWords=function(e){this.codeWords=e},r.prototype.getMatrix=function(){return this.matrix},r.prototype.setMatrix=function(e){this.matrix=e},r}(),ml=function(){function r(){}return r.singletonList=function(e){return[e]},r.min=function(e,t){return e.sort(t)[0]},r}(),Jm=function(){function r(e){this.previous=e}return r.prototype.getPrevious=function(){return this.previous},r}(),eg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ko=function(r){eg(e,r);function e(t,n,a){var i=r.call(this,t)||this;return i.value=n,i.bitCount=a,i}return e.prototype.appendTo=function(t,n){t.appendBits(this.value,this.bitCount)},e.prototype.add=function(t,n){return new e(this,t,n)},e.prototype.addBinaryShift=function(t,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,t,n)},e.prototype.toString=function(){var t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+he.toBinaryString(t|1<<this.bitCount).substring(1)+">"},e}(Jm),tg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),rg=function(r){tg(e,r);function e(t,n,a){var i=r.call(this,t,0,0)||this;return i.binaryShiftStart=n,i.binaryShiftByteCount=a,i}return e.prototype.appendTo=function(t,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):a===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(t,n){return new e(this,t,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(ko);function ng(r,e,t){return new rg(r,e,t)}function wn(r,e,t){return new ko(r,e,t)}var ag=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],xr=0,Oa=1,kt=2,Yu=3,Yt=4,ig=new ko(null,0,0),fi=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],og=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function sg(r){var e,t;try{for(var n=og(r),a=n.next();!a.done;a=n.next()){var i=a.value;et.fill(i,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r[xr][Yt]=0,r[Oa][Yt]=0,r[Oa][xr]=28,r[Yu][Yt]=0,r[kt][Yt]=0,r[kt][xr]=15,r}var Ku=sg(et.createInt32Array(6,6)),lg=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cg=function(){function r(e,t,n,a){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=a}return r.prototype.getMode=function(){return this.mode},r.prototype.getToken=function(){return this.token},r.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},r.prototype.getBitCount=function(){return this.bitCount},r.prototype.latchAndAppend=function(e,t){var n=this.bitCount,a=this.token;if(e!==this.mode){var i=fi[this.mode][e];a=wn(a,i&65535,i>>16),n+=i>>16}var o=e===kt?4:5;return a=wn(a,t,o),new r(a,e,0,n+o)},r.prototype.shiftAndAppend=function(e,t){var n=this.token,a=this.mode===kt?4:5;return n=wn(n,Ku[this.mode][e],a),n=wn(n,t,5),new r(n,this.mode,0,this.bitCount+a+5)},r.prototype.addBinaryShiftChar=function(e){var t=this.token,n=this.mode,a=this.bitCount;if(this.mode===Yt||this.mode===kt){var i=fi[n][xr];t=wn(t,i&65535,i>>16),a+=i>>16,n=xr}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,s=new r(t,n,this.binaryShiftByteCount+1,a+o);return s.binaryShiftByteCount===2078&&(s=s.endBinaryShift(e+1)),s},r.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var t=this.token;return t=ng(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new r(t,this.mode,0,this.bitCount)},r.prototype.isBetterThanOrEqualTo=function(e){var t=this.bitCount+(fi[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=r.calculateBinaryShiftCost(e)-r.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount},r.prototype.toBitArray=function(e){for(var t,n,a=[],i=this.endBinaryShift(e.length).token;i!==null;i=i.getPrevious())a.unshift(i);var o=new ot;try{for(var s=lg(a),l=s.next();!l.done;l=s.next()){var c=l.value;c.appendTo(o,e)}}catch(d){t={error:d}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o},r.prototype.toString=function(){return ve.format("%s bits=%d bytes=%d",ag[this.mode],this.bitCount,this.binaryShiftByteCount)},r.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},r.INITIAL_STATE=new r(ig,xr,0,0),r}();function ug(r){var e=ve.getCharCode(" "),t=ve.getCharCode("."),n=ve.getCharCode(",");r[xr][e]=1;for(var a=ve.getCharCode("Z"),i=ve.getCharCode("A"),o=i;o<=a;o++)r[xr][o]=o-i+2;r[Oa][e]=1;for(var s=ve.getCharCode("z"),l=ve.getCharCode("a"),o=l;o<=s;o++)r[Oa][o]=o-l+2;r[kt][e]=1;for(var c=ve.getCharCode("9"),d=ve.getCharCode("0"),o=d;o<=c;o++)r[kt][o]=o-d+2;r[kt][n]=12,r[kt][t]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],h=0;h<f.length;h++)r[Yu][ve.getCharCode(f[h])]=h;for(var p=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],h=0;h<p.length;h++)ve.getCharCode(p[h])>0&&(r[Yt][ve.getCharCode(p[h])]=h);return r}var hi=ug(et.createInt32Array(5,256)),ua=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dg=function(){function r(e){this.text=e}return r.prototype.encode=function(){for(var e=ve.getCharCode(" "),t=ve.getCharCode(`
`),n=ml.singletonList(cg.INITIAL_STATE),a=0;a<this.text.length;a++){var i=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case ve.getCharCode("\r"):i=o===t?2:0;break;case ve.getCharCode("."):i=o===e?3:0;break;case ve.getCharCode(","):i=o===e?4:0;break;case ve.getCharCode(":"):i=o===e?5:0;break;default:i=0}i>0?(n=r.updateStateListForPair(n,a,i),a++):n=this.updateStateListForChar(n,a)}var s=ml.min(n,function(l,c){return l.getBitCount()-c.getBitCount()});return s.toBitArray(this.text)},r.prototype.updateStateListForChar=function(e,t){var n,a,i=[];try{for(var o=ua(e),s=o.next();!s.done;s=o.next()){var l=s.value;this.updateStateForChar(l,t,i)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return r.simplifyStates(i)},r.prototype.updateStateForChar=function(e,t,n){for(var a=this.text[t]&255,i=hi[e.getMode()][a]>0,o=null,s=0;s<=Yt;s++){var l=hi[s][a];if(l>0){if(o==null&&(o=e.endBinaryShift(t)),!i||s===e.getMode()||s===kt){var c=o.latchAndAppend(s,l);n.push(c)}if(!i&&Ku[e.getMode()][s]>=0){var d=o.shiftAndAppend(s,l);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||hi[e.getMode()][a]===0){var f=e.addBinaryShiftChar(t);n.push(f)}},r.updateStateListForPair=function(e,t,n){var a,i,o=[];try{for(var s=ua(e),l=s.next();!l.done;l=s.next()){var c=l.value;this.updateStateForPair(c,t,n,o)}}catch(d){a={error:d}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}return this.simplifyStates(o)},r.updateStateForPair=function(e,t,n,a){var i=e.endBinaryShift(t);if(a.push(i.latchAndAppend(Yt,n)),e.getMode()!==Yt&&a.push(i.shiftAndAppend(Yt,n)),n===3||n===4){var o=i.latchAndAppend(kt,16-n).latchAndAppend(kt,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var s=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);a.push(s)}},r.simplifyStates=function(e){var t,n,a,i,o=[];try{for(var s=ua(e),l=s.next();!l.done;l=s.next()){var c=l.value,d=!0,f=function(x){if(x.isBetterThanOrEqualTo(c))return d=!1,"break";c.isBetterThanOrEqualTo(x)&&(o=o.filter(function(v){return v!==x}))};try{for(var h=(a=void 0,ua(o)),p=h.next();!p.done;p=h.next()){var g=p.value,y=f(g);if(y==="break")break}}catch(x){a={error:x}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}d&&o.push(c)}}catch(x){t={error:x}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o},r}(),fg=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.encodeBytes=function(e){return r.encode(e,r.DEFAULT_EC_PERCENT,r.DEFAULT_AZTEC_LAYERS)},r.encode=function(e,t,n){var a=new dg(e).encode(),i=he.truncDivision(a.getSize()*t,100)+11,o=a.getSize()+i,s,l,c,d,f;if(n!==r.DEFAULT_AZTEC_LAYERS){if(s=n<0,l=Math.abs(n),l>(s?r.MAX_NB_BITS_COMPACT:r.MAX_NB_BITS))throw new re(ve.format("Illegal value %s for layers",n));c=r.totalBitsInLayer(l,s),d=r.WORD_SIZE[l];var h=c-c%d;if(f=r.stuffBits(a,d),f.getSize()+i>h)throw new re("Data to large for user specified layer");if(s&&f.getSize()>d*64)throw new re("Data to large for user specified layer")}else{d=0,f=null;for(var p=0;;p++){if(p>r.MAX_NB_BITS)throw new re("Data too large for an Aztec code");if(s=p<=3,l=s?p+1:p,c=r.totalBitsInLayer(l,s),!(o>c)){(f==null||d!==r.WORD_SIZE[l])&&(d=r.WORD_SIZE[l],f=r.stuffBits(a,d));var h=c-c%d;if(!(s&&f.getSize()>d*64)&&f.getSize()+i<=h)break}}}var g=r.generateCheckWords(f,c,d),y=f.getSize()/d,x=r.generateModeMessage(s,l,y),v=(s?11:14)+l*4,b=new Int32Array(v),_;if(s){_=v;for(var p=0;p<b.length;p++)b[p]=p}else{_=v+1+2*he.truncDivision(he.truncDivision(v,2)-1,15);for(var w=he.truncDivision(v,2),A=he.truncDivision(_,2),p=0;p<w;p++){var C=p+he.truncDivision(p,15);b[w-p-1]=A-C-1,b[w+p]=A+C+1}}for(var I=new er(_),p=0,R=0;p<l;p++){for(var F=(l-p)*4+(s?9:12),T=0;T<F;T++)for(var U=T*2,L=0;L<2;L++)g.get(R+U+L)&&I.set(b[p*2+L],b[p*2+T]),g.get(R+F*2+U+L)&&I.set(b[p*2+T],b[v-1-p*2-L]),g.get(R+F*4+U+L)&&I.set(b[v-1-p*2-L],b[v-1-p*2-T]),g.get(R+F*6+U+L)&&I.set(b[v-1-p*2-T],b[p*2+L]);R+=F*8}if(r.drawModeMessage(I,s,_,x),s)r.drawBullsEye(I,he.truncDivision(_,2),5);else{r.drawBullsEye(I,he.truncDivision(_,2),7);for(var p=0,T=0;p<he.truncDivision(v,2)-1;p+=15,T+=16)for(var L=he.truncDivision(_,2)&1;L<_;L+=2)I.set(he.truncDivision(_,2)-T,L),I.set(he.truncDivision(_,2)+T,L),I.set(L,he.truncDivision(_,2)-T),I.set(L,he.truncDivision(_,2)+T)}var B=new Qm;return B.setCompact(s),B.setSize(_),B.setLayers(l),B.setCodeWords(y),B.setMatrix(I),B},r.drawBullsEye=function(e,t,n){for(var a=0;a<n;a+=2)for(var i=t-a;i<=t+a;i++)e.set(i,t-a),e.set(i,t+a),e.set(t-a,i),e.set(t+a,i);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)},r.generateModeMessage=function(e,t,n){var a=new ot;return e?(a.appendBits(t-1,2),a.appendBits(n-1,6),a=r.generateCheckWords(a,28,4)):(a.appendBits(t-1,5),a.appendBits(n-1,11),a=r.generateCheckWords(a,40,4)),a},r.drawModeMessage=function(e,t,n,a){var i=he.truncDivision(n,2);if(t)for(var o=0;o<7;o++){var s=i-3+o;a.get(o)&&e.set(s,i-5),a.get(o+7)&&e.set(i+5,s),a.get(20-o)&&e.set(s,i+5),a.get(27-o)&&e.set(i-5,s)}else for(var o=0;o<10;o++){var s=i-5+o+he.truncDivision(o,5);a.get(o)&&e.set(s,i-7),a.get(o+10)&&e.set(i+7,s),a.get(29-o)&&e.set(s,i+7),a.get(39-o)&&e.set(i-7,s)}},r.generateCheckWords=function(e,t,n){var a,i,o=e.getSize()/n,s=new Xu(r.getGF(n)),l=he.truncDivision(t,n),c=r.bitsToWords(e,n,l);s.encode(c,l-o);var d=t%n,f=new ot;f.appendBits(0,d);try{for(var h=fg(Array.from(c)),p=h.next();!p.done;p=h.next()){var g=p.value;f.appendBits(g,n)}}catch(y){a={error:y}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}return f},r.bitsToWords=function(e,t,n){var a=new Int32Array(n),i,o;for(i=0,o=e.getSize()/t;i<o;i++){for(var s=0,l=0;l<t;l++)s|=e.get(i*t+l)?1<<t-l-1:0;a[i]=s}return a},r.getGF=function(e){switch(e){case 4:return Nt.AZTEC_PARAM;case 6:return Nt.AZTEC_DATA_6;case 8:return Nt.AZTEC_DATA_8;case 10:return Nt.AZTEC_DATA_10;case 12:return Nt.AZTEC_DATA_12;default:throw new re("Unsupported word size "+e)}},r.stuffBits=function(e,t){for(var n=new ot,a=e.getSize(),i=(1<<t)-2,o=0;o<a;o+=t){for(var s=0,l=0;l<t;l++)(o+l>=a||e.get(o+l))&&(s|=1<<t-1-l);(s&i)===i?(n.appendBits(s&i,t),o--):s&i?n.appendBits(s,t):(n.appendBits(s|1,t),o--)}return n},r.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.DEFAULT_EC_PERCENT=33,r.DEFAULT_AZTEC_LAYERS=0,r.MAX_NB_BITS=32,r.MAX_NB_BITS_COMPACT=4,r.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),r})();var hg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),pg=function(r){hg(e,r);function e(t){var n=r.call(this,t.width,t.height)||this;return n.canvas=t,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(t),n}return e.makeBufferFromCanvasImageData=function(t){var n;try{n=t.getContext("2d",{willReadFrequently:!0})}catch{n=t.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,t.width,t.height);return e.toGrayscaleBuffer(a.data,t.width,t.height)},e.toGrayscaleBuffer=function(t,n,a){for(var i=new Uint8ClampedArray(n*a),o=0,s=0,l=t.length;o<l;o+=4,s++){var c=void 0,d=t[o+3];if(d===0)c=255;else{var f=t[o],h=t[o+1],p=t[o+2];c=306*f+601*h+117*p+512>>10}i[s]=c}return i},e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new re("Requested row is outside the image: "+t);var a=this.getWidth(),i=t*a;return n===null?n=this.buffer.slice(i,i+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(i,i+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return r.prototype.crop.call(this,t,n,a,i),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new Ha(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement},e.prototype.rotate=function(t){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=t*e.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(a))*i+Math.abs(Math.sin(a))*o),l=Math.ceil(Math.abs(Math.sin(a))*i+Math.abs(Math.cos(a))*o);n.width=s,n.height=l;var c=n.getContext("2d");if(!c)throw new Error("Could not create a Canvas Context element.");return c.translate(s/2,l/2),c.rotate(a),c.drawImage(this.canvas,i/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(Qn);function Zu(){return typeof navigator<"u"}function mg(){return Zu()&&!!navigator.mediaDevices}function gg(){return!!(mg()&&navigator.mediaDevices.enumerateDevices)}var Qr=function(){return Qr=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a])}return r},Qr.apply(this,arguments)},Be=function(r,e,t,n){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function s(d){try{c(n.next(d))}catch(f){o(f)}}function l(d){try{c(n.throw(d))}catch(f){o(f)}}function c(d){d.done?i(d.value):a(d.value).then(s,l)}c((n=n.apply(r,e||[])).next())})},Ve=function(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,a=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],a=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},pi=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vg={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},hn=function(){function r(e,t,n){t===void 0&&(t=new Map),n===void 0&&(n={}),this.reader=e,this.hints=t,this.options=Qr(Qr({},vg),n)}return Object.defineProperty(r.prototype,"possibleFormats",{set:function(e){this.hints.set(De.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),r.addVideoSource=function(e,t){try{e.srcObject=t}catch{console.error("got interrupted by new loading request")}},r.mediaStreamSetTorch=function(e,t){return Be(this,void 0,void 0,function(){return Ve(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:t?"flash":"off",torch:!!t}]})];case 1:return n.sent(),[2]}})})},r.mediaStreamIsTorchCompatible=function(e){var t,n,a=e.getVideoTracks();try{for(var i=pi(a),o=i.next();!o.done;o=i.next()){var s=o.value;if(r.mediaStreamIsTorchCompatibleTrack(s))return!0}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1},r.mediaStreamIsTorchCompatibleTrack=function(e){try{var t=e.getCapabilities();return"torch"in t}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},r.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},r.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new Xe("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new Xe("element with id '".concat(e,"' must be an ").concat(t," element"));return n},r.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return r.getMediaElement(e,"video");if(!e&&typeof document<"u"){var t=document.createElement("video");return t.width=200,t.height=200,t}throw new Error("Couldn't get videoElement from videoSource!")},r.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return r.getMediaElement(e,"img");if(typeof e>"u"){var t=document.createElement("img");return t.width=200,t.height=200,t}throw new Error("Couldn't get imageElement from imageSource!")},r.prepareVideoElement=function(e){var t=r.createVideoElement(e);return t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},r.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},r.createBinaryBitmapFromCanvas=function(e){var t=new pg(e),n=new Lu(t);return new Mu(n)},r.drawImageOnCanvas=function(e,t){e.drawImage(t,0,0)},r.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},r.createCaptureCanvas=function(e){if(!e)throw new Xe("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var t=document.createElement("canvas"),n=r.getMediaElementDimensions(e),a=n.width,i=n.height;return t.style.width=a+"px",t.style.height=i+"px",t.width=a,t.height=i,t},r.tryPlayVideo=function(e){return Be(this,void 0,void 0,function(){var t;return Ve(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(r.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return t=n.sent(),console.warn("It was not possible to play the video.",t),[2,!1];case 4:return[2]}})})},r.createCanvasFromMediaElement=function(e){var t=r.createCaptureCanvas(e),n=t.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return r.drawImageOnCanvas(n,e),t},r.createBinaryBitmapFromMediaElem=function(e){var t=r.createCanvasFromMediaElement(e);return r.createBinaryBitmapFromCanvas(t)},r.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},r.listVideoInputDevices=function(){return Be(this,void 0,void 0,function(){var e,t,n,a,i,o,s,l,c,d,f,h;return Ve(this,function(p){switch(p.label){case 0:if(!Zu())throw new Error("Can't enumerate devices, navigator is not present.");if(!gg())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=p.sent(),t=[];try{for(n=pi(e),a=n.next();!a.done;a=n.next())i=a.value,o=i.kind==="video"?"videoinput":i.kind,o==="videoinput"&&(s=i.deviceId||i.id,l=i.label||"Video device ".concat(t.length+1),c=i.groupId,d={deviceId:s,label:l,kind:o,groupId:c},t.push(d))}catch(g){f={error:g}}finally{try{a&&!a.done&&(h=n.return)&&h.call(n)}finally{if(f)throw f.error}}return[2,t]}})})},r.findDeviceById=function(e){return Be(this,void 0,void 0,function(){var t;return Ve(this,function(n){switch(n.label){case 0:return[4,r.listVideoInputDevices()];case 1:return t=n.sent(),t?[2,t.find(function(a){return a.deviceId===e})]:[2]}})})},r.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},r.releaseAllStreams=function(){r.streamTracker.length!==0&&r.streamTracker.forEach(function(e){e.getTracks().forEach(function(t){return t.stop()})}),r.streamTracker=[]},r.playVideoOnLoadAsync=function(e,t){return Be(this,void 0,void 0,function(){var n;return Ve(this,function(a){switch(a.label){case 0:return[4,r.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(i,o){var s=setTimeout(function(){r.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",l))},t),l=function(){r.tryPlayVideo(e).then(function(c){clearTimeout(s),e.removeEventListener("canplay",l),i(c)})};e.addEventListener("canplay",l)})]}})})},r.attachStreamToVideo=function(e,t,n){return n===void 0&&(n=5e3),Be(this,void 0,void 0,function(){var a;return Ve(this,function(i){switch(i.label){case 0:return a=r.prepareVideoElement(t),r.addVideoSource(a,e),[4,r.playVideoOnLoadAsync(a,n)];case 1:return i.sent(),[2,a]}})})},r._waitImageLoad=function(e){return new Promise(function(t,n){var a=1e4,i=setTimeout(function(){r.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(i),e.removeEventListener("load",o),t()};e.addEventListener("load",o)})},r.checkCallbackFnOrThrow=function(e){if(!e)throw new Xe("`callbackFn` is a required parameter, you cannot capture results without it.")},r.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(t){return t.stop()}),e=void 0},r.prototype.decode=function(e){var t=r.createCanvasFromMediaElement(e);return this.decodeFromCanvas(t)},r.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},r.prototype.decodeFromCanvas=function(e){var t=r.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(t)},r.prototype.decodeFromImageElement=function(e){return Be(this,void 0,void 0,function(){var t;return Ve(this,function(n){switch(n.label){case 0:if(!e)throw new Xe("An image element must be provided.");return t=r.prepareImageElement(e),[4,this._decodeOnLoadImage(t)];case 1:return[2,n.sent()]}})})},r.prototype.decodeFromImageUrl=function(e){return Be(this,void 0,void 0,function(){var t;return Ve(this,function(n){switch(n.label){case 0:if(!e)throw new Xe("An URL must be provided.");t=r.prepareImageElement(),t.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(t)];case 2:return[2,n.sent()];case 3:return r.destroyImageElement(t),[7];case 4:return[2]}})})},r.prototype.decodeFromConstraints=function(e,t,n){return Be(this,void 0,void 0,function(){var a,i;return Ve(this,function(o){switch(o.label){case 0:return r.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,t,n)];case 3:return[2,o.sent()];case 4:throw i=o.sent(),r.disposeMediaStream(a),i;case 5:return[2]}})})},r.prototype.decodeFromStream=function(e,t,n){return Be(this,void 0,void 0,function(){var a,i,o,s,l,c,d,f,h,p=this;return Ve(this,function(g){switch(g.label){case 0:return r.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,r.attachStreamToVideo(e,t,a)];case 1:return i=g.sent(),o=function(){r.disposeMediaStream(e),r.cleanVideoSource(i)},s=this.scan(i,n,o),l=e.getVideoTracks(),c=Qr(Qr({},s),{stop:function(){s.stop()},streamVideoConstraintsApply:function(y,x){return Be(this,void 0,void 0,function(){var v,b,_,w,A,C,I;return Ve(this,function(R){switch(R.label){case 0:v=x?l.filter(x):l,R.label=1;case 1:R.trys.push([1,6,7,8]),b=pi(v),_=b.next(),R.label=2;case 2:return _.done?[3,5]:(w=_.value,[4,w.applyConstraints(y)]);case 3:R.sent(),R.label=4;case 4:return _=b.next(),[3,2];case 5:return[3,8];case 6:return A=R.sent(),C={error:A},[3,8];case 7:try{_&&!_.done&&(I=b.return)&&I.call(b)}finally{if(C)throw C.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(y){return l.find(y).getConstraints()},streamVideoSettingsGet:function(y){return l.find(y).getSettings()},streamVideoCapabilitiesGet:function(y){return l.find(y).getCapabilities()}}),d=r.mediaStreamIsTorchCompatible(e),d&&(f=l==null?void 0:l.find(function(y){return r.mediaStreamIsTorchCompatibleTrack(y)}),h=function(y){return Be(p,void 0,void 0,function(){return Ve(this,function(x){switch(x.label){case 0:return[4,r.mediaStreamSetTorch(f,y)];case 1:return x.sent(),[2]}})})},c.switchTorch=h,c.stop=function(){return Be(p,void 0,void 0,function(){return Ve(this,function(y){switch(y.label){case 0:return s.stop(),[4,h(!1)];case 1:return y.sent(),[2]}})})}),[2,c]}})})},r.prototype.decodeFromVideoDevice=function(e,t,n){return Be(this,void 0,void 0,function(){var a,i;return Ve(this,function(o){switch(o.label){case 0:return r.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},i={video:a},[4,this.decodeFromConstraints(i,t,n)];case 1:return[2,o.sent()]}})})},r.prototype.decodeFromVideoElement=function(e,t){return Be(this,void 0,void 0,function(){var n,a;return Ve(this,function(i){switch(i.label){case 0:if(r.checkCallbackFnOrThrow(t),!e)throw new Xe("A video element must be provided.");return n=r.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(n,a)];case 1:return i.sent(),[2,this.scan(n,t)]}})})},r.prototype.decodeFromVideoUrl=function(e,t){return Be(this,void 0,void 0,function(){var n,a,i,o;return Ve(this,function(s){switch(s.label){case 0:if(r.checkCallbackFnOrThrow(t),!e)throw new Xe("An URL must be provided.");return n=r.prepareVideoElement(),n.src=e,a=function(){r.cleanVideoSource(n)},i=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(n,i)];case 1:return s.sent(),o=this.scan(n,t,a),[2,o]}})})},r.prototype.decodeOnceFromConstraints=function(e,t){return Be(this,void 0,void 0,function(){var n;return Ve(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,a.sent()]}})})},r.prototype.decodeOnceFromStream=function(e,t){return Be(this,void 0,void 0,function(){var n,a,i;return Ve(this,function(o){switch(o.label){case 0:return n=!!t,[4,r.attachStreamToVideo(e,t)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return i=o.sent(),[2,i];case 4:return n||r.cleanVideoSource(a),[7];case 5:return[2]}})})},r.prototype.decodeOnceFromVideoDevice=function(e,t){return Be(this,void 0,void 0,function(){var n,a;return Ve(this,function(i){switch(i.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,t)];case 1:return[2,i.sent()]}})})},r.prototype.decodeOnceFromVideoElement=function(e){return Be(this,void 0,void 0,function(){var t,n;return Ve(this,function(a){switch(a.label){case 0:if(!e)throw new Xe("A video element must be provided.");return t=r.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(t,n)];case 1:return a.sent(),[4,this.scanOneResult(t)];case 2:return[2,a.sent()]}})})},r.prototype.decodeOnceFromVideoUrl=function(e){return Be(this,void 0,void 0,function(){var t,n;return Ve(this,function(a){switch(a.label){case 0:if(!e)throw new Xe("An URL must be provided.");t=r.prepareVideoElement(),t.src=e,n=this.decodeOnceFromVideoElement(t),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return r.cleanVideoSource(t),[7];case 4:return[2]}})})},r.prototype.scanOneResult=function(e,t,n,a){var i=this;return t===void 0&&(t=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,s){i.scan(e,function(l,c,d){if(l){o(l),d.stop();return}if(c){if(c instanceof k&&t||c instanceof Ye&&n||c instanceof $&&a)return;d.stop(),s(c)}})})},r.prototype.scan=function(e,t,n){var a=this;r.checkCallbackFnOrThrow(t);var i=r.createCaptureCanvas(e),o;try{o=i.getContext("2d",{willReadFrequently:!0})}catch{o=i.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var s=function(){o=void 0,i=void 0},l=!1,c,d=function(){l=!0,clearTimeout(c),s(),n&&n()},f={stop:d},h=function(){if(!l)try{r.drawImageOnCanvas(o,e);var p=a.decodeFromCanvas(i);t(p,void 0,f),c=setTimeout(h,a.options.delayBetweenScanSuccess)}catch(v){t(void 0,v,f);var g=v instanceof Ye,y=v instanceof $,x=v instanceof k;if(g||y||x){c=setTimeout(h,a.options.delayBetweenScanAttempts);return}s(),n&&n(v)}};return h(),f},r.prototype._decodeOnLoadImage=function(e){return Be(this,void 0,void 0,function(){var t;return Ve(this,function(n){switch(n.label){case 0:return t=r.isImageLoaded(e),t?[3,2]:[4,r._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},r.prototype.getUserMedia=function(e){return Be(this,void 0,void 0,function(){var t;return Ve(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return t=n.sent(),r.streamTracker.push(t),[2,t]}})})},r.streamTracker=[],r}(),yg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){yg(e,r);function e(t,n){return r.call(this,new Na,t,n)||this}return e})(hn);var xg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){xg(e,r);function e(t,n){return r.call(this,new Kr(t),t,n)||this}return e})(hn);var bg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){bg(e,r);function e(t,n){return r.call(this,new Ia,t,n)||this}return e})(hn);var wg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),gl=function(r){wg(e,r);function e(t,n){var a=this,i=new Wu;return i.setHints(t),a=r.call(this,i,t,n)||this,a.reader=i,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(t){this.hints.set(De.POSSIBLE_FORMATS,t),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)},e.prototype.setHints=function(t){this.hints=t,this.reader.setHints(this.hints)},e}(hn),Ag=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Ag(e,r);function e(t,n){return r.call(this,new Ra,t,n)||this}return e})(hn);var Cg=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Cg(e,r);function e(t,n){return r.call(this,new Ta,t,n)||this}return e})(hn);function Jr(r){const e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${e}-${t}-${n}`}const vl=r=>r.toLocaleDateString("fr-FR",{weekday:"long"}).toLowerCase();function mi(r){const e=(r||"").trim();try{const n=new URL(e).pathname.split("/").filter(Boolean),a=n.findIndex(i=>i.toLowerCase()==="r");return a>=0&&n[a+1]?decodeURIComponent(n[a+1]):decodeURIComponent(n[n.length-1]||e)}catch{return e}}function yl(r){return r?typeof r=="string"?r:typeof r.getText=="function"?r.getText():typeof r.text=="string"?r.text:String(r):""}function Qu(r){return r.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Xt(r){return Qu((r||"").toLowerCase()).replace(/[^a-z0-9]+/g," ").replace(/\s+/g," ").trim()}function ba(r){if(!r)return null;const e=r.trim().match(/^(\d{1,2}):(\d{2})$/);return e?e[1].padStart(2,"0")+":"+e[2]:null}function Xr(r){if(!r)return null;if(typeof r=="string"){const e=r.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=e.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/);return t?`${t[3]}-${t[2].padStart(2,"0")}-${t[1].padStart(2,"0")}`:null}if(typeof r=="object"&&"seconds"in r){const e=new Date(r.seconds*1e3);return Jr(e)}return r instanceof Date?Jr(r):null}async function gi(r,e,t,n){const a={city:h=>h?Qu(h).toLowerCase().trim():"",date:h=>h?Xr(h):null,time:h=>h?ba(h):null},i={dep:a.city(n==null?void 0:n.dep),arr:a.city(n==null?void 0:n.arr),date:a.date(n==null?void 0:n.date),heure:a.time(n==null?void 0:n.heure),id:(n==null?void 0:n.weeklyTripId)||null},o=h=>{let p=0;const g=a.city(h.depart),y=a.city(h.arrivee||h.arrival),x=a.date(h.date),v=a.time(h.heure);return i.id&&h.trajetId&&h.trajetId===i.id&&(p+=100),g&&i.dep&&g===i.dep&&(p+=20),y&&i.arr&&y===i.arr&&(p+=20),x&&i.date&&x===i.date&&(p+=30),v&&i.heure&&v===i.heure&&(p+=10),p},s=h=>{if(h.empty)return null;let p=null,g=-1;return h.docs.forEach(y=>{const x=o(y.data());x>g&&(g=x,p=y)}),p||h.docs[0]};if(e){const h=le(j,`companies/${r}/agences/${e}/reservations`,t),p=await pt(h);if(p.exists())return{resId:p.id,agencyId:e};const g=Pe(ce(j,`companies/${r}/agences/${e}/reservations`),me("referenceCode","==",t)),y=await xe(g),x=s(y);if(x)return{resId:x.id,agencyId:e}}const l=await xe(ce(j,`companies/${r}/agences`));for(const h of l.docs){const p=le(j,`companies/${r}/agences/${h.id}/reservations`,t),g=await pt(p);if(g.exists())return{resId:g.id,agencyId:h.id}}let c=null,d=null,f=-1;for(const h of l.docs){const p=Pe(ce(j,`companies/${r}/agences/${h.id}/reservations`),me("referenceCode","==",t)),g=await xe(p);if(!g.empty){const y=s(g);if(y){const x=o(y.data());x>f&&(f=x,c=y,d=h.id)}}}return c&&d?{resId:c.id,agencyId:d}:null}const _g=()=>{var Ee;const{user:r,company:e}=Tt(),t=Ur(),n={primary:(e==null?void 0:e.couleurPrimaire)||"#0ea5e9",secondary:(e==null?void 0:e.couleurSecondaire)||"#f59e0b",bg:"#f7f8fa"},a=(r==null?void 0:r.companyId)??null,i=(r==null?void 0:r.agencyId)??null,o=(r==null?void 0:r.uid)??null,[s,l]=N.useState([]),[c,d]=N.useState(i),[f,h]=N.useState(null),[p,g]=N.useState(((Ee=t.state)==null?void 0:Ee.date)||Jr(new Date)),[y,x]=N.useState([]),[v,b]=N.useState(null),[_,w]=N.useState([]),[A,C]=N.useState(!1),[I,R]=N.useState(""),[F,T]=N.useState(!1),U=N.useRef(null),L=N.useRef(null),B=N.useRef(0),H=N.useRef(0),[Q,ae]=N.useState({});N.useEffect(()=>{(async()=>{if(!a)return;if(i){if(!s.length){const M=(await xe(ce(j,`companies/${a}/agences`))).docs.map(Z=>{var V,Y;return{id:Z.id,nom:((V=Z.data())==null?void 0:V.nom)||((Y=Z.data())==null?void 0:Y.name)||Z.id}});l(M)}return}const O=(await xe(ce(j,`companies/${a}/agences`))).docs.map(P=>{var M,Z;return{id:P.id,nom:((M=P.data())==null?void 0:M.nom)||((Z=P.data())==null?void 0:Z.name)||P.id}});l(O),O.length===1&&d(O[0].id)})()},[a,i,s.length]),N.useEffect(()=>{if(!a||!c){h(null);return}const E=le(j,`companies/${a}/agences/${c}`);pt(E).then(O=>{O.exists()&&h({id:O.id,...O.data()})})},[a,c]),N.useEffect(()=>{if(ae({}),!a||!c||!v||!p)return;const E=`${(v.departure||"").trim()}_${(v.arrival||"").trim()}_${(v.heure||"").trim()}_${p}`.replace(/\s+/g,"-"),O=le(j,`companies/${a}/agences/${c}/affectations/${E}`);pt(O).then(P=>{if(P.exists()){const M=P.data();ae({bus:(M==null?void 0:M.busNumber)||(M==null?void 0:M.bus)||"",immat:(M==null?void 0:M.immatriculation)||(M==null?void 0:M.immat)||"",chauffeur:(M==null?void 0:M.chauffeur)||"",chef:(M==null?void 0:M.chefEmbarquement)||(M==null?void 0:M.chef)||""})}}).catch(()=>{})},[a,c,v,p]),N.useEffect(()=>{const E=t.state;if(!(E!=null&&E.trajet)||!(E!=null&&E.heure))return;const[O,P]=E.trajet.split("â†’").map(M=>M.trim());b({departure:O||"",arrival:P||"",heure:E.heure}),E.date&&g(E.date)},[t.state]),N.useEffect(()=>{(async()=>{if(!a||!c){x([]);return}const O=ce(j,`companies/${a}/agences/${c}/weeklyTrips`),P=await xe(O),M=vl(new Date(p)),Z=P.docs.map(V=>({id:V.id,...V.data()})).filter(V=>{var Y,ee;return V.active&&((ee=(Y=V.horaires)==null?void 0:Y[M])==null?void 0:ee.length)>0});if(x(Z),v&&!v.id){const V=Z.find(Y=>Y.departure===v.departure&&Y.arrival===v.arrival&&(Y.horaires[M]||[]).includes(v.heure));V&&b(Y=>Y&&{...Y,id:V.id})}})()},[a,c,p]),N.useEffect(()=>{if(!a||!c){w([]);return}if(!v||!v.departure||!v.arrival||!v.heure){w([]);return}C(!0),w([]);const E=ce(j,`companies/${a}/agences/${c}/reservations`),O=[],P=new Map,M=()=>{const V=Array.from(P.values()).sort((Y,ee)=>{const ge=!!(Y.canal==="report"||Y.sourceReservationId),ue=!!(ee.canal==="report"||ee.sourceReservationId);return ge!==ue?ge?-1:1:(Y.nomClient||"").localeCompare(ee.nomClient||"")});w(V),C(!1)},Z=Pe(E,me("date","==",p),me("depart","==",v.departure),me("arrivee","==",v.arrival),me("heure","==",v.heure),me("statut","in",["payÃ©","validÃ©","embarquÃ©"]));if(O.push(lr(Z,V=>{V.docs.forEach(Y=>P.set(Y.id,{id:Y.id,...Y.data()})),M()},()=>C(!1))),v.id){const V=Pe(E,me("date","==",p),me("trajetId","==",v.id),me("heure","==",v.heure),me("statut","in",["payÃ©","validÃ©","embarquÃ©"]));O.push(lr(V,Y=>{Y.docs.forEach(ee=>P.set(ee.id,{id:ee.id,...ee.data()})),M()},()=>C(!1)))}return()=>O.forEach(V=>V())},[a,c,v,p]);const W=N.useCallback(async(E,O,P)=>{if(!a||!o)return;const M=P??c;if(!M){alert("SÃ©lectionne dâ€™abord une agence.");return}if(!v||!p){alert("SÃ©lectionne la date et le trajet avant dâ€™embarquer.");return}const Z=le(j,`companies/${a}/agences/${M}/reservations/${E}`);try{await Ss(j,async V=>{const Y=await V.get(Z);if(!Y.exists())throw new Error("RÃ©servation introuvable");const ee=Y.data(),ge=Xt(ee.depart),ue=Xt(ee.arrivee||ee.arrival),Ne=ba(ee.heure||""),st=Xr(ee.date),rt=Xt(v.departure),rr=Xt(v.arrival),Uf=ba(v.heure),vs=Xr(p),ys=!!(ee.trajetId&&(v!=null&&v.id)&&ee.trajetId===v.id),$f=ge===rt&&ue===rr&&Ne===Uf&&st===vs,Hf=ge===rt&&ue===rr&&st===vs;let xs=!1;const Za=(v==null?void 0:v.id)??ee.trajetId??null,Qa=ee.trajetId??null;if(!ys&&(Za||Qa))try{let vn=null,aa=null;if(v!=null&&v.id){const Sr=le(j,`companies/${a}/agences/${M}/weeklyTrips/${v.id}`),Wt=await V.get(Sr);if(Wt.exists()){const $e=Wt.data();vn={departure:$e==null?void 0:$e.departure,arrival:$e==null?void 0:$e.arrival}}}else if(Za){const Sr=le(j,`companies/${a}/agences/${M}/weeklyTrips/${Za}`),Wt=await V.get(Sr);if(Wt.exists()){const $e=Wt.data();vn={departure:$e==null?void 0:$e.departure,arrival:$e==null?void 0:$e.arrival}}}if(Qa){const Sr=le(j,`companies/${a}/agences/${M}/weeklyTrips/${Qa}`),Wt=await V.get(Sr);if(Wt.exists()){const $e=Wt.data();aa={departure:$e==null?void 0:$e.departure,arrival:$e==null?void 0:$e.arrival}}}if(vn&&aa){const Sr=Xt(vn.departure),Wt=Xt(vn.arrival),$e=Xt(aa.departure),zf=Xt(aa.arrival);xs=Sr===$e&&Wt===zf}}catch{}if(!(ys||$f||Hf||xs))throw new Error("Billet pour un autre dÃ©part (date/heure/trajet non concordants).");if(ee.statutEmbarquement==="embarquÃ©"&&O==="embarquÃ©")throw new Error("DÃ©jÃ  embarquÃ©");const bs=le(j,`companies/${a}/agences/${M}/boardingLocks/${E}`),ws=await V.get(bs);if(ws.exists()&&O==="embarquÃ©")throw new Error("DÃ©jÃ  embarquÃ©");O==="embarquÃ©"&&!ws.exists()&&V.set(bs,{reservationId:E,by:o,at:it(),tripId:(v==null?void 0:v.id)??ee.trajetId??null,date:p,heure:(v==null?void 0:v.heure)??ee.heure??null});const As={statutEmbarquement:O,controleurId:o,checkInTime:O==="embarquÃ©"?it():null};O==="embarquÃ©"&&(As.statut="embarquÃ©"),V.update(Z,As);const Gf=ce(j,`companies/${a}/agences/${M}/boardingLogs`);V.set(le(Gf),{reservationId:E,trajetId:(v==null?void 0:v.id)??ee.trajetId??null,departure:(v==null?void 0:v.departure)??ee.depart,arrival:(v==null?void 0:v.arrival)??ee.arrivee??ee.arrival,date:p,heure:(v==null?void 0:v.heure)??ee.heure,result:(O==="embarquÃ©"?"EMBARQUE":O).toUpperCase(),controleurId:o,scannedAt:it()})});try{new Audio("/beep.mp3").play()}catch{}}catch(V){const Y=String((V==null?void 0:V.message)||V||"");Y.includes("DÃ©jÃ  embarquÃ©")?alert("Billet dÃ©jÃ  embarquÃ©."):Y.includes("non concordants")?alert("Billet pour un autre dÃ©part (date/heure/trajet non concordants)."):alert("Erreur dâ€™embarquement."),console.error("[EMBARK][ERROR]",V)}},[a,c,o,v==null?void 0:v.id,v==null?void 0:v.departure,v==null?void 0:v.arrival,v==null?void 0:v.heure,p]);async function X(E,O,P,M,Z){var ee;let V=null;if(M.id){const ge=await pt(le(E,`companies/${O}/agences/${P}/weeklyTrips/${M.id}`));ge.exists()&&(V={id:ge.id,...ge.data()})}if(!V){const ge=ce(E,`companies/${O}/agences/${P}/weeklyTrips`);V=(await xe(ge)).docs.map(Ne=>({id:Ne.id,...Ne.data()})).find(Ne=>Ne.active&&Ne.departure===M.departure&&Ne.arrival===M.arrival)||null}if(!V)throw new Error("Trajet hebdo introuvable.");const Y=new Date(`${Z}T${M.heure||"00:00"}:00`);for(let ge=0;ge<14;ge++){const ue=new Date(Y);ue.setDate(ue.getDate()+ge);const Ne=ue.toLocaleDateString("fr-FR",{weekday:"long"}).toLowerCase(),st=(((ee=V.horaires)==null?void 0:ee[Ne])||[]).slice().sort();if(st.length)if(ge===0){const rt=st.filter(rr=>rr>M.heure);if(rt.length)return{date:Z,heure:rt[0]}}else return{date:Jr(ue),heure:st[0]}}throw new Error("Aucun prochain dÃ©part disponible.")}N.useCallback(async E=>{if(!a||!c||!o||!v||!p){alert("Contexte incomplet (agence, trajet ou date manquants).");return}const O=le(j,`companies/${a}/agences/${c}/reservations/${E}`),P=await pt(O);if(!P.exists())return alert("RÃ©servation introuvable.");const M=P.data();if(!(M.noShowAt||M.reprogrammedOnce===!0))try{const Z=await X(j,a,c,{id:M.trajetId||v.id,departure:M.depart||v.departure,arrival:M.arrivee||M.arrival||v.arrival,heure:M.heure||v.heure},Xr(M.date)||p),V=Is(j);V.update(O,{statutEmbarquement:"absent",noShowAt:it(),noShowBy:o,reprogrammedOnce:!0});const Y=le(ce(j,`companies/${a}/agences/${c}/reservations`));V.set(Y,{companyId:a,agencyId:c,depart:M.depart,arrivee:M.arrivee||M.arrival,trajetId:M.trajetId||v.id||null,date:Z.date,heure:Z.heure,nomClient:M.nomClient,telephone:M.telephone,seatsGo:M.seatsGo||1,canal:"report",statut:"validÃ©",statutEmbarquement:"en_attente",sourceReservationId:E,createdBy:o,createdAt:it()});const ee=le(ce(j,`companies/${a}/agences/${c}/boardingLogs`));V.set(ee,{reservationId:E,trajetId:M.trajetId||v.id||null,departure:M.depart,arrival:M.arrivee||M.arrival,date:p,heure:v.heure,result:"ABSENT_REPROG",nextDate:Z.date,nextHeure:Z.heure,controleurId:o,scannedAt:it()}),await V.commit()}catch(Z){console.error(Z)}},[a,c,o,v,p]);const z=N.useMemo(()=>{if(!v||!p)return null;const E=Xt(v.departure),O=Xt(v.arrival),P=ba(v.heure),M=Xr(p);return!E||!O||!P||!M?null:`${E}_${O}_${P}_${M}`},[v,p]),[ie,J]=N.useState(!1);N.useEffect(()=>{if(!a||!c||!z){J(!1);return}const E=le(j,`companies/${a}/agences/${c}/boardingClosures/${z}`),O=lr(E,P=>J(P.exists()));return()=>O()},[a,c,z]);const K=N.useCallback(async()=>{if(!a||!c||!o||!v||!p){alert("Contexte incomplet (agence, trajet ou date manquants).");return}if(_.length===0){alert("Aucune rÃ©servation Ã  traiter.");return}if(!z){alert("Trajet invalide.");return}const E=le(j,`companies/${a}/agences/${c}/boardingClosures/${z}`);try{await Ss(j,async P=>{if((await P.get(E)).exists())throw new Error("DEJA_CLOTURE");for(const Z of _)if(!(Z.statutEmbarquement==="embarquÃ©")){const Y=le(j,`companies/${a}/agences/${c}/reservations/${Z.id}`);P.update(Y,{statutEmbarquement:"absent",noShowAt:it(),noShowBy:o})}P.set(E,{closedAt:it(),closedBy:o,date:p,heure:v.heure,departure:v.departure,arrival:v.arrival})});const O=Is(j);for(const P of _)if(!(P.statutEmbarquement==="embarquÃ©"||P.reprogrammedOnce===!0||!(await xe(Pe(ce(j,`companies/${a}/agences/${c}/reservations`),me("sourceReservationId","==",P.id),dn(1)))).empty))try{const V=await X(j,a,c,{id:P.trajetId||v.id,departure:P.depart||v.departure,arrival:P.arrivee||P.arrival||v.arrival,heure:P.heure||v.heure},Xr(P.date)||p),Y=le(ce(j,`companies/${a}/agences/${c}/reservations`));O.set(Y,{companyId:a,agencyId:c,depart:P.depart,arrivee:P.arrivee||P.arrival,trajetId:P.trajetId||v.id||null,date:V.date,heure:V.heure,nomClient:P.nomClient,telephone:P.telephone,seatsGo:P.seatsGo||1,canal:"report",statut:"validÃ©",statutEmbarquement:"en_attente",sourceReservationId:P.id,createdBy:o,createdAt:it()});const ee=le(j,`companies/${a}/agences/${c}/reservations/${P.id}`);O.update(ee,{reprogrammedOnce:!0});const ge=le(ce(j,`companies/${a}/agences/${c}/boardingLogs`));O.set(ge,{reservationId:P.id,trajetId:P.trajetId||v.id||null,departure:P.depart,arrival:P.arrivee||P.arrival,date:p,heure:v.heure,result:"ABSENT_REPROG",nextDate:V.date,nextHeure:V.heure,controleurId:o,scannedAt:it()})}catch(V){console.warn("Pas de prochain dÃ©part pour",P.id,V)}await O.commit(),alert("ClÃ´ture effectuÃ©e. Absents marquÃ©s et reprogrammÃ©s (si possible).")}catch(O){String((O==null?void 0:O.message)||O)==="DEJA_CLOTURE"?alert("DÃ©jÃ  clÃ´turÃ© : aucune action rÃ©pÃ©tÃ©e."):(console.error(O),alert("Erreur lors de la clÃ´ture."))}},[a,c,o,v,p,_,z]),[pe,Ue]=N.useState(""),be=N.useCallback(async E=>{if(E.preventDefault(),!a)return;const O=mi(pe);if(O)try{const P=await gi(a,c,O,v?{dep:v.departure,arr:v.arrival,date:p,heure:v.heure,weeklyTripId:v.id||null}:void 0);P?(await W(P.resId,"embarquÃ©",P.agencyId),Ue("")):alert("RÃ©servation introuvable.")}catch(P){console.error(P),alert("Erreur lors de la validation manuelle.")}},[pe,a,c,W,v,p]);N.useEffect(()=>{var O,P,M,Z;if(!F){(P=(O=L.current)==null?void 0:O.reset)==null||P.call(O),L.current=null,(M=U.current)!=null&&M.srcObject&&((Z=U.current.srcObject)==null||Z.getTracks().forEach(V=>V.stop()),U.current.srcObject=null);return}const E=new gl;return L.current=E,(async()=>{var V;try{await E.decodeFromConstraints({video:{facingMode:{ideal:"environment"}}},U.current,async Y=>{const ee=Date.now();if(!Y||ee-B.current<1200)return;B.current=ee;const ge=yl(Y),ue=mi(ge);try{const Ne=await gi(a,c,ue,v?{dep:v.departure,arr:v.arrival,date:p,heure:v.heure,weeklyTripId:v.id||null}:void 0);Ne?await W(Ne.resId,"embarquÃ©",Ne.agencyId):ee-H.current>2e3&&(H.current=ee,alert("Billet introuvable."))}catch(Ne){console.error(Ne),ee-H.current>2e3&&(H.current=ee,alert("Erreur lors du scan"))}})}catch{const Y=await gl.listVideoInputDevices(),ee=((V=Y==null?void 0:Y[0])==null?void 0:V.deviceId)??null;await E.decodeFromVideoDevice(ee,U.current,async ge=>{const ue=Date.now();if(!ge||ue-B.current<1200)return;B.current=ue;const Ne=yl(ge),st=mi(Ne);try{const rt=await gi(a,c,st,v?{dep:v.departure,arr:v.arrival,date:p,heure:v.heure,weeklyTripId:v.id||null}:void 0);rt?await W(rt.resId,"embarquÃ©",rt.agencyId):ue-H.current>2e3&&(H.current=ue,alert("Billet introuvable."))}catch(rt){console.error(rt),ue-H.current>2e3&&(H.current=ue,alert("Erreur lors du scan"))}})}})(),()=>{var V,Y,ee,ge;(Y=(V=L.current)==null?void 0:V.reset)==null||Y.call(V),L.current=null,(ee=U.current)!=null&&ee.srcObject&&((ge=U.current.srcObject)==null||ge.getTracks().forEach(ue=>ue.stop()),U.current.srcObject=null)}},[F,a,c,W,v,p]);const At=N.useMemo(()=>{const E=I.toLowerCase().trim();return E?_.filter(O=>(O.nomClient||"").toLowerCase().includes(E)||(O.telephone||"").includes(I)):_},[_,I]),ze=N.useMemo(()=>{let E=0,O=0,P=0,M=0;for(const Z of _){const V=Z.seatsGo??1;E+=1,O+=V,Z.statutEmbarquement==="embarquÃ©"&&(P+=V),Z.statutEmbarquement==="absent"&&(M+=V)}return{totalRes:E,totalSeats:O,seatsEmbarques:P,seatsAbsents:M}},[_]),fe=N.useMemo(()=>{try{const E=new Date(p+"T00:00:00");return Iu(E,"dd/MM/yyyy")}catch{return p}},[p]),Me=N.useMemo(()=>vl(new Date(p)),[p]),Re=N.useMemo(()=>y.length?y.flatMap(E=>(E.horaires[Me]||[]).map(O=>{const P=(v==null?void 0:v.departure)===E.departure&&(v==null?void 0:v.arrival)===E.arrival&&(v==null?void 0:v.heure)===O;return m("button",{onClick:()=>b({id:E.id,departure:E.departure,arrival:E.arrival,heure:O}),className:`px-3 py-2 rounded-lg text-sm font-medium shadow-sm ${P?"text-white":"bg-gray-200 text-gray-700"}`,style:P?{background:n.primary}:void 0,children:[E.departure," â†’ ",E.arrival," Ã  ",O]},`${E.id}_${O}`)})):[],[y,Me,v,n.primary]);return r?m("div",{className:"min-h-screen",style:{background:n.bg},children:[u("style",{children:`
        .brand-logo{height:40px;width:auto;object-fit:contain}
        .case{display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;border:2px solid #0f172a;border-radius:6px;background:#fff;cursor:pointer;user-select:none}
        .case[data-checked="true"]::after{content:"âœ“";font-weight:700}

        tr.embarked { background:#f8fafc; color:#334155; }

        .thin-table { table-layout: fixed; }
        .thin-table th, .thin-table td { padding: 6px 8px; }
        .col-idx{width:40px}
        .col-client{width:24%}
        .col-phone{width:14%}
        .col-canal{width:12%}
        .col-ref{width:18%}
        .col-seats{width:8%}
        .col-emb{width:8%}
        .col-abs{width:8%}

        @media (max-width: 640px){
          .col-client{width:38%}
          .col-phone{width:18%}
          .col-ref{width:22%}
        }

        /* Header imprimable centrÃ© */
        #print-area .title{ text-align:center; font-weight:800; font-size:18px; }
        #print-area .subtitle{ text-align:center; color:#334155; font-size:14px; margin-top:2px; }

        #print-area .meta-card {
          border: 1px solid #e5e7eb;
          background: #f9fafb;
          border-radius: 0.5rem;
          padding: 0.5rem 0.75rem;
        }

        /* zones signatures Ã©purÃ©es */
        #print-area .sig-box {
          border: 1px solid #000;
          min-height: 28mm;
          border-radius: 6px;
        }
        #print-area .sig-caption { text-align:center; margin-top:6px; }

        @media print{
          body * { visibility: hidden; }
          #print-area, #print-area * { visibility: visible; }
          #print-area { position: absolute; inset: 0; padding: 0 8mm; }
          .brand-logo{height:26px}
          .case{width:14px;height:14px;border:1.5px solid #000;border-radius:0}
          .case::after{font-size:12px;line-height:1}
          tr.embarked { background:transparent !important; color:inherit !important; }
        }
      `}),m("div",{className:"max-w-6xl mx-auto px-4 py-6 space-y-6",children:[m("div",{className:"bg-white rounded-xl border p-4 shadow-sm space-y-3",children:[m("div",{className:"flex flex-wrap items-center gap-3",children:[m("div",{className:"flex items-center gap-2",children:[u("span",{className:"font-semibold",style:{color:n.secondary},children:"Agence :"}),c?u("span",{className:"px-2 py-1 rounded border bg-gray-50 text-sm",children:(f==null?void 0:f.nomAgence)||"â€”"}):m("select",{className:"px-2 py-1 border rounded text-sm",value:c||"",onChange:E=>d(E.target.value||null),children:[u("option",{value:"",children:"â€” Choisir une agence â€”"}),s.map(E=>u("option",{value:E.id,children:E.nom},E.id))]})]}),u("span",{className:"font-semibold",style:{color:n.secondary},children:"Date :"}),u("button",{className:"px-2 py-1 rounded border",onClick:()=>{const E=new Date(p);E.setDate(E.getDate()-1),g(Jr(E))},children:"â—€ Jour prÃ©cÃ©dent"}),u("input",{type:"date",className:"border rounded px-3 py-1",value:p,onChange:E=>g(E.target.value)}),u("button",{className:"px-2 py-1 rounded border",onClick:()=>{const E=new Date(p);E.setDate(E.getDate()+1),g(Jr(E))},children:"Jour suivant â–¶"})]}),u("div",{className:"font-semibold",children:"SÃ©lectionner un trajet"}),u("div",{className:"flex flex-wrap gap-2",children:c?y.length===0?u("div",{className:"text-gray-500",children:"Aucun trajet planifiÃ© pour cette date"}):Re:u("div",{className:"text-gray-500",children:"Choisissez dâ€™abord une agence."})})]}),m("div",{className:"bg-white rounded-xl border shadow-sm",children:[m("div",{className:"px-4 pt-4 flex flex-wrap items-center gap-3",children:[u("div",{className:"text-sm text-gray-500",children:"Trajet"}),u("div",{className:"font-semibold",children:v?m(bt,{children:[v.departure," â€” ",v.arrival," â€¢ ",fe," Ã  ",v.heure]}):"Aucun trajet sÃ©lectionnÃ©"}),m("div",{className:"ml-auto flex items-center gap-2 text-xs",children:[m("div",{className:"px-2 py-1 rounded bg-gray-100 border",children:[u("span",{className:"text-gray-500",children:"RÃ©servations:"})," ",u("b",{children:ze.totalRes})]}),m("div",{className:"px-2 py-1 rounded bg-gray-100 border",children:[u("span",{className:"text-gray-500",children:"Places:"})," ",u("b",{children:ze.totalSeats})]}),m("div",{className:"px-2 py-1 rounded bg-gray-100 border",children:[u("span",{className:"text-gray-500",children:"EmbarquÃ©es:"})," ",u("b",{children:ze.seatsEmbarques})]}),m("div",{className:"px-2 py-1 rounded bg-gray-100 border",children:[u("span",{className:"text-gray-500",children:"Absentes:"})," ",u("b",{children:ze.seatsAbsents})]})]})]}),m("div",{className:"px-4 pb-3 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[m("div",{className:"border rounded-lg p-3 bg-gray-50",children:[u("div",{className:"text-xs text-gray-500 mb-1",children:"Bus / Immat"}),u("div",{className:"font-medium",children:Q.bus||Q.immat?`${Q.bus||"â€”"} / ${Q.immat||"â€”"}`:"â€” / â€”"})]}),m("div",{className:"border rounded-lg p-3 bg-gray-50",children:[u("div",{className:"text-xs text-gray-500 mb-1",children:"Chauffeur"}),u("div",{className:"font-medium",children:Q.chauffeur||"â€”"})]}),m("div",{className:"border rounded-lg p-3 bg-gray-50",children:[u("div",{className:"text-xs text-gray-500 mb-1",children:"ContrÃ´leur"}),u("div",{className:"font-medium",children:Q.chef||"â€”"})]})]}),m("div",{className:"px-4 pb-3 flex flex-wrap items-center gap-3",children:[u("input",{type:"text",placeholder:"Rechercher nom / tÃ©lÃ©phoneâ€¦",value:I,onChange:E=>R(E.target.value),className:"px-3 py-2 border rounded-lg text-sm"}),u("button",{type:"button",onClick:()=>T(E=>!E),className:`px-3 py-2 rounded-lg text-sm ${F?"bg-emerald-600 text-white":"bg-gray-200 text-gray-700"}`,title:"Activer le scanner (QR / code-barres)",disabled:!v||!c,children:F?"Scanner ON":"Scanner OFF"}),u("button",{type:"button",onClick:()=>window.print(),className:"px-3 py-2 rounded-lg text-sm border",title:"Imprimer la liste",children:"ðŸ–¨ï¸ Imprimer"}),u("button",{type:"button",onClick:K,className:`px-3 py-2 rounded-lg text-sm ${ie?"bg-gray-300 text-gray-600":"bg-red-600 text-white"}`,title:ie?"DÃ©jÃ  clÃ´turÃ©":"ClÃ´turer lâ€™embarquement",disabled:!v||!c||ie,children:ie?"ClÃ´turÃ©":"ðŸš ClÃ´turer"})]}),F&&u("div",{className:"px-4 pb-4",children:u("video",{ref:U,className:"w-full max-w-md aspect-video bg-black rounded-lg overflow-hidden",muted:!0,playsInline:!0,autoPlay:!0})})]}),m("div",{className:"bg-white rounded-xl border shadow-sm p-4",children:[u("div",{className:"text-sm font-semibold mb-2",style:{color:n.secondary},children:"Saisir une rÃ©fÃ©rence"}),m("form",{onSubmit:be,className:"flex gap-2",children:[u("input",{value:pe,onChange:E=>Ue(E.target.value),placeholder:"ID Firestore ou rÃ©fÃ©rence (REF-â€¦ / MT-â€¦)",className:"flex-1 px-3 py-2 border rounded-lg text-sm"}),u("button",{type:"submit",className:"px-3 py-2 rounded-lg text-white text-sm",style:{background:n.primary},disabled:!c&&!i,children:"Valider"})]})]}),m("div",{id:"print-area",className:"bg-white rounded-xl border shadow-sm",children:[m("div",{className:"px-4 pt-4",children:[u("div",{className:"flex items-center justify-between gap-3",children:m("div",{className:"flex items-center gap-3",children:[(e==null?void 0:e.logoUrl)&&u("img",{src:e.logoUrl,alt:e==null?void 0:e.nom,className:"brand-logo"}),m("div",{children:[u("div",{className:"font-extrabold text-lg",children:(e==null?void 0:e.nom)??"â€”"}),m("div",{className:"text-xs text-gray-500",children:[(f==null?void 0:f.nomAgence)||"Agence"," â€¢ Tel. ",(f==null?void 0:f.telephone)||"â€”"]})]})]})}),m("div",{className:"mt-2",children:[u("div",{className:"title",children:"Liste dâ€™embarquement"}),v&&m("div",{className:"subtitle",children:[v.departure," â†’ ",v.arrival," â€¢ ",fe," â€¢ ",v.heure]})]}),m("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-4 gap-2",children:[m("div",{className:"meta-card",children:[u("div",{className:"text-xs text-gray-500",children:"Bus / Immat"}),u("div",{className:"font-medium",children:(Q.bus||"â€”")+" / "+(Q.immat||"â€”")})]}),m("div",{className:"meta-card",children:[u("div",{className:"text-xs text-gray-500",children:"Chauffeur"}),u("div",{className:"font-medium",children:Q.chauffeur||"â€”"})]}),m("div",{className:"meta-card",children:[u("div",{className:"text-xs text-gray-500",children:"ContrÃ´leur"}),u("div",{className:"font-medium",children:Q.chef||"â€”"})]}),m("div",{className:"meta-card",children:[u("div",{className:"text-xs text-gray-500",children:"Totaux"}),m("div",{className:"font-medium",children:["R: ",ze.totalRes," â€¢ P: ",ze.totalSeats," â€¢ E: ",ze.seatsEmbarques," â€¢ A: ",ze.seatsAbsents]})]})]})]}),u("div",{className:"overflow-x-auto mt-3",children:m("table",{className:"w-full text-sm thin-table",children:[m("colgroup",{children:[u("col",{className:"col-idx"}),u("col",{className:"col-client"}),u("col",{className:"col-phone"}),u("col",{className:"col-canal"}),u("col",{className:"col-ref"}),u("col",{className:"col-seats"}),u("col",{className:"col-emb"}),u("col",{className:"col-abs"})]}),u("thead",{className:"bg-gray-50",children:m("tr",{children:[u("th",{className:"text-left",children:"#"}),u("th",{className:"text-left",children:"Client"}),u("th",{className:"text-left",children:"TÃ©lÃ©phone"}),u("th",{className:"text-left",children:"Canal"}),u("th",{className:"text-left",children:"RÃ©fÃ©rence"}),u("th",{className:"text-center",children:"Places"}),u("th",{className:"text-center",children:"EmbarquÃ©"}),u("th",{className:"text-center",children:"Absent"})]})}),u("tbody",{children:A?u("tr",{children:u("td",{className:"py-4 text-gray-500",colSpan:8,children:"Chargementâ€¦"})}):At.length===0?u("tr",{children:u("td",{className:"py-4 text-gray-400",colSpan:8,children:"Aucun passager trouvÃ©"})}):At.map((E,O)=>{const P=E.statutEmbarquement==="embarquÃ©",M=E.statutEmbarquement==="absent",Z=E.seatsGo??1;return m("tr",{className:`border-t ${P?"embarked":""}`,children:[u("td",{children:O+1}),u("td",{className:"truncate",children:E.nomClient||"â€”"}),u("td",{className:"truncate",children:E.telephone||"â€”"}),u("td",{className:"capitalize truncate",children:E.canal||"â€”"}),u("td",{className:"truncate",children:E.referenceCode||E.id}),u("td",{className:"text-center font-semibold",children:Z}),u("td",{className:"text-center",children:u("button",{className:"case","data-checked":P,onClick:()=>W(E.id,P?"en_attente":"embarquÃ©"),title:"Basculer EmbarquÃ©"})}),u("td",{className:"text-center",children:u("button",{className:"case","data-checked":M,onClick:()=>W(E.id,M?"en_attente":"absent"),title:"Basculer Absent"})})]},E.id)})})]})}),u("div",{className:"px-4 py-6 text-sm",children:m("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[m("div",{children:[u("div",{className:"sig-box"}),u("div",{className:"sig-caption",children:"ContrÃ´leur / Chef dâ€™embarquement â€” Nom & Signature"})]}),m("div",{children:[u("div",{className:"sig-box"}),u("div",{className:"sig-caption",children:"Chauffeur â€” Nom & Signature"})]}),m("div",{children:[u("div",{className:"sig-box"}),u("div",{className:"sig-caption",children:"Visa Agence"})]})]})})]})]})]}):u("div",{className:"min-h-screen grid place-items-center text-gray-600",children:"Chargementâ€¦"})},Eg=()=>{const e=Ur().state,t=Iu(new Date,"dd/MM/yyyy");return m("div",{className:"bg-white text-black p-6 print:p-0 print:m-0",children:[u("div",{className:"print:hidden flex justify-end mb-4",children:u("button",{onClick:()=>{window.print(),setTimeout(()=>window.history.back(),500)},className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded",children:"ðŸ–¨ï¸ Imprimer"})}),m("div",{className:"print:block print:w-full print:max-w-4xl print:mx-auto print:my-0 print:bg-white print:text-black",children:[m("header",{className:"text-center border-b border-gray-300 pb-4 mb-6 print:pb-2 print:mb-4",children:[e.logoUrl&&u("img",{src:e.logoUrl,alt:"logo",className:"h-16 mx-auto mb-2 print:h-14"}),u("h1",{className:"text-xl font-bold print:text-lg",children:e.companyName}),m("div",{className:"text-xs text-gray-600 print:text-xs",children:[e.agencyName&&m("span",{children:[e.agencyName," - "]}),m("span",{children:["ImprimÃ© le ",t]})]}),m("h2",{className:"text-lg font-semibold mt-2 print:mt-1 print:text-base",children:["Liste des rÃ©servations pour le trajet :"," ",u("span",{className:"text-blue-600",children:e.trajet})]}),m("p",{className:"text-sm text-gray-700 print:text-xs",children:["DÃ©part le ",e.date," Ã  ",e.heure]})]}),m("table",{className:"w-full text-xs border border-gray-300 print:text-xs",children:[u("thead",{className:"bg-gray-100 print:bg-gray-100",children:m("tr",{children:[u("th",{className:"border px-2 py-1 w-8",children:"#"}),u("th",{className:"border px-2 py-1 text-left",children:"Nom du client"}),u("th",{className:"border px-2 py-1 text-left",children:"TÃ©lÃ©phone"}),u("th",{className:"border px-2 py-1 w-12",children:"Places"}),u("th",{className:"border px-2 py-1 text-right",children:"Montant"}),u("th",{className:"border px-2 py-1 text-center",children:"Statut"})]})}),u("tbody",{children:e.reservations.map((n,a)=>{var i;return m("tr",{className:"break-inside-avoid",children:[u("td",{className:"border px-2 py-1 text-center",children:a+1}),u("td",{className:"border px-2 py-1",children:n.nomClient}),u("td",{className:"border px-2 py-1",children:n.telephone}),u("td",{className:"border px-2 py-1 text-center",children:n.seatsGo||1}),m("td",{className:"border px-2 py-1 text-right",children:[(i=n.montant)==null?void 0:i.toLocaleString()," FCFA"]}),u("td",{className:"border px-2 py-1 text-center",children:u("span",{className:`inline-block px-1 rounded ${n.statut==="ConfirmÃ©"?"bg-green-100 text-green-800":n.statut==="En attente"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:n.statut})})]},n.id)})})]}),m("div",{className:"mt-2 text-right text-xs",children:["Total rÃ©servations: ",e.reservations.length," | Places totales: ",e.reservations.reduce((n,a)=>n+(a.seatsGo||1),0)," | Montant total: ",e.reservations.reduce((n,a)=>n+(a.montant||0),0).toLocaleString()," FCFA"]}),m("div",{className:"mt-6 text-right text-xs italic text-gray-700 print:mt-4",children:[u("div",{className:"border-t border-dashed border-gray-400 w-32 mb-1 ml-auto"}),"Signature du responsable"]}),m("footer",{className:"mt-8 text-center text-xs text-gray-500 print:mt-4",children:[m("p",{children:["Document imprimÃ© le ",t," - ",e.companyName]}),u("p",{className:"mt-1",children:"Merci pour votre confiance"})]})]})]})},Fo=N.createContext({});function Bo(r){const e=N.useRef(null);return e.current===null&&(e.current=r()),e.current}const Vo=typeof window<"u",Ju=Vo?N.useLayoutEffect:N.useEffect,Wa=N.createContext(null);function jo(r,e){r.indexOf(e)===-1&&r.push(e)}function Uo(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const ur=(r,e,t)=>t>e?e:t<r?r:t;let $o=()=>{};const dr={},ed=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r);function td(r){return typeof r=="object"&&r!==null}const rd=r=>/^0[^.\s]+$/u.test(r);function Ho(r){let e;return()=>(e===void 0&&(e=r()),e)}const jt=r=>r,Ng=(r,e)=>t=>e(r(t)),ea=(...r)=>r.reduce(Ng),jn=(r,e,t)=>{const n=e-r;return n===0?1:(t-r)/n};class Go{constructor(){this.subscriptions=[]}add(e){return jo(this.subscriptions,e),()=>Uo(this.subscriptions,e)}notify(e,t,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](e,t,n);else for(let i=0;i<a;i++){const o=this.subscriptions[i];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Qt=r=>r*1e3,Ft=r=>r/1e3;function nd(r,e){return e?r*(1e3/e):0}const ad=(r,e,t)=>(((1-3*t+3*e)*r+(3*t-6*e))*r+3*e)*r,Sg=1e-7,Ig=12;function Tg(r,e,t,n,a){let i,o,s=0;do o=e+(t-e)/2,i=ad(o,n,a)-r,i>0?t=o:e=o;while(Math.abs(i)>Sg&&++s<Ig);return o}function ta(r,e,t,n){if(r===e&&t===n)return jt;const a=i=>Tg(i,0,1,r,t);return i=>i===0||i===1?i:ad(a(i),e,n)}const id=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,od=r=>e=>1-r(1-e),sd=ta(.33,1.53,.69,.99),zo=od(sd),ld=id(zo),cd=r=>(r*=2)<1?.5*zo(r):.5*(2-Math.pow(2,-10*(r-1))),Wo=r=>1-Math.sin(Math.acos(r)),ud=od(Wo),dd=id(Wo),Rg=ta(.42,0,1,1),Og=ta(0,0,.58,1),fd=ta(.42,0,.58,1),Dg=r=>Array.isArray(r)&&typeof r[0]!="number",hd=r=>Array.isArray(r)&&typeof r[0]=="number",Pg={linear:jt,easeIn:Rg,easeInOut:fd,easeOut:Og,circIn:Wo,circInOut:dd,circOut:ud,backIn:zo,backInOut:ld,backOut:sd,anticipate:cd},Mg=r=>typeof r=="string",xl=r=>{if(hd(r)){$o(r.length===4);const[e,t,n,a]=r;return ta(e,t,n,a)}else if(Mg(r))return Pg[r];return r},da=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Lg(r,e){let t=new Set,n=new Set,a=!1,i=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1};function l(d){o.has(d)&&(c.schedule(d),r()),d(s)}const c={schedule:(d,f=!1,h=!1)=>{const g=h&&a?t:n;return f&&o.add(d),g.has(d)||g.add(d),d},cancel:d=>{n.delete(d),o.delete(d)},process:d=>{if(s=d,a){i=!0;return}a=!0,[t,n]=[n,t],t.forEach(l),t.clear(),a=!1,i&&(i=!1,c.process(d))}};return c}const kg=40;function pd(r,e){let t=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>t=!0,o=da.reduce((_,w)=>(_[w]=Lg(i),_),{}),{setup:s,read:l,resolveKeyframes:c,preUpdate:d,update:f,preRender:h,render:p,postRender:g}=o,y=()=>{const _=dr.useManualTiming?a.timestamp:performance.now();t=!1,dr.useManualTiming||(a.delta=n?1e3/60:Math.max(Math.min(_-a.timestamp,kg),1)),a.timestamp=_,a.isProcessing=!0,s.process(a),l.process(a),c.process(a),d.process(a),f.process(a),h.process(a),p.process(a),g.process(a),a.isProcessing=!1,t&&e&&(n=!1,r(y))},x=()=>{t=!0,n=!0,a.isProcessing||r(y)};return{schedule:da.reduce((_,w)=>{const A=o[w];return _[w]=(C,I=!1,R=!1)=>(t||x(),A.schedule(C,I,R)),_},{}),cancel:_=>{for(let w=0;w<da.length;w++)o[da[w]].cancel(_)},state:a,steps:o}}const{schedule:Fe,cancel:Ar,state:ut,steps:vi}=pd(typeof requestAnimationFrame<"u"?requestAnimationFrame:jt,!0);let wa;function Fg(){wa=void 0}const St={now:()=>(wa===void 0&&St.set(ut.isProcessing||dr.useManualTiming?ut.timestamp:performance.now()),wa),set:r=>{wa=r,queueMicrotask(Fg)}},md=r=>e=>typeof e=="string"&&e.startsWith(r),Xo=md("--"),Bg=md("var(--"),qo=r=>Bg(r)?Vg.test(r.split("/*")[0].trim()):!1,Vg=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,pn={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},Un={...pn,transform:r=>ur(0,1,r)},fa={...pn,default:1},On=r=>Math.round(r*1e5)/1e5,Yo=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function jg(r){return r==null}const Ug=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Ko=(r,e)=>t=>!!(typeof t=="string"&&Ug.test(t)&&t.startsWith(r)||e&&!jg(t)&&Object.prototype.hasOwnProperty.call(t,e)),gd=(r,e,t)=>n=>{if(typeof n!="string")return n;const[a,i,o,s]=n.match(Yo);return{[r]:parseFloat(a),[e]:parseFloat(i),[t]:parseFloat(o),alpha:s!==void 0?parseFloat(s):1}},$g=r=>ur(0,255,r),yi={...pn,transform:r=>Math.round($g(r))},kr={test:Ko("rgb","red"),parse:gd("red","green","blue"),transform:({red:r,green:e,blue:t,alpha:n=1})=>"rgba("+yi.transform(r)+", "+yi.transform(e)+", "+yi.transform(t)+", "+On(Un.transform(n))+")"};function Hg(r){let e="",t="",n="",a="";return r.length>5?(e=r.substring(1,3),t=r.substring(3,5),n=r.substring(5,7),a=r.substring(7,9)):(e=r.substring(1,2),t=r.substring(2,3),n=r.substring(3,4),a=r.substring(4,5),e+=e,t+=t,n+=n,a+=a),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const eo={test:Ko("#"),parse:Hg,transform:kr.transform},ra=r=>({test:e=>typeof e=="string"&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),pr=ra("deg"),Jt=ra("%"),oe=ra("px"),Gg=ra("vh"),zg=ra("vw"),bl={...Jt,parse:r=>Jt.parse(r)/100,transform:r=>Jt.transform(r*100)},en={test:Ko("hsl","hue"),parse:gd("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(r)+", "+Jt.transform(On(e))+", "+Jt.transform(On(t))+", "+On(Un.transform(n))+")"},qe={test:r=>kr.test(r)||eo.test(r)||en.test(r),parse:r=>kr.test(r)?kr.parse(r):en.test(r)?en.parse(r):eo.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?kr.transform(r):en.transform(r),getAnimatableNone:r=>{const e=qe.parse(r);return e.alpha=0,qe.transform(e)}},Wg=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Xg(r){var e,t;return isNaN(r)&&typeof r=="string"&&(((e=r.match(Yo))==null?void 0:e.length)||0)+(((t=r.match(Wg))==null?void 0:t.length)||0)>0}const vd="number",yd="color",qg="var",Yg="var(",wl="${}",Kg=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function $n(r){const e=r.toString(),t=[],n={color:[],number:[],var:[]},a=[];let i=0;const s=e.replace(Kg,l=>(qe.test(l)?(n.color.push(i),a.push(yd),t.push(qe.parse(l))):l.startsWith(Yg)?(n.var.push(i),a.push(qg),t.push(l)):(n.number.push(i),a.push(vd),t.push(parseFloat(l))),++i,wl)).split(wl);return{values:t,split:s,indexes:n,types:a}}function xd(r){return $n(r).values}function bd(r){const{split:e,types:t}=$n(r),n=e.length;return a=>{let i="";for(let o=0;o<n;o++)if(i+=e[o],a[o]!==void 0){const s=t[o];s===vd?i+=On(a[o]):s===yd?i+=qe.transform(a[o]):i+=a[o]}return i}}const Zg=r=>typeof r=="number"?0:qe.test(r)?qe.getAnimatableNone(r):r;function Qg(r){const e=xd(r);return bd(r)(e.map(Zg))}const Cr={test:Xg,parse:xd,createTransformer:bd,getAnimatableNone:Qg};function xi(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function Jg({hue:r,saturation:e,lightness:t,alpha:n}){r/=360,e/=100,t/=100;let a=0,i=0,o=0;if(!e)a=i=o=t;else{const s=t<.5?t*(1+e):t+e-t*e,l=2*t-s;a=xi(l,s,r+1/3),i=xi(l,s,r),o=xi(l,s,r-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}function Da(r,e){return t=>t>0?e:r}const je=(r,e,t)=>r+(e-r)*t,bi=(r,e,t)=>{const n=r*r,a=t*(e*e-n)+n;return a<0?0:Math.sqrt(a)},ev=[eo,kr,en],tv=r=>ev.find(e=>e.test(r));function Al(r){const e=tv(r);if(!e)return!1;let t=e.parse(r);return e===en&&(t=Jg(t)),t}const Cl=(r,e)=>{const t=Al(r),n=Al(e);if(!t||!n)return Da(r,e);const a={...t};return i=>(a.red=bi(t.red,n.red,i),a.green=bi(t.green,n.green,i),a.blue=bi(t.blue,n.blue,i),a.alpha=je(t.alpha,n.alpha,i),kr.transform(a))},to=new Set(["none","hidden"]);function rv(r,e){return to.has(r)?t=>t<=0?r:e:t=>t>=1?e:r}function nv(r,e){return t=>je(r,e,t)}function Zo(r){return typeof r=="number"?nv:typeof r=="string"?qo(r)?Da:qe.test(r)?Cl:ov:Array.isArray(r)?wd:typeof r=="object"?qe.test(r)?Cl:av:Da}function wd(r,e){const t=[...r],n=t.length,a=r.map((i,o)=>Zo(i)(i,e[o]));return i=>{for(let o=0;o<n;o++)t[o]=a[o](i);return t}}function av(r,e){const t={...r,...e},n={};for(const a in t)r[a]!==void 0&&e[a]!==void 0&&(n[a]=Zo(r[a])(r[a],e[a]));return a=>{for(const i in n)t[i]=n[i](a);return t}}function iv(r,e){const t=[],n={color:0,var:0,number:0};for(let a=0;a<e.values.length;a++){const i=e.types[a],o=r.indexes[i][n[i]],s=r.values[o]??0;t[a]=s,n[i]++}return t}const ov=(r,e)=>{const t=Cr.createTransformer(e),n=$n(r),a=$n(e);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?to.has(r)&&!a.values.length||to.has(e)&&!n.values.length?rv(r,e):ea(wd(iv(n,a),a.values),t):Da(r,e)};function Ad(r,e,t){return typeof r=="number"&&typeof e=="number"&&typeof t=="number"?je(r,e,t):Zo(r)(r,e)}const sv=r=>{const e=({timestamp:t})=>r(t);return{start:(t=!0)=>Fe.update(e,t),stop:()=>Ar(e),now:()=>ut.isProcessing?ut.timestamp:St.now()}},Cd=(r,e,t=10)=>{let n="";const a=Math.max(Math.round(e/t),2);for(let i=0;i<a;i++)n+=Math.round(r(i/(a-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Pa=2e4;function Qo(r){let e=0;const t=50;let n=r.next(e);for(;!n.done&&e<Pa;)e+=t,n=r.next(e);return e>=Pa?1/0:e}function lv(r,e=100,t){const n=t({...r,keyframes:[0,e]}),a=Math.min(Qo(n),Pa);return{type:"keyframes",ease:i=>n.next(a*i).value/e,duration:Ft(a)}}const cv=5;function _d(r,e,t){const n=Math.max(e-cv,0);return nd(t-r(n),e-n)}const Ge={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},wi=.001;function uv({duration:r=Ge.duration,bounce:e=Ge.bounce,velocity:t=Ge.velocity,mass:n=Ge.mass}){let a,i,o=1-e;o=ur(Ge.minDamping,Ge.maxDamping,o),r=ur(Ge.minDuration,Ge.maxDuration,Ft(r)),o<1?(a=c=>{const d=c*o,f=d*r,h=d-t,p=ro(c,o),g=Math.exp(-f);return wi-h/p*g},i=c=>{const f=c*o*r,h=f*t+t,p=Math.pow(o,2)*Math.pow(c,2)*r,g=Math.exp(-f),y=ro(Math.pow(c,2),o);return(-a(c)+wi>0?-1:1)*((h-p)*g)/y}):(a=c=>{const d=Math.exp(-c*r),f=(c-t)*r+1;return-wi+d*f},i=c=>{const d=Math.exp(-c*r),f=(t-c)*(r*r);return d*f});const s=5/r,l=fv(a,i,s);if(r=Qt(r),isNaN(l))return{stiffness:Ge.stiffness,damping:Ge.damping,duration:r};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:r}}}const dv=12;function fv(r,e,t){let n=t;for(let a=1;a<dv;a++)n=n-r(n)/e(n);return n}function ro(r,e){return r*Math.sqrt(1-e*e)}const hv=["duration","bounce"],pv=["stiffness","damping","mass"];function _l(r,e){return e.some(t=>r[t]!==void 0)}function mv(r){let e={velocity:Ge.velocity,stiffness:Ge.stiffness,damping:Ge.damping,mass:Ge.mass,isResolvedFromDuration:!1,...r};if(!_l(r,pv)&&_l(r,hv))if(r.visualDuration){const t=r.visualDuration,n=2*Math.PI/(t*1.2),a=n*n,i=2*ur(.05,1,1-(r.bounce||0))*Math.sqrt(a);e={...e,mass:Ge.mass,stiffness:a,damping:i}}else{const t=uv(r);e={...e,...t,mass:Ge.mass},e.isResolvedFromDuration=!0}return e}function Ma(r=Ge.visualDuration,e=Ge.bounce){const t=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:e}:r;let{restSpeed:n,restDelta:a}=t;const i=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],s={done:!1,value:i},{stiffness:l,damping:c,mass:d,duration:f,velocity:h,isResolvedFromDuration:p}=mv({...t,velocity:-Ft(t.velocity||0)}),g=h||0,y=c/(2*Math.sqrt(l*d)),x=o-i,v=Ft(Math.sqrt(l/d)),b=Math.abs(x)<5;n||(n=b?Ge.restSpeed.granular:Ge.restSpeed.default),a||(a=b?Ge.restDelta.granular:Ge.restDelta.default);let _;if(y<1){const A=ro(v,y);_=C=>{const I=Math.exp(-y*v*C);return o-I*((g+y*v*x)/A*Math.sin(A*C)+x*Math.cos(A*C))}}else if(y===1)_=A=>o-Math.exp(-v*A)*(x+(g+v*x)*A);else{const A=v*Math.sqrt(y*y-1);_=C=>{const I=Math.exp(-y*v*C),R=Math.min(A*C,300);return o-I*((g+y*v*x)*Math.sinh(R)+A*x*Math.cosh(R))/A}}const w={calculatedDuration:p&&f||null,next:A=>{const C=_(A);if(p)s.done=A>=f;else{let I=A===0?g:0;y<1&&(I=A===0?Qt(g):_d(_,A,C));const R=Math.abs(I)<=n,F=Math.abs(o-C)<=a;s.done=R&&F}return s.value=s.done?o:C,s},toString:()=>{const A=Math.min(Qo(w),Pa),C=Cd(I=>w.next(A*I).value,A,30);return A+"ms "+C},toTransition:()=>{}};return w}Ma.applyToOptions=r=>{const e=lv(r,100,Ma);return r.ease=e.ease,r.duration=Qt(e.duration),r.type="keyframes",r};function no({keyframes:r,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:o,min:s,max:l,restDelta:c=.5,restSpeed:d}){const f=r[0],h={done:!1,value:f},p=R=>s!==void 0&&R<s||l!==void 0&&R>l,g=R=>s===void 0?l:l===void 0||Math.abs(s-R)<Math.abs(l-R)?s:l;let y=t*e;const x=f+y,v=o===void 0?x:o(x);v!==x&&(y=v-f);const b=R=>-y*Math.exp(-R/n),_=R=>v+b(R),w=R=>{const F=b(R),T=_(R);h.done=Math.abs(F)<=c,h.value=h.done?v:T};let A,C;const I=R=>{p(h.value)&&(A=R,C=Ma({keyframes:[h.value,g(h.value)],velocity:_d(_,R,h.value),damping:a,stiffness:i,restDelta:c,restSpeed:d}))};return I(0),{calculatedDuration:null,next:R=>{let F=!1;return!C&&A===void 0&&(F=!0,w(R),I(R)),A!==void 0&&R>=A?C.next(R-A):(!F&&w(R),h)}}}function gv(r,e,t){const n=[],a=t||dr.mix||Ad,i=r.length-1;for(let o=0;o<i;o++){let s=a(r[o],r[o+1]);if(e){const l=Array.isArray(e)?e[o]||jt:e;s=ea(l,s)}n.push(s)}return n}function vv(r,e,{clamp:t=!0,ease:n,mixer:a}={}){const i=r.length;if($o(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=r[0]===r[1];r[0]>r[i-1]&&(r=[...r].reverse(),e=[...e].reverse());const s=gv(e,n,a),l=s.length,c=d=>{if(o&&d<r[0])return e[0];let f=0;if(l>1)for(;f<r.length-2&&!(d<r[f+1]);f++);const h=jn(r[f],r[f+1],d);return s[f](h)};return t?d=>c(ur(r[0],r[i-1],d)):c}function yv(r,e){const t=r[r.length-1];for(let n=1;n<=e;n++){const a=jn(0,e,n);r.push(je(t,1,a))}}function xv(r){const e=[0];return yv(e,r.length-1),e}function bv(r,e){return r.map(t=>t*e)}function wv(r,e){return r.map(()=>e||fd).splice(0,r.length-1)}function Dn({duration:r=300,keyframes:e,times:t,ease:n="easeInOut"}){const a=Dg(n)?n.map(xl):xl(n),i={done:!1,value:e[0]},o=bv(t&&t.length===e.length?t:xv(e),r),s=vv(o,e,{ease:Array.isArray(a)?a:wv(e,a)});return{calculatedDuration:r,next:l=>(i.value=s(l),i.done=l>=r,i)}}const Av=r=>r!==null;function Jo(r,{repeat:e,repeatType:t="loop"},n,a=1){const i=r.filter(Av),s=a<0||e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||n===void 0?i[s]:n}const Cv={decay:no,inertia:no,tween:Dn,keyframes:Dn,spring:Ma};function Ed(r){typeof r.type=="string"&&(r.type=Cv[r.type])}class es{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const _v=r=>r/100;class ts extends es{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,a;const{motionValue:t}=this.options;t&&t.updatedAt!==St.now()&&this.tick(St.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(n=this.options).onStop)==null||a.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;Ed(e);const{type:t=Dn,repeat:n=0,repeatDelay:a=0,repeatType:i,velocity:o=0}=e;let{keyframes:s}=e;const l=t||Dn;l!==Dn&&typeof s[0]!="number"&&(this.mixKeyframes=ea(_v,Ad(s[0],s[1])),s=[0,100]);const c=l({...e,keyframes:s});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...s].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=Qo(c));const{calculatedDuration:d}=c;this.calculatedDuration=d,this.resolvedDuration=d+a,this.totalDuration=this.resolvedDuration*(n+1)-a,this.generator=c}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:n,totalDuration:a,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:s,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:c=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:p,type:g,onUpdate:y,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const v=this.currentTime-c*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?v<0:v>a;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let _=this.currentTime,w=n;if(f){const R=Math.min(this.currentTime,a)/s;let F=Math.floor(R),T=R%1;!T&&R>=1&&(T=1),T===1&&F--,F=Math.min(F,f+1),!!(F%2)&&(h==="reverse"?(T=1-T,p&&(T-=p/s)):h==="mirror"&&(w=o)),_=ur(0,1,T)*s}const A=b?{done:!1,value:d[0]}:w.next(_);i&&(A.value=i(A.value));let{done:C}=A;!b&&l!==null&&(C=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return I&&g!==no&&(A.value=Jo(d,this.options,x,this.speed)),y&&y(A.value),I&&this.finish(),A}then(e,t){return this.finished.then(e,t)}get duration(){return Ft(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ft(e)}get time(){return Ft(this.currentTime)}set time(e){var t;e=Qt(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(St.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ft(this.currentTime))}play(){var a,i;if(this.isStopped)return;const{driver:e=sv,startTime:t}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(a=this.options).onPlay)==null||i.call(a);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=t??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(St.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function Ev(r){for(let e=1;e<r.length;e++)r[e]??(r[e]=r[e-1])}const Fr=r=>r*180/Math.PI,ao=r=>{const e=Fr(Math.atan2(r[1],r[0]));return io(e)},Nv={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:r=>(Math.abs(r[0])+Math.abs(r[3]))/2,rotate:ao,rotateZ:ao,skewX:r=>Fr(Math.atan(r[1])),skewY:r=>Fr(Math.atan(r[2])),skew:r=>(Math.abs(r[1])+Math.abs(r[2]))/2},io=r=>(r=r%360,r<0&&(r+=360),r),El=ao,Nl=r=>Math.sqrt(r[0]*r[0]+r[1]*r[1]),Sl=r=>Math.sqrt(r[4]*r[4]+r[5]*r[5]),Sv={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Nl,scaleY:Sl,scale:r=>(Nl(r)+Sl(r))/2,rotateX:r=>io(Fr(Math.atan2(r[6],r[5]))),rotateY:r=>io(Fr(Math.atan2(-r[2],r[0]))),rotateZ:El,rotate:El,skewX:r=>Fr(Math.atan(r[4])),skewY:r=>Fr(Math.atan(r[1])),skew:r=>(Math.abs(r[1])+Math.abs(r[4]))/2};function oo(r){return r.includes("scale")?1:0}function so(r,e){if(!r||r==="none")return oo(e);const t=r.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(t)n=Sv,a=t;else{const s=r.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Nv,a=s}if(!a)return oo(e);const i=n[e],o=a[1].split(",").map(Tv);return typeof i=="function"?i(o):o[i]}const Iv=(r,e)=>{const{transform:t="none"}=getComputedStyle(r);return so(t,e)};function Tv(r){return parseFloat(r.trim())}const mn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],gn=new Set(mn),Il=r=>r===pn||r===oe,Rv=new Set(["x","y","z"]),Ov=mn.filter(r=>!Rv.has(r));function Dv(r){const e=[];return Ov.forEach(t=>{const n=r.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const Vr={width:({x:r},{paddingLeft:e="0",paddingRight:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),height:({y:r},{paddingTop:e="0",paddingBottom:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),top:(r,{top:e})=>parseFloat(e),left:(r,{left:e})=>parseFloat(e),bottom:({y:r},{top:e})=>parseFloat(e)+(r.max-r.min),right:({x:r},{left:e})=>parseFloat(e)+(r.max-r.min),x:(r,{transform:e})=>so(e,"x"),y:(r,{transform:e})=>so(e,"y")};Vr.translateX=Vr.x;Vr.translateY=Vr.y;const jr=new Set;let lo=!1,co=!1,uo=!1;function Nd(){if(co){const r=Array.from(jr).filter(n=>n.needsMeasurement),e=new Set(r.map(n=>n.element)),t=new Map;e.forEach(n=>{const a=Dv(n);a.length&&(t.set(n,a),n.render())}),r.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const a=t.get(n);a&&a.forEach(([i,o])=>{var s;(s=n.getValue(i))==null||s.set(o)})}),r.forEach(n=>n.measureEndState()),r.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}co=!1,lo=!1,jr.forEach(r=>r.complete(uo)),jr.clear()}function Sd(){jr.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(co=!0)})}function Pv(){uo=!0,Sd(),Nd(),uo=!1}class rs{constructor(e,t,n,a,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=a,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(jr.add(this),lo||(lo=!0,Fe.read(Sd),Fe.resolveKeyframes(Nd))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:a}=this;if(e[0]===null){const i=a==null?void 0:a.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(n&&t){const s=n.readValue(t,o);s!=null&&(e[0]=s)}e[0]===void 0&&(e[0]=o),a&&i===void 0&&a.set(e[0])}Ev(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),jr.delete(this)}cancel(){this.state==="scheduled"&&(jr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Mv=r=>r.startsWith("--");function Lv(r,e,t){Mv(e)?r.style.setProperty(e,t):r.style[e]=t}const kv=Ho(()=>window.ScrollTimeline!==void 0),Fv={};function Bv(r,e){const t=Ho(r);return()=>Fv[e]??t()}const Id=Bv(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Rn=([r,e,t,n])=>`cubic-bezier(${r}, ${e}, ${t}, ${n})`,Tl={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Rn([0,.65,.55,1]),circOut:Rn([.55,0,1,.45]),backIn:Rn([.31,.01,.66,-.59]),backOut:Rn([.33,1.53,.69,.99])};function Td(r,e){if(r)return typeof r=="function"?Id()?Cd(r,e):"ease-out":hd(r)?Rn(r):Array.isArray(r)?r.map(t=>Td(t,e)||Tl.easeOut):Tl[r]}function Vv(r,e,t,{delay:n=0,duration:a=300,repeat:i=0,repeatType:o="loop",ease:s="easeOut",times:l}={},c=void 0){const d={[e]:t};l&&(d.offset=l);const f=Td(s,a);Array.isArray(f)&&(d.easing=f);const h={delay:n,duration:a,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),r.animate(d,h)}function Rd(r){return typeof r=="function"&&"applyToOptions"in r}function jv({type:r,...e}){return Rd(r)&&Id()?r.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Uv extends es{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:a,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:s,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,$o(typeof e.type!="string");const c=jv(e);this.animation=Vv(t,n,a,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const d=Jo(a,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(d):Lv(t,n,d),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,n;const e=((n=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:n.call(t).duration)||0;return Ft(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ft(e)}get time(){return Ft(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Qt(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&kv()?(this.animation.timeline=e,jt):t(this)}}const Od={anticipate:cd,backInOut:ld,circInOut:dd};function $v(r){return r in Od}function Hv(r){typeof r.ease=="string"&&$v(r.ease)&&(r.ease=Od[r.ease])}const Rl=10;class Gv extends Uv{constructor(e){Hv(e),Ed(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:n,onComplete:a,element:i,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const s=new ts({...o,autoplay:!1}),l=Qt(this.finishedTime??this.time);t.setWithVelocity(s.sample(l-Rl).value,s.sample(l).value,Rl),s.stop()}}const Ol=(r,e)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(Cr.test(r)||r==="0")&&!r.startsWith("url("));function zv(r){const e=r[0];if(r.length===1)return!0;for(let t=0;t<r.length;t++)if(r[t]!==e)return!0}function Wv(r,e,t,n){const a=r[0];if(a===null)return!1;if(e==="display"||e==="visibility")return!0;const i=r[r.length-1],o=Ol(a,e),s=Ol(i,e);return!o||!s?!1:zv(r)||(t==="spring"||Rd(t))&&n}function fo(r){r.duration=0,r.type="keyframes"}const Xv=new Set(["opacity","clipPath","filter","transform"]),qv=Ho(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Yv(r){var d;const{motionValue:e,name:t,repeatDelay:n,repeatType:a,damping:i,type:o}=r;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return qv()&&t&&Xv.has(t)&&(t!=="transform"||!c)&&!l&&!n&&a!=="mirror"&&i!==0&&o!=="inertia"}const Kv=40;class Zv extends es{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:a=0,repeatDelay:i=0,repeatType:o="loop",keyframes:s,name:l,motionValue:c,element:d,...f}){var g;super(),this.stop=()=>{var y,x;this._animation&&(this._animation.stop(),(y=this.stopTimeline)==null||y.call(this)),(x=this.keyframeResolver)==null||x.cancel()},this.createdAt=St.now();const h={autoplay:e,delay:t,type:n,repeat:a,repeatDelay:i,repeatType:o,name:l,motionValue:c,element:d,...f},p=(d==null?void 0:d.KeyframeResolver)||rs;this.keyframeResolver=new p(s,(y,x,v)=>this.onKeyframesResolved(y,x,h,!v),l,c,d),(g=this.keyframeResolver)==null||g.scheduleResolve()}onKeyframesResolved(e,t,n,a){this.keyframeResolver=void 0;const{name:i,type:o,velocity:s,delay:l,isHandoff:c,onUpdate:d}=n;this.resolvedAt=St.now(),Wv(e,i,o,s)||((dr.instantAnimations||!l)&&(d==null||d(Jo(e,n,t))),e[0]=e[e.length-1],fo(n),n.repeat=0);const h={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>Kv?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...n,keyframes:e},p=!c&&Yv(h)?new Gv({...h,element:h.motionValue.owner.current}):new ts(h);p.finished.then(()=>this.notifyFinished()).catch(jt),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),Pv()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Qv=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Jv(r){const e=Qv.exec(r);if(!e)return[,];const[,t,n,a]=e;return[`--${t??n}`,a]}function Dd(r,e,t=1){const[n,a]=Jv(r);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const o=i.trim();return ed(o)?parseFloat(o):o}return qo(a)?Dd(a,e,t+1):a}function ns(r,e){return(r==null?void 0:r[e])??(r==null?void 0:r.default)??r}const Pd=new Set(["width","height","top","left","right","bottom",...mn]),ey={test:r=>r==="auto",parse:r=>r},Md=r=>e=>e.test(r),Ld=[pn,oe,Jt,pr,zg,Gg,ey],Dl=r=>Ld.find(Md(r));function ty(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||rd(r):!0}const ry=new Set(["brightness","contrast","saturate","opacity"]);function ny(r){const[e,t]=r.slice(0,-1).split("(");if(e==="drop-shadow")return r;const[n]=t.match(Yo)||[];if(!n)return r;const a=t.replace(n,"");let i=ry.has(e)?1:0;return n!==t&&(i*=100),e+"("+i+a+")"}const ay=/\b([a-z-]*)\(.*?\)/gu,ho={...Cr,getAnimatableNone:r=>{const e=r.match(ay);return e?e.map(ny).join(" "):r}},Pl={...pn,transform:Math.round},iy={rotate:pr,rotateX:pr,rotateY:pr,rotateZ:pr,scale:fa,scaleX:fa,scaleY:fa,scaleZ:fa,skew:pr,skewX:pr,skewY:pr,distance:oe,translateX:oe,translateY:oe,translateZ:oe,x:oe,y:oe,z:oe,perspective:oe,transformPerspective:oe,opacity:Un,originX:bl,originY:bl,originZ:oe},as={borderWidth:oe,borderTopWidth:oe,borderRightWidth:oe,borderBottomWidth:oe,borderLeftWidth:oe,borderRadius:oe,radius:oe,borderTopLeftRadius:oe,borderTopRightRadius:oe,borderBottomRightRadius:oe,borderBottomLeftRadius:oe,width:oe,maxWidth:oe,height:oe,maxHeight:oe,top:oe,right:oe,bottom:oe,left:oe,padding:oe,paddingTop:oe,paddingRight:oe,paddingBottom:oe,paddingLeft:oe,margin:oe,marginTop:oe,marginRight:oe,marginBottom:oe,marginLeft:oe,backgroundPositionX:oe,backgroundPositionY:oe,...iy,zIndex:Pl,fillOpacity:Un,strokeOpacity:Un,numOctaves:Pl},oy={...as,color:qe,backgroundColor:qe,outlineColor:qe,fill:qe,stroke:qe,borderColor:qe,borderTopColor:qe,borderRightColor:qe,borderBottomColor:qe,borderLeftColor:qe,filter:ho,WebkitFilter:ho},kd=r=>oy[r];function Fd(r,e){let t=kd(r);return t!==ho&&(t=Cr),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const sy=new Set(["auto","none","0"]);function ly(r,e,t){let n=0,a;for(;n<r.length&&!a;){const i=r[n];typeof i=="string"&&!sy.has(i)&&$n(i).values.length&&(a=r[n]),n++}if(a&&t)for(const i of e)r[i]=Fd(t,a)}class cy extends rs{constructor(e,t,n,a,i){super(e,t,n,a,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),qo(c))){const d=Dd(c,t.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Pd.has(n)||e.length!==2)return;const[a,i]=e,o=Dl(a),s=Dl(i);if(o!==s)if(Il(o)&&Il(s))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else Vr[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let a=0;a<e.length;a++)(e[a]===null||ty(e[a]))&&n.push(a);n.length&&ly(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Vr[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const a=t[t.length-1];a!==void 0&&e.getValue(n,a).jump(a,!1)}measureEndState(){var s;const{element:e,name:t,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const a=e.getValue(t);a&&a.jump(this.measuredOrigin,!1);const i=n.length-1,o=n[i];n[i]=Vr[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(s=this.removedTransforms)!=null&&s.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function uy(r,e,t){if(r instanceof EventTarget)return[r];if(typeof r=="string"){let n=document;const a=(t==null?void 0:t[r])??n.querySelectorAll(r);return a?Array.from(a):[]}return Array.from(r)}const Bd=(r,e)=>e&&typeof r=="number"?e.transform(r):r;function Vd(r){return td(r)&&"offsetHeight"in r}const Ml=30,dy=r=>!isNaN(parseFloat(r));class fy{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var i;const a=St.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=St.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=dy(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Go);const n=this.events[e].add(t);return e==="change"?()=>{n(),Fe.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=St.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Ml)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,Ml);return nd(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function cn(r,e){return new fy(r,e)}const{schedule:is}=pd(queueMicrotask,!1),$t={x:!1,y:!1};function jd(){return $t.x||$t.y}function hy(r){return r==="x"||r==="y"?$t[r]?null:($t[r]=!0,()=>{$t[r]=!1}):$t.x||$t.y?null:($t.x=$t.y=!0,()=>{$t.x=$t.y=!1})}function Ud(r,e){const t=uy(r),n=new AbortController,a={passive:!0,...e,signal:n.signal};return[t,a,()=>n.abort()]}function Ll(r){return!(r.pointerType==="touch"||jd())}function py(r,e,t={}){const[n,a,i]=Ud(r,t),o=s=>{if(!Ll(s))return;const{target:l}=s,c=e(l,s);if(typeof c!="function"||!l)return;const d=f=>{Ll(f)&&(c(f),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,a)};return n.forEach(s=>{s.addEventListener("pointerenter",o,a)}),i}const $d=(r,e)=>e?r===e?!0:$d(r,e.parentElement):!1,os=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,my=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function gy(r){return my.has(r.tagName)||r.tabIndex!==-1}const Aa=new WeakSet;function kl(r){return e=>{e.key==="Enter"&&r(e)}}function Ai(r,e){r.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const vy=(r,e)=>{const t=r.currentTarget;if(!t)return;const n=kl(()=>{if(Aa.has(t))return;Ai(t,"down");const a=kl(()=>{Ai(t,"up")}),i=()=>Ai(t,"cancel");t.addEventListener("keyup",a,e),t.addEventListener("blur",i,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function Fl(r){return os(r)&&!jd()}function yy(r,e,t={}){const[n,a,i]=Ud(r,t),o=s=>{const l=s.currentTarget;if(!Fl(s))return;Aa.add(l);const c=e(l,s),d=(p,g)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),Aa.has(l)&&Aa.delete(l),Fl(p)&&typeof c=="function"&&c(p,{success:g})},f=p=>{d(p,l===window||l===document||t.useGlobalTarget||$d(l,p.target))},h=p=>{d(p,!1)};window.addEventListener("pointerup",f,a),window.addEventListener("pointercancel",h,a)};return n.forEach(s=>{(t.useGlobalTarget?window:s).addEventListener("pointerdown",o,a),Vd(s)&&(s.addEventListener("focus",c=>vy(c,a)),!gy(s)&&!s.hasAttribute("tabindex")&&(s.tabIndex=0))}),i}function Hd(r){return td(r)&&"ownerSVGElement"in r}function xy(r){return Hd(r)&&r.tagName==="svg"}const mt=r=>!!(r&&r.getVelocity),by=[...Ld,qe,Cr],wy=r=>by.find(Md(r)),ss=N.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});function Bl(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function Ay(...r){return e=>{let t=!1;const n=r.map(a=>{const i=Bl(a,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():Bl(r[a],null)}}}}function Cy(...r){return N.useCallback(Ay(...r),r)}class _y extends N.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=t.offsetParent,a=Vd(n)&&n.offsetWidth||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=a-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Ey({children:r,isPresent:e,anchorX:t,root:n}){const a=N.useId(),i=N.useRef(null),o=N.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:s}=N.useContext(ss),l=Cy(i,r==null?void 0:r.ref);return N.useInsertionEffect(()=>{const{width:c,height:d,top:f,left:h,right:p}=o.current;if(e||!i.current||!c||!d)return;const g=t==="left"?`left: ${h}`:`right: ${p}`;i.current.dataset.motionPopId=a;const y=document.createElement("style");s&&(y.nonce=s);const x=n??document.head;return x.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${g}px !important;
            top: ${f}px !important;
          }
        `),()=>{x.contains(y)&&x.removeChild(y)}},[e]),or.jsx(_y,{isPresent:e,childRef:i,sizeRef:o,children:N.cloneElement(r,{ref:l})})}const Ny=({children:r,initial:e,isPresent:t,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:o,anchorX:s,root:l})=>{const c=Bo(Sy),d=N.useId();let f=!0,h=N.useMemo(()=>(f=!1,{id:d,initial:e,isPresent:t,custom:a,onExitComplete:p=>{c.set(p,!0);for(const g of c.values())if(!g)return;n&&n()},register:p=>(c.set(p,!1),()=>c.delete(p))}),[t,c,n]);return i&&f&&(h={...h}),N.useMemo(()=>{c.forEach((p,g)=>c.set(g,!1))},[t]),N.useEffect(()=>{!t&&!c.size&&n&&n()},[t]),o==="popLayout"&&(r=or.jsx(Ey,{isPresent:t,anchorX:s,root:l,children:r})),or.jsx(Wa.Provider,{value:h,children:r})};function Sy(){return new Map}function Gd(r=!0){const e=N.useContext(Wa);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:a}=e,i=N.useId();N.useEffect(()=>{if(r)return a(i)},[r]);const o=N.useCallback(()=>r&&n&&n(i),[i,n,r]);return!t&&n?[!1,o]:[!0]}const ha=r=>r.key||"";function Vl(r){const e=[];return N.Children.forEach(r,t=>{N.isValidElement(t)&&e.push(t)}),e}const zd=({children:r,custom:e,initial:t=!0,onExitComplete:n,presenceAffectsLayout:a=!0,mode:i="sync",propagate:o=!1,anchorX:s="left",root:l})=>{const[c,d]=Gd(o),f=N.useMemo(()=>Vl(r),[r]),h=o&&!c?[]:f.map(ha),p=N.useRef(!0),g=N.useRef(f),y=Bo(()=>new Map),[x,v]=N.useState(f),[b,_]=N.useState(f);Ju(()=>{p.current=!1,g.current=f;for(let C=0;C<b.length;C++){const I=ha(b[C]);h.includes(I)?y.delete(I):y.get(I)!==!0&&y.set(I,!1)}},[b,h.length,h.join("-")]);const w=[];if(f!==x){let C=[...f];for(let I=0;I<b.length;I++){const R=b[I],F=ha(R);h.includes(F)||(C.splice(I,0,R),w.push(R))}return i==="wait"&&w.length&&(C=w),_(Vl(C)),v(f),null}const{forceRender:A}=N.useContext(Fo);return or.jsx(or.Fragment,{children:b.map(C=>{const I=ha(C),R=o&&!c?!1:f===b||h.includes(I),F=()=>{if(y.has(I))y.set(I,!0);else return;let T=!0;y.forEach(U=>{U||(T=!1)}),T&&(A==null||A(),_(g.current),o&&(d==null||d()),n&&n())};return or.jsx(Ny,{isPresent:R,initial:!p.current||t?void 0:!1,custom:e,presenceAffectsLayout:a,mode:i,root:l,onExitComplete:R?void 0:F,anchorX:s,children:C},I)})})},Wd=N.createContext({strict:!1}),jl={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},un={};for(const r in jl)un[r]={isEnabled:e=>jl[r].some(t=>!!e[t])};function Iy(r){for(const e in r)un[e]={...un[e],...r[e]}}const Ty=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function La(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||Ty.has(r)}let Xd=r=>!La(r);function Ry(r){typeof r=="function"&&(Xd=e=>e.startsWith("on")?!La(e):r(e))}try{Ry(require("@emotion/is-prop-valid").default)}catch{}function Oy(r,e,t){const n={};for(const a in r)a==="values"&&typeof r.values=="object"||(Xd(a)||t===!0&&La(a)||!e&&!La(a)||r.draggable&&a.startsWith("onDrag"))&&(n[a]=r[a]);return n}const Xa=N.createContext({});function qa(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}function Hn(r){return typeof r=="string"||Array.isArray(r)}const ls=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],cs=["initial",...ls];function Ya(r){return qa(r.animate)||cs.some(e=>Hn(r[e]))}function qd(r){return!!(Ya(r)||r.variants)}function Dy(r,e){if(Ya(r)){const{initial:t,animate:n}=r;return{initial:t===!1||Hn(t)?t:void 0,animate:Hn(n)?n:void 0}}return r.inherit!==!1?e:{}}function Py(r){const{initial:e,animate:t}=Dy(r,N.useContext(Xa));return N.useMemo(()=>({initial:e,animate:t}),[Ul(e),Ul(t)])}function Ul(r){return Array.isArray(r)?r.join(" "):r}const Gn={};function My(r){for(const e in r)Gn[e]=r[e],Xo(e)&&(Gn[e].isCSSVariable=!0)}function Yd(r,{layout:e,layoutId:t}){return gn.has(r)||r.startsWith("origin")||(e||t!==void 0)&&(!!Gn[r]||r==="opacity")}const Ly={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ky=mn.length;function Fy(r,e,t){let n="",a=!0;for(let i=0;i<ky;i++){const o=mn[i],s=r[o];if(s===void 0)continue;let l=!0;if(typeof s=="number"?l=s===(o.startsWith("scale")?1:0):l=parseFloat(s)===0,!l||t){const c=Bd(s,as[o]);if(!l){a=!1;const d=Ly[o]||o;n+=`${d}(${c}) `}t&&(e[o]=c)}}return n=n.trim(),t?n=t(e,a?"":n):a&&(n="none"),n}function us(r,e,t){const{style:n,vars:a,transformOrigin:i}=r;let o=!1,s=!1;for(const l in e){const c=e[l];if(gn.has(l)){o=!0;continue}else if(Xo(l)){a[l]=c;continue}else{const d=Bd(c,as[l]);l.startsWith("origin")?(s=!0,i[l]=d):n[l]=d}}if(e.transform||(o||t?n.transform=Fy(e,r.transform,t):n.transform&&(n.transform="none")),s){const{originX:l="50%",originY:c="50%",originZ:d=0}=i;n.transformOrigin=`${l} ${c} ${d}`}}const ds=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Kd(r,e,t){for(const n in e)!mt(e[n])&&!Yd(n,t)&&(r[n]=e[n])}function By({transformTemplate:r},e){return N.useMemo(()=>{const t=ds();return us(t,e,r),Object.assign({},t.vars,t.style)},[e])}function Vy(r,e){const t=r.style||{},n={};return Kd(n,t,r),Object.assign(n,By(r,e)),n}function jy(r,e){const t={},n=Vy(r,e);return r.drag&&r.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(t.tabIndex=0),t.style=n,t}const Uy={offset:"stroke-dashoffset",array:"stroke-dasharray"},$y={offset:"strokeDashoffset",array:"strokeDasharray"};function Hy(r,e,t=1,n=0,a=!0){r.pathLength=1;const i=a?Uy:$y;r[i.offset]=oe.transform(-n);const o=oe.transform(e),s=oe.transform(t);r[i.array]=`${o} ${s}`}function Zd(r,{attrX:e,attrY:t,attrScale:n,pathLength:a,pathSpacing:i=1,pathOffset:o=0,...s},l,c,d){if(us(r,s,c),l){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:f,style:h}=r;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),t!==void 0&&(f.y=t),n!==void 0&&(f.scale=n),a!==void 0&&Hy(f,a,i,o,!1)}const Qd=()=>({...ds(),attrs:{}}),Jd=r=>typeof r=="string"&&r.toLowerCase()==="svg";function Gy(r,e,t,n){const a=N.useMemo(()=>{const i=Qd();return Zd(i,e,Jd(n),r.transformTemplate,r.style),{...i.attrs,style:{...i.style}}},[e]);if(r.style){const i={};Kd(i,r.style,r),a.style={...i,...a.style}}return a}const zy=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function fs(r){return typeof r!="string"||r.includes("-")?!1:!!(zy.indexOf(r)>-1||/[A-Z]/u.test(r))}function Wy(r,e,t,{latestValues:n},a,i=!1){const s=(fs(r)?Gy:jy)(e,n,a,r),l=Oy(e,typeof r=="string",i),c=r!==N.Fragment?{...l,...s,ref:t}:{},{children:d}=e,f=N.useMemo(()=>mt(d)?d.get():d,[d]);return N.createElement(r,{...c,children:f})}function $l(r){const e=[{},{}];return r==null||r.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function hs(r,e,t,n){if(typeof e=="function"){const[a,i]=$l(n);e=e(t!==void 0?t:r.custom,a,i)}if(typeof e=="string"&&(e=r.variants&&r.variants[e]),typeof e=="function"){const[a,i]=$l(n);e=e(t!==void 0?t:r.custom,a,i)}return e}function Ca(r){return mt(r)?r.get():r}function Xy({scrapeMotionValuesFromProps:r,createRenderState:e},t,n,a){return{latestValues:qy(t,n,a,r),renderState:e()}}function qy(r,e,t,n){const a={},i=n(r,{});for(const h in i)a[h]=Ca(i[h]);let{initial:o,animate:s}=r;const l=Ya(r),c=qd(r);e&&c&&!l&&r.inherit!==!1&&(o===void 0&&(o=e.initial),s===void 0&&(s=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const f=d?s:o;if(f&&typeof f!="boolean"&&!qa(f)){const h=Array.isArray(f)?f:[f];for(let p=0;p<h.length;p++){const g=hs(r,h[p]);if(g){const{transitionEnd:y,transition:x,...v}=g;for(const b in v){let _=v[b];if(Array.isArray(_)){const w=d?_.length-1:0;_=_[w]}_!==null&&(a[b]=_)}for(const b in y)a[b]=y[b]}}}return a}const ef=r=>(e,t)=>{const n=N.useContext(Xa),a=N.useContext(Wa),i=()=>Xy(r,e,n,a);return t?i():Bo(i)};function ps(r,e,t){var i;const{style:n}=r,a={};for(const o in n)(mt(n[o])||e.style&&mt(e.style[o])||Yd(o,r)||((i=t==null?void 0:t.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(a[o]=n[o]);return a}const Yy=ef({scrapeMotionValuesFromProps:ps,createRenderState:ds});function tf(r,e,t){const n=ps(r,e,t);for(const a in r)if(mt(r[a])||mt(e[a])){const i=mn.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[i]=r[a]}return n}const Ky=ef({scrapeMotionValuesFromProps:tf,createRenderState:Qd}),Zy=Symbol.for("motionComponentSymbol");function tn(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function Qy(r,e,t){return N.useCallback(n=>{n&&r.onMount&&r.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):tn(t)&&(t.current=n))},[e])}const ms=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Jy="framerAppearId",rf="data-"+ms(Jy),nf=N.createContext({});function ex(r,e,t,n,a){var y,x;const{visualElement:i}=N.useContext(Xa),o=N.useContext(Wd),s=N.useContext(Wa),l=N.useContext(ss).reducedMotion,c=N.useRef(null);n=n||o.renderer,!c.current&&n&&(c.current=n(r,{visualState:e,parent:i,props:t,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const d=c.current,f=N.useContext(nf);d&&!d.projection&&a&&(d.type==="html"||d.type==="svg")&&tx(c.current,t,a,f);const h=N.useRef(!1);N.useInsertionEffect(()=>{d&&h.current&&d.update(t,s)});const p=t[rf],g=N.useRef(!!p&&!((y=window.MotionHandoffIsComplete)!=null&&y.call(window,p))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,p)));return Ju(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),g.current&&d.animationState&&d.animationState.animateChanges())}),N.useEffect(()=>{d&&(!g.current&&d.animationState&&d.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)==null||v.call(window,p)}),g.current=!1),d.enteringChildren=void 0)}),d}function tx(r,e,t,n){const{layoutId:a,layout:i,drag:o,dragConstraints:s,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=e;r.projection=new t(r.latestValues,e["data-framer-portal-id"]?void 0:af(r.parent)),r.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:!!o||s&&tn(s),visualElement:r,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:c})}function af(r){if(r)return r.options.allowProjection!==!1?r.projection:af(r.parent)}function Ci(r,{forwardMotionProps:e=!1}={},t,n){t&&Iy(t);const a=fs(r)?Ky:Yy;function i(s,l){let c;const d={...N.useContext(ss),...s,layoutId:rx(s)},{isStatic:f}=d,h=Py(s),p=a(s,f);if(!f&&Vo){nx();const g=ax(d);c=g.MeasureLayout,h.visualElement=ex(r,p,d,n,g.ProjectionNode)}return or.jsxs(Xa.Provider,{value:h,children:[c&&h.visualElement?or.jsx(c,{visualElement:h.visualElement,...d}):null,Wy(r,s,Qy(p,h.visualElement,l),p,f,e)]})}i.displayName=`motion.${typeof r=="string"?r:`create(${r.displayName??r.name??""})`}`;const o=N.forwardRef(i);return o[Zy]=r,o}function rx({layoutId:r}){const e=N.useContext(Fo).id;return e&&r!==void 0?e+"-"+r:r}function nx(r,e){N.useContext(Wd).strict}function ax(r){const{drag:e,layout:t}=un;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(r)||t!=null&&t.isEnabled(r)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function ix(r,e){if(typeof Proxy>"u")return Ci;const t=new Map,n=(i,o)=>Ci(i,o,r,e),a=(i,o)=>n(i,o);return new Proxy(a,{get:(i,o)=>o==="create"?n:(t.has(o)||t.set(o,Ci(o,void 0,r,e)),t.get(o))})}function of({top:r,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:r,max:n}}}function ox({x:r,y:e}){return{top:e.min,right:r.max,bottom:e.max,left:r.min}}function sx(r,e){if(!e)return r;const t=e({x:r.left,y:r.top}),n=e({x:r.right,y:r.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function _i(r){return r===void 0||r===1}function po({scale:r,scaleX:e,scaleY:t}){return!_i(r)||!_i(e)||!_i(t)}function Mr(r){return po(r)||sf(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function sf(r){return Hl(r.x)||Hl(r.y)}function Hl(r){return r&&r!=="0%"}function ka(r,e,t){const n=r-t,a=e*n;return t+a}function Gl(r,e,t,n,a){return a!==void 0&&(r=ka(r,a,n)),ka(r,t,n)+e}function mo(r,e=0,t=1,n,a){r.min=Gl(r.min,e,t,n,a),r.max=Gl(r.max,e,t,n,a)}function lf(r,{x:e,y:t}){mo(r.x,e.translate,e.scale,e.originPoint),mo(r.y,t.translate,t.scale,t.originPoint)}const zl=.999999999999,Wl=1.0000000000001;function lx(r,e,t,n=!1){const a=t.length;if(!a)return;e.x=e.y=1;let i,o;for(let s=0;s<a;s++){i=t[s],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&nn(r,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,lf(r,o)),n&&Mr(i.latestValues)&&nn(r,i.latestValues))}e.x<Wl&&e.x>zl&&(e.x=1),e.y<Wl&&e.y>zl&&(e.y=1)}function rn(r,e){r.min=r.min+e,r.max=r.max+e}function Xl(r,e,t,n,a=.5){const i=je(r.min,r.max,a);mo(r,e,t,i,n)}function nn(r,e){Xl(r.x,e.x,e.scaleX,e.scale,e.originX),Xl(r.y,e.y,e.scaleY,e.scale,e.originY)}function cf(r,e){return of(sx(r.getBoundingClientRect(),e))}function cx(r,e,t){const n=cf(r,t),{scroll:a}=e;return a&&(rn(n.x,a.offset.x),rn(n.y,a.offset.y)),n}const ql=()=>({translate:0,scale:1,origin:0,originPoint:0}),an=()=>({x:ql(),y:ql()}),Yl=()=>({min:0,max:0}),We=()=>({x:Yl(),y:Yl()}),go={current:null},uf={current:!1};function ux(){if(uf.current=!0,!!Vo)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),e=()=>go.current=r.matches;r.addEventListener("change",e),e()}else go.current=!1}const dx=new WeakMap;function fx(r,e,t){for(const n in e){const a=e[n],i=t[n];if(mt(a))r.addValue(n,a);else if(mt(i))r.addValue(n,cn(a,{owner:r}));else if(i!==a)if(r.hasValue(n)){const o=r.getValue(n);o.liveStyle===!0?o.jump(a):o.hasAnimated||o.set(a)}else{const o=r.getStaticValue(n);r.addValue(n,cn(o!==void 0?o:a,{owner:r}))}}for(const n in t)e[n]===void 0&&r.removeValue(n);return e}const Kl=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class hx{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:i,visualState:o},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=rs,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=St.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Fe.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.blockInitialAnimation=!!i,this.isControllingVariants=Ya(t),this.isVariantNode=qd(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(t,{},this);for(const h in f){const p=f[h];l[h]!==void 0&&mt(p)&&p.set(l[h])}}mount(e){var t;this.current=e,dx.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,a)=>this.bindToMotionValue(a,n)),uf.current||ux(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:go.current,(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Ar(this.notifyUpdate),Ar(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=gn.has(e);n&&this.onBindTransform&&this.onBindTransform();const a=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Fe.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{a(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in un){const t=un[e];if(!t)continue;const{isEnabled:n,Feature:a}=t;if(!this.features[e]&&a&&n(this.props)&&(this.features[e]=new a(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):We()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Kl.length;n++){const a=Kl[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i="on"+a,o=e[i];o&&(this.propEventSubscriptions[a]=this.on(a,o))}this.prevMotionValues=fx(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=cn(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(ed(n)||rd(n))?n=parseFloat(n):!wy(n)&&Cr.test(t)&&(n=Fd(e,t)),this.setBaseTarget(e,mt(n)?n.get():n)),mt(n)?n.get():n}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var i;const{initial:t}=this.props;let n;if(typeof t=="string"||typeof t=="object"){const o=hs(this.props,t,(i=this.presenceContext)==null?void 0:i.custom);o&&(n=o[e])}if(t&&n!==void 0)return n;const a=this.getBaseTargetFromProps(this.props,e);return a!==void 0&&!mt(a)?a:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Go),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){is.render(this.render)}}class df extends hx{constructor(){super(...arguments),this.KeyframeResolver=cy}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;mt(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function ff(r,{style:e,vars:t},n,a){const i=r.style;let o;for(o in e)i[o]=e[o];a==null||a.applyProjectionStyles(i,n);for(o in t)i.setProperty(o,t[o])}function px(r){return window.getComputedStyle(r)}class mx extends df{constructor(){super(...arguments),this.type="html",this.renderInstance=ff}readValueFromInstance(e,t){var n;if(gn.has(t))return(n=this.projection)!=null&&n.isProjecting?oo(t):Iv(e,t);{const a=px(e),i=(Xo(t)?a.getPropertyValue(t):a[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return cf(e,t)}build(e,t,n){us(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return ps(e,t,n)}}const hf=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function gx(r,e,t,n){ff(r,e,void 0,n);for(const a in e.attrs)r.setAttribute(hf.has(a)?a:ms(a),e.attrs[a])}class vx extends df{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=We}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(gn.has(t)){const n=kd(t);return n&&n.default||0}return t=hf.has(t)?t:ms(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return tf(e,t,n)}build(e,t,n){Zd(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,a){gx(e,t,n,a)}mount(e){this.isSVGTag=Jd(e.tagName),super.mount(e)}}const yx=(r,e)=>fs(r)?new vx(e):new mx(e,{allowProjection:r!==N.Fragment});function on(r,e,t){const n=r.getProps();return hs(n,e,t!==void 0?t:n.custom,r)}const vo=r=>Array.isArray(r);function xx(r,e,t){r.hasValue(e)?r.getValue(e).set(t):r.addValue(e,cn(t))}function bx(r){return vo(r)?r[r.length-1]||0:r}function wx(r,e){const t=on(r,e);let{transitionEnd:n={},transition:a={},...i}=t||{};i={...i,...n};for(const o in i){const s=bx(i[o]);xx(r,o,s)}}function Ax(r){return!!(mt(r)&&r.add)}function yo(r,e){const t=r.getValue("willChange");if(Ax(t))return t.add(e);if(!t&&dr.WillChange){const n=new dr.WillChange("auto");r.addValue("willChange",n),n.add(e)}}function pf(r){return r.props[rf]}const Cx=r=>r!==null;function _x(r,{repeat:e,repeatType:t="loop"},n){const a=r.filter(Cx),i=e&&t!=="loop"&&e%2===1?0:a.length-1;return a[i]}const Ex={type:"spring",stiffness:500,damping:25,restSpeed:10},Nx=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),Sx={type:"keyframes",duration:.8},Ix={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Tx=(r,{keyframes:e})=>e.length>2?Sx:gn.has(r)?r.startsWith("scale")?Nx(e[1]):Ex:Ix;function Rx({when:r,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:o,repeatDelay:s,from:l,elapsed:c,...d}){return!!Object.keys(d).length}const gs=(r,e,t,n={},a,i)=>o=>{const s=ns(n,r)||{},l=s.delay||n.delay||0;let{elapsed:c=0}=n;c=c-Qt(l);const d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...s,delay:-c,onUpdate:h=>{e.set(h),s.onUpdate&&s.onUpdate(h)},onComplete:()=>{o(),s.onComplete&&s.onComplete()},name:r,motionValue:e,element:i?void 0:a};Rx(s)||Object.assign(d,Tx(r,d)),d.duration&&(d.duration=Qt(d.duration)),d.repeatDelay&&(d.repeatDelay=Qt(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(fo(d),d.delay===0&&(f=!0)),(dr.instantAnimations||dr.skipAnimations)&&(f=!0,fo(d),d.delay=0),d.allowFlatten=!s.type&&!s.ease,f&&!i&&e.get()!==void 0){const h=_x(d.keyframes,s);if(h!==void 0){Fe.update(()=>{d.onUpdate(h),d.onComplete()});return}}return s.isSync?new ts(d):new Zv(d)};function Ox({protectedKeys:r,needsAnimating:e},t){const n=r.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function mf(r,e,{delay:t=0,transitionOverride:n,type:a}={}){let{transition:i=r.getDefaultTransition(),transitionEnd:o,...s}=e;n&&(i=n);const l=[],c=a&&r.animationState&&r.animationState.getState()[a];for(const d in s){const f=r.getValue(d,r.latestValues[d]??null),h=s[d];if(h===void 0||c&&Ox(c,d))continue;const p={delay:t,...ns(i||{},d)},g=f.get();if(g!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===g&&!p.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const v=pf(r);if(v){const b=window.MotionHandoffAnimation(v,d,Fe);b!==null&&(p.startTime=b,y=!0)}}yo(r,d),f.start(gs(d,f,h,r.shouldReduceMotion&&Pd.has(d)?{type:!1}:p,r,y));const x=f.animation;x&&l.push(x)}return o&&Promise.all(l).then(()=>{Fe.update(()=>{o&&wx(r,o)})}),l}function gf(r,e,t,n=0,a=1){const i=Array.from(r).sort((c,d)=>c.sortNodePosition(d)).indexOf(e),o=r.size,s=(o-1)*n;return typeof t=="function"?t(i,o):a===1?i*n:s-i*n}function xo(r,e,t={}){var l;const n=on(r,e,t.type==="exit"?(l=r.presenceContext)==null?void 0:l.custom:void 0);let{transition:a=r.getDefaultTransition()||{}}=n||{};t.transitionOverride&&(a=t.transitionOverride);const i=n?()=>Promise.all(mf(r,n,t)):()=>Promise.resolve(),o=r.variantChildren&&r.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=a;return Dx(r,e,c,d,f,h,t)}:()=>Promise.resolve(),{when:s}=a;if(s){const[c,d]=s==="beforeChildren"?[i,o]:[o,i];return c().then(()=>d())}else return Promise.all([i(),o(t.delay)])}function Dx(r,e,t=0,n=0,a=0,i=1,o){const s=[];for(const l of r.variantChildren)l.notify("AnimationStart",e),s.push(xo(l,e,{...o,delay:t+(typeof n=="function"?0:n)+gf(r.variantChildren,l,n,a,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(s)}function Px(r,e,t={}){r.notify("AnimationStart",e);let n;if(Array.isArray(e)){const a=e.map(i=>xo(r,i,t));n=Promise.all(a)}else if(typeof e=="string")n=xo(r,e,t);else{const a=typeof e=="function"?on(r,e,t.custom):e;n=Promise.all(mf(r,a,t))}return n.then(()=>{r.notify("AnimationComplete",e)})}function vf(r,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==r.length)return!1;for(let n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}const Mx=cs.length;function yf(r){if(!r)return;if(!r.isControllingVariants){const t=r.parent?yf(r.parent)||{}:{};return r.props.initial!==void 0&&(t.initial=r.props.initial),t}const e={};for(let t=0;t<Mx;t++){const n=cs[t],a=r.props[n];(Hn(a)||a===!1)&&(e[n]=a)}return e}const Lx=[...ls].reverse(),kx=ls.length;function Fx(r){return e=>Promise.all(e.map(({animation:t,options:n})=>Px(r,t,n)))}function Bx(r){let e=Fx(r),t=Zl(),n=!0;const a=l=>(c,d)=>{var h;const f=on(r,d,l==="exit"?(h=r.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:p,transitionEnd:g,...y}=f;c={...c,...y,...g}}return c};function i(l){e=l(r)}function o(l){const{props:c}=r,d=yf(r.parent)||{},f=[],h=new Set;let p={},g=1/0;for(let x=0;x<kx;x++){const v=Lx[x],b=t[v],_=c[v]!==void 0?c[v]:d[v],w=Hn(_),A=v===l?b.isActive:null;A===!1&&(g=x);let C=_===d[v]&&_!==c[v]&&w;if(C&&n&&r.manuallyAnimateOnMount&&(C=!1),b.protectedKeys={...p},!b.isActive&&A===null||!_&&!b.prevProp||qa(_)||typeof _=="boolean")continue;const I=Vx(b.prevProp,_);let R=I||v===l&&b.isActive&&!C&&w||x>g&&w,F=!1;const T=Array.isArray(_)?_:[_];let U=T.reduce(a(v),{});A===!1&&(U={});const{prevResolvedValues:L={}}=b,B={...L,...U},H=W=>{R=!0,h.has(W)&&(F=!0,h.delete(W)),b.needsAnimating[W]=!0;const X=r.getValue(W);X&&(X.liveStyle=!1)};for(const W in B){const X=U[W],z=L[W];if(p.hasOwnProperty(W))continue;let ie=!1;vo(X)&&vo(z)?ie=!vf(X,z):ie=X!==z,ie?X!=null?H(W):h.add(W):X!==void 0&&h.has(W)?H(W):b.protectedKeys[W]=!0}b.prevProp=_,b.prevResolvedValues=U,b.isActive&&(p={...p,...U}),n&&r.blockInitialAnimation&&(R=!1);const Q=C&&I;R&&(!Q||F)&&f.push(...T.map(W=>{const X={type:v};if(typeof W=="string"&&n&&!Q&&r.manuallyAnimateOnMount&&r.parent){const{parent:z}=r,ie=on(z,W);if(z.enteringChildren&&ie){const{delayChildren:J}=ie.transition||{};X.delay=gf(z.enteringChildren,r,J)}}return{animation:W,options:X}}))}if(h.size){const x={};if(typeof c.initial!="boolean"){const v=on(r,Array.isArray(c.initial)?c.initial[0]:c.initial);v&&v.transition&&(x.transition=v.transition)}h.forEach(v=>{const b=r.getBaseTarget(v),_=r.getValue(v);_&&(_.liveStyle=!0),x[v]=b??null}),f.push({animation:x})}let y=!!f.length;return n&&(c.initial===!1||c.initial===c.animate)&&!r.manuallyAnimateOnMount&&(y=!1),n=!1,y?e(f):Promise.resolve()}function s(l,c){var f;if(t[l].isActive===c)return Promise.resolve();(f=r.variantChildren)==null||f.forEach(h=>{var p;return(p=h.animationState)==null?void 0:p.setActive(l,c)}),t[l].isActive=c;const d=o(l);for(const h in t)t[h].protectedKeys={};return d}return{animateChanges:o,setActive:s,setAnimateFunction:i,getState:()=>t,reset:()=>{t=Zl()}}}function Vx(r,e){return typeof e=="string"?e!==r:Array.isArray(e)?!vf(e,r):!1}function Or(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Zl(){return{animate:Or(!0),whileInView:Or(),whileHover:Or(),whileTap:Or(),whileDrag:Or(),whileFocus:Or(),exit:Or()}}class Er{constructor(e){this.isMounted=!1,this.node=e}update(){}}class jx extends Er{constructor(e){super(e),e.animationState||(e.animationState=Bx(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();qa(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let Ux=0;class $x extends Er{constructor(){super(...arguments),this.id=Ux++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const a=this.node.animationState.setActive("exit",!e);t&&!e&&a.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Hx={animation:{Feature:jx},exit:{Feature:$x}};function zn(r,e,t,n={passive:!0}){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t)}function na(r){return{point:{x:r.pageX,y:r.pageY}}}const Gx=r=>e=>os(e)&&r(e,na(e));function Pn(r,e,t,n){return zn(r,e,Gx(t),n)}const xf=1e-4,zx=1-xf,Wx=1+xf,bf=.01,Xx=0-bf,qx=0+bf;function wt(r){return r.max-r.min}function Yx(r,e,t){return Math.abs(r-e)<=t}function Ql(r,e,t,n=.5){r.origin=n,r.originPoint=je(e.min,e.max,r.origin),r.scale=wt(t)/wt(e),r.translate=je(t.min,t.max,r.origin)-r.originPoint,(r.scale>=zx&&r.scale<=Wx||isNaN(r.scale))&&(r.scale=1),(r.translate>=Xx&&r.translate<=qx||isNaN(r.translate))&&(r.translate=0)}function Mn(r,e,t,n){Ql(r.x,e.x,t.x,n?n.originX:void 0),Ql(r.y,e.y,t.y,n?n.originY:void 0)}function Jl(r,e,t){r.min=t.min+e.min,r.max=r.min+wt(e)}function Kx(r,e,t){Jl(r.x,e.x,t.x),Jl(r.y,e.y,t.y)}function ec(r,e,t){r.min=e.min-t.min,r.max=r.min+wt(e)}function Ln(r,e,t){ec(r.x,e.x,t.x),ec(r.y,e.y,t.y)}function Dt(r){return[r("x"),r("y")]}const wf=({current:r})=>r?r.ownerDocument.defaultView:null,tc=(r,e)=>Math.abs(r-e);function Zx(r,e){const t=tc(r.x,e.x),n=tc(r.y,e.y);return Math.sqrt(t**2+n**2)}class Af{constructor(e,t,{transformPagePoint:n,contextWindow:a=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ni(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=Zx(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!g)return;const{point:y}=h,{timestamp:x}=ut;this.history.push({...y,timestamp:x});const{onStart:v,onMove:b}=this.handlers;p||(v&&v(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Ei(p,this.transformPagePoint),Fe.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:g,onSessionEnd:y,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Ni(h.type==="pointercancel"?this.lastMoveEventInfo:Ei(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,v),y&&y(h,v)},!os(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=a||window;const s=na(e),l=Ei(s,this.transformPagePoint),{point:c}=l,{timestamp:d}=ut;this.history=[{...c,timestamp:d}];const{onSessionStart:f}=t;f&&f(e,Ni(l,this.history)),this.removeListeners=ea(Pn(this.contextWindow,"pointermove",this.handlePointerMove),Pn(this.contextWindow,"pointerup",this.handlePointerUp),Pn(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ar(this.updatePoint)}}function Ei(r,e){return e?{point:e(r.point)}:r}function rc(r,e){return{x:r.x-e.x,y:r.y-e.y}}function Ni({point:r},e){return{point:r,delta:rc(r,Cf(e)),offset:rc(r,Qx(e)),velocity:Jx(e,.1)}}function Qx(r){return r[0]}function Cf(r){return r[r.length-1]}function Jx(r,e){if(r.length<2)return{x:0,y:0};let t=r.length-1,n=null;const a=Cf(r);for(;t>=0&&(n=r[t],!(a.timestamp-n.timestamp>Qt(e)));)t--;if(!n)return{x:0,y:0};const i=Ft(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function e2(r,{min:e,max:t},n){return e!==void 0&&r<e?r=n?je(e,r,n.min):Math.max(r,e):t!==void 0&&r>t&&(r=n?je(t,r,n.max):Math.min(r,t)),r}function nc(r,e,t){return{min:e!==void 0?r.min+e:void 0,max:t!==void 0?r.max+t-(r.max-r.min):void 0}}function t2(r,{top:e,left:t,bottom:n,right:a}){return{x:nc(r.x,t,a),y:nc(r.y,e,n)}}function ac(r,e){let t=e.min-r.min,n=e.max-r.max;return e.max-e.min<r.max-r.min&&([t,n]=[n,t]),{min:t,max:n}}function r2(r,e){return{x:ac(r.x,e.x),y:ac(r.y,e.y)}}function n2(r,e){let t=.5;const n=wt(r),a=wt(e);return a>n?t=jn(e.min,e.max-n,r.min):n>a&&(t=jn(r.min,r.max-a,e.min)),ur(0,1,t)}function a2(r,e){const t={};return e.min!==void 0&&(t.min=e.min-r.min),e.max!==void 0&&(t.max=e.max-r.min),t}const bo=.35;function i2(r=bo){return r===!1?r=0:r===!0&&(r=bo),{x:ic(r,"left","right"),y:ic(r,"top","bottom")}}function ic(r,e,t){return{min:oc(r,e),max:oc(r,t)}}function oc(r,e){return typeof r=="number"?r:r[e]||0}const o2=new WeakMap;class s2{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=We(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:n}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const i=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(na(f).point)},o=(f,h)=>{const{drag:p,dragPropagation:g,onDragStart:y}=this.getProps();if(p&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=hy(p),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Dt(v=>{let b=this.getAxisMotionValue(v).get()||0;if(Jt.test(b)){const{projection:_}=this.visualElement;if(_&&_.layout){const w=_.layout.layoutBox[v];w&&(b=wt(w)*(parseFloat(b)/100))}}this.originPoint[v]=b}),y&&Fe.postRender(()=>y(f,h)),yo(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},s=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:g,onDirectionLock:y,onDrag:x}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:v}=h;if(g&&this.currentDirection===null){this.currentDirection=l2(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",h.point,v),this.updateAxis("y",h.point,v),this.visualElement.render(),x&&x(f,h)},l=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>Dt(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Af(e,{onSessionStart:i,onStart:o,onMove:s,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:wf(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,a=t||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!a||!n)return;const{velocity:o}=a;this.startAnimation(o);const{onDragEnd:s}=this.getProps();s&&Fe.postRender(()=>s(n,a))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:a}=this.getProps();if(!n||!pa(e,a,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=e2(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:t}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,a=this.constraints;e&&tn(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=t2(n.layoutBox,e):this.constraints=!1,this.elastic=i2(t),a!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Dt(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=a2(n.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!tn(e))return!1;const n=e.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=cx(n,a.root,this.visualElement.getTransformPagePoint());let o=r2(a.layout.layoutBox,i);if(t){const s=t(ox(o));this.hasMutatedConstraints=!!s,s&&(o=of(s))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:s}=this.getProps(),l=this.constraints||{},c=Dt(d=>{if(!pa(d,t,this.currentDirection))return;let f=l&&l[d]||{};o&&(f={min:0,max:0});const h=a?200:1e6,p=a?40:1e7,g={type:"inertia",velocity:n?e[d]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(d,g)});return Promise.all(c).then(s)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return yo(this.visualElement,e),n.start(gs(e,n,0,t,this.visualElement,!1))}stopAnimation(){Dt(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Dt(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),a=n[t];return a||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Dt(t=>{const{drag:n}=this.getProps();if(!pa(t,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(t);if(a&&a.layout){const{min:o,max:s}=a.layout.layoutBox[t];i.set(e[t]-je(o,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!tn(t)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Dt(o=>{const s=this.getAxisMotionValue(o);if(s&&this.constraints!==!1){const l=s.get();a[o]=n2({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Dt(o=>{if(!pa(o,e,null))return;const s=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];s.set(je(l,c,a[o]))})}addListeners(){if(!this.visualElement.current)return;o2.set(this.visualElement,this);const e=this.visualElement.current,t=Pn(e,"pointerdown",l=>{const{drag:c,dragListener:d=!0}=this.getProps();c&&d&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();tn(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),Fe.read(n);const o=zn(window,"resize",()=>this.scalePositionWithinConstraints()),s=a.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Dt(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=l[d].translate,f.set(f.get()+l[d].translate))}),this.visualElement.render())});return()=>{o(),t(),i(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:o=bo,dragMomentum:s=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:o,dragMomentum:s}}}function pa(r,e,t){return(e===!0||e===r)&&(t===null||t===r)}function l2(r,e=10){let t=null;return Math.abs(r.y)>e?t="y":Math.abs(r.x)>e&&(t="x"),t}class c2 extends Er{constructor(e){super(e),this.removeGroupControls=jt,this.removeListeners=jt,this.controls=new s2(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||jt}unmount(){this.removeGroupControls(),this.removeListeners()}}const sc=r=>(e,t)=>{r&&Fe.postRender(()=>r(e,t))};class u2 extends Er{constructor(){super(...arguments),this.removePointerDownListener=jt}onPointerDown(e){this.session=new Af(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:wf(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:sc(e),onStart:sc(t),onMove:n,onEnd:(i,o)=>{delete this.session,a&&Fe.postRender(()=>a(i,o))}}}mount(){this.removePointerDownListener=Pn(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const _a={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function lc(r,e){return e.max===e.min?0:r/(e.max-e.min)*100}const An={correct:(r,e)=>{if(!e.target)return r;if(typeof r=="string")if(oe.test(r))r=parseFloat(r);else return r;const t=lc(r,e.target.x),n=lc(r,e.target.y);return`${t}% ${n}%`}},d2={correct:(r,{treeScale:e,projectionDelta:t})=>{const n=r,a=Cr.parse(r);if(a.length>5)return n;const i=Cr.createTransformer(r),o=typeof a[0]!="number"?1:0,s=t.x.scale*e.x,l=t.y.scale*e.y;a[0+o]/=s,a[1+o]/=l;const c=je(s,l,.5);return typeof a[2+o]=="number"&&(a[2+o]/=c),typeof a[3+o]=="number"&&(a[3+o]/=c),i(a)}};let Si=!1;class f2 extends N.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=e;My(h2),i&&(t.group&&t.group.add(i),n&&n.register&&a&&n.register(i),Si&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),_a.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:a,isPresent:i}=this.props,{projection:o}=n;return o&&(o.isPresent=i,Si=!0,a||e.layoutDependency!==t||t===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Fe.postRender(()=>{const s=o.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),is.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:a}=e;Si=!0,a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function _f(r){const[e,t]=Gd(),n=N.useContext(Fo);return or.jsx(f2,{...r,layoutGroup:n,switchLayoutGroup:N.useContext(nf),isPresent:e,safeToRemove:t})}const h2={borderRadius:{...An,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:An,borderTopRightRadius:An,borderBottomLeftRadius:An,borderBottomRightRadius:An,boxShadow:d2};function p2(r,e,t){const n=mt(r)?r:cn(r);return n.start(gs("",n,e,t)),n.animation}const m2=(r,e)=>r.depth-e.depth;class g2{constructor(){this.children=[],this.isDirty=!1}add(e){jo(this.children,e),this.isDirty=!0}remove(e){Uo(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(m2),this.isDirty=!1,this.children.forEach(e)}}function v2(r,e){const t=St.now(),n=({timestamp:a})=>{const i=a-t;i>=e&&(Ar(n),r(i-e))};return Fe.setup(n,!0),()=>Ar(n)}const Ef=["TopLeft","TopRight","BottomLeft","BottomRight"],y2=Ef.length,cc=r=>typeof r=="string"?parseFloat(r):r,uc=r=>typeof r=="number"||oe.test(r);function x2(r,e,t,n,a,i){a?(r.opacity=je(0,t.opacity??1,b2(n)),r.opacityExit=je(e.opacity??1,0,w2(n))):i&&(r.opacity=je(e.opacity??1,t.opacity??1,n));for(let o=0;o<y2;o++){const s=`border${Ef[o]}Radius`;let l=dc(e,s),c=dc(t,s);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||uc(l)===uc(c)?(r[s]=Math.max(je(cc(l),cc(c),n),0),(Jt.test(c)||Jt.test(l))&&(r[s]+="%")):r[s]=c}(e.rotate||t.rotate)&&(r.rotate=je(e.rotate||0,t.rotate||0,n))}function dc(r,e){return r[e]!==void 0?r[e]:r.borderRadius}const b2=Nf(0,.5,ud),w2=Nf(.5,.95,jt);function Nf(r,e,t){return n=>n<r?0:n>e?1:t(jn(r,e,n))}function fc(r,e){r.min=e.min,r.max=e.max}function Rt(r,e){fc(r.x,e.x),fc(r.y,e.y)}function hc(r,e){r.translate=e.translate,r.scale=e.scale,r.originPoint=e.originPoint,r.origin=e.origin}function pc(r,e,t,n,a){return r-=e,r=ka(r,1/t,n),a!==void 0&&(r=ka(r,1/a,n)),r}function A2(r,e=0,t=1,n=.5,a,i=r,o=r){if(Jt.test(e)&&(e=parseFloat(e),e=je(o.min,o.max,e/100)-o.min),typeof e!="number")return;let s=je(i.min,i.max,n);r===i&&(s-=e),r.min=pc(r.min,e,t,s,a),r.max=pc(r.max,e,t,s,a)}function mc(r,e,[t,n,a],i,o){A2(r,e[t],e[n],e[a],e.scale,i,o)}const C2=["x","scaleX","originX"],_2=["y","scaleY","originY"];function gc(r,e,t,n){mc(r.x,e,C2,t?t.x:void 0,n?n.x:void 0),mc(r.y,e,_2,t?t.y:void 0,n?n.y:void 0)}function vc(r){return r.translate===0&&r.scale===1}function Sf(r){return vc(r.x)&&vc(r.y)}function yc(r,e){return r.min===e.min&&r.max===e.max}function E2(r,e){return yc(r.x,e.x)&&yc(r.y,e.y)}function xc(r,e){return Math.round(r.min)===Math.round(e.min)&&Math.round(r.max)===Math.round(e.max)}function If(r,e){return xc(r.x,e.x)&&xc(r.y,e.y)}function bc(r){return wt(r.x)/wt(r.y)}function wc(r,e){return r.translate===e.translate&&r.scale===e.scale&&r.originPoint===e.originPoint}class N2{constructor(){this.members=[]}add(e){jo(this.members,e),e.scheduleRender()}remove(e){if(Uo(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(a=>e===a);if(t===0)return!1;let n;for(let a=t;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:a}=e.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function S2(r,e,t){let n="";const a=r.x.translate/e.x,i=r.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((a||i||o)&&(n=`translate3d(${a}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:d,rotateX:f,rotateY:h,skewX:p,skewY:g}=t;c&&(n=`perspective(${c}px) ${n}`),d&&(n+=`rotate(${d}deg) `),f&&(n+=`rotateX(${f}deg) `),h&&(n+=`rotateY(${h}deg) `),p&&(n+=`skewX(${p}deg) `),g&&(n+=`skewY(${g}deg) `)}const s=r.x.scale*e.x,l=r.y.scale*e.y;return(s!==1||l!==1)&&(n+=`scale(${s}, ${l})`),n||"none"}const Ii=["","X","Y","Z"],I2=1e3;let T2=0;function Ti(r,e,t,n){const{latestValues:a}=e;a[r]&&(t[r]=a[r],e.setStaticValue(r,0),n&&(n[r]=0))}function Tf(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:e}=r.options;if(!e)return;const t=pf(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:a,layoutId:i}=r.options;window.MotionCancelOptimisedAnimation(t,"transform",Fe,!(a||i))}const{parent:n}=r;n&&!n.hasCheckedOptimisedAppear&&Tf(n)}function Rf({attachResizeListener:r,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(o={},s=e==null?void 0:e()){this.id=T2++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(D2),this.nodes.forEach(k2),this.nodes.forEach(F2),this.nodes.forEach(P2)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new g2)}addEventListener(o,s){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Go),this.eventHandlers.get(o).add(s)}notifyListeners(o,...s){const l=this.eventHandlers.get(o);l&&l.notify(...s)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Hd(o)&&!xy(o),this.instance=o;const{layoutId:s,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||s)&&(this.isLayoutDirty=!0),r){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;Fe.read(()=>{f=window.innerWidth}),r(o,()=>{const p=window.innerWidth;p!==f&&(f=p,this.root.updateBlockedByResize=!0,d&&d(),d=v2(h,250),_a.hasAnimatedSinceResize&&(_a.hasAnimatedSinceResize=!1,this.nodes.forEach(_c)))})}s&&this.root.registerSharedNode(s,this),this.options.animate!==!1&&c&&(s||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||c.getDefaultTransition()||$2,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=c.getProps(),v=!this.targetLayout||!If(this.targetLayout,p),b=!f&&h;if(this.options.layoutRoot||this.resumeFrom||b||f&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...ns(g,"layout"),onPlay:y,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(d,b)}else f||_c(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ar(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(B2),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Tf(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:s,layout:l}=this.options;if(s===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ac);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Cc);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(L2),this.nodes.forEach(R2),this.nodes.forEach(O2)):this.nodes.forEach(Cc),this.clearAllSnapshots();const s=St.now();ut.delta=ur(0,1e3/60,s-ut.timestamp),ut.timestamp=s,ut.isProcessing=!0,vi.update.process(ut),vi.preRender.process(ut),vi.render.process(ut),ut.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,is.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(M2),this.sharedNodes.forEach(V2)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Fe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Fe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!wt(this.snapshot.measuredBox.x)&&!wt(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=We(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let s=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(s=!1),s&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!a)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,s=this.projectionDelta&&!Sf(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,d=c!==this.prevTransformTemplateValue;o&&this.instance&&(s||Mr(this.latestValues)||d)&&(a(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const s=this.measurePageBox();let l=this.removeElementScroll(s);return o&&(l=this.removeTransform(l)),H2(l),{animationId:this.root.animationId,measuredBox:s,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return We();const s=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(G2))){const{scroll:d}=this.root;d&&(rn(s.x,d.offset.x),rn(s.y,d.offset.y))}return s}removeElementScroll(o){var l;const s=We();if(Rt(s,o),(l=this.scroll)!=null&&l.wasRoot)return s;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&Rt(s,o),rn(s.x,f.offset.x),rn(s.y,f.offset.y))}return s}applyTransform(o,s=!1){const l=We();Rt(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];!s&&d.options.layoutScroll&&d.scroll&&d!==d.root&&nn(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Mr(d.latestValues)&&nn(l,d.latestValues)}return Mr(this.latestValues)&&nn(l,this.latestValues),l}removeTransform(o){const s=We();Rt(s,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Mr(c.latestValues))continue;po(c.latestValues)&&c.updateSnapshot();const d=We(),f=c.measurePageBox();Rt(d,f),gc(s,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,d)}return Mr(this.latestValues)&&gc(s,this.latestValues),s}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ut.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var h;const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==s;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=ut.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=We(),this.relativeTargetOrigin=We(),Ln(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),Rt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=We(),this.targetWithTransforms=We()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Kx(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Rt(this.target,this.layout.layoutBox),lf(this.target,this.targetDelta)):Rt(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=We(),this.relativeTargetOrigin=We(),Ln(this.relativeTargetOrigin,this.target,p.target),Rt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||po(this.parent.latestValues)||sf(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var g;const o=this.getLead(),s=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(g=this.parent)!=null&&g.isProjectionDirty)&&(l=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ut.timestamp&&(l=!1),l)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;Rt(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;lx(this.layoutCorrected,this.treeScale,this.path,s),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=We());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(hc(this.prevProjectionDelta.x,this.projectionDelta.x),hc(this.prevProjectionDelta.y,this.projectionDelta.y)),Mn(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!wc(this.projectionDelta.x,this.prevProjectionDelta.x)||!wc(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var s;if((s=this.options.visualElement)==null||s.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=an(),this.projectionDelta=an(),this.projectionDeltaWithTransform=an()}setAnimationOrigin(o,s=!1){const l=this.snapshot,c=l?l.latestValues:{},d={...this.latestValues},f=an();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const h=We(),p=l?l.source:void 0,g=this.layout?this.layout.source:void 0,y=p!==g,x=this.getStack(),v=!x||x.members.length<=1,b=!!(y&&!v&&this.options.crossfade===!0&&!this.path.some(U2));this.animationProgress=0;let _;this.mixTargetDelta=w=>{const A=w/1e3;Ec(f.x,o.x,A),Ec(f.y,o.y,A),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ln(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),j2(this.relativeTarget,this.relativeTargetOrigin,h,A),_&&E2(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=We()),Rt(_,this.relativeTarget)),y&&(this.animationValues=d,x2(d,c,this.latestValues,A,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var s,l,c;this.notifyListeners("animationStart"),(s=this.currentAnimation)==null||s.stop(),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(),this.pendingAnimation&&(Ar(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Fe.update(()=>{_a.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=cn(0)),this.currentAnimation=p2(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),o.onUpdate&&o.onUpdate(d)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(I2),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:s,target:l,layout:c,latestValues:d}=o;if(!(!s||!l||!c)){if(this!==o&&this.layout&&c&&Of(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||We();const f=wt(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+f;const h=wt(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}Rt(s,l),nn(s,d),Mn(this.projectionDeltaWithTransform,this.layoutCorrected,s,d)}}registerSharedNode(o,s){this.sharedNodes.has(o)||this.sharedNodes.set(o,new N2),this.sharedNodes.get(o).add(s);const c=s.options.initialPromotionConfig;s.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(s):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var s;const{layoutId:o}=this.options;return o?((s=this.getStack())==null?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:o}=this.options;return o?(s=this.getStack())==null?void 0:s.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:s,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let s=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(s=!0),!s)return;const c={};l.z&&Ti("z",o,c,this.animationValues);for(let d=0;d<Ii.length;d++)Ti(`rotate${Ii[d]}`,o,c,this.animationValues),Ti(`skew${Ii[d]}`,o,c,this.animationValues);o.render();for(const d in c)o.setStaticValue(d,c[d]),this.animationValues&&(this.animationValues[d]=c[d]);o.scheduleRender()}applyProjectionStyles(o,s){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Ca(s==null?void 0:s.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Ca(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!Mr(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const d=c.animationValues||c.latestValues;this.applyTransformsToTarget();let f=S2(this.projectionDeltaWithTransform,this.treeScale,d);l&&(f=l(d,f)),o.transform=f;const{x:h,y:p}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,c.animationValues?o.opacity=c===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:o.opacity=c===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in Gn){if(d[g]===void 0)continue;const{correct:y,applyTo:x,isCSSVariable:v}=Gn[g],b=f==="none"?d[g]:y(d[g],c);if(x){const _=x.length;for(let w=0;w<_;w++)o[x[w]]=b}else v?this.options.visualElement.renderState.vars[g]=b:o[g]=b}this.options.layoutId&&(o.pointerEvents=c===this?Ca(s==null?void 0:s.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var s;return(s=o.currentAnimation)==null?void 0:s.stop()}),this.root.nodes.forEach(Ac),this.root.sharedNodes.clear()}}}function R2(r){r.updateLayout()}function O2(r){var t;const e=((t=r.resumeFrom)==null?void 0:t.snapshot)||r.snapshot;if(r.isLead()&&r.layout&&e&&r.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=r.layout,{animationType:i}=r.options,o=e.source!==r.layout.source;i==="size"?Dt(f=>{const h=o?e.measuredBox[f]:e.layoutBox[f],p=wt(h);h.min=n[f].min,h.max=h.min+p}):Of(i,e.layoutBox,n)&&Dt(f=>{const h=o?e.measuredBox[f]:e.layoutBox[f],p=wt(n[f]);h.max=h.min+p,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[f].max=r.relativeTarget[f].min+p)});const s=an();Mn(s,n,e.layoutBox);const l=an();o?Mn(l,r.applyTransform(a,!0),e.measuredBox):Mn(l,n,e.layoutBox);const c=!Sf(s);let d=!1;if(!r.resumeFrom){const f=r.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:p}=f;if(h&&p){const g=We();Ln(g,e.layoutBox,h.layoutBox);const y=We();Ln(y,n,p.layoutBox),If(g,y)||(d=!0),f.options.layoutRoot&&(r.relativeTarget=y,r.relativeTargetOrigin=g,r.relativeParent=f)}}}r.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:l,layoutDelta:s,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(r.isLead()){const{onExitComplete:n}=r.options;n&&n()}r.options.transition=void 0}function D2(r){r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function P2(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function M2(r){r.clearSnapshot()}function Ac(r){r.clearMeasurements()}function Cc(r){r.isLayoutDirty=!1}function L2(r){const{visualElement:e}=r.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),r.resetTransform()}function _c(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function k2(r){r.resolveTargetDelta()}function F2(r){r.calcProjection()}function B2(r){r.resetSkewAndRotation()}function V2(r){r.removeLeadSnapshot()}function Ec(r,e,t){r.translate=je(e.translate,0,t),r.scale=je(e.scale,1,t),r.origin=e.origin,r.originPoint=e.originPoint}function Nc(r,e,t,n){r.min=je(e.min,t.min,n),r.max=je(e.max,t.max,n)}function j2(r,e,t,n){Nc(r.x,e.x,t.x,n),Nc(r.y,e.y,t.y,n)}function U2(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const $2={duration:.45,ease:[.4,0,.1,1]},Sc=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),Ic=Sc("applewebkit/")&&!Sc("chrome/")?Math.round:jt;function Tc(r){r.min=Ic(r.min),r.max=Ic(r.max)}function H2(r){Tc(r.x),Tc(r.y)}function Of(r,e,t){return r==="position"||r==="preserve-aspect"&&!Yx(bc(e),bc(t),.2)}function G2(r){var e;return r!==r.root&&((e=r.scroll)==null?void 0:e.wasRoot)}const z2=Rf({attachResizeListener:(r,e)=>zn(r,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ri={current:void 0},Df=Rf({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!Ri.current){const r=new z2({});r.mount(window),r.setOptions({layoutScroll:!0}),Ri.current=r}return Ri.current},resetTransform:(r,e)=>{r.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),W2={pan:{Feature:u2},drag:{Feature:c2,ProjectionNode:Df,MeasureLayout:_f}};function Rc(r,e,t){const{props:n}=r;r.animationState&&n.whileHover&&r.animationState.setActive("whileHover",t==="Start");const a="onHover"+t,i=n[a];i&&Fe.postRender(()=>i(e,na(e)))}class X2 extends Er{mount(){const{current:e}=this.node;e&&(this.unmount=py(e,(t,n)=>(Rc(this.node,n,"Start"),a=>Rc(this.node,a,"End"))))}unmount(){}}class q2 extends Er{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ea(zn(this.node.current,"focus",()=>this.onFocus()),zn(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Oc(r,e,t){const{props:n}=r;if(r.current instanceof HTMLButtonElement&&r.current.disabled)return;r.animationState&&n.whileTap&&r.animationState.setActive("whileTap",t==="Start");const a="onTap"+(t==="End"?"":t),i=n[a];i&&Fe.postRender(()=>i(e,na(e)))}class Y2 extends Er{mount(){const{current:e}=this.node;e&&(this.unmount=yy(e,(t,n)=>(Oc(this.node,n,"Start"),(a,{success:i})=>Oc(this.node,a,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const wo=new WeakMap,Oi=new WeakMap,K2=r=>{const e=wo.get(r.target);e&&e(r)},Z2=r=>{r.forEach(K2)};function Q2({root:r,...e}){const t=r||document;Oi.has(t)||Oi.set(t,{});const n=Oi.get(t),a=JSON.stringify(e);return n[a]||(n[a]=new IntersectionObserver(Z2,{root:r,...e})),n[a]}function J2(r,e,t){const n=Q2(e);return wo.set(r,t),n.observe(r),()=>{wo.delete(r),n.unobserve(r)}}const eb={some:0,all:1};class tb extends Er{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:a="some",once:i}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:eb[a]},s=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=c?d:f;h&&h(l)};return J2(this.node.current,o,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(rb(e,t))&&this.startObserver()}unmount(){}}function rb({viewport:r={}},{viewport:e={}}={}){return t=>r[t]!==e[t]}const nb={inView:{Feature:tb},tap:{Feature:Y2},focus:{Feature:q2},hover:{Feature:X2}},ab={layout:{ProjectionNode:Df,MeasureLayout:_f}},ib={...Hx,...nb,...W2,...ab},gr=ix(ib,yx),Pf="pendingReservation",ob=r=>`mb:lastStep:${r||""}`,sb=()=>{try{const r=localStorage.getItem(Pf);return r?JSON.parse(r):null}catch{return null}},Dr=()=>{try{localStorage.removeItem(Pf),console.log("ðŸ§¹ pendingReservation nettoyÃ© du localStorage")}catch(r){console.error("Erreur lors du nettoyage localStorage:",r)}try{sessionStorage.removeItem("reservationDraft"),console.log("ðŸ§¹ reservationDraft nettoyÃ© du sessionStorage")}catch(r){console.error("Erreur lors du nettoyage sessionStorage:",r)}try{["currentReservation","lastReservationId","pending_payment","mb_pending"].forEach(e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)})}catch{}},lb=r=>r?{text:r,icon:u(sr,{className:"h-4 w-4"})}:{text:"Non prÃ©cisÃ©",icon:u(sr,{className:"h-4 w-4"})},cb=r=>new Date(r).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"});async function ub(r,e){var o;const t=await xe(Pe(ce(j,"companies"),me("slug","==",r)));if(t.empty)throw new Error("Compagnie introuvable");const n=t.docs[0].id,a=await xe(Pe(Su(j,"reservations"),me($h(),"==",e)));for(const s of a.docs)if(s.ref.path.includes(`/companies/${n}/`)){const l=(o=s.ref.parent.parent)==null?void 0:o.id;return{ref:s.ref,companyId:n,agencyId:l}}const i=await xe(ce(j,"companies",n,"agences"));for(const s of i.docs){const l=le(j,"companies",n,"agences",s.id,"reservations",e);if((await pt(l)).exists())return{ref:l,companyId:n,agencyId:s.id}}throw new Error("RÃ©servation introuvable")}async function db(r,e){const t=Pe(Su(j,"reservations"),me("companySlug","==",r),me("publicToken","==",e),dn(1)),n=await xe(t);if(n.empty)throw new Error("RÃ©servation introuvable");const a=n.docs[0],i=a.ref.path.split("/");return{ref:a.ref,companyId:i[1],agencyId:i[3],hardId:a.id}}function fb(r){return r.canal==="guichet"||r.statut==="confirme"}const Di=[{key:"verification",label:"Preuve envoyÃ©e",description:"Preuve envoyÃ©e. En attente de vÃ©rification par la compagnie.",icon:u(No,{className:"h-4 w-4"}),isFinal:!1},{key:"confirme",label:"Paiement confirmÃ©",description:"Paiement confirmÃ©. Votre billet est disponible.",icon:u(eh,{className:"h-4 w-4"}),isFinal:!0}],Ao=()=>{var W;const r=tr(),{slug:e="",id:t}=_r(),n=Ur(),i=new URLSearchParams(n.search).get("r")||"",{companyInfo:o}=n.state||{},[s,l]=N.useState(null),[c,d]=N.useState(""),[f,h]=N.useState(!0),[p,g]=N.useState(o||null),[y,x]=N.useState(null),[v,b]=N.useState(!1),[_,w]=qf(),C=(p==null?void 0:p.couleurPrimaire)||(p==null?void 0:p.primaryColor)||"#3b82f6",I=(p==null?void 0:p.secondaryColor)||"#60a5fa";N.useEffect(()=>{try{localStorage.setItem(ob(e),"details")}catch{}},[e]),N.useEffect(()=>{if(!t&&!i||!e){x("ParamÃ¨tres manquants"),h(!1);return}let X;return(async()=>{try{h(!0),console.log(`ðŸ” Recherche rÃ©servation: ID=${t}, token=${i}, slug=${e}`);let z,ie=t||"";const J=n.state||{};if(t)J!=null&&J.companyId&&(J!=null&&J.agencyId)?z=le(j,"companies",J.companyId,"agences",J.agencyId,"reservations",t):z=(await ub(e,t)).ref;else{const K=await db(e,i);z=K.ref,ie=K.hardId}X=lr(z,async K=>{var Me;if(!K.exists()){console.warn("âŒ RÃ©servation introuvable dans Firestore, nettoyage du cache..."),Dr(),x("RÃ©servation introuvable ou expirÃ©e. Veuillez crÃ©er une nouvelle rÃ©servation."),h(!1);return}const pe=K.data(),Ue={...pe,id:K.id,updatedAt:(pe==null?void 0:pe.updatedAt)||new Date().toISOString()},be=(()=>{var Ee;const Re=((Ee=pe.statut)==null?void 0:Ee.toLowerCase())||"";return["preuve_recue","verif","vÃ©rif"].some(E=>Re.includes(E))?"verification":["pay","confirm","valid"].some(E=>Re.includes(E))?"confirme":["refuse","refusÃ©","reject","rejetÃ©"].some(E=>Re.includes(E))?"refuse":["annule","cancel","cancelled"].some(E=>Re.includes(E))?"annule":"en_attente"})(),At={...Ue,statut:be};l(At);const ze=sb();(be==="confirme"||be==="annule"||be==="refuse")&&(ze==null?void 0:ze.id)===K.id&&(console.log("âœ… RÃ©servation terminÃ©e, nettoyage du cache"),Dr()),ze&&ze.id!==K.id&&(console.log("ðŸ”„ ID diffÃ©rent dÃ©tectÃ©, nettoyage ancien cache"),Dr());const fe=At.agencyNom||At.agenceNom;if(fe)d(fe);else{const Re=z.path.split("/")[1],Ee=z.path.split("/")[3];try{const O=(await pt(le(j,"companies",Re,"agences",Ee))).data();d((O==null?void 0:O.nom)||(O==null?void 0:O.name)||"")}catch{}}if(!p)try{const Re=z.path.split("/")[1],Ee=await pt(le(j,"companies",Re));if(Ee.exists()){const E=Ee.data();g({id:Ee.id,name:(E==null?void 0:E.name)||(E==null?void 0:E.nom),primaryColor:E==null?void 0:E.primaryColor,secondaryColor:E==null?void 0:E.secondaryColor,couleurPrimaire:E==null?void 0:E.couleurPrimaire,logoUrl:E==null?void 0:E.logoUrl})}}catch{}if(h(!1),!t&&ie){const Re=((Me=n==null?void 0:n.state)==null?void 0:Me.slug)||At.companySlug||e;window.history.replaceState({},"",`/${Re}/reservation/${ie}`)}},K=>{console.error("âŒ Erreur Firestore:",K),Dr(),x((K==null?void 0:K.message)||"Erreur de connexion au serveur"),h(!1)})}catch(z){console.error("âŒ Erreur gÃ©nÃ©rale:",z),Dr(),x((z==null?void 0:z.message)||"Impossible de localiser la rÃ©servation"),h(!1)}})(),()=>{X&&X()}},[t,i,e,n,p]),N.useEffect(()=>{if((s==null?void 0:s.statut)==="confirme"){const X=`celebrated-${s.id}`;if(!localStorage.getItem(X)){b(!0),localStorage.setItem(X,"true");const z=setTimeout(()=>b(!1),5e3);return()=>clearTimeout(z)}}},[s==null?void 0:s.statut,s==null?void 0:s.id]);const R=s?fb(s):!1,F=String((s==null?void 0:s.canal)||"").toLowerCase(),T=s?Math.max(0,Di.findIndex(X=>X.key===s.statut)):-1,U={en_attente:"Veuillez envoyer votre preuve de paiement.",verification:"Preuve envoyÃ©e. En attente de vÃ©rification par la compagnie.",confirme:"Paiement confirmÃ©. Votre billet est disponible.",refuse:"Cette rÃ©servation a Ã©tÃ© refusÃ©e par la compagnie.",annule:"Cette rÃ©servation a Ã©tÃ© annulÃ©e."};N.useEffect(()=>{var ie;if(!R||!s)return;const X=window.location.pathname,z=`/${((ie=n==null?void 0:n.state)==null?void 0:ie.slug)||s.companySlug||e}/receipt/${s.id}`;X!==z&&(console.log("ðŸš€ Redirection automatique vers le billet"),r(z,{replace:!0,state:{reservation:{...s,agencyNom:c,canal:F},companyInfo:p}}))},[R,s,c,p,F,e,n,r]);const L=F==="guichet"?"EspÃ¨ces":(s==null?void 0:s.paymentMethodLabel)||(s!=null&&s.canal&&s.canal!=="en_ligne"?String(s.canal).replace(/_/g," "):"En ligne"),B=lb(L),H=s!=null&&s.updatedAt&&!isNaN(new Date(s.updatedAt).getTime())?new Date(s.updatedAt).toLocaleString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):null,Q=()=>{Dr(),r(-1)},ae=()=>{Dr();const X=(s==null?void 0:s.companySlug)||e;r(`/${X}`,{replace:!0})};return f?u("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"#f8fafc"},children:m("div",{className:"flex flex-col items-center space-y-3",children:[u(Ja,{className:"h-8 w-8 animate-spin",style:{color:C}}),u("p",{className:"text-gray-700 text-sm",children:"Chargement de votre rÃ©servation..."})]})}):y||!s?u("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"#f8fafc"},children:m("div",{className:"bg-white rounded-xl shadow-sm p-6 max-w-md w-full text-center border border-gray-100",children:[u(vr,{className:"h-10 w-10 text-red-500 mx-auto mb-3"}),u("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"RÃ©servation introuvable"}),u("p",{className:"text-gray-600 mb-5",children:y||"Cette rÃ©servation a expirÃ© ou a Ã©tÃ© supprimÃ©e."}),m("div",{className:"space-y-3",children:[u("button",{onClick:ae,className:"w-full px-5 py-3 rounded-lg text-sm font-medium shadow-sm",style:{backgroundColor:C,color:Et(C)},children:"CrÃ©er une nouvelle rÃ©servation"}),u("button",{onClick:Q,className:"w-full px-5 py-2.5 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:"Retour"})]}),u("p",{className:"text-xs text-gray-500 mt-4 pt-4 border-t border-gray-200",children:"ðŸ’¡ Conseil : Videz le cache de votre navigateur si le problÃ¨me persiste."})]})}):m("div",{className:"min-h-screen pb-32",style:{background:"linear-gradient(180deg, #f8fafc, #ffffff)"},children:[u(zd,{children:s.statut==="confirme"&&u(Yf,{width:_,height:w,recycle:!1,numberOfPieces:200,colors:[C,I,"#ffffff"]})}),u("header",{className:"sticky top-0 z-10 px-5 py-3 shadow-sm",style:{backgroundColor:C,color:Et(C),boxShadow:"0 1px 0 rgba(0,0,0,0.06)"},children:m("div",{className:"flex items-center justify-between max-w-md mx-auto",children:[u("button",{onClick:Q,className:"p-1.5 rounded-full hover:bg-black/10 transition-colors","aria-label":"Retour",children:u(qn,{className:"h-5 w-5"})}),u("h1",{className:"font-semibold text-base tracking-tight",children:"DÃ©tails de rÃ©servation"}),p!=null&&p.logoUrl?u(Kf.LazyLoadImage,{src:p.logoUrl,alt:"Logo",className:"h-8 w-8 rounded-full object-cover border",style:{borderColor:"rgba(255,255,255,0.25)"},effect:"blur"}):u("div",{className:"h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium border",style:{backgroundColor:"rgba(255,255,255,0.15)",borderColor:"rgba(255,255,255,0.35)",color:Et(C)},children:((W=p==null?void 0:p.name)==null?void 0:W.charAt(0))||"C"})]})}),m("main",{className:"max-w-md mx-auto px-4 py-5 space-y-5",children:[s.canal==="en_ligne"&&s.statut!=="refuse"&&s.statut!=="annule"&&m(gr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},className:"rounded-xl p-4 border shadow-xs bg-white",style:{borderColor:"rgba(0,0,0,0.06)"},children:[m("div",{className:"flex justify-between items-center mb-3",children:[u("h2",{className:"text-sm font-semibold text-gray-800",children:"Suivi de paiement"}),H&&u("span",{className:"text-xs text-gray-500",children:H})]}),m("div",{className:"relative",children:[u("div",{className:"absolute top-3 left-0 right-0 h-1 bg-gray-200 rounded-full z-0"}),u(gr.div,{className:"absolute top-3 left-0 h-1 rounded-full z-0",style:{backgroundColor:C},initial:{width:0},animate:{width:`${Math.max(0,(T+1)/Di.length*100)}%`},transition:{type:"spring",stiffness:120,damping:18}}),u("div",{className:"relative z-10 flex justify-between",children:Di.map((X,z)=>{const ie=z<=T,J=z===T&&s.statut!=="confirme",K=X.icon;return m("div",{className:"flex flex-col items-center w-1/2",children:[m("div",{className:"relative mb-1",children:[u("div",{className:"h-6 w-6 rounded-full flex items-center justify-center",style:{backgroundColor:ie?C:"#e5e7eb",color:ie?Et(C):"#6b7280",border:J?`2px solid ${Et(C)}`:"none"},children:z<T?u(Bt,{className:"h-3.5 w-3.5"}):J&&s.statut==="verification"?u(Ja,{className:"h-3.5 w-3.5 animate-spin"}):K}),J&&s.statut==="verification"&&u("span",{className:"absolute inset-0 rounded-full",style:{border:`2px solid ${C}`,opacity:.45,animation:"pingStep 1.2s cubic-bezier(0,0,0.2,1) infinite"}})]}),u("span",{className:`text-xs text-center ${ie?"font-medium text-gray-900":"text-gray-500"}`,children:X.label})]},X.key)})})]})]}),m(gr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"p-4 rounded-xl flex items-start gap-3 border bg-white",style:{borderColor:s.statut==="confirme"?Mt("#10b981",.2):s.statut==="verification"?Mt("#7c3aed",.2):s.statut==="refuse"?Mt("#ef4444",.2):s.statut==="annule"?Mt("#9ca3af",.2):"rgba(0,0,0,0.06)"},children:[u("div",{className:"p-2 rounded-lg flex-shrink-0",style:{backgroundColor:"#ffffff",color:s.statut==="confirme"?"#059669":s.statut==="verification"?"#6d28d9":s.statut==="refuse"?"#dc2626":s.statut==="annule"?"#6b7280":C},children:s.statut==="confirme"?u(Bt,{className:"h-4 w-4"}):s.statut==="refuse"||s.statut==="annule"?u(vr,{className:"h-4 w-4"}):s.statut==="verification"?u(No,{className:"h-4 w-4"}):u(Ja,{className:"h-4 w-4 animate-spin"})}),m("div",{className:"flex-1",children:[u("p",{className:"font-medium text-sm mb-1",children:s.statut==="confirme"?"Paiement confirmÃ©":s.statut==="refuse"?"RefusÃ©e par la compagnie":s.statut==="annule"?"AnnulÃ©e":s.statut==="verification"?"En vÃ©rification":"En attente de preuve"}),m("p",{className:"text-xs text-gray-600",children:[U[s.statut]||U.en_attente,s.reason&&s.statut==="refuse"&&m("span",{className:"block mt-1 text-red-600 font-medium",children:["Raison : ",s.reason]})]}),s.referenceCode&&m("p",{className:"mt-2 text-xs text-gray-700 flex items-center gap-1",children:[u(Zf,{className:"h-3 w-3"}),u("span",{className:"font-semibold",children:"NÂ°"})," ",s.referenceCode]}),c&&m("p",{className:"text-xs text-gray-600 mt-1 flex items-center gap-1",children:[u(Fi,{className:"h-3 w-3"}),u("span",{className:"font-semibold",children:"Agence :"})," ",c]})]})]}),m(gr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.22},className:"rounded-xl shadow-xs border overflow-hidden bg-white",style:{borderColor:"rgba(0,0,0,0.06)"},children:[u("div",{className:"p-4 border-b",style:{borderColor:"rgba(0,0,0,0.06)"},children:m("h2",{className:"font-semibold text-sm flex items-center gap-2",style:{color:"#111827"},children:[u(Qf,{className:"h-4 w-4",style:{color:C}}),"DÃ©tails du voyage"]})}),m("div",{className:"p-4 space-y-4",children:[m("div",{className:"flex items-start gap-3",children:[u("div",{className:"p-1.5 rounded-lg bg-gray-100 flex-shrink-0",children:u(Fi,{className:"h-4 w-4 text-gray-600"})}),m("div",{children:[u("p",{className:"text-xs text-gray-500 mb-1",children:"ItinÃ©raire"}),m("p",{className:"text-sm font-medium text-gray-900",children:[s.depart," ",u(yu,{className:"inline h-3 w-3 mx-1 text-gray-400"})," ",s.arrivee]})]})]}),m("div",{className:"grid grid-cols-2 gap-4",children:[m("div",{className:"flex items-start gap-3",children:[u("div",{className:"p-1.5 rounded-lg bg-gray-100 flex-shrink-0",children:u(br,{className:"h-4 w-4 text-gray-600"})}),m("div",{children:[u("p",{className:"text-xs text-gray-500 mb-1",children:"Date"}),u("p",{className:"text-sm font-medium text-gray-900",children:cb(s.date)})]})]}),m("div",{className:"flex items-start gap-3",children:[u("div",{className:"p-1.5 rounded-lg bg-gray-100 flex-shrink-0",children:u(Yn,{className:"h-4 w-4 text-gray-600"})}),m("div",{children:[u("p",{className:"text-xs text-gray-500 mb-1",children:"Heure"}),u("p",{className:"text-sm font-medium text-gray-900",children:s.heure})]})]})]}),m("div",{className:"flex items-start gap-3",children:[u("div",{className:"p-1.5 rounded-lg bg-gray-100 flex-shrink-0",children:u(sr,{className:"h-4 w-4 text-gray-600"})}),m("div",{className:"flex-1",children:[u("p",{className:"text-xs text-gray-500 mb-1",children:"Paiement"}),m("div",{className:"flex justify-between items-center",children:[m("p",{className:"text-sm font-medium text-gray-900",children:[s.montant.toLocaleString("fr-FR")," FCFA"]}),u("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:B.text})]})]})]}),s.tripType==="aller-retour"&&m("div",{className:"text-xs text-gray-600 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200",children:[u("p",{className:"font-medium text-gray-700 mb-1",children:"Aller-retour"}),m("div",{className:"flex justify-between",children:[m("span",{children:["Aller: ",s.seatsGo," place(s)"]}),m("span",{children:["Retour: ",s.seatsReturn," place(s)"]})]})]})]})]}),m(gr.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.35},className:"text-center pt-4",children:[m("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600",children:[u(Jf,{className:"h-3.5 w-3.5 text-rose-400 fill-rose-400"}),u("span",{children:"Merci pour votre confiance"})]}),u("p",{className:"text-sm font-medium mt-1",style:{color:C},children:s.companyName||(p==null?void 0:p.name)||"Votre compagnie"})]})]}),u("div",{className:"fixed bottom-0 left-0 w-full z-40 px-4 py-3 shadow-md border-t",style:{backgroundColor:"#ffffff",borderColor:"rgba(0,0,0,0.06)"},children:u("div",{className:"max-w-md mx-auto",children:s.statut!=="refuse"&&s.statut!=="annule"?m(bt,{children:[m("button",{onClick:()=>{var z;const X=((z=n==null?void 0:n.state)==null?void 0:z.slug)||s.companySlug||e;r(`/${X}/receipt/${s.id}`,{state:{reservation:{...s,agencyNom:c,canal:F},companyInfo:p}})},className:`w-full py-3 rounded-lg text-sm font-medium flex items-center justify-center gap-2 shadow-sm transition-all ${R?"hover:opacity-95":"opacity-70 cursor-not-allowed"}`,style:{background:R?`linear-gradient(135deg, ${C}, ${I})`:`linear-gradient(135deg, ${Mt(C,.5)}, ${Mt(I,.5)})`,color:Et(C)},disabled:!R,children:[u(Bt,{className:"h-4 w-4"}),R?"Voir mon billet":s.statut==="verification"?"Billet disponible aprÃ¨s confirmation":"En attente de confirmation"]}),u("button",{onClick:ae,className:"w-full mt-3 py-2.5 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:"CrÃ©er une nouvelle rÃ©servation"})]}):m("div",{className:"space-y-3",children:[m("div",{className:"text-center py-3 text-gray-600",children:[u("p",{className:"font-medium mb-1",children:s.statut==="refuse"?"RÃ©servation refusÃ©e":"RÃ©servation annulÃ©e"}),u("p",{className:"text-sm",children:s.statut==="refuse"?"Pour toute question, contactez la compagnie.":"Vous pouvez crÃ©er une nouvelle rÃ©servation."})]}),u("button",{onClick:ae,className:"w-full py-3 rounded-lg text-sm font-medium shadow-sm",style:{backgroundColor:C,color:Et(C)},children:"CrÃ©er une nouvelle rÃ©servation"})]})})}),u("style",{children:`
          @keyframes pingStep {
            0% { transform: scale(1); opacity: .45; }
            80% { transform: scale(1.75); opacity: 0; }
            100% { transform: scale(1.75); opacity: 0; }
          }
        `})]})},hb=Object.freeze(Object.defineProperty({__proto__:null,default:Ao},Symbol.toStringTag,{value:"Module"})),pb=({onSelect:r,onClose:e,title:t="Choisir une image",source:n="company",companyId:a})=>{const[i,o]=N.useState([]),[s,l]=N.useState(!0),[c,d]=N.useState(null),f=N.useRef(null);return N.useEffect(()=>{let p=!0;async function g(){l(!0),d(null);try{let y;if(n==="platform"){const v=Pe(ce(j,"mediaPlatform"));y=await xe(v)}else{if(!a){o([]),l(!1);return}const v=`companies/${a}/imagesBibliotheque`,b=Pe(ce(j,v),cr("createdAt","desc"));y=await xe(b)}if(!p)return;const x=y.docs.map(v=>{const b=v.data();return{id:v.id,url:b.url,nom:b.nom,type:b.type}});o(x)}catch(y){if(!p)return;console.error("Erreur chargement images:",y),d("Impossible de charger les images. RÃ©essayez plus tard.")}finally{p&&l(!1)}}return g(),()=>{p=!1}},[n,a]),N.useEffect(()=>{const p=g=>{g.key==="Escape"&&e()};return document.addEventListener("keydown",p),setTimeout(()=>{var g;return(g=f.current)==null?void 0:g.focus()},0),()=>document.removeEventListener("keydown",p)},[e]),u("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-[1px] flex items-center justify-center z-50",onClick:p=>{p.target===p.currentTarget&&e()},children:m("div",{ref:f,role:"dialog","aria-modal":"true","aria-labelledby":"image-selector-title",tabIndex:-1,className:"bg-white rounded-xl shadow-xl p-5 w-[92vw] max-w-2xl outline-none",children:[m("div",{className:"flex items-center justify-between mb-4",children:[u("h2",{id:"image-selector-title",className:"text-lg font-bold",children:t}),u("button",{onClick:e,className:"px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm",children:"Fermer"})]}),s?u("div",{className:"grid grid-cols-3 gap-4",children:Array.from({length:6}).map((p,g)=>u("div",{className:"h-32 w-full rounded bg-gray-100 animate-pulse"},g))}):c?u("p",{className:"text-red-600 text-sm",children:c}):i.length===0?u("p",{className:"text-gray-600 text-sm",children:n==="platform"?"Aucune image plateforme disponible.":"Aucune image trouvÃ©e pour cette compagnie."}):u("div",{className:"grid grid-cols-3 gap-4",children:i.map(p=>u("button",{type:"button",onClick:()=>r(p.url),className:"group relative rounded overflow-hidden border hover:shadow-md transition focus:outline-none focus:ring-2 focus:ring-orange-500",title:p.nom||"Image",children:u("img",{src:p.url,alt:p.nom||"image",className:"h-32 w-full object-cover transition group-hover:scale-[1.02]",loading:"lazy",decoding:"async"})},p.id))}),u("div",{className:"flex justify-end mt-5",children:u("button",{onClick:e,className:"px-4 py-2 rounded-lg border hover:bg-gray-50 text-sm",children:"Fermer"})})]})})},Dc=le(j,"platform","settings"),mb=()=>{var x,v,b,_;const[r,e]=N.useState({accroche:"Voyagez avec Teliya",instructionRecherche:"Remplissez les champs ci-dessous pour trouver un trajet",logoUrl:"",faviconUrl:"",banniereUrl:"",imagesSlider:[],couleurPrimaire:"#ea580c",couleurSecondaire:"#16a34a",themeStyle:"moderne",platformName:"Teliya",slogan:"RÃ©server simplement, voyager sereinement.",country:"Mali",about:"Plateforme dÃ©veloppÃ©e au Mali. Nous simplifions la rÃ©servation des billets interurbains avec des compagnies partenaires vÃ©rifiÃ©es, des paiements fiables et un suivi clair.",contact:{},social:{},legalLinks:[{label:"Mentions lÃ©gales",url:"/mentions-legales"},{label:"Politique de confidentialitÃ©",url:"/confidentialite"},{label:"Conditions dâ€™utilisation",url:"/conditions"},{label:"Politique cookies",url:"/cookies"}],extraLinks:[{label:"Ã€ propos",url:"/a-propos"},{label:"Aide",url:"/aide"},{label:"Partenaires",url:"/partenaires"}],worldMapBg:!0}),[t,n]=N.useState({text:"",type:""}),[a,i]=N.useState(null),[o,s]=N.useState(null);N.useEffect(()=>{(async()=>{const w=await pt(Dc);if(w.exists()){const A=w.data();e(C=>({...C,...A,contact:{...C.contact,...A.contact||{}},social:{...C.social,...A.social||{}},legalLinks:A.legalLinks??C.legalLinks,extraLinks:A.extraLinks??C.extraLinks,worldMapBg:typeof A.worldMapBg=="boolean"?A.worldMapBg:C.worldMapBg}))}})()},[]);const l=async()=>{try{await $a(Dc,r,{merge:!0}),n({text:"ParamÃ¨tres enregistrÃ©s avec succÃ¨s âœ…",type:"success"})}catch(w){console.error(w),n({text:"Ã‰chec de l'enregistrement âŒ",type:"error"})}},c=w=>{a&&(a==="logo"&&e(A=>({...A,logoUrl:w})),a==="favicon"&&e(A=>({...A,faviconUrl:w})),a==="banniere"&&e(A=>({...A,banniereUrl:w})),a==="slider"&&e(A=>({...A,imagesSlider:[...A.imagesSlider,w]})),i(null))},d=w=>e(A=>({...A,imagesSlider:A.imagesSlider.filter((C,I)=>I!==w)})),f=(w,A)=>e(C=>({...C,contact:{...C.contact||{},[w]:A}})),h=(w,A)=>e(C=>({...C,social:{...C.social||{},[w]:A}})),p=w=>e(A=>({...A,[w]:[...A[w]||[],{label:"",url:"",external:!1}]})),g=(w,A,C)=>e(I=>{const R=[...I[w]||[]];return R[A]={...R[A],...C},{...I,[w]:R}}),y=(w,A)=>e(C=>{const I=[...C[w]||[]];return I.splice(A,1),{...C,[w]:I}});return u("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:m(gr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"max-w-5xl mx-auto",children:[u("h1",{className:"text-2xl font-bold mb-6 text-gray-800",children:"ParamÃ¨tres de la plateforme"}),u(zd,{children:t.text&&m(gr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-4 rounded-lg shadow mb-4 ${t.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[t.type==="success"?u(Bt,{className:"inline mr-2"}):u(Fn,{className:"inline mr-2"}),t.text]})}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(Ea,{})," IdentitÃ© & contenu du footer"]}),m("div",{className:"grid md:grid-cols-2 gap-4",children:[m("div",{children:[u("label",{className:"block text-sm mb-1",children:"Nom de la plateforme"}),u("input",{className:"w-full px-4 py-2 border rounded-lg",value:r.platformName||"",onChange:w=>e(A=>({...A,platformName:w.target.value})),placeholder:"Teliya"})]}),m("div",{children:[u("label",{className:"block text-sm mb-1",children:"Pays"}),m("div",{className:"relative",children:[u("input",{className:"w-full px-4 py-2 border rounded-lg pr-9",value:r.country||"",onChange:w=>e(A=>({...A,country:w.target.value})),placeholder:"Mali"}),u(Kn,{className:"h-4 w-4 absolute right-3 top-3.5 text-gray-400"})]})]}),m("div",{className:"md:col-span-2",children:[u("label",{className:"block text-sm mb-1",children:"Slogan"}),u("input",{className:"w-full px-4 py-2 border rounded-lg",value:r.slogan||"",onChange:w=>e(A=>({...A,slogan:w.target.value})),placeholder:"RÃ©server simplement, voyager sereinement."})]}),m("div",{className:"md:col-span-2",children:[u("label",{className:"block text-sm mb-1",children:"Ã€ propos (footer)"}),u("textarea",{className:"w-full px-4 py-2 border rounded-lg",rows:3,value:r.about||"",onChange:w=>e(A=>({...A,about:w.target.value})),placeholder:"Texte court de prÃ©sentation affichÃ© dans le pied de pageâ€¦"})]})]})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[u("h3",{className:"text-lg font-semibold mb-4",children:"Textes principaux"}),u("input",{className:"w-full mb-3 px-4 py-2 border rounded-lg",value:r.accroche,onChange:w=>e(A=>({...A,accroche:w.target.value}))}),u("input",{className:"w-full px-4 py-2 border rounded-lg",value:r.instructionRecherche,onChange:w=>e(A=>({...A,instructionRecherche:w.target.value}))})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(th,{})," Contact (footer)"]}),m("div",{className:"grid md:grid-cols-2 gap-4",children:[m("div",{children:[u("label",{className:"block text-sm mb-1",children:"TÃ©lÃ©phone"}),u("input",{className:"w-full px-4 py-2 border rounded-lg",value:((x=r.contact)==null?void 0:x.phone)||"",onChange:w=>f("phone",w.target.value),placeholder:"+223 70 00 00 00"})]}),m("div",{children:[u("label",{className:"block text-sm mb-1",children:"E-mail"}),u("input",{className:"w-full px-4 py-2 border rounded-lg",value:((v=r.contact)==null?void 0:v.email)||"",onChange:w=>f("email",w.target.value),placeholder:"contact@teliya.africa"})]}),m("div",{children:[u("label",{className:"block text-sm mb-1",children:"Adresse"}),m("div",{className:"relative",children:[u("input",{className:"w-full px-4 py-2 border rounded-lg pr-9",value:((b=r.contact)==null?void 0:b.address)||"",onChange:w=>f("address",w.target.value),placeholder:"Bamako, Mali"}),u(Fi,{className:"h-4 w-4 absolute right-3 top-3.5 text-gray-400"})]})]}),m("div",{children:[u("label",{className:"block text-sm mb-1",children:"Horaires"}),m("div",{className:"relative",children:[u("input",{className:"w-full px-4 py-2 border rounded-lg pr-9",value:((_=r.contact)==null?void 0:_.hours)||"",onChange:w=>f("hours",w.target.value),placeholder:"Lunâ€“Sam : 8hâ€“19h"}),u(Yn,{className:"h-4 w-4 absolute right-3 top-3.5 text-gray-400"})]})]})]})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(_s,{})," RÃ©seaux sociaux (footer)"]}),u("div",{className:"grid md:grid-cols-2 gap-4",children:[{k:"facebook",label:"Facebook",Icon:rh,ph:"https://facebook.com/â€¦"},{k:"instagram",label:"Instagram",Icon:_s,ph:"https://instagram.com/â€¦"},{k:"twitter",label:"Twitter / X",Icon:nh,ph:"https://twitter.com/â€¦"},{k:"linkedin",label:"LinkedIn",Icon:ah,ph:"https://linkedin.com/company/â€¦"},{k:"youtube",label:"YouTube",Icon:ih,ph:"https://youtube.com/@â€¦"}].map(({k:w,label:A,Icon:C,ph:I})=>{var R;return m("div",{children:[u("label",{className:"block text-sm mb-1",children:A}),m("div",{className:"relative",children:[u("input",{className:"w-full px-4 py-2 border rounded-lg pl-10",value:((R=r.social)==null?void 0:R[w])||"",onChange:F=>h(w,F.target.value),placeholder:I}),u(C,{className:"h-4 w-4 absolute left-3 top-3.5 text-gray-400"})]})]},w)})})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(oh,{})," Liens du footer (lÃ©gaux & utiles)"]}),m("div",{className:"mb-6",children:[m("div",{className:"flex items-center justify-between mb-2",children:[u("h4",{className:"font-semibold",children:"Liens lÃ©gaux"}),m("button",{onClick:()=>p("legalLinks"),className:"inline-flex items-center gap-2 px-3 py-1.5 rounded border hover:bg-gray-50",children:[u(Es,{className:"h-4 w-4"})," Ajouter"]})]}),u("div",{className:"space-y-2",children:(r.legalLinks||[]).map((w,A)=>m("div",{className:"grid md:grid-cols-[1fr_1fr_auto_auto] grid-cols-1 gap-2 items-center",children:[u("input",{className:"px-3 py-2 border rounded-lg",placeholder:"LibellÃ© (ex: Mentions lÃ©gales)",value:w.label,onChange:C=>g("legalLinks",A,{label:C.target.value})}),u("input",{className:"px-3 py-2 border rounded-lg",placeholder:"/mentions-legales ou https://â€¦",value:w.url,onChange:C=>g("legalLinks",A,{url:C.target.value})}),m("label",{className:"inline-flex items-center gap-2 text-sm",children:[u("input",{type:"checkbox",checked:!!w.external,onChange:C=>g("legalLinks",A,{external:C.target.checked})}),"externe"]}),u("button",{onClick:()=>y("legalLinks",A),className:"p-2 rounded border hover:bg-red-50 text-red-600",title:"Supprimer",children:u(ei,{className:"h-4 w-4"})})]},`legal-${A}`))})]}),m("div",{children:[m("div",{className:"flex items-center justify-between mb-2",children:[u("h4",{className:"font-semibold",children:"Liens utiles"}),m("button",{onClick:()=>p("extraLinks"),className:"inline-flex items-center gap-2 px-3 py-1.5 rounded border hover:bg-gray-50",children:[u(Es,{className:"h-4 w-4"})," Ajouter"]})]}),u("div",{className:"space-y-2",children:(r.extraLinks||[]).map((w,A)=>m("div",{className:"grid md:grid-cols-[1fr_1fr_auto_auto] grid-cols-1 gap-2 items-center",children:[u("input",{className:"px-3 py-2 border rounded-lg",placeholder:"LibellÃ© (ex: Ã€ propos)",value:w.label,onChange:C=>g("extraLinks",A,{label:C.target.value})}),u("input",{className:"px-3 py-2 border rounded-lg",placeholder:"/a-propos ou https://â€¦",value:w.url,onChange:C=>g("extraLinks",A,{url:C.target.value})}),m("label",{className:"inline-flex items-center gap-2 text-sm",children:[u("input",{type:"checkbox",checked:!!w.external,onChange:C=>g("extraLinks",A,{external:C.target.checked})}),"externe"]}),u("button",{onClick:()=>y("extraLinks",A),className:"p-2 rounded border hover:bg-red-50 text-red-600",title:"Supprimer",children:u(ei,{className:"h-4 w-4"})})]},`extra-${A}`))})]})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(Ns,{})," ArriÃ¨re-plan du footer"]}),m("label",{className:"inline-flex items-center gap-2",children:[u("input",{type:"checkbox",checked:r.worldMapBg!==!1,onChange:w=>e(A=>({...A,worldMapBg:w.target.checked}))}),"Afficher le motif de carte du monde en fond"]})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(sh,{})," Couleurs"]}),u("div",{className:"flex gap-6",children:[{key:"couleurPrimaire",name:"Primaire",pick:"primary"},{key:"couleurSecondaire",name:"Secondaire",pick:"secondary"}].map(w=>m("div",{children:[u("label",{className:"block text-sm mb-2",children:w.name}),u("div",{className:"h-12 w-12 rounded-full border cursor-pointer",style:{backgroundColor:r[w.key]},onClick:()=>s(w.pick),title:"Changer la couleur"}),o===w.pick&&u("div",{className:"mt-2",children:u(lh,{color:r[w.key],onChange:A=>e(C=>({...C,[w.key]:A}))})})]},w.key))})]}),m("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[m("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[u(Ns,{})," Images"]}),m("div",{className:"mb-4",children:[u("label",{className:"block text-sm mb-2",children:"Logo"}),r.logoUrl?m("div",{className:"flex items-center gap-4",children:[u("img",{src:r.logoUrl,className:"h-16 w-16 object-contain"}),u("button",{onClick:()=>i("logo"),className:"bg-gray-100 px-3 py-1 rounded",children:"Changer"})]}):u("button",{onClick:()=>i("logo"),className:"px-4 py-2 border rounded-lg",children:"Ajouter un logo"})]}),m("div",{className:"mb-4",children:[u("label",{className:"block text-sm mb-2",children:"Favicon"}),r.faviconUrl?m("div",{className:"flex items-center gap-4",children:[u("img",{src:r.faviconUrl,className:"h-10 w-10 object-contain"}),u("button",{onClick:()=>i("favicon"),className:"bg-gray-100 px-3 py-1 rounded",children:"Changer"})]}):u("button",{onClick:()=>i("favicon"),className:"px-4 py-2 border rounded-lg",children:"Ajouter un favicon"})]}),m("div",{className:"mb-4",children:[u("label",{className:"block text-sm mb-2",children:"BanniÃ¨re"}),r.banniereUrl?m("div",{children:[u("img",{src:r.banniereUrl,className:"h-32 w-full object-cover rounded-lg"}),u("button",{onClick:()=>i("banniere"),className:"mt-2 bg-gray-100 px-3 py-1 rounded",children:"Changer"})]}):u("button",{onClick:()=>i("banniere"),className:"px-4 py-2 border rounded-lg",children:"Ajouter une banniÃ¨re"})]}),m("div",{children:[m("label",{className:"block text-sm mb-2",children:["Images du slider (",r.imagesSlider.length,")"]}),u("div",{className:"grid grid-cols-3 gap-3",children:r.imagesSlider.map((w,A)=>m("div",{className:"relative group",children:[u("img",{src:w,className:"h-24 w-full object-cover rounded-lg"}),u("button",{onClick:()=>d(A),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition",children:u(ei,{size:14})})]},A))}),m("button",{onClick:()=>i("slider"),className:"mt-2 text-blue-600 flex items-center gap-2",children:[u(No,{size:16})," Ajouter des images"]})]})]}),m("button",{onClick:l,className:"bg-orange-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-orange-700 flex items-center gap-2",children:[u(xu,{size:20})," Sauvegarder"]}),a&&u(pb,{title:a==="logo"?"Choisir un logo":a==="favicon"?"Choisir un favicon":a==="banniere"?"Choisir une banniÃ¨re":"Choisir des images pour le slider",source:"platform",onSelect:c,onClose:()=>i(null)})]})})},gb=(r,e)=>{const t={moderne:{colors:{primary:"#3B82F6",secondary:"#10B981",accent:"#8B5CF6",background:"#F9FAFB",text:"#111827"},typography:"sans-serif",buttons:"rounded-lg",effects:"shadow-md hover:shadow-lg",borders:"rounded-lg",animations:"transition-all duration-300"},classique:{colors:{primary:"#2563EB",secondary:"#1E40AF",accent:"#4B5563",background:"#FFFFFF",text:"#1F2937"},typography:"serif",buttons:"rounded-sm",effects:"shadow-sm",borders:"border",animations:"transition-colors duration-200"},sombre:{colors:{primary:"#F59E0B",secondary:"#F97316",accent:"#F43F5E",background:"#111827",text:"#F3F4F6"},typography:"sans-serif",buttons:"rounded-md",effects:"shadow-lg",borders:"border border-gray-700",animations:"transition-transform duration-300"},contraste:{colors:{primary:"#EF4444",secondary:"#F59E0B",accent:"#22D3EE",background:"#FFFFFF",text:"#000000"},typography:"sans-serif",buttons:"rounded-full",effects:"shadow-xl",borders:"border-2 border-black",animations:"hover:scale-105 transition-transform"},minimaliste:{colors:{primary:"#6B7280",secondary:"#9CA3AF",accent:"#D1D5DB",background:"#FFFFFF",text:"#374151"},typography:"sans-serif",buttons:"",effects:"",borders:"",animations:""},glassmorphism:{colors:{primary:"rgba(59, 130, 246, 0.8)",secondary:"rgba(16, 185, 129, 0.8)",accent:"rgba(255, 255, 255, 0.3)",background:"rgba(255, 255, 255, 0.1)",text:"#FFFFFF"},typography:"sans-serif",buttons:"rounded-lg backdrop-blur-md",effects:"backdrop-filter backdrop-blur-lg bg-opacity-20",borders:"border border-white border-opacity-20",animations:"transition-all duration-500"}},n=t[r]||t.moderne;return{...n,colors:{...n.colors,primary:(e==null?void 0:e.couleurPrimaire)||n.colors.primary,secondary:(e==null?void 0:e.couleurSecondaire)||n.colors.secondary,accent:n.colors.accent||n.colors.primary}}},Pc="companyTheme",Nr=r=>{const[e,t]=N.useState(()=>{const a=sessionStorage.getItem(Pc);return a?JSON.parse(a):null}),n=N.useMemo(()=>{var _,w,A,C,I,R,F,T;const a=gb((r==null?void 0:r.themeStyle)||"moderne"),i=((_=r==null?void 0:r.couleurPrimaire)==null?void 0:_.trim())||((w=e==null?void 0:e.colors)==null?void 0:w.primary)||a.colors.primary||"#3B82F6",o=((A=r==null?void 0:r.couleurSecondaire)==null?void 0:A.trim())||((C=e==null?void 0:e.colors)==null?void 0:C.secondary)||a.colors.secondary||"#6366F1",s=((I=r==null?void 0:r.couleurAccent)==null?void 0:I.trim())||((R=e==null?void 0:e.colors)==null?void 0:R.accent)||"#FBBF24",l=((F=r==null?void 0:r.couleurTertiaire)==null?void 0:F.trim())||((T=e==null?void 0:e.colors)==null?void 0:T.tertiary)||"#6366F1",c=Mt(i,.15),d=Mt(i,.85),f=Et(i),h=Et(o),p=f==="#FFFFFF"?"#1e293b":f,g=h==="#FFFFFF"?"#64748b":h,y=Et(i),x=i,v=d,b={config:a,colors:{primary:i,secondary:o,accent:s,tertiary:l,primaryLight:c,primaryDark:d,textPrimary:p,textSecondary:g,buttonText:y,buttonBg:x,buttonBorder:v,background:a.colors.background,text:p},classes:{background:a.colors.background,text:a.colors.text,card:`bg-white ${a.effects} ${a.borders}`,button:`text-[${y}] bg-[${x}] border-[${v}] ${a.buttons} ${a.animations}`,input:`${a.borders} ${a.animations}`,header:`bg-white ${a.effects} ${a.borders}`,animations:a.animations}};return{...b,primary:b.colors.primary,secondary:b.colors.secondary,primaryLight:b.colors.primaryLight,primaryDark:b.colors.primaryDark,textPrimary:b.colors.textPrimary,textSecondary:b.colors.textSecondary}},[r,e]);return N.useEffect(()=>{r!=null&&r.couleurPrimaire&&(r!=null&&r.couleurSecondaire)&&sessionStorage.setItem(Pc,JSON.stringify(n))},[r,n]),n};function Mc(r){var t;if(!r)return"â€”";const e=(t=r==null?void 0:r.toDate)!=null&&t.call(r)?r.toDate():new Date(r);return isNaN(e.getTime())?"â€”":e.toLocaleString("fr-FR")}const vb=()=>{const{user:r,company:e}=Tt(),t=Nr(e)||{primary:"#EA580C",secondary:"#F97316"},[n,a]=N.useState([]),[i,o]=N.useState(!1),s=N.useCallback(async()=>{if(!(!(r!=null&&r.companyId)||!(r!=null&&r.agencyId))){o(!0);try{const c=ce(j,`companies/${r.companyId}/agences/${r.agencyId}/shiftReports`),d=await xe(Pe(c,me("status","==","awaiting_accountant"),cr("endAt","desc"),dn(50)));a(d.docs.map(f=>f.data()))}finally{o(!1)}}},[r==null?void 0:r.companyId,r==null?void 0:r.agencyId]);N.useEffect(()=>{s()},[s]);const l=async c=>{if(!(r!=null&&r.companyId)||!(r!=null&&r.agencyId))return;const d=le(j,`companies/${r.companyId}/agences/${r.agencyId}/shiftReports/${c.shiftId}`);await sn(d,{status:"awaiting_manager",accountantValidatedAt:He.now()}),await s()};return m("div",{className:"max-w-6xl mx-auto p-4",children:[m("header",{className:"flex items-center justify-between mb-4",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:"h-10 w-10 rounded bg-gray-100 grid place-items-center border",children:u(wr,{className:"h-5 w-5 text-gray-600"})}),u("h1",{className:"text-xl font-bold",children:"Validations â€“ ComptabilitÃ©"})]}),u("button",{onClick:s,className:"px-3 py-2 rounded-lg border bg-white hover:bg-gray-50",children:"Actualiser"})]}),i&&u("div",{className:"text-sm text-gray-600",children:"Chargementâ€¦"}),!i&&n.length===0&&u("div",{className:"text-sm text-gray-600",children:"Aucun rapport en attente de validation comptable."}),u("div",{className:"space-y-4",children:n.map(c=>m("div",{className:"rounded-2xl border bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between",children:[m("div",{children:[m("div",{className:"text-lg font-semibold",children:["Session #",c.shiftId.slice(0,6)," â€“ Guichetier ",c.guichetierCode||c.guichetierId]}),m("div",{className:"text-xs text-gray-500",children:["DÃ©but : ",Mc(c.startAt)," â€¢ Fin : ",Mc(c.endAt)]})]}),u("span",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{background:"#FEF3C7",color:"#92400E"},children:"En attente de validation comptable"})]}),m("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mt-4",children:[m("div",{className:"rounded-xl border p-4 bg-gray-50",children:[u("div",{className:"text-sm text-gray-500",children:"RÃ©servations"}),u("div",{className:"text-2xl font-bold",children:c.reservationsCount})]}),m("div",{className:"rounded-xl border p-4 bg-gray-50",children:[u("div",{className:"text-sm text-gray-500",children:"Billets"}),u("div",{className:"text-2xl font-bold",children:c.ticketsCount})]}),m("div",{className:"rounded-xl border p-4 bg-gray-50",children:[u("div",{className:"text-sm text-gray-500",children:"Montant"}),m("div",{className:"text-2xl font-bold",children:[c.amountTotal.toLocaleString("fr-FR")," FCFA"]})]})]}),m("div",{className:"mt-4",children:[u("div",{className:"font-semibold mb-2",children:"DÃ©tails par trajet"}),Array.isArray(c.byRoute)&&c.byRoute.length>0?c.byRoute.map((d,f)=>m("div",{className:"mb-3 rounded-lg border overflow-hidden",children:[m("div",{className:"px-3 py-2 bg-gray-50 flex items-center justify-between",children:[m("div",{className:"font-medium",children:[d.depart," â†’ ",d.arrivee]}),m("div",{className:"text-sm",children:[u("b",{children:d.totalBillets})," billets â€¢ ",u("b",{children:d.totalMontant.toLocaleString("fr-FR")})," FCFA"]})]}),m("table",{className:"w-full text-sm",children:[u("thead",{className:"bg-white",children:m("tr",{children:[u("th",{className:"px-3 py-2 text-left",children:"Date"}),u("th",{className:"px-3 py-2 text-left",children:"Heure"}),u("th",{className:"px-3 py-2 text-right",children:"Billets"}),u("th",{className:"px-3 py-2 text-right",children:"Montant"})]})}),u("tbody",{children:d.trips.map((h,p)=>m("tr",{className:"border-t",children:[u("td",{className:"px-3 py-2",children:h.date}),u("td",{className:"px-3 py-2",children:h.heure}),u("td",{className:"px-3 py-2 text-right",children:h.billets}),m("td",{className:"px-3 py-2 text-right",children:[h.montant.toLocaleString("fr-FR")," FCFA"]})]},p))})]})]},f)):u("div",{className:"text-gray-500 text-sm",children:"Aucune vente."})]}),m("div",{className:"mt-4 flex gap-2",children:[m("button",{className:"px-3 py-2 rounded-lg border bg-white hover:bg-gray-50",onClick:()=>window.print(),children:[u(So,{className:"h-4 w-4 inline mr-1"})," Imprimer"]}),m("button",{onClick:()=>l(c),className:"px-3 py-2 rounded-lg text-white",style:{background:`linear-gradient(90deg, ${t.primary}, ${t.secondary})`},children:[u(Bt,{className:"h-4 w-4 inline mr-1"})," Valider (envoyer au chef dâ€™agence)"]})]})]},c.shiftId))})]})};function Lc(r){var t;if(!r)return"â€”";const e=(t=r==null?void 0:r.toDate)!=null&&t.call(r)?r.toDate():new Date(r);return isNaN(e.getTime())?"â€”":e.toLocaleString("fr-FR")}const yb=()=>{const{user:r,company:e}=Tt(),t=Nr(e)||{primary:"#0EA5E9",secondary:"#22D3EE"},[n,a]=N.useState([]),[i,o]=N.useState(!1),s=N.useCallback(async()=>{if(!(!(r!=null&&r.companyId)||!(r!=null&&r.agencyId))){o(!0);try{const c=ce(j,`companies/${r.companyId}/agences/${r.agencyId}/shiftReports`),d=await xe(Pe(c,me("status","==","awaiting_manager"),cr("endAt","desc"),dn(50)));a(d.docs.map(f=>f.data()))}finally{o(!1)}}},[r==null?void 0:r.companyId,r==null?void 0:r.agencyId]);N.useEffect(()=>{s()},[s]);const l=async c=>{if(!(r!=null&&r.companyId)||!(r!=null&&r.agencyId))return;const d=le(j,`companies/${r.companyId}/agences/${r.agencyId}/shiftReports/${c.shiftId}`);await sn(d,{status:"validated",managerValidatedAt:He.now()}),await s()};return m("div",{className:"max-w-6xl mx-auto p-4",children:[m("header",{className:"flex items-center justify-between mb-4",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:"h-10 w-10 rounded bg-gray-100 grid place-items-center border",children:u(wr,{className:"h-5 w-5 text-gray-600"})}),u("h1",{className:"text-xl font-bold",children:"Validations â€“ Chef dâ€™agence"})]}),u("button",{onClick:s,className:"px-3 py-2 rounded-lg border bg-white hover:bg-gray-50",children:"Actualiser"})]}),i&&u("div",{className:"text-sm text-gray-600",children:"Chargementâ€¦"}),!i&&n.length===0&&u("div",{className:"text-sm text-gray-600",children:"Aucun rapport en attente de validation du chef dâ€™agence."}),u("div",{className:"space-y-4",children:n.map(c=>m("div",{className:"rounded-2xl border bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between",children:[m("div",{children:[m("div",{className:"text-lg font-semibold",children:["Session #",c.shiftId.slice(0,6)," â€“ Guichetier ",c.guichetierCode||c.guichetierId]}),m("div",{className:"text-xs text-gray-500",children:["DÃ©but : ",Lc(c.startAt)," â€¢ Fin : ",Lc(c.endAt)]})]}),u("span",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{background:"#DBEAFE",color:"#1D4ED8"},children:"En attente de validation chef dâ€™agence"})]}),m("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mt-4",children:[m("div",{className:"rounded-xl border p-4 bg-gray-50",children:[u("div",{className:"text-sm text-gray-500",children:"RÃ©servations"}),u("div",{className:"text-2xl font-bold",children:c.reservationsCount})]}),m("div",{className:"rounded-xl border p-4 bg-gray-50",children:[u("div",{className:"text-sm text-gray-500",children:"Billets"}),u("div",{className:"text-2xl font-bold",children:c.ticketsCount})]}),m("div",{className:"rounded-xl border p-4 bg-gray-50",children:[u("div",{className:"text-sm text-gray-500",children:"Montant"}),m("div",{className:"text-2xl font-bold",children:[c.amountTotal.toLocaleString("fr-FR")," FCFA"]})]})]}),m("div",{className:"mt-4",children:[u("div",{className:"font-semibold mb-2",children:"DÃ©tails par trajet"}),Array.isArray(c.byRoute)&&c.byRoute.length>0?c.byRoute.map((d,f)=>m("div",{className:"mb-3 rounded-lg border overflow-hidden",children:[m("div",{className:"px-3 py-2 bg-gray-50 flex items-center justify-between",children:[m("div",{className:"font-medium",children:[d.depart," â†’ ",d.arrivee]}),m("div",{className:"text-sm",children:[u("b",{children:d.totalBillets})," billets â€¢ ",u("b",{children:d.totalMontant.toLocaleString("fr-FR")})," FCFA"]})]}),m("table",{className:"w-full text-sm",children:[u("thead",{className:"bg-white",children:m("tr",{children:[u("th",{className:"px-3 py-2 text-left",children:"Date"}),u("th",{className:"px-3 py-2 text-left",children:"Heure"}),u("th",{className:"px-3 py-2 text-right",children:"Billets"}),u("th",{className:"px-3 py-2 text-right",children:"Montant"})]})}),u("tbody",{children:d.trips.map((h,p)=>m("tr",{className:"border-t",children:[u("td",{className:"px-3 py-2",children:h.date}),u("td",{className:"px-3 py-2",children:h.heure}),u("td",{className:"px-3 py-2 text-right",children:h.billets}),m("td",{className:"px-3 py-2 text-right",children:[h.montant.toLocaleString("fr-FR")," FCFA"]})]},p))})]})]},f)):u("div",{className:"text-gray-500 text-sm",children:"Aucune vente."})]}),m("div",{className:"mt-4 flex gap-2",children:[m("button",{className:"px-3 py-2 rounded-lg border bg-white hover:bg-gray-50",onClick:()=>window.print(),children:[u(So,{className:"h-4 w-4 inline mr-1"})," Imprimer"]}),m("button",{onClick:()=>l(c),className:"px-3 py-2 rounded-lg text-white",style:{background:`linear-gradient(90deg, ${t.primary}, ${t.secondary})`},children:[u(Bt,{className:"h-4 w-4 inline mr-1"})," Valider (archiver dans Historique)"]})]})]},c.shiftId))})]})},xb=r=>r.trim().toLowerCase(),bb=()=>{const r=tr(),[e,t]=N.useState(""),[n,a]=N.useState(!1),[i,o]=N.useState(null),[s,l]=N.useState(!1),c=async f=>{var h,p;l(!0),o(null);try{const g=xb(f);if(!Ts(Ht,window.location.href))throw new Error("Lien invalide ou expirÃ©.");const y=await Hh(Ht,g,window.location.href);try{window.localStorage.removeItem("emailForSignIn")}catch{}const x=y.user,v=x.uid,b=x.email||g,_=Pe(ce(j,"invites"),me("email","==",g),me("status","in",["pending","sent"]),cr("createdAt","desc"),dn(1)),w=await xe(_);let A=null,C=null;if(!w.empty){const I=w.docs[0];A=I.id,C=I.data()}if(C!=null&&C.name)try{await Gh(x,{displayName:C.name})}catch(I){console.warn("updateProfile Ã©chouÃ©:",I)}if(await $a(le(j,"users",v),{uid:v,email:b,displayName:x.displayName||(C==null?void 0:C.name)||"",phoneNumber:x.phoneNumber||(C==null?void 0:C.phone)||"",role:(C==null?void 0:C.role)||"user",companyId:(C==null?void 0:C.companyId)||null,agencyId:(C==null?void 0:C.agencyId)||null,status:"active",provider:"emailLink",createdAt:it(),updatedAt:it()},{merge:!0}),A){try{const I=Eu();await zh(I,"claimInvite")({inviteId:A})}catch(I){console.error("Erreur claimInvite:",I)}try{await((h=Ht.currentUser)==null?void 0:h.getIdToken(!0))}catch(I){console.warn("Impossible de forcer refresh token:",I)}}try{const I=await((p=Ht.currentUser)==null?void 0:p.getIdTokenResult()),R=(I==null?void 0:I.claims)||{};if(R.agencyId){r(`/agence/${R.agencyId}/dashboard`,{replace:!0});return}if(R.companyId){r("/compagnie/dashboard",{replace:!0});return}}catch{}C!=null&&C.agencyId?r(`/agence/${C.agencyId}/dashboard`,{replace:!0}):C!=null&&C.companyId?r("/compagnie/dashboard",{replace:!0}):r("/",{replace:!0})}catch(g){console.error("FinishSignIn error:",g),o((g==null?void 0:g.message)||"Ã‰chec de la connexion.")}finally{l(!1)}};N.useEffect(()=>{(async()=>{try{if(!Ts(Ht,window.location.href)){o("Lien invalide ou expirÃ©.");return}const f=window.localStorage.getItem("emailForSignIn");if(!f){a(!0);return}await c(f)}catch(f){console.error(f),o((f==null?void 0:f.message)||"Ã‰chec de la connexion.")}})()},[]);const d=async f=>{f.preventDefault(),o(null),e&&await c(e)};return i?u("div",{className:"min-h-[60vh] flex items-center justify-center p-6",children:m("div",{className:"max-w-md w-full bg-white border rounded-lg p-6 shadow-sm",children:[u("h1",{className:"text-xl font-semibold mb-2",children:"Erreur"}),u("p",{className:"text-red-600 mb-4",children:i}),u("a",{href:"/",className:"text-blue-600 underline",children:"Retour Ã  lâ€™accueil"})]})}):n?u("div",{className:"min-h-[60vh] flex items-center justify-center p-6",children:m("form",{onSubmit:d,className:"max-w-md w-full bg-white border rounded-lg p-6 shadow-sm",children:[u("h1",{className:"text-xl font-semibold mb-2",children:"Confirmer votre e-mail"}),u("p",{className:"text-sm text-gray-600 mb-4",children:"Entrez lâ€™adresse e-mail sur laquelle vous avez reÃ§u le lien."}),u("input",{type:"email",required:!0,value:e,onChange:f=>t(f.target.value.trim().toLowerCase()),className:"w-full border rounded px-3 py-2 mb-4",placeholder:"exemple@domaine.com"}),u("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 hover:bg-blue-700 text-white rounded px-4 py-2 disabled:opacity-60",children:"Continuer"})]})}):u(Vn,{fullScreen:!0})},wb=()=>{var w,A;const{user:r,logout:e,company:t}=Tt(),n=tr(),a=Ur(),i=Nr(t)||{primary:"#2563eb",secondary:"#3b82f6"},[o,s]=N.useState(0),[l,c]=N.useState({}),[d,f]=N.useState(new Set),h=N.useRef(null),[p,g]=N.useState(null),[y,x]=N.useState("Compagnie");N.useEffect(()=>{const C=()=>{h.current||(h.current=new Audio("/notification.mp3"),h.current.preload="auto"),document.removeEventListener("click",C),document.removeEventListener("keydown",C)};return document.addEventListener("click",C),document.addEventListener("keydown",C),()=>{document.removeEventListener("click",C),document.removeEventListener("keydown",C)}},[]),N.useEffect(()=>{if(!r)return;["company_accountant","financial_director","admin","super_admin"].includes(r.role)||(console.warn(`[ChefComptable] RÃ´le non autorisÃ©: ${r.role}`),n("/dashboard"))},[r,n]);const v=(()=>{const C=a.pathname;return C.includes("reservations-en-ligne")?"reservations":C.includes("finances")?"finances":C.includes("rapports")?"rapports":C.includes("parametres")?"parametres":"globale"})();N.useEffect(()=>{r!=null&&r.companyId&&(async()=>{try{const C=await pt(le(j,"companies",r.companyId));if(C.exists()){const I=C.data();g(I.logoUrl||I.logo||null),x(I.nom||I.name||"Compagnie")}}catch(C){console.error("[ChefComptable] Erreur chargement compagnie:",C)}})()},[r==null?void 0:r.companyId]),N.useEffect(()=>{const C=Object.values(l).reduce((I,R)=>I+R,0);s(C)},[l]),N.useEffect(()=>{if(!(r!=null&&r.companyId))return;let C=[];return(async()=>{try{(await xe(ce(j,"companies",r.companyId,"agences"))).forEach(R=>{const F=R.id,T=Pe(ce(j,"companies",r.companyId,"agences",F,"reservations"),me("statut","==","preuve_recue")),U=lr(T,L=>{c(B=>({...B,[F]:L.size})),L.docChanges().forEach(B=>{var H,Q;if(B.type==="added"){const ae=B.doc.id,W=`${F}_${ae}`,z=(Q=(H=B.doc.data().createdAt)==null?void 0:H.toDate)==null?void 0:Q.call(H);if(z&&Date.now()-z.getTime()>3e4){f(ie=>{const J=new Set(ie);return J.add(W),J});return}f(ie=>{if(ie.has(W))return ie;if(h.current)try{h.current.currentTime=0,h.current.play().catch(()=>{})}catch(K){console.warn("Erreur notification audio:",K)}const J=new Set(ie);return J.add(W),J})}})},L=>{console.error("[ChefComptable] Erreur listener rÃ©servations:",L)});C.push(U)})}catch(I){console.error("[ChefComptable] Erreur initialisation listener:",I)}})(),()=>{C.forEach(I=>I())}},[r==null?void 0:r.companyId]);const b=C=>{switch(C){case"globale":n("/chef-comptable");break;case"reservations":n("/chef-comptable/reservations-en-ligne");break;case"finances":n("/chef-comptable/finances");break;case"rapports":n("/chef-comptable/rapports");break;case"parametres":n("/chef-comptable/parametres");break}},_=N.useCallback(()=>{f(new Set),b("reservations")},[]);return m("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[u("div",{className:"sticky top-0 z-10 border-b bg-white/95 backdrop-blur-sm supports-[backdrop-filter]:bg-white/90 shadow-sm",children:u("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:m("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[m("div",{className:"flex items-center gap-3 min-w-0",children:[m("div",{className:"relative shrink-0",children:[p?u("img",{src:p,alt:"Logo compagnie",className:"h-12 w-12 rounded-full object-contain border-2 border-white shadow-md"}):u("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 border-2 border-white shadow-md grid place-items-center",children:u(wr,{className:"h-6 w-6 text-gray-600"})}),u("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-gradient-to-br from-amber-500 to-orange-500 rounded-full border border-white flex items-center justify-center",children:u(ga,{className:"h-3 w-3 text-white"})})]}),u("div",{className:"min-w-0",children:u("div",{className:"text-xl font-bold tracking-tight line-clamp-2 leading-tight bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",title:y,children:y})})]}),u("div",{className:"w-full lg:w-auto lg:max-w-2xl",children:u("div",{className:"inline-flex rounded-2xl p-1.5 bg-gradient-to-r from-slate-100 to-slate-50 shadow-inner w-full lg:w-auto overflow-x-auto",children:m("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[u(Cn,{active:v==="globale",onClick:()=>b("globale"),label:"Vue Globale",icon:u(Kn,{className:"h-4 w-4"}),theme:i}),u(Cn,{active:v==="reservations",onClick:_,label:"RÃ©servations",icon:u(sr,{className:"h-4 w-4"}),theme:i,badgeCount:o}),u(Cn,{active:v==="finances",onClick:()=>b("finances"),label:"Finances",icon:u(Ua,{className:"h-4 w-4"}),theme:i}),u(Cn,{active:v==="rapports",onClick:()=>b("rapports"),label:"Rapports",icon:u(ar,{className:"h-4 w-4"}),theme:i}),u(Cn,{active:v==="parametres",onClick:()=>b("parametres"),label:"ParamÃ¨tres",icon:u(bu,{className:"h-4 w-4"}),theme:i})]})})}),m("div",{className:"flex items-center gap-2 w-full lg:w-auto justify-between lg:justify-end",children:[r&&m("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-100 shadow-sm min-w-0",children:[u("div",{className:"h-8 w-8 rounded-full bg-gradient-to-br from-amber-500 to-orange-500 flex items-center justify-center text-white text-xs font-bold shrink-0",children:((A=(w=r.email)==null?void 0:w.charAt(0))==null?void 0:A.toUpperCase())||"C"}),m("div",{className:"min-w-0",children:[u("div",{className:"text-xs font-medium text-gray-900 truncate",children:r.email||"â€”"}),u("div",{className:"text-xs text-gray-600 truncate",children:"Chef Comptable"})]})]}),m("button",{onClick:async()=>{await e(),n("/login")},className:"inline-flex items-center gap-2 p-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm transition-colors group relative",title:"DÃ©connexion",children:[u(ch,{className:"h-4 w-4"}),u("span",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-xs py-1 px-2 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"DÃ©connexion"})]})]})]})})}),u("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8",children:u(uh,{})})]})},Cn=({active:r,onClick:e,label:t,icon:n,theme:a,badgeCount:i})=>m("button",{onClick:e,className:`
      relative flex items-center gap-2 px-3 py-2 rounded-xl text-xs sm:text-sm font-medium transition-all shrink-0
      ${r?"text-white shadow-lg scale-105":"text-gray-600 hover:text-gray-900 hover:bg-white/80"}
    `,style:r?{background:`linear-gradient(135deg, ${a.primary}, ${a.secondary})`}:{},children:[n,u("span",{className:"whitespace-nowrap",children:t}),i&&i>0&&u("span",{className:"absolute -top-1 -right-1 h-5 min-w-[20px] px-1 rounded-full text-xs font-bold text-white flex items-center justify-center animate-pulse",style:{background:a.primary,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:i>99?"99+":i})]}),Ab=()=>{const{user:r,company:e}=Tt(),t=Nr(e)||{primary:"#2563eb",secondary:"#3b82f6"},[n,a]=N.useState(!0),[i,o]=N.useState("week"),[s,l]=N.useState({totalReservations:0,totalAmount:0,totalAgencies:0,activeAgencies:0,pendingValidations:0,totalOnlineAmount:0,cashAmount:0,mobileMoneyAmount:0}),[c,d]=N.useState([]),[f,h]=N.useState([]),[p,g]=N.useState([]),y=()=>{const A=new Date,C=new Date;switch(i){case"today":C.setHours(0,0,0,0);break;case"week":C.setDate(A.getDate()-7),C.setHours(0,0,0,0);break;case"month":C.setMonth(A.getMonth()-1),C.setHours(0,0,0,0);break;case"all":C.setFullYear(2020);break}return{start:C,end:A}};N.useEffect(()=>{r!=null&&r.companyId&&x()},[r==null?void 0:r.companyId,i]);const x=async()=>{var A,C;a(!0);try{const I=y(),R=ce(j,`companies/${r.companyId}/agences`),T=(await xe(R)).docs.map(K=>({id:K.id,...K.data()}));let U=0,L=0,B=0,H=0,Q=0,ae=0;const W={},X=[];for(const K of T){const pe=K.id,Ue=ce(j,`companies/${r.companyId}/agences/${pe}/reservations`),be=Pe(Ue,me("createdAt",">=",He.fromDate(I.start)),me("createdAt","<=",He.fromDate(I.end)),cr("createdAt","desc")),At=await xe(be);let ze=0,fe=0,Me=0,Re=0;At.forEach(Ee=>{const E=Ee.data();U++,ze++;const O=E.montant||0;L+=O,fe+=O,(E.statut==="en_attente"||E.statut==="verification")&&B++,String(E.canal||"").toLowerCase()==="en_ligne"&&(H+=O,Me++,Re+=O);const M=String(E.paiement||"").toLowerCase();(M.includes("esp")||M.includes("cash"))&&(Q+=O),(M.includes("mobile")||M.includes("mm")||M.includes("orange")||M.includes("mtn"))&&(ae+=O),X.push({...E,id:Ee.id,agencyId:pe,agencyName:K.nomAgence||K.nom||K.ville||"Agence",createdAt:E.createdAt instanceof He?E.createdAt.toDate():new Date})}),W[pe]={reservations:ze,amount:fe,onlineReservations:Me,onlineAmount:Re,lastActivity:((C=(A=At.docs[0])==null?void 0:A.data())==null?void 0:C.createdAt)||null}}const z=T.map(K=>{const pe=W[K.id]||{reservations:0,amount:0,onlineReservations:0,onlineAmount:0};let Ue=null;const be=pe.lastActivity;return be instanceof He?Ue=be.toDate():be instanceof Date?Ue=be:be&&typeof be=="object"&&"toDate"in be&&(Ue=be.toDate()),{id:K.id,name:K.nomAgence||K.nom||K.ville||"Agence",ville:K.ville||K.city||"",reservations:pe.reservations,amount:pe.amount,onlineReservations:pe.onlineReservations,onlineAmount:pe.onlineAmount,lastActivity:Ue}}),ie=X.sort((K,pe)=>{const Ue=K.createdAt instanceof Date?K.createdAt:new Date;return(pe.createdAt instanceof Date?pe.createdAt:new Date).getTime()-Ue.getTime()}).slice(0,10),J=[];z.forEach(K=>{if(K.lastActivity){const pe=Math.floor((new Date().getTime()-K.lastActivity.getTime())/864e5);pe>7&&J.push({type:"warning",title:`Agence ${K.name} inactive`,description:`Aucune activitÃ© depuis ${pe} jours`})}}),B>5&&J.push({type:"info",title:`${B} validations en attente`,description:"Des rÃ©servations nÃ©cessitent votre attention"}),l({totalReservations:U,totalAmount:L,totalAgencies:T.length,activeAgencies:z.filter(K=>K.reservations>0).length,pendingValidations:B,totalOnlineAmount:H,cashAmount:Q,mobileMoneyAmount:ae}),d(z),h(ie),g(J)}catch(I){console.error("[VueGlobale] Erreur chargement donnÃ©es:",I)}finally{a(!1)}},v=A=>`${(A||0).toLocaleString("fr-FR")} FCFA`,b=A=>A.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),_=A=>A.toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),w=({icon:A,label:C,value:I,sublabel:R,theme:F,emphasis:T})=>m("div",{className:`relative overflow-hidden rounded-2xl border border-gray-200 p-5 bg-white shadow-sm
        hover:shadow-md transition-all duration-300
        ${T?"ring-2 ring-offset-2":""}`,style:T?{"--tw-ring-color":F.primary}:void 0,children:[u("div",{className:"absolute top-0 right-0 h-20 w-20 opacity-10",children:u("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full blur-xl"})}),m("div",{className:"flex items-start justify-between mb-4",children:[u("div",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:C}),u("div",{className:"h-10 w-10 rounded-xl grid place-items-center",style:{background:`linear-gradient(135deg, ${F.primary}20, ${F.secondary}20)`},children:u("span",{className:"text-gray-700",children:A})})]}),m("div",{className:"space-y-1",children:[u("div",{className:`font-bold ${T?"text-3xl":"text-2xl"} text-gray-900`,children:I}),R&&u("div",{className:"text-xs font-medium text-gray-500",children:R})]})]});return n?u("div",{className:"flex items-center justify-center py-20",children:m("div",{className:"text-center",children:[u("div",{className:"h-12 w-12 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-3"}),u("div",{className:"text-gray-600",children:"Chargement des donnÃ©es globales..."})]})}):m("div",{className:"space-y-6 sm:space-y-8",children:[m("div",{className:"rounded-2xl border border-gray-200 shadow-sm p-6 bg-gradient-to-r from-white to-gray-50/50",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center",children:u(Kn,{className:"h-6 w-6 text-blue-600"})}),m("div",{children:[u("div",{className:"text-xl font-bold text-gray-900",children:"Vue Globale Compagnie"}),u("div",{className:"text-sm text-gray-600",children:"Tableau de bord financier multi-agences"})]})]}),m("div",{className:"flex flex-wrap items-center gap-3",children:[m("div",{className:"flex rounded-xl border border-gray-300 p-1 bg-white",children:[u("button",{className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${i==="today"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,onClick:()=>o("today"),children:"Aujourd'hui"}),u("button",{className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${i==="week"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,onClick:()=>o("week"),children:"7 jours"}),u("button",{className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${i==="month"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,onClick:()=>o("month"),children:"30 jours"}),u("button",{className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${i==="all"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,onClick:()=>o("all"),children:"Toutes"})]}),m("button",{onClick:x,className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-gray-200 bg-white hover:bg-gray-50 text-sm font-medium",children:[u(Zt,{className:"h-4 w-4"}),"Actualiser"]})]})]}),u("div",{className:"mt-4 p-3 rounded-xl bg-gradient-to-r from-gray-50 to-gray-100/50 border border-gray-200",children:m("div",{className:"text-sm text-gray-600",children:["PÃ©riode analysÃ©e: ",b(y().start)," â†’ ",b(y().end)]})})]}),m("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[u(w,{icon:u(sr,{className:"h-6 w-6"}),label:"RÃ©servations totales",value:s.totalReservations.toString(),sublabel:`${s.activeAgencies}/${s.totalAgencies} agences actives`,theme:t,emphasis:!1}),u(w,{icon:u(Ua,{className:"h-6 w-6"}),label:"Chiffre d'affaires",value:v(s.totalAmount),sublabel:`${v(s.totalOnlineAmount)} en ligne`,theme:t,emphasis:!0}),u(w,{icon:u(wr,{className:"h-6 w-6"}),label:"Agences",value:s.totalAgencies.toString(),sublabel:`${s.activeAgencies} avec activitÃ©`,theme:t,emphasis:!1}),u(w,{icon:u(qt,{className:"h-6 w-6"}),label:"Validations en attente",value:s.pendingValidations.toString(),sublabel:"NÃ©cessitent votre attention",theme:t,emphasis:!1})]}),m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8",children:[m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"RÃ©partition des paiements"}),u("div",{className:"text-sm text-gray-600",children:v(s.totalAmount)})]}),m("div",{className:"space-y-4",children:[m("div",{className:"space-y-2",children:[m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"font-medium text-gray-700",children:"EspÃ¨ces"}),m("span",{className:"text-gray-900",children:[v(s.cashAmount),"(",s.totalAmount>0?(s.cashAmount/s.totalAmount*100).toFixed(1):"0","%)"]})]}),u("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u("div",{className:"h-full rounded-full bg-blue-500",style:{width:`${s.totalAmount>0?s.cashAmount/s.totalAmount*100:0}%`}})})]}),m("div",{className:"space-y-2",children:[m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"font-medium text-gray-700",children:"Mobile Money"}),m("span",{className:"text-gray-900",children:[v(s.mobileMoneyAmount),"(",s.totalAmount>0?(s.mobileMoneyAmount/s.totalAmount*100).toFixed(1):"0","%)"]})]}),u("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u("div",{className:"h-full rounded-full bg-green-500",style:{width:`${s.totalAmount>0?s.mobileMoneyAmount/s.totalAmount*100:0}%`}})})]}),m("div",{className:"space-y-2",children:[m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"font-medium text-gray-700",children:"En ligne"}),m("span",{className:"text-gray-900",children:[v(s.totalOnlineAmount),"(",s.totalAmount>0?(s.totalOnlineAmount/s.totalAmount*100).toFixed(1):"0","%)"]})]}),u("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u("div",{className:"h-full rounded-full bg-purple-500",style:{width:`${s.totalAmount>0?s.totalOnlineAmount/s.totalAmount*100:0}%`}})})]})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Top 5 Agences (CA)"}),m("div",{className:"text-sm text-gray-600",children:[c.filter(A=>A.amount>0).length," agences avec activitÃ©"]})]}),c.filter(A=>A.amount>0).length===0?u("div",{className:"text-center py-8 text-gray-500",children:"Aucune activitÃ© d'agence sur la pÃ©riode"}):u("div",{className:"space-y-4",children:c.filter(A=>A.amount>0).sort((A,C)=>C.amount-A.amount).slice(0,5).map((A,C)=>m("div",{className:"flex items-center justify-between p-3 rounded-xl border border-gray-200 hover:bg-gray-50/50",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center",children:m("div",{className:"text-sm font-bold text-blue-600",children:["#",C+1]})}),m("div",{children:[u("div",{className:"font-medium text-gray-900",children:A.name}),u("div",{className:"text-xs text-gray-500",children:A.ville})]})]}),m("div",{className:"text-right",children:[u("div",{className:"font-bold text-gray-900",children:v(A.amount)}),m("div",{className:"text-xs text-gray-500",children:[A.reservations," rÃ©servations"]})]})]},A.id))})]})]}),p.length>0&&m("div",{className:"rounded-2xl border border-gray-200 bg-gradient-to-r from-white to-gray-50/50 p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-amber-100 to-orange-100 flex items-center justify-center",children:u(qt,{className:"h-5 w-5 text-amber-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Alertes et notifications"}),u("div",{className:"text-sm text-amber-700",children:"Points nÃ©cessitant votre attention"})]})]}),m("span",{className:"px-3 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-medium",children:[p.length," alerte",p.length>1?"s":""]})]}),u("div",{className:"space-y-3",children:p.map((A,C)=>m("div",{className:`p-3 rounded-lg border ${A.type==="error"?"border-red-200 bg-red-50":A.type==="warning"?"border-amber-200 bg-amber-50":"border-blue-200 bg-blue-50"}`,children:[m("div",{className:"flex items-center justify-between",children:[u("div",{className:"font-medium text-gray-900",children:A.title}),u("span",{className:`text-xs px-2 py-1 rounded-full ${A.type==="error"?"bg-red-100 text-red-800":A.type==="warning"?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800"}`,children:A.type==="error"?"Urgent":A.type==="warning"?"Avertissement":"Information"})]}),u("div",{className:"text-sm text-gray-600 mt-1",children:A.description})]},C))})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"RÃ©servations rÃ©centes"}),m("div",{className:"text-sm text-gray-600",children:[f.length," plus rÃ©centes"]})]}),f.length===0?u("div",{className:"text-center py-8 text-gray-500",children:"Aucune rÃ©servation rÃ©cente"}):u("div",{className:"overflow-hidden rounded-xl border border-gray-200",children:u("div",{className:"overflow-x-auto",children:m("table",{className:"w-full text-sm",children:[u("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50",children:m("tr",{children:[u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Date"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Agence"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Client"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Trajet"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Montant"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Statut"})]})}),u("tbody",{className:"divide-y divide-gray-200",children:f.map((A,C)=>{const I=A.createdAt instanceof Date?A.createdAt:new Date;return m("tr",{className:`hover:bg-gray-50/50 ${C%2===0?"bg-white":"bg-gray-50/30"}`,children:[u("td",{className:"px-4 py-3",children:u("div",{className:"font-medium",children:_(I)})}),u("td",{className:"px-4 py-3",children:u("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700",children:A.agencyName||"Agence inconnue"})}),m("td",{className:"px-4 py-3",children:[u("div",{className:"font-medium",children:A.nomClient||"Sans nom"}),A.telephone&&u("div",{className:"text-xs text-gray-500",children:A.telephone})]}),u("td",{className:"px-4 py-3",children:m("div",{className:"font-medium",children:[A.depart||"N/A"," â†’ ",A.arrivee||"N/A"]})}),u("td",{className:"px-4 py-3",children:u("span",{className:"font-bold text-gray-900",children:v(A.montant||0)})}),u("td",{className:"px-4 py-3",children:u("span",{className:`text-xs px-2 py-1 rounded-full ${A.statut==="confirme"?"bg-emerald-100 text-emerald-800":A.statut==="en_attente"?"bg-amber-100 text-amber-800":A.statut==="verification"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:A.statut==="confirme"?"ConfirmÃ©":A.statut==="en_attente"?"En attente":A.statut==="verification"?"Ã€ vÃ©rifier":A.statut||"Inconnu"})})]},A.id)})})]})})})]})]})};function Cb(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}Array(12).fill(0);let Co=1;class _b{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:n,...a}=e,i=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Co++,o=this.toasts.find(l=>l.id===i),s=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:n}),{...l,...e,id:i,dismissible:s,title:n}):l):this.addToast({title:n,...a,dismissible:s,id:i}),i},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const a=Promise.resolve(e instanceof Function?e():e);let i=n!==void 0,o;const s=a.then(async c=>{if(o=["resolve",c],Lt.isValidElement(c))i=!1,this.create({id:n,type:"default",message:c});else if(Nb(c)&&!c.ok){i=!1;const f=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,h=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description,g=typeof f=="object"&&!Lt.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:h,...g})}else if(c instanceof Error){i=!1;const f=typeof t.error=="function"?await t.error(c):t.error,h=typeof t.description=="function"?await t.description(c):t.description,g=typeof f=="object"&&!Lt.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:h,...g})}else if(t.success!==void 0){i=!1;const f=typeof t.success=="function"?await t.success(c):t.success,h=typeof t.description=="function"?await t.description(c):t.description,g=typeof f=="object"&&!Lt.isValidElement(f)?f:{message:f};this.create({id:n,type:"success",description:h,...g})}}).catch(async c=>{if(o=["reject",c],t.error!==void 0){i=!1;const d=typeof t.error=="function"?await t.error(c):t.error,f=typeof t.description=="function"?await t.description(c):t.description,p=typeof d=="object"&&!Lt.isValidElement(d)?d:{message:d};this.create({id:n,type:"error",description:f,...p})}}).finally(()=>{i&&(this.dismiss(n),n=void 0),t.finally==null||t.finally.call(t)}),l=()=>new Promise((c,d)=>s.then(()=>o[0]==="reject"?d(o[1]):c(o[1])).catch(d));return typeof n!="string"&&typeof n!="number"?{unwrap:l}:Object.assign(n,{unwrap:l})},this.custom=(e,t)=>{const n=(t==null?void 0:t.id)||Co++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Pt=new _b,Eb=(r,e)=>{const t=(e==null?void 0:e.id)||Co++;return Pt.addToast({title:r,...e,id:t}),t},Nb=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",Sb=Eb,Ib=()=>Pt.toasts,Tb=()=>Pt.getActiveToasts(),_t=Object.assign(Sb,{success:Pt.success,info:Pt.info,warning:Pt.warning,error:Pt.error,custom:Pt.custom,message:Pt.message,promise:Pt.promise,dismiss:Pt.dismiss,loading:Pt.loading},{getHistory:Ib,getToasts:Tb});Cb("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const kc=r=>{if(!r)return"en_attente";const e=r.toLowerCase().trim();return e.includes("preuve")||e.includes("verif")?"verification":e.includes("pay")||e.includes("confirm")||e.includes("valid")?"confirme":e.includes("refus")?"refuse":e.includes("annul")||e.includes("cancel")?"annule":(e.includes("attente")||e==="pending","en_attente")},Fc=20,Rb=()=>{const[r,e]=N.useState(null),[t,n]=N.useState(new Set),[a,i]=N.useState(!1);return{initializeAudio:()=>{if(r||typeof window>"u")return;const c=new Audio("/notification.mp3");c.preload="auto",c.load(),c.addEventListener("canplaythrough",()=>{e(c),i(!0)}),c.addEventListener("error",d=>{console.warn("Erreur chargement audio:",d),i(!1)})},playNotification:c=>{!a||!r||t.has(c)||(r.currentTime=0,r.play().catch(d=>{console.warn("Erreur lecture son notification:",d)}),n(d=>{const f=new Set(d);return f.add(c),f}))},resetNotification:c=>{n(d=>{const f=new Set(d);return f.delete(c),f})},isAudioReady:a}},Bc=({children:r,className:e=""})=>u("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${e}`,children:r}),Vc=({theme:r,className:e="",children:t,...n})=>u("button",{...n,className:`
      inline-flex items-center justify-center px-4 py-2.5 rounded-xl text-white font-medium 
      shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200
      disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none relative
      ${e}
    `,style:{background:`linear-gradient(135deg, ${r.primary}, ${r.secondary})`,boxShadow:`0 4px 12px ${r.primary}40`},children:t}),_n=({className:r="",children:e,...t})=>u("button",{...t,className:`
      inline-flex items-center justify-center px-4 py-2.5 rounded-xl border-2 border-gray-200 
      bg-white text-gray-700 font-medium shadow-sm hover:shadow-md hover:border-gray-300 
      hover:bg-gray-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed
      ${r}
    `,children:e}),En=({tone:r,label:e,value:t,icon:n})=>{const a={blue:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-100"},amber:{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-100"},emerald:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-100"},red:{bg:"bg-red-50",text:"text-red-700",border:"border-red-100"},gray:{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-100"}}[r];return m("div",{className:`rounded-2xl border ${a.border} p-4 bg-white shadow-sm hover:shadow-md transition-shadow`,children:[m("div",{className:"flex items-center justify-between mb-2",children:[u("div",{className:`px-2.5 py-1 rounded-lg text-xs font-medium ${a.bg} ${a.text}`,children:e}),u("div",{className:`h-8 w-8 rounded-lg flex items-center justify-center ${a.bg}`,children:u("span",{className:a.text,children:n})})]}),u("div",{className:"text-2xl font-bold text-gray-900",children:t})]})},Pi=r=>{switch(r){case"en_attente":return{label:"En attente",color:"bg-blue-100 text-blue-800 border-blue-300",icon:u(Yn,{className:"h-3 w-3"}),priority:0};case"verification":return{label:"Ã€ vÃ©rifier",color:"bg-amber-100 text-amber-800 border-amber-300",icon:u(Fn,{className:"h-3 w-3"}),priority:1};case"confirme":return{label:"ConfirmÃ©",color:"bg-emerald-100 text-emerald-800 border-emerald-300",icon:u(Bt,{className:"h-3 w-3"}),priority:2};case"refuse":return{label:"RefusÃ©",color:"bg-red-100 text-red-800 border-red-300",icon:u(vr,{className:"h-3 w-3"}),priority:3};case"annule":return{label:"AnnulÃ©",color:"bg-gray-100 text-gray-800 border-gray-300",icon:u(vr,{className:"h-3 w-3"}),priority:4};default:return{label:"Inconnu",color:"bg-gray-100 text-gray-800 border-gray-300",icon:u(Fn,{className:"h-3 w-3"}),priority:5}}},Ob=()=>{const{user:r,company:e}=Tt(),t=tr(),n=Nr(e)||{primary:"#2563eb",secondary:"#3b82f6"},{initializeAudio:a,playNotification:i,resetNotification:o,isAudioReady:s}=Rb(),[l,c]=N.useState([]),[d,f]=N.useState([]),[h,p]=N.useState({}),[g,y]=N.useState(!0),[x,v]=N.useState(!1),[b,_]=N.useState(null),[w,A]=N.useState(""),[C,I]=N.useState(""),[R,F]=N.useState(1),[T,U]=N.useState(!1),[L,B]=N.useState(!1),[H,Q]=N.useState("today"),ae=E=>{const O=new Date,P=new Date;switch(E){case"today":P.setHours(0,0,0,0);break;case"7days":P.setDate(P.getDate()-7),P.setHours(0,0,0,0);break;case"30days":P.setDate(P.getDate()-30),P.setHours(0,0,0,0);break}return{start:P,end:O}};N.useEffect(()=>{const E=()=>{a(),document.removeEventListener("click",E),document.removeEventListener("keydown",E),document.removeEventListener("touchstart",E)};return document.addEventListener("click",E),document.addEventListener("keydown",E),document.addEventListener("touchstart",E),()=>{document.removeEventListener("click",E),document.removeEventListener("keydown",E),document.removeEventListener("touchstart",E)}},[]),N.useEffect(()=>{r!=null&&r.companyId&&(async()=>{try{const E=await xe(ce(j,"companies",r.companyId,"agences")),O={};E.forEach(P=>{const M=P.data();O[P.id]={name:M.nomAgence||M.nom||M.ville||"Agence",ville:M.ville||M.city||""}}),p(O)}catch(E){console.error("Erreur chargement agences:",E),_t.error("Erreur",{description:"Impossible de charger les agences"})}})()},[r==null?void 0:r.companyId]),N.useEffect(()=>{if(!(r!=null&&r.companyId)){y(!1);return}let E=[];return(async()=>{try{const O=await xe(ce(j,"companies",r.companyId,"agences"));if(O.empty){y(!1);return}O.docs.map(M=>M.id).forEach(M=>{const Z=Pe(ce(j,"companies",r.companyId,"agences",M,"reservations"),me("statut","==","preuve_recue"),cr("createdAt","desc")),V=lr(Z,Y=>{c(ee=>{const ge=new Map;return ee.forEach(ue=>{ge.set(`${ue.agencyId}_${ue.id}`,ue)}),Y.docChanges().forEach(ue=>{const Ne=ue.doc.data(),st={id:ue.doc.id,...Ne,statut:kc(Ne.statut),agencyId:Ne.agencyId||M,createdAt:Ne.createdAt||He.now()},rt=`${st.agencyId}_${st.id}`;ue.type==="removed"?(ge.delete(rt),o(rt)):(ue.type==="added"&&st.statut==="verification"&&(s&&i(rt),_t("ðŸ†• Nouvelle preuve reÃ§ue",{description:`${st.nomClient||"Client"} a envoyÃ© une preuve de paiement`,duration:4e3,action:{label:"Voir",onClick:()=>{const rr=document.getElementById(`reservation-${st.id}`);rr&&(rr.scrollIntoView({behavior:"smooth",block:"center"}),rr.classList.add("ring-2","ring-amber-500"),setTimeout(()=>{rr.classList.remove("ring-2","ring-amber-500")},2e3))}}})),ge.set(rt,st))}),Array.from(ge.values()).sort((ue,Ne)=>{const st=ue.createdAt instanceof He?ue.createdAt.toMillis():new Date(ue.createdAt).getTime();return(Ne.createdAt instanceof He?Ne.createdAt.toMillis():new Date(Ne.createdAt).getTime())-st})})},Y=>{console.error("Erreur Firestore (verification):",Y),_t.error("Erreur de connexion",{description:"Impossible de charger les rÃ©servations Ã  vÃ©rifier"})});E.push(V)}),W(),y(!1)}catch(O){console.error("Erreur initiale:",O),y(!1),_t.error("Erreur",{description:"Impossible de charger les agences"})}})(),()=>{E.forEach(O=>O())}},[r==null?void 0:r.companyId,s]);const W=async(E=1)=>{if(r!=null&&r.companyId)try{const O=await xe(ce(j,"companies",r.companyId,"agences"));if(O.empty)return;const P=O.docs.map(V=>V.id),M=[];for(const V of P){const Y=Pe(ce(j,"companies",r.companyId,"agences",V,"reservations"),me("statut","not-in",["preuve_recue"]),cr("createdAt","desc"),dn(Fc*E));(await xe(Y)).docs.forEach(ge=>{const ue=ge.data(),Ne=kc(ue.statut);M.push({id:ge.id,...ue,statut:Ne,agencyId:ue.agencyId||V,createdAt:ue.createdAt||He.now()})})}const Z=Array.from(new Map(M.map(V=>[`${V.agencyId}_${V.id}`,V])).values());f(Z),F(E)}catch(O){console.error("Erreur chargement autres rÃ©servations:",O)}},X=N.useMemo(()=>{const E=new Map;return l.forEach(O=>{const P=`${O.agencyId}_${O.id}`;E.set(P,O)}),d.forEach(O=>{var M;const P=`${O.agencyId}_${O.id}`;(!E.has(P)||((M=E.get(P))==null?void 0:M.statut)!=="verification")&&E.set(P,O)}),Array.from(E.values()).sort((O,P)=>{const M=O.createdAt instanceof He?O.createdAt.toMillis():new Date(O.createdAt).getTime();return(P.createdAt instanceof He?P.createdAt.toMillis():new Date(P.createdAt).getTime())-M})},[l,d]),z=(E,O)=>{if(O==="today"){const M=new Date;M.setHours(0,0,0,0);const Z=new Date;return Z.setHours(23,59,59,999),E.filter(V=>{let Y;if(V.createdAt instanceof He)Y=V.createdAt.toDate();else if(typeof V.createdAt=="string")Y=new Date(V.createdAt);else if(V.createdAt instanceof Date)Y=V.createdAt;else return!1;return Y>=M&&Y<=Z})}const{start:P}=ae(O);return E.filter(M=>{let Z;if(M.createdAt instanceof He)Z=M.createdAt.toDate();else if(typeof M.createdAt=="string")Z=new Date(M.createdAt);else if(M.createdAt instanceof Date)Z=M.createdAt;else return!1;return Z>=P})},ie=N.useMemo(()=>{const E=z(X,H);let O=E;if(C==="verification"?O=z(l,H):C&&(O=E.filter(M=>M.statut===C)),!w)return O;const P=w.toLowerCase();return O.filter(M=>[M.nomClient||"",M.telephone||"",M.referenceCode||"",M.depart||"",M.arrivee||"",M.email||"",M.preuveMessage||""].join(" ").toLowerCase().includes(P))},[X,l,w,C,H]),J=N.useMemo(()=>{const E=z(X,H),O=z(l,H);return{enAttente:E.filter(P=>P.statut==="en_attente").length,verification:O.length,confirme:E.filter(P=>P.statut==="confirme").length,refuse:E.filter(P=>P.statut==="refuse").length,annule:E.filter(P=>P.statut==="annule").length,total:E.length,totalAmount:E.reduce((P,M)=>P+(M.montant||0),0)}},[X,l,H]),K=async E=>{if(!(r!=null&&r.companyId)||!E.agencyId){_t.error("Erreur",{description:"Informations manquantes"});return}_(E.id);try{await sn(le(j,"companies",r.companyId,"agences",E.agencyId,"reservations",E.id),{statut:"confirme",validatedAt:He.now(),updatedAt:He.now()}),c(O=>O.filter(P=>!(P.id===E.id&&P.agencyId===E.agencyId))),o(`${E.agencyId}_${E.id}`),setTimeout(()=>{W(R)},500),_t.success("RÃ©servation confirmÃ©e",{description:`Le billet est maintenant disponible pour ${E.nomClient}`})}catch(O){console.error("Erreur lors de la validation:",O),_t.error("Erreur",{description:"Impossible de confirmer la rÃ©servation"})}finally{_(null)}},pe=async E=>{if(!(r!=null&&r.companyId)||!E.agencyId){_t.error("Erreur",{description:"Informations manquantes"});return}_(E.id);try{const O=window.prompt("Raison du refus ?")||"Raison non spÃ©cifiÃ©e";await sn(le(j,"companies",r.companyId,"agences",E.agencyId,"reservations",E.id),{statut:"refuse",refusedAt:He.now(),updatedAt:He.now(),reason:O}),c(P=>P.filter(M=>!(M.id===E.id&&M.agencyId===E.agencyId))),o(`${E.agencyId}_${E.id}`),setTimeout(()=>{W(R)},500),_t.info("RÃ©servation refusÃ©e",{description:`La rÃ©servation de ${E.nomClient} a Ã©tÃ© refusÃ©e`})}catch(O){console.error("Erreur lors du refus:",O),_t.error("Erreur",{description:"Impossible de refuser la rÃ©servation"})}finally{_(null)}},Ue=async E=>{if(!(r!=null&&r.companyId)||!E.agencyId){_t.error("Erreur",{description:"Informations manquantes"});return}if(window.confirm("ÃŠtes-vous sÃ»r de vouloir supprimer cette rÃ©servation ?")){_(E.id);try{await Nu(le(j,"companies",r.companyId,"agences",E.agencyId,"reservations",E.id)),E.statut==="verification"?(c(O=>O.filter(P=>!(P.id===E.id&&P.agencyId===E.agencyId))),o(`${E.agencyId}_${E.id}`)):f(O=>O.filter(P=>!(P.id===E.id&&P.agencyId===E.agencyId))),_t.success("RÃ©servation supprimÃ©e",{description:"La rÃ©servation a Ã©tÃ© supprimÃ©e avec succÃ¨s"})}catch(O){console.error("Erreur lors de la suppression:",O),_t.error("Erreur",{description:"Impossible de supprimer la rÃ©servation"})}finally{_(null)}}},be=E=>{if(!E.companySlug){_t.error("Erreur",{description:"Impossible d'afficher les dÃ©tails"});return}t(`/${E.companySlug}/reservation/${E.id}`,{state:{companyId:r==null?void 0:r.companyId,agencyId:E.agencyId,companyInfo:{id:r==null?void 0:r.companyId}}})},At=()=>{v(!0),W(R),setTimeout(()=>v(!1),1e3)},ze=()=>{W(R+1)},fe=N.useMemo(()=>{const E=z(X,H),O={};return E.forEach(P=>{P.agencyId&&h[P.agencyId]&&(O[P.agencyId]||(O[P.agencyId]={count:0,amount:0}),O[P.agencyId].count++,O[P.agencyId].amount+=P.montant||0)}),Object.entries(O).map(([P,M])=>{var Z,V;return{id:P,name:((Z=h[P])==null?void 0:Z.name)||"Agence inconnue",ville:((V=h[P])==null?void 0:V.ville)||"",count:M.count,amount:M.amount}}).sort((P,M)=>M.count-P.count).slice(0,5)},[X,h,H]),Me=E=>`${(E||0).toLocaleString("fr-FR")} FCFA`,Re=E=>{if(!E)return"N/A";let O;if(E instanceof He)O=E.toDate();else if(typeof E=="string")O=new Date(E);else if(E instanceof Date)O=E;else return"N/A";return O.toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})},Ee=E=>E.paymentProofUrl||E.preuveUrl||E.paiementPreuveUrl||E.proofUrl||E.receiptUrl;return m("div",{className:"space-y-6 sm:space-y-8",children:[u("div",{className:"rounded-2xl border border-gray-200 shadow-sm p-6 bg-gradient-to-r from-white to-gray-50/50",children:m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[m("div",{className:"flex-1",children:[m("div",{className:"mb-2",children:[u("h1",{className:"text-2xl font-bold text-gray-900",children:"RÃ©servations en ligne"}),u("p",{className:"text-sm text-gray-600 mt-1",children:"Gestion des rÃ©servations et paiements"})]}),m("div",{className:"flex flex-wrap items-center gap-4 mt-3",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:`h-3 w-3 rounded-full ${l.length>0?"bg-amber-500 animate-pulse":"bg-gray-300"}`}),u("span",{className:"text-sm text-gray-600",children:l.length>0?`${l.length} preuve${l.length>1?"s":""} Ã  vÃ©rifier`:"Tout est Ã  jour"})]}),u("div",{className:"text-sm text-gray-400",children:"â€¢ Mise Ã  jour en temps rÃ©el"})]})]}),u("div",{className:"flex items-center gap-2",children:u("button",{onClick:At,className:"p-2.5 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-xl transition-colors",title:"Actualiser manuellement",children:u(Zt,{className:`h-4 w-4 ${x?"animate-spin":""}`})})})]})}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm",children:[m("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3",children:[u("div",{className:"sm:col-span-2",children:m("div",{className:"relative",children:[u(dh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u("input",{type:"text",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-xl bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:n.primary},placeholder:"Rechercher par nom, tÃ©lÃ©phone ou rÃ©fÃ©rence...",value:w,onChange:E=>A(E.target.value)})]})}),u("div",{children:m("select",{value:C,onChange:E=>I(E.target.value),className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:n.primary},children:[u("option",{value:"",children:"Toutes les rÃ©servations"}),m("option",{value:"verification",children:["Ã€ vÃ©rifier (",J.verification,")"]}),m("option",{value:"en_attente",children:["En attente (",J.enAttente,")"]}),m("option",{value:"confirme",children:["ConfirmÃ©es (",J.confirme,")"]}),m("option",{value:"refuse",children:["RefusÃ©es (",J.refuse,")"]}),m("option",{value:"annule",children:["AnnulÃ©es (",J.annule,")"]})]})}),u("div",{children:m("select",{value:H,onChange:E=>Q(E.target.value),className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:n.primary},children:[u("option",{value:"today",children:"Aujourd'hui"}),u("option",{value:"7days",children:"7 derniers jours"}),u("option",{value:"30days",children:"30 derniers jours"})]})})]}),m("div",{className:"mt-3 flex gap-2",children:[m("button",{onClick:()=>U(!T),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border-2 border-gray-200 bg-white text-gray-700 font-medium shadow-sm hover:shadow-md hover:border-gray-300 hover:bg-gray-50 transition-all duration-200",children:[T?u(Bi,{className:"h-4 w-4"}):u(Vi,{className:"h-4 w-4"}),T?"Masquer les stats":"Afficher les stats"]}),m(Vc,{theme:n,className:"flex-1",children:[u(Io,{className:"h-4 w-4 mr-2"}),"Exporter"]})]})]}),T&&m(bt,{children:[m("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3 sm:gap-4",children:[u(En,{tone:"amber",label:"Ã€ vÃ©rifier",value:J.verification.toString(),icon:u(Fn,{className:"h-4 w-4"})}),u(En,{tone:"blue",label:"En attente",value:J.enAttente.toString(),icon:u(Yn,{className:"h-4 w-4"})}),u(En,{tone:"emerald",label:"ConfirmÃ©es",value:J.confirme.toString(),icon:u(Bt,{className:"h-4 w-4"})}),u(En,{tone:"red",label:"RefusÃ©es",value:J.refuse.toString(),icon:u(vr,{className:"h-4 w-4"})}),u(En,{tone:"gray",label:"AnnulÃ©es",value:J.annule.toString(),icon:u(vr,{className:"h-4 w-4"})})]}),u("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{className:"flex items-center gap-2",children:[u(br,{className:"h-5 w-5 text-gray-500"}),m("div",{className:"text-lg font-bold text-gray-900",children:["PÃ©riode : ",H==="today"?"Aujourd'hui":H==="7days"?"7 derniers jours":"30 derniers jours"]})]}),m("div",{className:"text-sm text-gray-600",children:["Total : ",J.total," rÃ©servations â€¢ ",Me(J.totalAmount)]})]})}),fe.length>0&&m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Top 5 Agences"}),u("div",{className:"text-sm text-gray-600",children:"Par nombre de rÃ©servations"})]}),u("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:fe.map((E,O)=>m("div",{className:"p-4 rounded-xl border border-gray-200 bg-gradient-to-br from-gray-50 to-gray-100/50",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center",children:m("div",{className:"text-sm font-bold text-blue-600",children:["#",O+1]})}),m("div",{className:"min-w-0",children:[u("div",{className:"font-medium text-gray-900 truncate",children:E.name}),u("div",{className:"text-xs text-gray-500 truncate",children:E.ville})]})]}),m("div",{className:"space-y-2",children:[m("div",{className:"flex justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"RÃ©servations"}),u("span",{className:"font-bold text-gray-900",children:E.count})]}),m("div",{className:"flex justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"Montant"}),u("span",{className:"font-bold text-gray-900",children:Me(E.amount)})]})]})]},E.id))})]})]}),l.length>0&&(!C||C==="verification")&&m("div",{className:"space-y-4",children:[u("div",{className:"flex items-center justify-between",children:m("div",{children:[m("div",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[u("div",{className:"h-2 w-2 rounded-full bg-amber-500 animate-pulse"}),"Preuves de paiement Ã  vÃ©rifier"]}),m("div",{className:"text-sm text-gray-600",children:[l.length," preuve",l.length>1?"s":""," en attente de validation"]})]})}),u("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z(l,H).filter(E=>!w||[E.nomClient,E.telephone,E.referenceCode,E.preuveMessage].join(" ").toLowerCase().includes(w.toLowerCase())).map(E=>{Pi(E.statut);const O=b===E.id,P=Ee(E),M=E.agencyId?h[E.agencyId]:null;return m("div",{id:`reservation-${E.id}`,className:"border-2 border-amber-200 rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 bg-gradient-to-b from-amber-50/50 to-white",children:[m("div",{className:"p-4 bg-gradient-to-r from-amber-50 to-amber-100/50 border-b border-amber-200",children:[m("div",{className:"flex items-center justify-between mb-2",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:"h-6 w-6 rounded-md bg-amber-100 flex items-center justify-center",children:u(wr,{className:"h-3 w-3 text-amber-600"})}),u("span",{className:"text-sm font-medium text-gray-900 truncate",children:(M==null?void 0:M.name)||"Agence inconnue"})]}),m(Bc,{className:"bg-amber-100 text-amber-800 border-amber-300",children:[u(Fn,{className:"h-3 w-3"}),u("span",{className:"ml-1",children:"Ã€ vÃ©rifier"})]})]}),E.referenceCode&&m("div",{className:"text-xs font-mono text-gray-600",children:["#",E.referenceCode]})]}),m("div",{className:"p-4 space-y-3",children:[m("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:[m("div",{className:"flex items-center gap-2 mb-1",children:[u(To,{className:"h-4 w-4 text-blue-600"}),u("span",{className:"text-sm font-medium text-gray-700",children:"TÃ©lÃ©phone client"})]}),u("div",{className:"text-lg font-bold text-gray-900",children:E.telephone||"Non renseignÃ©"})]}),E.preuveMessage&&m("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-200",children:[m("div",{className:"flex items-center gap-2 mb-1",children:[u(ar,{className:"h-4 w-4 text-amber-600"}),u("span",{className:"text-sm font-medium text-gray-700",children:"Message de preuve"})]}),u("div",{className:"text-sm text-gray-800",children:E.preuveMessage})]}),m("div",{className:"space-y-2",children:[m("div",{className:"flex items-center justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"Client"}),u("span",{className:"text-sm font-medium text-gray-900 truncate max-w-[150px] text-right",children:E.nomClient||"Sans nom"})]}),m("div",{className:"flex items-center justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"Trajet"}),m("span",{className:"text-sm font-medium text-gray-900 text-right",children:[E.depart||"N/A"," â†’ ",E.arrivee||"N/A"]})]}),m("div",{className:"flex items-center justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"Montant"}),u("span",{className:"text-sm font-bold text-gray-900",children:Me(E.montant||0)})]})]}),P&&m("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 font-medium p-2 rounded-lg hover:bg-blue-50 w-full justify-center border border-blue-200",children:[u(ar,{className:"h-4 w-4"}),"Voir la preuve de paiement complÃ¨te"]}),m("div",{className:"text-xs text-gray-400",children:["ReÃ§u le: ",Re(E.createdAt)]})]}),m("div",{className:"p-4 border-t border-amber-200 bg-amber-50/50 space-y-2",children:[m("div",{className:"grid grid-cols-2 gap-2",children:[u(Vc,{onClick:()=>K(E),disabled:O,theme:n,className:"flex items-center justify-center gap-2",children:O?u(gr.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:u(fh,{className:"h-4 w-4"})}):m(bt,{children:[u(Bt,{className:"h-4 w-4"}),"Valider"]})}),m(_n,{onClick:()=>pe(E),disabled:O,className:"border-red-300 text-red-700 hover:bg-red-50",children:[u(vr,{className:"h-4 w-4"}),"Refuser"]})]}),m("div",{className:"grid grid-cols-2 gap-2",children:[m(_n,{onClick:()=>be(E),className:"flex items-center justify-center gap-2",children:[u(Bn,{className:"h-4 w-4"}),"DÃ©tails"]}),u(_n,{onClick:()=>Ue(E),disabled:O,children:"Supprimer"})]})]})]},`${E.agencyId}_${E.id}`)})})]}),(C!=="verification"&&C!==""||C===""&&d.length>0)&&m("div",{className:"space-y-4",children:[m("div",{className:"flex items-center justify-between",children:[m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:C?`${Pi(C).label}s`:"Toutes les rÃ©servations"}),u("div",{className:"text-sm text-gray-600",children:C?`${ie.filter(E=>E.statut!=="verification").length} rÃ©servation${ie.filter(E=>E.statut!=="verification").length>1?"s":""}`:"Historique des rÃ©servations"})]}),u("button",{onClick:()=>B(!L),className:"text-sm text-gray-600 hover:text-gray-900 flex items-center gap-1 px-3 py-1.5 rounded-lg hover:bg-gray-100 transition-colors",children:L?m(bt,{children:[u(Bi,{className:"h-4 w-4"}),"RÃ©duire"]}):m(bt,{children:[u(Vi,{className:"h-4 w-4"}),"DÃ©velopper"]})})]}),L&&u(bt,{children:ie.filter(E=>E.statut!=="verification").length===0?u("div",{className:"text-center py-8 border border-gray-200 rounded-xl",children:u("div",{className:"text-gray-500",children:"Aucune rÃ©servation Ã  afficher"})}):m(bt,{children:[u("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ie.filter(E=>E.statut!=="verification").map(E=>{const O=Pi(E.statut);E.id;const P=E.agencyId?h[E.agencyId]:null;return m("div",{className:"border border-gray-200 rounded-xl overflow-hidden hover:shadow-md transition-all duration-300 bg-white",children:[m("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100/50 border-b",children:[m("div",{className:"flex items-center justify-between mb-2",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:"h-6 w-6 rounded-md bg-blue-100 flex items-center justify-center",children:u(wr,{className:"h-3 w-3 text-blue-600"})}),u("span",{className:"text-sm font-medium text-gray-900 truncate",children:(P==null?void 0:P.name)||"Agence inconnue"})]}),m(Bc,{className:O.color,children:[O.icon,u("span",{className:"ml-1",children:O.label})]})]}),E.referenceCode&&m("div",{className:"text-xs font-mono text-gray-600",children:["#",E.referenceCode]})]}),m("div",{className:"p-4 space-y-2",children:[m("div",{className:"flex items-center justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"Client"}),u("span",{className:"text-sm font-medium text-gray-900",children:E.nomClient||"Sans nom"})]}),m("div",{className:"flex items-center justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"TÃ©lÃ©phone"}),u("span",{className:"text-sm font-medium text-gray-900",children:E.telephone||"N/A"})]}),m("div",{className:"flex items-center justify-between",children:[u("span",{className:"text-sm text-gray-500",children:"Montant"}),u("span",{className:"text-sm font-bold text-gray-900",children:Me(E.montant||0)})]}),m("div",{className:"text-xs text-gray-400",children:["CrÃ©Ã© le: ",Re(E.createdAt)]})]}),u("div",{className:"p-4 border-t bg-gray-50 space-y-2",children:m(_n,{onClick:()=>be(E),className:"w-full flex items-center justify-center gap-2",children:[u(Bn,{className:"h-4 w-4"}),"Voir dÃ©tails"]})})]},`${E.agencyId}_${E.id}`)})}),!C&&d.length>0&&R*Fc<=d.length&&u("div",{className:"text-center pt-6",children:m(_n,{onClick:ze,children:[u(Zt,{className:"h-4 w-4 mr-2"}),"Charger plus de rÃ©servations"]})})]})})]})]})},Db=()=>{var T,U;const{user:r,company:e}=Tt(),t=Nr(e)||{primary:"#2563eb",secondary:"#3b82f6"},[n,a]=N.useState(!0),[i,o]=N.useState("month"),[s,l]=N.useState({start:null,end:null}),[c,d]=N.useState(null),[f,h]=N.useState(new Date),p=()=>{const L=new Date,B=new Date(L.getFullYear(),L.getMonth(),1),H=new Date(L.getFullYear(),L.getMonth()+1,0,23,59,59);return{start:B,end:H,label:B.toLocaleDateString("fr-FR",{month:"long",year:"numeric"}),isCurrentMonth:!0}},g=(L,B,H)=>{const Q=new Date;if(L==="custom"&&B&&H){const z=new Date(H);return z.setHours(23,59,59),{start:B,end:z,label:`${B.toLocaleDateString("fr-FR")} â†’ ${H.toLocaleDateString("fr-FR")}`,isCurrentMonth:!1}}let ae=new Date,W="";switch(L){case"day":ae.setHours(0,0,0,0),W="Aujourd'hui";break;case"week":ae.setDate(Q.getDate()-7),ae.setHours(0,0,0,0),W="7 derniers jours";break;case"month":return p();case"quarter":ae.setMonth(Q.getMonth()-3),ae.setHours(0,0,0,0),W="Trimestre Ã©coulÃ©";break;case"year":ae.setFullYear(Q.getFullYear()-1),ae.setHours(0,0,0,0),W="AnnÃ©e Ã©coulÃ©e";break}const X=new Date;return X.setHours(23,59,59,999),{start:ae,end:X,label:W,isCurrentMonth:!1}};N.useEffect(()=>{r!=null&&r.companyId&&y()},[r==null?void 0:r.companyId,i,s]);const y=async()=>{var L;a(!0);try{const B=i==="custom"&&s.start&&s.end?g("custom",s.start,s.end):g(i),H=ce(j,`companies/${r.companyId}/agences`),ae=(await xe(H)).docs.map(fe=>({id:fe.id,name:fe.data().nomAgence||fe.data().nom||fe.data().ville||"Agence",ville:fe.data().ville||""})),W=[];let X=0,z=0,ie=0,J=0,K=0;for(const fe of ae){const Me=ce(j,`companies/${r.companyId}/agences/${fe.id}/reservations`),Re=Pe(Me,me("statut","==","confirme"),me("createdAt",">=",He.fromDate(B.start)),me("createdAt","<=",He.fromDate(B.end))),Ee=await xe(Re);let E=0,O=0,P=0;Ee.forEach(M=>{const Z=M.data(),V=Z.montant||0;P+=V,String(Z.canal||"").toLowerCase()==="en_ligne"?(O+=V,ie+=V):(E+=V,z+=V);const ee=String(Z.paiement||"").toLowerCase();ee.includes("cash")||ee.includes("esp")?J+=V:(ee.includes("mobile")||ee.includes("mtn")||ee.includes("orange")||ee.includes("wave"))&&(K+=V)}),X+=P,W.push({id:fe.id,name:fe.name,revenue:P,guichetRevenue:E,onlineRevenue:O})}const pe=[];let Ue=null,be=null;try{for(const fe of ae){const Me=le(j,`companies/${r.companyId}/agences/${fe.id}/expenses/current`),Re=await pt(Me);if(Re.exists()){const Ee=Re.data(),E=(L=Ee.lastUpdated)==null?void 0:L.toDate();if(!E||E>=B.start&&E<=B.end){const O={id:fe.id,name:fe.name,total:Ee.total||0,salaries:Ee.salaries||0,operations:Ee.operations||0,marketing:Ee.marketing||0,other:Ee.other||0};pe.push(O),Ue=(Ue||0)+O.total,be||(be={salaries:0,operations:0,marketing:0,other:0}),be.salaries+=O.salaries,be.operations+=O.operations,be.marketing+=O.marketing,be.other+=O.other}}}}catch{console.warn("Aucune donnÃ©e de dÃ©penses disponible")}const At=W.map(fe=>{const Me=pe.find(O=>O.id===fe.id),Re=(Me==null?void 0:Me.total)||null,Ee=Re!==null?fe.revenue-Re:null,E=Ee!==null&&fe.revenue>0?Ee/fe.revenue*100:null;return{id:fe.id,name:fe.name,revenue:fe.revenue,expenses:Re,profit:Ee,margin:E}}).sort((fe,Me)=>Me.revenue-fe.revenue),ze={period:B,revenue:{total:X,guichet:z,online:ie,byAgency:W.sort((fe,Me)=>Me.revenue-fe.revenue)},paymentMethods:{cash:J,mobileMoney:K,total:J+K},expenses:{total:Ue,byAgency:pe,detail:be},agencies:At};d(ze),h(new Date)}catch(B){console.error("[Finances] Erreur chargement donnÃ©es:",B)}finally{a(!1)}},x=()=>{y()},v=(L,B)=>{const H=B?new Date(B):null;l(Q=>({...Q,[L]:H}))},b=L=>L==null?"N/A":`${(L||0).toLocaleString("fr-FR")} FCFA`,_=L=>L==null?"N/A":`${L>=0?"+":""}${L.toFixed(1)}%`,w=L=>L>=1e6?`${(L/1e6).toFixed(1)}M`:L>=1e3?`${(L/1e3).toFixed(0)}K`:L.toString(),A=({icon:L,label:B,value:H,sublabel:Q,trend:ae,theme:W,emphasis:X,warning:z=!1,info:ie=!1})=>m("div",{className:`relative overflow-hidden rounded-2xl border p-5 bg-white shadow-sm
        hover:shadow-md transition-all duration-300
        ${X?"ring-2 ring-offset-2":""}
        ${z?"border-amber-300 bg-amber-50/30":ie?"border-blue-300 bg-blue-50/30":"border-gray-200"}`,style:X?{"--tw-ring-color":W.primary}:void 0,children:[u("div",{className:"absolute top-0 right-0 h-20 w-20 opacity-10",children:u("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full blur-xl"})}),m("div",{className:"flex items-start justify-between mb-4",children:[u("div",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:B}),u("div",{className:`h-10 w-10 rounded-xl grid place-items-center ${z?"bg-amber-100":ie?"bg-blue-100":""}`,style:!z&&!ie?{background:`linear-gradient(135deg, ${W.primary}20, ${W.secondary}20)`}:void 0,children:u("span",{className:z?"text-amber-600":ie?"text-blue-600":"text-gray-700",children:L})})]}),m("div",{className:"space-y-1",children:[u("div",{className:`font-bold ${X?"text-3xl":"text-2xl"} 
          ${z?"text-amber-700":ie?"text-blue-700":"text-gray-900"}`,children:H}),Q&&u("div",{className:`text-xs font-medium ${z?"text-amber-600":ie?"text-blue-600":"text-gray-500"}`,children:Q}),ae!=null&&m("div",{className:`inline-flex items-center gap-1 text-xs font-medium ${ae>=0?"text-emerald-600":"text-red-600"}`,children:[ae>=0?u(ph,{className:"h-3 w-3"}):u(mh,{className:"h-3 w-3"}),Math.abs(ae).toFixed(1),"% vs pÃ©riode prÃ©cÃ©dente"]})]})]}),C=({period:L})=>m("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200",children:[u(br,{className:"h-3 w-3 text-blue-600"}),u("span",{className:"text-sm font-medium text-blue-700",children:L.label}),L.isCurrentMonth&&u("span",{className:"text-xs px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700",children:"En cours"})]});if(n)return u("div",{className:"flex items-center justify-center py-20",children:m("div",{className:"text-center",children:[u("div",{className:"h-12 w-12 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-3"}),u("div",{className:"text-gray-600",children:"Calcul des donnÃ©es financiÃ¨res..."})]})});if(!c)return m("div",{className:"text-center py-20",children:[u(qt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),u("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"DonnÃ©es non disponibles"}),u("div",{className:"text-gray-600",children:"Impossible de charger les donnÃ©es financiÃ¨res"})]});const I=c.expenses.total!==null,R=I&&c.expenses.total!==null?c.revenue.total-c.expenses.total:null,F=R!==null&&c.revenue.total>0?R/c.revenue.total*100:null;return m("div",{className:"space-y-6 sm:space-y-8",children:[m("div",{className:"rounded-2xl border border-gray-200 shadow-sm p-6 bg-gradient-to-r from-white to-gray-50/50",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-emerald-50 to-green-50 flex items-center justify-center",children:u(Ua,{className:"h-6 w-6 text-emerald-600"})}),m("div",{children:[u("div",{className:"text-xl font-bold text-gray-900",children:"Finances Compagnie"}),u("div",{className:"text-sm text-gray-600",children:"DonnÃ©es consolidÃ©es pour la prise de dÃ©cision"})]})]}),m("div",{className:"flex items-center gap-3",children:[m("button",{onClick:x,className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-gray-200 bg-white hover:bg-gray-50 text-sm font-medium",children:[u(Zt,{className:"h-4 w-4"}),"Actualiser"]}),m("button",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-gray-200 bg-white hover:bg-gray-50 text-sm font-medium",children:[u(Io,{className:"h-4 w-4"}),"Exporter"]})]})]}),m("div",{className:"mt-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[m("div",{className:"flex items-center gap-3",children:[u(C,{period:c.period}),m("div",{className:"text-sm text-gray-600",children:["DonnÃ©es consolidÃ©es de ",c.revenue.byAgency.length," agences"]})]}),m("div",{className:"text-xs text-gray-500",children:["DerniÃ¨re mise Ã  jour : ",f.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-5",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:u(br,{className:"h-5 w-5 text-gray-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"PÃ©riode d'analyse"}),u("div",{className:"text-sm text-gray-600",children:"SÃ©lectionnez la pÃ©riode Ã  analyser"})]})]}),m("div",{className:"text-sm text-gray-600",children:[u("span",{className:"font-medium",children:"PÃ©riode :"})," ",c.period.start.toLocaleDateString("fr-FR")," â†’ ",c.period.end.toLocaleDateString("fr-FR")]})]}),m("div",{className:"space-y-4",children:[m("div",{className:"flex flex-wrap gap-2",children:[u("button",{className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i==="day"?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>o("day"),children:"Aujourd'hui"}),u("button",{className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i==="week"?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>o("week"),children:"7 derniers jours"}),u("button",{className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i==="month"?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>o("month"),children:"Mois en cours"}),u("button",{className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i==="quarter"?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>o("quarter"),children:"Trimestre"}),u("button",{className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i==="year"?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>o("year"),children:"AnnÃ©e"}),u("button",{className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i==="custom"?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>o("custom"),children:"PÃ©riode personnalisÃ©e"})]}),i==="custom"&&m("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 rounded-lg border border-blue-200 bg-blue-50",children:[m("div",{children:[u("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de dÃ©but"}),u("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:t.primary},value:((T=s.start)==null?void 0:T.toISOString().split("T")[0])||"",onChange:L=>v("start",L.target.value)})]}),m("div",{children:[u("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),u("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:t.primary},value:((U=s.end)==null?void 0:U.toISOString().split("T")[0])||"",onChange:L=>v("end",L.target.value)})]}),u("div",{className:"sm:col-span-2",children:m("button",{onClick:()=>{s.start&&s.end&&y()},disabled:!s.start||!s.end,className:"w-full inline-flex items-center justify-center px-4 py-2.5 rounded-lg text-white font-medium disabled:opacity-50",style:{background:`linear-gradient(135deg, ${t.primary}, ${t.secondary})`},children:[u(ji,{className:"h-4 w-4 mr-2"}),"Appliquer la pÃ©riode"]})})]}),m("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-gray-50 border border-gray-200",children:[u(Ea,{className:"h-5 w-5 text-gray-500 mt-0.5 flex-shrink-0"}),m("div",{className:"text-sm text-gray-600",children:[u("span",{className:"font-medium",children:"Mois en cours par dÃ©faut :"}),"La pÃ©riode d'analyse est automatiquement dÃ©finie sur le mois civil en cours pour correspondre aux pratiques comptables standards."]})]})]})]}),m("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[u(A,{icon:u(wu,{className:"h-6 w-6"}),label:"Chiffre d'affaires",value:b(c.revenue.total),sublabel:`${c.revenue.byAgency.length} agences actives`,theme:t,emphasis:!0}),I?u(A,{icon:u(Au,{className:"h-6 w-6"}),label:"DÃ©penses totales",value:b(c.expenses.total),sublabel:`${c.expenses.byAgency.length} agences renseignÃ©es`,theme:t,emphasis:!1}):u(A,{icon:u(qt,{className:"h-6 w-6"}),label:"DÃ©penses totales",value:"DonnÃ©es manquantes",sublabel:"Ã€ renseigner par les agences",theme:t,emphasis:!1,warning:!0}),I?u(A,{icon:u(Cu,{className:"h-6 w-6"}),label:"BÃ©nÃ©fice net",value:b(R),sublabel:`Marge : ${_(F)}`,theme:t,emphasis:!1}):u(A,{icon:u(hh,{className:"h-6 w-6"}),label:"BÃ©nÃ©fice net",value:"Non calculable",sublabel:"En attente des donnÃ©es de dÃ©penses",theme:t,emphasis:!1,info:!0}),u(A,{icon:u(Ui,{className:"h-6 w-6"}),label:"Transactions",value:w(c.revenue.total),sublabel:`${c.paymentMethods.total>0?`${(c.paymentMethods.cash/c.paymentMethods.total*100).toFixed(0)}% espÃ¨ces`:"0 transaction"}`,theme:t,emphasis:!1})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"RÃ©partition du chiffre d'affaires par canal"}),u("div",{className:"text-sm text-gray-600",children:"Analyse des points de vente"})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m("div",{className:"p-5 rounded-xl border border-gray-200 bg-gradient-to-br from-blue-50 to-indigo-50",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[u("div",{className:"h-12 w-12 rounded-xl bg-white border border-blue-200 flex items-center justify-center",children:u(wr,{className:"h-6 w-6 text-blue-600"})}),m("div",{children:[u("div",{className:"font-bold text-gray-900",children:"Guichet"}),u("div",{className:"text-sm text-gray-600",children:"Ventes en agence"})]})]}),m("div",{className:"space-y-4",children:[u("div",{className:"text-3xl font-bold text-gray-900",children:b(c.revenue.guichet)}),u("div",{className:"text-sm text-gray-500",children:c.revenue.total>0?`${(c.revenue.guichet/c.revenue.total*100).toFixed(1)}% du chiffre d'affaires total`:"Aucune vente"}),m("div",{className:"pt-4 border-t border-blue-200",children:[u("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Top agences guichet :"}),u("div",{className:"space-y-2",children:c.revenue.byAgency.filter(L=>L.guichetRevenue>0).sort((L,B)=>B.guichetRevenue-L.guichetRevenue).slice(0,3).map((L,B)=>m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:"h-6 w-6 rounded-md bg-blue-100 flex items-center justify-center",children:m("span",{className:"text-xs font-bold text-blue-600",children:["#",B+1]})}),u("span",{className:"text-sm text-gray-700 truncate",children:L.name})]}),u("span",{className:"text-sm font-medium text-gray-900",children:w(L.guichetRevenue)})]},L.id))})]})]})]}),m("div",{className:"p-5 rounded-xl border border-gray-200 bg-gradient-to-br from-purple-50 to-pink-50",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[u("div",{className:"h-12 w-12 rounded-xl bg-white border border-purple-200 flex items-center justify-center",children:u(Kn,{className:"h-6 w-6 text-purple-600"})}),m("div",{children:[u("div",{className:"font-bold text-gray-900",children:"En ligne"}),u("div",{className:"text-sm text-gray-600",children:"RÃ©servations web"})]})]}),m("div",{className:"space-y-4",children:[u("div",{className:"text-3xl font-bold text-gray-900",children:b(c.revenue.online)}),u("div",{className:"text-sm text-gray-500",children:c.revenue.total>0?`${(c.revenue.online/c.revenue.total*100).toFixed(1)}% du chiffre d'affaires total`:"Aucune vente"}),m("div",{className:"pt-4 border-t border-purple-200",children:[u("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Top agences en ligne :"}),u("div",{className:"space-y-2",children:c.revenue.byAgency.filter(L=>L.onlineRevenue>0).sort((L,B)=>B.onlineRevenue-L.onlineRevenue).slice(0,3).map((L,B)=>m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-2",children:[u("div",{className:"h-6 w-6 rounded-md bg-purple-100 flex items-center justify-center",children:m("span",{className:"text-xs font-bold text-purple-600",children:["#",B+1]})}),u("span",{className:"text-sm text-gray-700 truncate",children:L.name})]}),u("span",{className:"text-sm font-medium text-gray-900",children:w(L.onlineRevenue)})]},L.id))})]})]})]})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Moyens de paiement utilisÃ©s"}),u("div",{className:"text-sm text-gray-600",children:"RÃ©partition des encaissements"})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m("div",{className:"p-5 rounded-xl border border-gray-200",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[u("div",{className:"h-12 w-12 rounded-xl bg-emerald-100 flex items-center justify-center",children:u(_u,{className:"h-6 w-6 text-emerald-600"})}),m("div",{children:[u("div",{className:"font-bold text-gray-900",children:"EspÃ¨ces"}),u("div",{className:"text-sm text-gray-600",children:"Paiements en cash"})]})]}),m("div",{className:"space-y-2",children:[u("div",{className:"text-3xl font-bold text-gray-900",children:b(c.paymentMethods.cash)}),u("div",{className:"text-sm text-gray-500",children:c.paymentMethods.total>0?`${(c.paymentMethods.cash/c.paymentMethods.total*100).toFixed(1)}% des encaissements`:"Aucun paiement"}),u("div",{className:"mt-4",children:u("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:u("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:`${c.paymentMethods.total>0?c.paymentMethods.cash/c.paymentMethods.total*100:0}%`}})})})]})]}),m("div",{className:"p-5 rounded-xl border border-gray-200",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[u("div",{className:"h-12 w-12 rounded-xl bg-blue-100 flex items-center justify-center",children:u(To,{className:"h-6 w-6 text-blue-600"})}),m("div",{children:[u("div",{className:"font-bold text-gray-900",children:"Mobile Money"}),u("div",{className:"text-sm text-gray-600",children:"Paiements mobiles"})]})]}),m("div",{className:"space-y-2",children:[u("div",{className:"text-3xl font-bold text-gray-900",children:b(c.paymentMethods.mobileMoney)}),u("div",{className:"text-sm text-gray-500",children:c.paymentMethods.total>0?`${(c.paymentMethods.mobileMoney/c.paymentMethods.total*100).toFixed(1)}% des encaissements`:"Aucun paiement"}),u("div",{className:"mt-4",children:u("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:u("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${c.paymentMethods.total>0?c.paymentMethods.mobileMoney/c.paymentMethods.total*100:0}%`}})})})]})]})]}),u("div",{className:"mt-6 p-4 rounded-lg bg-gray-50 border border-gray-200",children:m("div",{className:"text-sm text-gray-600",children:[u("span",{className:"font-medium",children:"Note :"}),"Les moyens de paiement (espÃ¨ces, mobile money) peuvent Ãªtre utilisÃ©s dans les deux canaux (guichet et en ligne). Cette rÃ©partition montre comment l'argent est physiquement encaissÃ©."]})})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Performance par agence"}),m("div",{className:"text-sm text-gray-600",children:[c.agencies.length," agences",!I&&" (bÃ©nÃ©fice non calculable - dÃ©penses manquantes)"]})]}),u("div",{className:"overflow-hidden rounded-xl border border-gray-200",children:m("table",{className:"w-full text-sm",children:[u("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50",children:m("tr",{children:[u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Agence"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Chiffre d'affaires"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"DÃ©penses"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"BÃ©nÃ©fice"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Marge"}),u("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"DÃ©tail"})]})}),u("tbody",{className:"divide-y divide-gray-200",children:c.agencies.map(L=>{const B=L.expenses!==null;return m("tr",{className:"hover:bg-gray-50/50",children:[u("td",{className:"px-4 py-3",children:u("div",{className:"font-medium text-gray-900",children:L.name})}),u("td",{className:"px-4 py-3",children:u("div",{className:"font-bold text-gray-900",children:b(L.revenue)})}),u("td",{className:"px-4 py-3",children:B?u("div",{className:"font-medium text-gray-700",children:b(L.expenses)}):u("div",{className:"text-amber-600 text-sm bg-amber-50 px-2 py-1 rounded inline-block",children:"Non renseignÃ©es"})}),u("td",{className:"px-4 py-3",children:B&&L.profit!==null?u("div",{className:`font-bold ${L.profit>=0?"text-emerald-700":"text-red-700"}`,children:b(L.profit)}):u("div",{className:"text-gray-400 text-sm",children:"-"})}),u("td",{className:"px-4 py-3",children:B&&L.margin!==null?u("div",{className:`font-medium ${L.margin>=0?"text-emerald-600":"text-red-600"}`,children:_(L.margin)}):u("div",{className:"text-gray-400 text-sm",children:"-"})}),u("td",{className:"px-4 py-3",children:m("button",{className:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Voir dÃ©tail",u(yu,{className:"h-3 w-3"})]})})]},L.id)})})]})}),u("div",{className:"mt-6 p-4 rounded-lg bg-gray-50 border border-gray-200",children:m("div",{className:"text-sm text-gray-700",children:[u("strong",{children:"Mode de calcul :"}),m("ul",{className:"mt-2 space-y-1",children:[u("li",{children:"â€¢ Chiffre d'affaires = Somme des transactions validÃ©es"}),u("li",{children:"â€¢ DÃ©penses = Saisies individuelles par chaque agence"}),u("li",{children:"â€¢ BÃ©nÃ©fice = CA - DÃ©penses (calculÃ© uniquement si dÃ©penses renseignÃ©es)"}),u("li",{children:"â€¢ Marge = (BÃ©nÃ©fice / CA) Ã— 100"})]}),u("div",{className:"mt-3 text-amber-600",children:!I&&m(bt,{children:[u(qt,{className:"h-4 w-4 inline mr-1"}),u("strong",{children:"Action requise :"})," Demandez aux agences de renseigner leurs dÃ©penses pour calculer les bÃ©nÃ©fices."]})})]})})]}),I&&c.expenses.detail&&m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"DÃ©tail des dÃ©penses consolidÃ©es"}),m("div",{className:"text-sm text-gray-600",children:[c.expenses.byAgency.length," agences ont renseignÃ© leurs dÃ©penses"]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[m("div",{className:"p-4 rounded-xl border border-gray-200",children:[u("div",{className:"text-sm text-gray-500 mb-2",children:"Salaires"}),u("div",{className:"text-2xl font-bold text-gray-900",children:b(c.expenses.detail.salaries)}),u("div",{className:"text-sm text-gray-500",children:c.expenses.total?`${(c.expenses.detail.salaries/c.expenses.total*100).toFixed(1)}% des dÃ©penses`:"0%"})]}),m("div",{className:"p-4 rounded-xl border border-gray-200",children:[u("div",{className:"text-sm text-gray-500 mb-2",children:"OpÃ©rations"}),u("div",{className:"text-2xl font-bold text-gray-900",children:b(c.expenses.detail.operations)}),u("div",{className:"text-sm text-gray-500",children:c.expenses.total?`${(c.expenses.detail.operations/c.expenses.total*100).toFixed(1)}% des dÃ©penses`:"0%"})]}),m("div",{className:"p-4 rounded-xl border border-gray-200",children:[u("div",{className:"text-sm text-gray-500 mb-2",children:"Marketing"}),u("div",{className:"text-2xl font-bold text-gray-900",children:b(c.expenses.detail.marketing)}),u("div",{className:"text-sm text-gray-500",children:c.expenses.total?`${(c.expenses.detail.marketing/c.expenses.total*100).toFixed(1)}% des dÃ©penses`:"0%"})]}),m("div",{className:"p-4 rounded-xl border border-gray-200",children:[u("div",{className:"text-sm text-gray-500 mb-2",children:"Autres"}),u("div",{className:"text-2xl font-bold text-gray-900",children:b(c.expenses.detail.other)}),u("div",{className:"text-sm text-gray-500",children:c.expenses.total?`${(c.expenses.detail.other/c.expenses.total*100).toFixed(1)}% des dÃ©penses`:"0%"})]})]})]}),!I&&m("div",{className:"rounded-2xl border border-amber-300 bg-amber-50 p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[u(qt,{className:"h-6 w-6 text-amber-600"}),u("div",{className:"text-lg font-bold text-amber-800",children:"DonnÃ©es de dÃ©penses incomplÃ¨tes"})]}),m("div",{className:"text-amber-700",children:[u("p",{className:"mb-3",children:"Pour calculer les bÃ©nÃ©fices et marges rÃ©elles, les agences doivent renseigner leurs dÃ©penses individuelles."}),m("div",{className:"bg-white p-4 rounded-lg border border-amber-200",children:[u("h4",{className:"font-medium text-amber-800 mb-3",children:"ProcÃ©dure recommandÃ©e :"}),m("ol",{className:"space-y-2 text-sm",children:[m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-6 w-6 rounded-full bg-amber-100 text-amber-700 flex items-center justify-center flex-shrink-0",children:"1"}),u("span",{children:"Chaque agence saisit ses dÃ©penses mensuelles dans son espace administratif"})]}),m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-6 w-6 rounded-full bg-amber-100 text-amber-700 flex items-center justify-center flex-shrink-0",children:"2"}),u("span",{children:"Les dÃ©penses sont catÃ©gorisÃ©es (salaires, opÃ©rations, marketing, autres)"})]}),m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-6 w-6 rounded-full bg-amber-100 text-amber-700 flex items-center justify-center flex-shrink-0",children:"3"}),u("span",{children:"Le systÃ¨me consolide automatiquement les donnÃ©es au niveau compagnie"})]}),m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-6 w-6 rounded-full bg-amber-100 text-amber-700 flex items-center justify-center flex-shrink-0",children:"4"}),u("span",{children:"Les bÃ©nÃ©fices et marges sont calculÃ©s pour chaque agence et globalement"})]})]})]})]})]})]})},Pb=()=>{const{user:r,company:e}=Tt(),t=Nr(e)||{primary:"#2563eb",secondary:"#3b82f6"},[n,a]=N.useState("comptable"),[i,o]=N.useState("monthly"),[s,l]=N.useState({start:"",end:""}),[c,d]=N.useState(null),[f,h]=N.useState([]),[p,g]=N.useState(null),y=()=>{const T=new Date,U=new Date(T.getFullYear(),T.getMonth(),1),L=new Date(T.getFullYear(),T.getMonth()+1,0);return{start:U.toISOString().split("T")[0],end:L.toISOString().split("T")[0],label:U.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}},x=[{id:"financial-summary",title:"Rapport financier mensuel",description:"Chiffre d'affaires, dÃ©penses et bÃ©nÃ©fices consolidÃ©s pour la pÃ©riode",category:"comptable",frequency:["monthly","quarterly"],icon:u(wu,{className:"h-5 w-5"}),color:"blue"},{id:"revenue-report",title:"Rapport des recettes",description:"DÃ©tail des recettes par agence, par canal et par moyen de paiement",category:"comptable",frequency:["daily","weekly","monthly"],icon:u(_u,{className:"h-5 w-5"}),color:"emerald"},{id:"expense-report",title:"Rapport des dÃ©penses",description:"Analyse des dÃ©penses par agence et par catÃ©gorie (salaires, opÃ©rations, etc.)",category:"comptable",frequency:["monthly","quarterly"],icon:u(Au,{className:"h-5 w-5"}),color:"amber"},{id:"profit-margin",title:"Rapport bÃ©nÃ©fice & marge",description:"BÃ©nÃ©fice net et marges par agence, avec analyse des performances",category:"comptable",frequency:["monthly","quarterly"],icon:u(Cu,{className:"h-5 w-5"}),color:"purple"},{id:"cash-flow",title:"Rapport de trÃ©sorerie",description:"EntrÃ©es et sorties d'argent, analyse des flux de trÃ©sorerie",category:"comptable",frequency:["weekly","monthly"],icon:u(sr,{className:"h-5 w-5"}),color:"indigo"},{id:"agency-performance",title:"Performance des agences",description:"Classement et analyse des agences par CA et par indicateurs clÃ©s",category:"operationnel",frequency:["weekly","monthly"],icon:u(wr,{className:"h-5 w-5"}),color:"blue"},{id:"agency-activity",title:"ActivitÃ© par agence",description:"Volume de transactions, taux d'occupation, activitÃ© dÃ©taillÃ©e",category:"operationnel",frequency:["daily","weekly"],icon:u(Ui,{className:"h-5 w-5"}),color:"emerald"},{id:"online-reservations",title:"RÃ©servations en ligne",description:"Statistiques des rÃ©servations web, validation et conversion",category:"operationnel",frequency:["daily","weekly"],icon:u(Kn,{className:"h-5 w-5"}),color:"purple"},{id:"monthly-evolution",title:"Ã‰volution mensuelle",description:"Comparaison pÃ©riode Ã  pÃ©riode, tendances et projections",category:"analytique",frequency:["monthly","quarterly"],icon:u(Ua,{className:"h-5 w-5"}),color:"indigo"},{id:"payment-methods",title:"Analyse des moyens de paiement",description:"Ã‰volution des usages, rÃ©partition espÃ¨ces vs mobile money",category:"analytique",frequency:["monthly","quarterly"],icon:u(To,{className:"h-5 w-5"}),color:"amber"}],v=async T=>{if(r){d(T);try{let U="",L="monthly";if(i==="custom"&&s.start&&s.end){const Q=new Date(s.start),ae=new Date(s.end);U=`${Q.toLocaleDateString("fr-FR")} â†’ ${ae.toLocaleDateString("fr-FR")}`,L="custom"}else U=y().label,L=i;const B=x.find(Q=>Q.id===T);if(!B)return;await new Promise(Q=>setTimeout(Q,1500));const H={id:`${T}-${Date.now()}`,title:B.title,type:B.category,period:L,periodLabel:U,generatedAt:new Date,generatedBy:r.email||"Utilisateur",fileSize:`${Math.floor(Math.random()*5)+1}.${Math.floor(Math.random()*9)} MB`,status:"ready",downloadUrl:"#"};h(Q=>[H,...Q]),alert(`âœ… Rapport "${B.title}" gÃ©nÃ©rÃ© avec succÃ¨s pour ${U}`)}catch(U){console.error("Erreur gÃ©nÃ©ration rapport:",U),alert("âŒ Erreur lors de la gÃ©nÃ©ration du rapport")}finally{d(null)}}},b=T=>{console.log("TÃ©lÃ©chargement rapport:",T),alert(`ðŸ“¥ TÃ©lÃ©chargement du rapport "${T.title}" dÃ©marrÃ©`)},_=T=>{g(p===T.id?null:T.id)},w=x.filter(T=>T.category===n&&T.frequency.includes(i)),C=(()=>{var L;const T=f.length,U=f.reduce((B,H)=>{if(H.fileSize){const Q=parseFloat(H.fileSize);return B+(isNaN(Q)?0:Q)}return B},0);return{totalGenerated:T,totalSizeMB:U,lastGeneration:((L=f[0])==null?void 0:L.generatedAt)||null}})(),I=({category:T})=>{const U={comptable:{label:"Comptable",color:"bg-blue-100 text-blue-800 border-blue-300"},operationnel:{label:"OpÃ©rationnel",color:"bg-emerald-100 text-emerald-800 border-emerald-300"},analytique:{label:"Analytique",color:"bg-purple-100 text-purple-800 border-purple-300"}}[T];return u("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border ${U.color}`,children:U.label})},R=({period:T})=>m("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700 border border-gray-300",children:[u(br,{className:"h-3 w-3"}),{daily:"Quotidien",weekly:"Hebdomadaire",monthly:"Mensuel",quarterly:"Trimestriel",custom:"PersonnalisÃ©"}[T]]}),F=({status:T})=>{const U={generating:{label:"GÃ©nÃ©ration...",icon:u(Zt,{className:"h-3 w-3 animate-spin"}),color:"bg-amber-100 text-amber-800 border-amber-300"},ready:{label:"PrÃªt",icon:u(Bt,{className:"h-3 w-3"}),color:"bg-emerald-100 text-emerald-800 border-emerald-300"},failed:{label:"Ã‰chec",icon:u(vr,{className:"h-3 w-3"}),color:"bg-red-100 text-red-800 border-red-300"}}[T];return m("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium border ${U.color}`,children:[U.icon,U.label]})};return m("div",{className:"space-y-6 sm:space-y-8",children:[m("div",{className:"rounded-2xl border border-gray-200 shadow-sm p-6 bg-gradient-to-r from-white to-gray-50/50",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 flex items-center justify-center",children:u(ar,{className:"h-6 w-6 text-indigo-600"})}),m("div",{children:[u("div",{className:"text-xl font-bold text-gray-900",children:"Rapports comptables"}),u("div",{className:"text-sm text-gray-600",children:"GÃ©nÃ©ration de documents officiels pour la direction"})]})]}),u("div",{className:"flex items-center gap-3",children:m("button",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-gray-200 bg-white hover:bg-gray-50 text-sm font-medium",children:[u(Bn,{className:"h-4 w-4"}),"Voir historique"]})})]}),u("div",{className:"mt-4 p-4 rounded-lg bg-blue-50 border border-blue-200",children:m("div",{className:"flex items-start gap-3",children:[u(Ea,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),m("div",{children:[u("div",{className:"font-medium text-blue-800",children:"Documentation officielle"}),u("div",{className:"text-sm text-blue-700 mt-1",children:"Cette interface permet de gÃ©nÃ©rer des rapports comptables et financiers officiels destinÃ©s Ã  la direction, aux audits et aux partenaires. Tous les chiffres prÃ©sentÃ©s sont issus des donnÃ©es rÃ©elles de la compagnie."})]})]})})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-5",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:u(ji,{className:"h-5 w-5 text-gray-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Configuration du rapport"}),u("div",{className:"text-sm text-gray-600",children:"DÃ©finissez les paramÃ¨tres de gÃ©nÃ©ration"})]})]}),m("div",{className:"text-sm text-gray-600",children:[w.length," rapport",w.length>1?"s":""," disponible",w.length>1?"s":""]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m("div",{children:[u("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CatÃ©gorie de rapport"}),m("select",{value:n,onChange:T=>a(T.target.value),className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:t.primary},children:[u("option",{value:"comptable",children:"Rapports comptables"}),u("option",{value:"operationnel",children:"Rapports opÃ©rationnels"}),u("option",{value:"analytique",children:"Rapports analytiques"})]})]}),m("div",{children:[u("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PÃ©riode"}),m("select",{value:i,onChange:T=>o(T.target.value),className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:t.primary},children:[u("option",{value:"monthly",children:"Mensuel (mois en cours)"}),u("option",{value:"weekly",children:"Hebdomadaire"}),u("option",{value:"quarterly",children:"Trimestriel"}),u("option",{value:"custom",children:"PÃ©riode personnalisÃ©e"})]})]}),u("div",{className:"flex items-end",children:m("button",{className:"w-full inline-flex items-center justify-center px-4 py-2.5 rounded-xl text-white font-medium",style:{background:`linear-gradient(135deg, ${t.primary}, ${t.secondary})`},children:[u(ji,{className:"h-4 w-4 mr-2"}),"Appliquer la configuration"]})})]}),i==="custom"&&m("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 rounded-lg border border-blue-200 bg-blue-50",children:[m("div",{children:[u("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de dÃ©but"}),u("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:t.primary},value:s.start,onChange:T=>l(U=>({...U,start:T.target.value}))})]}),m("div",{children:[u("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),u("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:t.primary},value:s.end,onChange:T=>l(U=>({...U,end:T.target.value}))})]})]}),m("div",{className:"mt-4 flex items-center justify-between p-3 rounded-lg bg-gray-50 border border-gray-200",children:[m("div",{className:"text-sm text-gray-700",children:[u("span",{className:"font-medium",children:"PÃ©riode par dÃ©faut : "}),i==="custom"&&s.start&&s.end?`${new Date(s.start).toLocaleDateString("fr-FR")} â†’ ${new Date(s.end).toLocaleDateString("fr-FR")}`:y().label]}),m("div",{className:"text-sm text-gray-600",children:[i==="monthly"&&"Mois en cours automatiquement sÃ©lectionnÃ©",i==="weekly"&&"7 derniers jours",i==="quarterly"&&"Trimestre en cours",i==="custom"&&"PÃ©riode personnalisÃ©e"]})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Historique des gÃ©nÃ©rations"}),u("div",{className:"text-sm text-gray-600",children:"DonnÃ©es rÃ©elles depuis la crÃ©ation"})]}),f.length===0?m("div",{className:"text-center py-8",children:[u(ar,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),u("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun rapport gÃ©nÃ©rÃ©"}),u("div",{className:"text-gray-600",children:"GÃ©nÃ©rez votre premier rapport pour voir apparaÃ®tre les statistiques ici"})]}):m("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[m("div",{className:"p-4 rounded-xl border border-gray-200",children:[m("div",{className:"flex items-center justify-between mb-4",children:[u("div",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Rapports gÃ©nÃ©rÃ©s"}),u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center",children:u(ar,{className:"h-5 w-5 text-blue-600"})})]}),u("div",{className:"text-3xl font-bold text-gray-900",children:C.totalGenerated}),u("div",{className:"text-sm text-gray-500 mt-2",children:"Depuis le dÃ©but"})]}),m("div",{className:"p-4 rounded-xl border border-gray-200",children:[m("div",{className:"flex items-center justify-between mb-4",children:[u("div",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Volume total"}),u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-emerald-50 to-green-50 flex items-center justify-center",children:u(Ui,{className:"h-5 w-5 text-emerald-600"})})]}),m("div",{className:"text-3xl font-bold text-gray-900",children:[C.totalSizeMB.toFixed(1)," MB"]}),u("div",{className:"text-sm text-gray-500 mt-2",children:"Stockage rÃ©el utilisÃ©"})]}),m("div",{className:"p-4 rounded-xl border border-gray-200",children:[m("div",{className:"flex items-center justify-between mb-4",children:[u("div",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"DerniÃ¨re gÃ©nÃ©ration"}),u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 flex items-center justify-center",children:u(Yn,{className:"h-5 w-5 text-amber-600"})})]}),u("div",{className:"text-xl font-bold text-gray-900",children:C.lastGeneration?C.lastGeneration.toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}):"Jamais"}),u("div",{className:"text-sm text-gray-500 mt-2",children:"Date rÃ©elle"})]})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[m("div",{className:"text-lg font-bold text-gray-900",children:[n==="comptable"&&"Rapports comptables disponibles",n==="operationnel"&&"Rapports opÃ©rationnels disponibles",n==="analytique"&&"Rapports analytiques disponibles"]}),m("div",{className:"text-sm text-gray-600",children:[w.length," rapport",w.length>1?"s":""]})]}),w.length===0?m("div",{className:"text-center py-12",children:[u(qt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),u("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun rapport disponible"}),m("div",{className:"text-gray-600",children:['Aucun rapport de type "',n,`" n'est disponible pour la pÃ©riode "`,i,`". Changez de catÃ©gorie ou de pÃ©riode pour voir d'autres rapports.`]})]}):u("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(T=>{const U=c===T.id;return m("div",{className:"border border-gray-200 rounded-xl p-5 hover:shadow-lg transition-shadow",children:[m("div",{className:"flex items-start justify-between mb-4",children:[u("div",{className:`h-12 w-12 rounded-xl flex items-center justify-center ${T.color==="blue"?"bg-blue-50":T.color==="emerald"?"bg-emerald-50":T.color==="amber"?"bg-amber-50":T.color==="purple"?"bg-purple-50":"bg-indigo-50"}`,children:u("span",{className:T.color==="blue"?"text-blue-600":T.color==="emerald"?"text-emerald-600":T.color==="amber"?"text-amber-600":T.color==="purple"?"text-purple-600":"text-indigo-600",children:T.icon})}),u(I,{category:T.category})]}),u("h3",{className:"font-bold text-gray-900 mb-2",children:T.title}),u("p",{className:"text-sm text-gray-600 mb-4",children:T.description}),u("div",{className:"space-y-2 mb-4",children:m("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[u(br,{className:"h-3 w-3"}),m("span",{children:["Disponible en : ",T.frequency.map(L=>L==="daily"?"Quotidien":L==="weekly"?"Hebdomadaire":L==="monthly"?"Mensuel":"Trimestriel").join(", ")]})]})}),u("div",{className:"flex gap-2",children:u("button",{onClick:()=>v(T.id),disabled:U,className:"flex-1 inline-flex items-center justify-center px-3 py-2 rounded-lg text-white text-sm font-medium disabled:opacity-50",style:{background:`linear-gradient(135deg, ${t.primary}, ${t.secondary})`},children:U?m(bt,{children:[u(Zt,{className:"h-4 w-4 mr-2 animate-spin"}),"GÃ©nÃ©ration..."]}):m(bt,{children:[u(So,{className:"h-4 w-4 mr-2"}),"GÃ©nÃ©rer"]})})})]},T.id)})})]}),f.length>0&&m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center justify-between mb-5",children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Rapports gÃ©nÃ©rÃ©s rÃ©cemment"}),m("div",{className:"text-sm text-gray-600",children:[f.length," rapport",f.length>1?"s":""]})]}),u("div",{className:"space-y-3",children:f.slice(0,5).map(T=>m("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[u("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100/50 border-b",children:m("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${T.type==="comptable"?"bg-blue-50":T.type==="operationnel"?"bg-emerald-50":"bg-purple-50"}`,children:u(ar,{className:T.type==="comptable"?"h-5 w-5 text-blue-600":T.type==="operationnel"?"h-5 w-5 text-emerald-600":"h-5 w-5 text-purple-600"})}),m("div",{children:[u("div",{className:"font-medium text-gray-900",children:T.title}),u("div",{className:"text-sm text-gray-500",children:T.periodLabel})]})]}),m("div",{className:"flex items-center gap-3",children:[u(F,{status:T.status}),u(R,{period:T.period}),u("button",{onClick:()=>_(T),className:"p-1 hover:bg-gray-100 rounded",children:p===T.id?u(Bi,{className:"h-4 w-4 text-gray-500"}):u(Vi,{className:"h-4 w-4 text-gray-500"})})]})]})}),p===T.id&&u("div",{className:"p-4 border-t",children:m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m("div",{children:[u("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"Informations du rapport"}),m("div",{className:"space-y-2",children:[m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"text-gray-600",children:"GÃ©nÃ©rÃ© le :"}),u("span",{className:"font-medium text-gray-900",children:T.generatedAt.toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"text-gray-600",children:"Par :"}),u("span",{className:"font-medium text-gray-900",children:T.generatedBy})]}),m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"text-gray-600",children:"PÃ©riode :"}),u("span",{className:"font-medium text-gray-900",children:T.periodLabel})]}),T.fileSize&&m("div",{className:"flex justify-between text-sm",children:[u("span",{className:"text-gray-600",children:"Taille :"}),u("span",{className:"font-medium text-gray-900",children:T.fileSize})]})]})]}),m("div",{children:[u("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"Actions"}),m("div",{className:"flex gap-2",children:[m("button",{onClick:()=>b(T),className:"flex-1 inline-flex items-center justify-center px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 text-sm font-medium",children:[u(Io,{className:"h-4 w-4 mr-2"}),"TÃ©lÃ©charger"]}),m("button",{onClick:()=>v(T.id.split("-")[0]),className:"flex-1 inline-flex items-center justify-center px-3 py-2 rounded-lg text-white text-sm font-medium",style:{background:`linear-gradient(135deg, ${t.primary}, ${t.secondary})`},children:[u(Zt,{className:"h-4 w-4 mr-2"}),"RegÃ©nÃ©rer"]})]})]})]})})]},T.id))}),f.length>5&&u("div",{className:"mt-4 text-center",children:m("button",{className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Voir tous les rapports gÃ©nÃ©rÃ©s (",f.length,")"]})})]}),m("div",{className:"rounded-2xl border border-blue-300 bg-blue-50 p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[u(Ea,{className:"h-6 w-6 text-blue-600"}),u("div",{className:"text-lg font-bold text-blue-800",children:"Ã€ propos des rapports gÃ©nÃ©rÃ©s"})]}),m("div",{className:"text-blue-700",children:[u("p",{className:"mb-3",children:"Les rapports gÃ©nÃ©rÃ©s sont des documents officiels contenant des donnÃ©es financiÃ¨res rÃ©elles. Ils sont destinÃ©s Ã  :"}),m("ul",{className:"space-y-2 mb-4",children:[m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-5 w-5 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center flex-shrink-0 mt-0.5",children:"âœ“"}),u("span",{children:"La direction gÃ©nÃ©rale pour le pilotage stratÃ©gique"})]}),m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-5 w-5 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center flex-shrink-0 mt-0.5",children:"âœ“"}),u("span",{children:"Les audits internes et externes"})]}),m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-5 w-5 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center flex-shrink-0 mt-0.5",children:"âœ“"}),u("span",{children:"Les partenaires financiers et institutionnels"})]}),m("li",{className:"flex items-start gap-2",children:[u("div",{className:"h-5 w-5 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center flex-shrink-0 mt-0.5",children:"âœ“"}),u("span",{children:"Les autoritÃ©s de rÃ©gulation (le cas Ã©chÃ©ant)"})]})]}),m("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[u("div",{className:"text-sm font-medium text-blue-800 mb-2",children:"ProcÃ©dure de gÃ©nÃ©ration"}),m("div",{className:"text-sm text-blue-700 space-y-1",children:[u("p",{children:"1. SÃ©lectionnez la catÃ©gorie et la pÃ©riode du rapport"}),u("p",{children:'2. Cliquez sur "GÃ©nÃ©rer" pour crÃ©er le document'}),u("p",{children:"3. TÃ©lÃ©chargez le rapport au format PDF"}),u("p",{children:"4. Le rapport est automatiquement archivÃ© dans l'historique"})]})]})]})]})]})},Mb=()=>{const{company:r}=Tt(),e=Nr(r)||{primary:"#2563eb",secondary:"#3b82f6"},[t,n]=N.useState({emailNotifications:!0,pushNotifications:!0,lowBalanceAlert:!0,alertThreshold:5e5,autoValidation:!1,validationDelay:2,minAmountForValidation:1e4,twoFactorAuth:!1,sessionTimeout:30,ipRestriction:!1,defaultCurrency:"FCFA",dateFormat:"DD/MM/YYYY",showAmountsInThousands:!0,autoReportGeneration:!0,reportFrequency:"weekly",reportEmail:"",keepReportsFor:12}),[a,i]=N.useState(!1),[o,s]=N.useState("idle"),l=()=>{i(!0),setTimeout(()=>{i(!1),s("success"),setTimeout(()=>s("idle"),3e3)},1e3)},c=p=>{typeof t[p]=="boolean"&&n(g=>({...g,[p]:!g[p]}))},d=(p,g)=>{n(y=>({...y,[p]:g}))},f=({label:p,description:g,checked:y,onChange:x,icon:v})=>m("div",{className:"flex items-start justify-between p-4 border border-gray-200 rounded-xl hover:bg-gray-50/50",children:[m("div",{className:"flex items-start gap-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:v}),m("div",{children:[u("div",{className:"font-medium text-gray-900",children:p}),u("div",{className:"text-sm text-gray-600 mt-1",children:g})]})]}),u("button",{onClick:x,className:`relative inline-flex h-6 w-11 items-center rounded-full ${y?"bg-blue-600":"bg-gray-300"}`,children:u("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${y?"translate-x-6":"translate-x-1"}`})})]}),h=({label:p,description:g,value:y,onChange:x,type:v="text",options:b,icon:_})=>m("div",{className:"p-4 border border-gray-200 rounded-xl",children:[m("div",{className:"flex items-start gap-3 mb-3",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:_}),m("div",{className:"flex-1",children:[u("div",{className:"font-medium text-gray-900",children:p}),u("div",{className:"text-sm text-gray-600 mt-1",children:g})]})]}),v==="select"&&b?u("select",{value:y,onChange:w=>x(w.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:e.primary},children:b.map(w=>u("option",{value:w.value,children:w.label},w.value))}):u("input",{type:v,value:y,onChange:w=>x(v==="number"?Number(w.target.value):w.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 bg-white focus:outline-none focus:ring-2 focus:border-transparent",style:{outlineColor:e.primary}})]});return m("div",{className:"space-y-6 sm:space-y-8",children:[m("div",{className:"rounded-2xl border border-gray-200 shadow-sm p-6 bg-gradient-to-r from-white to-gray-50/50",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[m("div",{className:"flex items-center gap-3",children:[u("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-slate-50 to-gray-50 flex items-center justify-center",children:u(bu,{className:"h-6 w-6 text-gray-600"})}),m("div",{children:[u("div",{className:"text-xl font-bold text-gray-900",children:"ParamÃ¨tres comptables"}),u("div",{className:"text-sm text-gray-600",children:"Configuration de l'espace chef comptable"})]})]}),m("button",{onClick:l,disabled:a,className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl text-white font-medium shadow-md disabled:opacity-50",style:{background:`linear-gradient(135deg, ${e.primary}, ${e.secondary})`},children:[a?u(Zt,{className:"h-4 w-4 animate-spin"}):o==="success"?u(Bt,{className:"h-4 w-4"}):u(xu,{className:"h-4 w-4"}),a?"Enregistrement...":o==="success"?"EnregistrÃ© !":"Enregistrer"]})]}),o==="success"&&u("div",{className:"mt-4 p-3 rounded-lg bg-emerald-50 border border-emerald-200",children:u("div",{className:"text-emerald-700 text-sm",children:"Les paramÃ¨tres ont Ã©tÃ© enregistrÃ©s avec succÃ¨s."})})]}),m("div",{className:"space-y-6",children:[m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-5",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center",children:u(ti,{className:"h-5 w-5 text-blue-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Alertes et notifications"}),u("div",{className:"text-sm text-gray-600",children:"Configurez les notifications systÃ¨me"})]})]}),m("div",{className:"space-y-3",children:[u(f,{label:"Notifications par email",description:"Recevoir les alertes importantes par email",checked:t.emailNotifications,onChange:()=>c("emailNotifications"),icon:u(ti,{className:"h-5 w-5"})}),u(f,{label:"Notifications push",description:"Alerte en temps rÃ©el dans le navigateur",checked:t.pushNotifications,onChange:()=>c("pushNotifications"),icon:u(qt,{className:"h-5 w-5"})}),u(f,{label:"Alerte solde bas",description:"Recevoir une alerte quand le solde d'une caisse est bas",checked:t.lowBalanceAlert,onChange:()=>c("lowBalanceAlert"),icon:u(sr,{className:"h-5 w-5"})}),u(h,{label:"Seuil d'alerte solde bas",description:"Montant minimum dÃ©clenchant une alerte (FCFA)",value:t.alertThreshold,onChange:p=>d("alertThreshold",p),type:"number",icon:u(qt,{className:"h-5 w-5"})})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-5",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-emerald-50 to-green-50 flex items-center justify-center",children:u(Bt,{className:"h-5 w-5 text-emerald-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Validation automatique"}),u("div",{className:"text-sm text-gray-600",children:"ParamÃ¨tres de validation des rÃ©servations"})]})]}),m("div",{className:"space-y-3",children:[u(f,{label:"Validation automatique",description:"Valider automatiquement les rÃ©servations avec preuve",checked:t.autoValidation,onChange:()=>c("autoValidation"),icon:u(Zt,{className:"h-5 w-5"})}),u(h,{label:"DÃ©lai de validation",description:"Heures avant validation automatique",value:t.validationDelay,onChange:p=>d("validationDelay",p),type:"number",icon:u(Bn,{className:"h-5 w-5"})}),u(h,{label:"Montant minimum",description:"Montant minimum pour validation auto (FCFA)",value:t.minAmountForValidation,onChange:p=>d("minAmountForValidation",p),type:"number",icon:u(sr,{className:"h-5 w-5"})})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-5",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 flex items-center justify-center",children:u(ga,{className:"h-5 w-5 text-amber-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"SÃ©curitÃ©"}),u("div",{className:"text-sm text-gray-600",children:"ParamÃ¨tres de sÃ©curitÃ© de l'espace"})]})]}),m("div",{className:"space-y-3",children:[u(f,{label:"Authentification Ã  deux facteurs",description:"Exiger une validation supplÃ©mentaire pour la connexion",checked:t.twoFactorAuth,onChange:()=>c("twoFactorAuth"),icon:u(ga,{className:"h-5 w-5"})}),u(h,{label:"DÃ©lai de session",description:"Minutes avant dÃ©connexion automatique",value:t.sessionTimeout,onChange:p=>d("sessionTimeout",p),type:"number",icon:u(gh,{className:"h-5 w-5"})}),u(f,{label:"Restriction d'adresse IP",description:"Limiter l'accÃ¨s Ã  certaines adresses IP",checked:t.ipRestriction,onChange:()=>c("ipRestriction"),icon:u(qt,{className:"h-5 w-5"})})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-5",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-purple-50 to-pink-50 flex items-center justify-center",children:u(Bn,{className:"h-5 w-5 text-purple-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Affichage"}),u("div",{className:"text-sm text-gray-600",children:"PrÃ©fÃ©rences d'affichage des donnÃ©es"})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u(h,{label:"Devise par dÃ©faut",description:"Devise d'affichage des montants",value:t.defaultCurrency,onChange:p=>d("defaultCurrency",p),type:"select",options:[{value:"FCFA",label:"FCFA (Franc CFA)"},{value:"EUR",label:"EUR (Euro)"},{value:"USD",label:"USD (Dollar)"}],icon:u(sr,{className:"h-5 w-5"})}),u(h,{label:"Format de date",description:"Format d'affichage des dates",value:t.dateFormat,onChange:p=>d("dateFormat",p),type:"select",options:[{value:"DD/MM/YYYY",label:"JJ/MM/AAAA (franÃ§ais)"},{value:"MM/DD/YYYY",label:"MM/JJ/AAAA (amÃ©ricain)"},{value:"YYYY-MM-DD",label:"AAAA-MM-JJ (international)"}],icon:u(br,{className:"h-5 w-5"})}),u("div",{className:"md:col-span-2",children:u(f,{label:"Montants en milliers",description:"Afficher les montants en milliers (ex: 15K au lieu de 15000)",checked:t.showAmountsInThousands,onChange:()=>c("showAmountsInThousands"),icon:u(ar,{className:"h-5 w-5"})})})]})]}),m("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[m("div",{className:"flex items-center gap-3 mb-5",children:[u("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-indigo-50 to-blue-50 flex items-center justify-center",children:u(ar,{className:"h-5 w-5 text-indigo-600"})}),m("div",{children:[u("div",{className:"text-lg font-bold text-gray-900",children:"Rapports"}),u("div",{className:"text-sm text-gray-600",children:"Configuration des rapports automatiques"})]})]}),m("div",{className:"space-y-3",children:[u(f,{label:"GÃ©nÃ©ration automatique",description:"GÃ©nÃ©rer automatiquement les rapports pÃ©riodiques",checked:t.autoReportGeneration,onChange:()=>c("autoReportGeneration"),icon:u(Zt,{className:"h-5 w-5"})}),u(h,{label:"FrÃ©quence des rapports",description:"FrÃ©quence de gÃ©nÃ©ration des rapports",value:t.reportFrequency,onChange:p=>d("reportFrequency",p),type:"select",options:[{value:"daily",label:"Quotidien"},{value:"weekly",label:"Hebdomadaire"},{value:"monthly",label:"Mensuel"},{value:"quarterly",label:"Trimestriel"}],icon:u(br,{className:"h-5 w-5"})}),u(h,{label:"Email des rapports",description:"Adresse email pour recevoir les rapports",value:t.reportEmail,onChange:p=>d("reportEmail",p),type:"text",icon:u(ti,{className:"h-5 w-5"})}),u(h,{label:"Conservation des rapports",description:"Nombre de mois de conservation",value:t.keepReportsFor,onChange:p=>d("keepReportsFor",p),type:"number",icon:u(ga,{className:"h-5 w-5"})})]})]})]})]})},Lb=N.lazy(()=>ne(()=>import("./js/HomePage-ChSM26Rq.js"),__vite__mapDeps([13,1,2,3,14,4]))),kb=N.lazy(()=>ne(()=>import("./js/PlatformSearchResultsPage-DOXhP8UQ.js"),__vite__mapDeps([15,1,2,3,4]))),Fb=N.lazy(()=>ne(()=>import("./js/LoginPage-BULUW3g0.js"),__vite__mapDeps([16,1,2,3,4]))),Bb=N.lazy(()=>ne(()=>import("./js/Register-SFQspjtj.js"),__vite__mapDeps([17,1,2,3,4]))),Vb=N.lazy(()=>ne(()=>import("./js/ListeVillesPage-XsMnynGf.js"),__vite__mapDeps([18,1,2,3,4]))),jb=N.lazy(()=>ne(()=>import("./js/AcceptInvitationPage-DX5eDzJA.js"),__vite__mapDeps([19,1,2,3,4]))),Ub=N.lazy(()=>ne(()=>import("./js/AgenceRapportsPage-db5tPp4h.js"),__vite__mapDeps([20,1,2,3,4]))),$b=N.lazy(()=>ne(()=>import("./js/ReservationClientPage-CDDS50Wv.js"),__vite__mapDeps([6,1,2,3,4]))),jc=N.lazy(()=>ne(()=>import("./js/ClientMesReservationsPage-B31-67bu.js"),__vite__mapDeps([7,1,2,3,4]))),Hb=N.lazy(()=>ne(()=>import("./js/AdminSidebarLayout-ngbwCGqS.js"),__vite__mapDeps([21,1,2,3,4]))),Uc=N.lazy(()=>ne(()=>import("./js/AdminDashboard-_zra0wsw.js"),__vite__mapDeps([22,1,2,3,23,14,4,24]))),Gb=N.lazy(()=>ne(()=>import("./js/AdminCompagniesPage-BsEWH0GD.js"),__vite__mapDeps([25,1,2,3,4]))),zb=N.lazy(()=>ne(()=>import("./js/AdminModifierCompagniePage-BWEgmuD9.js"),__vite__mapDeps([26,1,2,3,4]))),Wb=N.lazy(()=>ne(()=>import("./js/AdminStatistiquesPage-BYpBHaKl.js"),__vite__mapDeps([27,1,2,3,23,14,4,28,24,29]))),Xb=N.lazy(()=>ne(()=>import("./js/AdminReservationsPage-Co6W20DI.js"),__vite__mapDeps([30,1,2,3,4]))),qb=N.lazy(()=>ne(()=>import("./js/AdminFinancesPage-Dm0QK_DT.js"),__vite__mapDeps([31,1,2,3,23,14,4,29,24]))),Yb=N.lazy(()=>ne(()=>import("./js/AdminCompagnieAjouterPage-BWXQ0Nwj.js"),__vite__mapDeps([32,1,2,3,4]))),Kb=N.lazy(()=>ne(()=>import("./js/CompagnieLayout-DXfLNPec.js"),__vite__mapDeps([33,1,2,3,4]))),Zb=N.lazy(()=>ne(()=>import("./js/CompagnieDashboard-B0hdwixK.js"),__vite__mapDeps([34,1,2,3,35,14,23,4,24,28]))),Qb=N.lazy(()=>ne(()=>import("./js/CompagnieAgencesPage-DGoGrbpK.js"),__vite__mapDeps([36,1,2,3,4,37]))),Jb=N.lazy(()=>ne(()=>import("./js/CompagnieParametresTabsPage-CPs-fzqK.js"),__vite__mapDeps([38,1,2,3,39,4]))),ew=N.lazy(()=>ne(()=>import("./js/CompagnieReservationsPage-C4AcuRoA.js"),__vite__mapDeps([40,1,2,3,4]))),tw=N.lazy(()=>ne(()=>import("./js/CompagnieComptabilitePage-DUL0NSQm.js"),__vite__mapDeps([41,1,2,3,4]))),rw=N.lazy(()=>ne(()=>import("./js/BibliothequeImagesPage-BfISW9RA.js"),__vite__mapDeps([42,1,2,3,43,4]))),nw=N.lazy(()=>ne(()=>import("./js/CompanyPaymentSettingsPage-RclLeTod.js"),__vite__mapDeps([44,1,2,3,4]))),aw=N.lazy(()=>ne(()=>import("./js/AvisModerationPage-b3kYbhCe.js"),__vite__mapDeps([45,1,2,3,4]))),iw=N.lazy(()=>ne(()=>import("./js/ParametresPlan-DlxOOg5H.js"),__vite__mapDeps([39,1,2,3,4]))),ow=N.lazy(()=>ne(()=>import("./js/DashboardAgencePage-Bw0lN4bd.js"),__vite__mapDeps([46,1,2,3,35,14,23,4,29,47]))),sw=N.lazy(()=>ne(()=>import("./js/AgenceReservationsPage-wq6YFicu.js"),__vite__mapDeps([48,1,2,3,4]))),lw=N.lazy(()=>ne(()=>import("./js/AgenceGuichetPage-CtUlARcZ.js"),__vite__mapDeps([49,1,2,3,50,51,9,10,11,4]))),cw=N.lazy(()=>ne(()=>import("./js/AgenceTrajetsPage-D9BGFoFx.js"),__vite__mapDeps([52,1,2,3,10,53,4]))),uw=N.lazy(()=>ne(()=>import("./js/AgenceFinancesPage-DBY5gsHE.js"),__vite__mapDeps([54,1,2,3,4]))),dw=N.lazy(()=>ne(()=>import("./js/AgenceRecettesPage-CWlQUQSB.js"),__vite__mapDeps([55,1,2,3,10,53,56,47,23,14,4,29,28,24]))),fw=N.lazy(()=>ne(()=>import("./js/AgencePersonnelPage-DtlYGnxe.js"),__vite__mapDeps([57,1,2,3,4]))),hw=N.lazy(()=>ne(()=>import("./js/ReceiptGuichetPage-kh8Nzdc1.js"),__vite__mapDeps([58,1,2,3,9,10,11,51,4]))),pw=N.lazy(()=>ne(()=>import("./js/MediaPage-COM6jxxx.js"),__vite__mapDeps([59,1,2,3,43,4]))),mw=N.lazy(()=>ne(()=>import("./js/AgenceShiftHistoryPage-D2Bt_ZVo.js"),__vite__mapDeps([60,1,2,3,4]))),gw=N.lazy(()=>ne(()=>import("./js/AgenceComptabilitePage-DmgZmDxD.js"),__vite__mapDeps([61,1,2,3,4]))),vw=N.lazy(()=>ne(()=>import("./js/AgenceShiftPage-ot3lc7um.js"),__vite__mapDeps([62,1,2,3,50,4]))),yw=N.lazy(()=>ne(()=>import("./js/AffectationVehiculePage-AZS3L9VD.js"),__vite__mapDeps([63,1,2,3,4]))),xw=N.lazy(()=>ne(()=>import("./js/AgenceShellPage-y2qft3hY.js"),__vite__mapDeps([64,1,2,3,4]))),qr={compagnieLayout:["admin_compagnie"],agenceShell:["chefAgence","superviseur","agentCourrier","admin_compagnie"],guichet:["guichetier","chefAgence","admin_compagnie"],comptabilite:["agency_accountant","admin_compagnie"],adminLayout:["admin_platforme"],chefComptableCompagnie:["company_accountant","financial_director","admin_platforme"]},Mf=r=>Array.isArray(r)?r:[r].filter(Boolean),Hr=(r,e)=>Mf(r).some(t=>e.includes(String(t))),bw=r=>{const e=Mf(r).map(String);return Hr(e,["company_accountant","financial_director"])?"/chef-comptable":Hr(e,qr.comptabilite)?"/agence/comptabilite":Hr(e,qr.guichet)?"/agence/guichet":Hr(e,qr.agenceShell)?"/agence/dashboard":Hr(e,qr.compagnieLayout)?"/compagnie/dashboard":Hr(e,qr.adminLayout)?"/admin/dashboard":"/login"};function $c(){const{user:r}=Tt();return r?u(ir,{to:bw(r.role),replace:!0}):u(ir,{to:"/login",replace:!0})}function ww(){const{slug:r,id:e}=_r();return u(ir,{to:`/${r||""}/reservation/${e||""}`,replace:!0})}function Aw(){const{companyId:r}=_r();return u(ir,{to:`/compagnie/${r}/dashboard`,replace:!0})}const Cw=()=>{const{user:r,loading:e,company:t}=Tt();return m("div",{className:"min-h-screen p-6 bg-gray-50",children:[u("h1",{className:"text-2xl font-bold mb-6 text-gray-800",children:"ðŸ” Debug Auth - Diagnostics"}),m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m("div",{className:"bg-white p-6 rounded-lg shadow-md border",children:[u("h2",{className:"text-lg font-semibold mb-4 text-blue-700",children:"ðŸ‘¤ Informations Utilisateur"}),m("div",{className:"space-y-3",children:[m("div",{children:[u("strong",{className:"text-gray-700",children:"Ã‰tat du chargement:"}),u("span",{className:`ml-2 px-2 py-1 rounded text-sm ${e?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:e?"En cours...":"TerminÃ©"})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"Utilisateur connectÃ©:"}),u("span",{className:`ml-2 px-2 py-1 rounded text-sm ${r?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r?"Oui":"Non"})]}),r&&m(bt,{children:[m("div",{children:[u("strong",{className:"text-gray-700",children:"Email:"}),u("span",{className:"ml-2 text-gray-900",children:r.email})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"Nom:"}),u("span",{className:"ml-2 text-gray-900",children:r.nom||"Non dÃ©fini"})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"RÃ´le (brut):"}),u("code",{className:"ml-2 px-2 py-1 bg-gray-100 rounded text-sm font-mono",children:r.role||"Non dÃ©fini"})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"ID Compagnie:"}),u("code",{className:"ml-2 px-2 py-1 bg-gray-100 rounded text-sm font-mono",children:r.companyId||"Non dÃ©fini"})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"ID Agence:"}),u("code",{className:"ml-2 px-2 py-1 bg-gray-100 rounded text-sm font-mono",children:r.agencyId||"Non dÃ©fini"})]})]})]})]}),m("div",{className:"bg-white p-6 rounded-lg shadow-md border",children:[u("h2",{className:"text-lg font-semibold mb-4 text-green-700",children:"ðŸ¢ Informations Compagnie"}),u("div",{className:"space-y-3",children:t?m(bt,{children:[m("div",{children:[u("strong",{className:"text-gray-700",children:"Nom Compagnie:"}),u("span",{className:"ml-2 text-gray-900",children:t.nom||"Non dÃ©fini"})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"ID:"}),u("code",{className:"ml-2 px-2 py-1 bg-gray-100 rounded text-sm font-mono",children:t.id})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"Slug:"}),u("code",{className:"ml-2 px-2 py-1 bg-gray-100 rounded text-sm font-mono",children:t.slug||"Non dÃ©fini"})]}),m("div",{children:[u("strong",{className:"text-gray-700",children:"Plan:"}),u("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded text-sm",children:t.plan||"Non dÃ©fini"})]})]}):u("div",{className:"text-gray-500 italic",children:r!=null&&r.companyId?"Chargement de la compagnie...":"Aucune compagnie associÃ©e"})})]}),m("div",{className:"lg:col-span-2 bg-white p-6 rounded-lg shadow-md border",children:[u("h2",{className:"text-lg font-semibold mb-4 text-red-700",children:"ðŸ§ª Tests de Navigation"}),m("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[m("a",{href:"/chef-comptable",className:"block p-4 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition text-center",children:[u("div",{className:"font-medium text-blue-800",children:"/chef-comptable"}),u("div",{className:"text-sm text-blue-600 mt-1",children:"Espace Chef Comptable Compagnie"}),u("div",{className:"text-xs text-blue-500 mt-2",children:"RÃ´les: company_accountant, financial_director"})]}),m("a",{href:"/agence/comptabilite",className:"block p-4 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition text-center",children:[u("div",{className:"font-medium text-green-800",children:"/agence/comptabilite"}),u("div",{className:"text-sm text-green-600 mt-1",children:"Espace Comptable Agence"}),u("div",{className:"text-xs text-green-500 mt-2",children:"RÃ´le: agency_accountant"})]}),m("a",{href:"/compagnie/dashboard",className:"block p-4 bg-purple-50 border border-purple-200 rounded-lg hover:bg-purple-100 transition text-center",children:[u("div",{className:"font-medium text-purple-800",children:"/compagnie/dashboard"}),u("div",{className:"text-sm text-purple-600 mt-1",children:"Espace CEO Compagnie"}),u("div",{className:"text-xs text-purple-500 mt-2",children:"RÃ´le: admin_compagnie"})]}),m("a",{href:"/admin/dashboard",className:"block p-4 bg-orange-50 border border-orange-200 rounded-lg hover:bg-orange-100 transition text-center",children:[u("div",{className:"font-medium text-orange-800",children:"/admin/dashboard"}),u("div",{className:"text-sm text-orange-600 mt-1",children:"Espace Admin Plateforme"}),u("div",{className:"text-xs text-orange-500 mt-2",children:"RÃ´le: admin_platforme"})]})]})]}),m("div",{className:"lg:col-span-2 bg-white p-6 rounded-lg shadow-md border",children:[u("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"ðŸ“Š DonnÃ©es Brutes (JSON)"}),m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[m("div",{children:[u("h3",{className:"font-medium mb-2 text-gray-600",children:"Utilisateur:"}),u("pre",{className:"bg-gray-100 p-3 rounded text-xs overflow-auto max-h-60",children:JSON.stringify(r,null,2)||"Aucun utilisateur"})]}),m("div",{children:[u("h3",{className:"font-medium mb-2 text-gray-600",children:"Compagnie:"}),u("pre",{className:"bg-gray-100 p-3 rounded text-xs overflow-auto max-h-60",children:JSON.stringify(t,null,2)||"Aucune compagnie"})]})]})]})]}),m("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[u("h3",{className:"font-semibold text-yellow-800 mb-2",children:"ðŸ“ Instructions de dÃ©bogage:"}),m("ul",{className:"list-disc pl-5 text-yellow-700 space-y-1",children:[u("li",{children:"Ouvrez la console du navigateur (F12) pour voir les logs dÃ©taillÃ©s"}),u("li",{children:"VÃ©rifiez que le rÃ´le de l'utilisateur dans Firestore correspond Ã  ceux autorisÃ©s"}),u("li",{children:"Testez les diffÃ©rents liens de navigation pour voir oÃ¹ vous Ãªtes redirigÃ©"}),u("li",{children:"Si bloquÃ©, vÃ©rifiez les logs de PrivateRoute dans la console"})]})]})]})},_w=()=>{const{loading:r}=Tt(),{pathname:e}=Ur(),t=e==="/";return r&&!t?u(Vn,{fullScreen:!0}):u(N.Suspense,{fallback:t?null:u(Vn,{fullScreen:!0}),children:m(vh,{children:[u(G,{path:"/debug-auth",element:u(Cw,{})}),u(G,{path:"/",element:u(_0,{logo:"/images/teliya-logo.jpg",sizePx:190,ringWidthPx:2,ringOpacity:.45,spinnerSpeedMs:800,minMs:1200,maxMs:3600,extraHoldMs:900,preload:["/images/hero-fallback.jpg","/images/partners/mali-trans.png","/images/partners/diarra-trans.png"],children:u(Lb,{})})}),u(G,{path:"/login",element:u(Fb,{})}),u(G,{path:"/register",element:u(Bb,{})}),u(G,{path:"/resultats",element:u(kb,{})}),u(G,{path:"/villes",element:u(Vb,{})}),u(G,{path:"/finishSignIn",element:u(bb,{})}),u(G,{path:"/:slug/mentions-legales",element:u(Du,{})}),u(G,{path:"/:slug/confidentialite",element:u(Pu,{})}),u(G,{path:"/:slug/conditions",element:u(R0,{})}),u(G,{path:"/:slug/cookies",element:u(O0,{})}),u(G,{path:"/accept-invitation/:invitationId",element:u(jb,{})}),m(G,{path:"/admin",element:u(nr,{allowedRoles:["admin_platforme"],children:u(S0,{children:u(Hb,{})})}),children:[u(G,{index:!0,element:u(Uc,{})}),u(G,{path:"dashboard",element:u(Uc,{})}),u(G,{path:"compagnies",element:u(Gb,{})}),u(G,{path:"compagnies/ajouter",element:u(Yb,{})}),u(G,{path:"compagnies/:id/modifier",element:u(zb,{})}),u(G,{path:"compagnies/:companyId/plan",element:u(E0,{})}),u(G,{path:"plans",element:u(N0,{})}),u(G,{path:"reservations",element:u(Xb,{})}),u(G,{path:"finances",element:u(qb,{})}),u(G,{path:"statistiques",element:u(Wb,{})}),u(G,{path:"parametres-platforme",element:u(mb,{})}),u(G,{path:"media",element:u(pw,{})}),u(G,{path:"compagnies/:companyId/configurer",element:u(Aw,{})})]}),m(G,{path:"/compagnie/:companyId",element:u(nr,{allowedRoles:["admin_compagnie","admin_platforme"],children:u(Kb,{})}),children:[u(G,{index:!0,element:u($c,{})}),u(G,{path:"dashboard",element:u(Zb,{})}),u(G,{path:"comptabilite",element:u(tw,{})}),u(G,{path:"agences",element:u(Qb,{})}),u(G,{path:"parametres",element:u(Jb,{})}),u(G,{path:"parametres/plan",element:u(iw,{companyId:""})}),u(G,{path:"reservations",element:u(ew,{})}),u(G,{path:"reservations-en-ligne",element:u(ir,{to:"/chef-comptable/reservations-en-ligne",replace:!0})}),u(G,{path:"images",element:u(rw,{})}),u(G,{path:"payment-settings",element:u(nw,{})}),u(G,{path:"avis-clients",element:u(aw,{})})]}),m(G,{path:"/chef-comptable",element:u(nr,{allowedRoles:qr.chefComptableCompagnie,children:u(wb,{})}),children:[u(G,{index:!0,element:u(Ab,{})}),u(G,{path:"reservations-en-ligne",element:u(Ob,{})}),u(G,{path:"finances",element:u(Db,{})}),u(G,{path:"rapports",element:u(Pb,{})}),u(G,{path:"parametres",element:u(Mb,{})})]}),m(G,{path:"/agence",element:u(nr,{allowedRoles:["chefAgence","embarquement"],children:u(xw,{})}),children:[u(G,{index:!0,element:u($c,{})}),u(G,{path:"dashboard",element:u(ow,{})}),u(G,{path:"reservations",element:u(sw,{})}),u(G,{path:"embarquement",element:u(_g,{})}),u(G,{path:"trajets",element:u(cw,{})}),u(G,{path:"garage",element:u(yw,{})}),u(G,{path:"recettes",element:u(dw,{})}),u(G,{path:"finances",element:u(uw,{})}),u(G,{path:"personnel",element:u(fw,{})}),u(G,{path:"shift",element:u(vw,{})}),u(G,{path:"shift-history",element:u(mw,{})}),u(G,{path:"rapports",element:u(Ub,{})})]}),u(G,{path:"/agence/guichet",element:u(nr,{allowedRoles:["guichetier","chefAgence","admin_compagnie"],children:u(lw,{})})}),u(G,{path:"/agence/comptabilite",element:u(nr,{allowedRoles:["agency_accountant","admin_compagnie"],children:u(gw,{})})}),u(G,{path:"/compta/validations",element:u(nr,{allowedRoles:["company_accountant","financial_director"],children:u(vb,{})})}),u(G,{path:"/agence/validations",element:u(nr,{allowedRoles:["chefAgence","admin_compagnie"],children:u(yb,{})})}),u(G,{path:"/agence/receipt/:id",element:u(nr,{allowedRoles:["chefAgence","guichetier","admin_compagnie"],children:u(hw,{})})}),u(G,{path:"/agence/reservations/print",element:u(Eg,{})}),u(G,{path:"/:slug/reserver",element:u($b,{})}),u(G,{path:"/:slug/reservation/:id",element:u(Ao,{})}),u(G,{path:"/:slug/mon-billet",element:u(Ao,{})}),u(G,{path:"/:slug/upload-preuve/:id",element:u(ww,{})}),u(G,{path:"/mes-reservations",element:u(jc,{})}),u(G,{path:"/:slug/mes-reservations",element:u(jc,{})}),u(G,{path:"/:slug/*",element:u(w0,{})}),u(G,{path:"/comptable",element:u(ir,{to:"/chef-comptable",replace:!0})}),u(G,{path:"/compagnie/reservations-en-ligne-compta",element:u(ir,{to:"/chef-comptable/reservations-en-ligne",replace:!0})}),u(G,{path:"*",element:m("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 bg-gray-100",children:[u("h1",{className:"text-4xl font-bold text-red-600 mb-4",children:"404 - Page non trouvÃ©e"}),u("p",{className:"text-lg text-gray-700 mb-6",children:"La page demandÃ©e est introuvable ou a Ã©tÃ© dÃ©placÃ©e."}),u("a",{href:"/",className:"bg-orange-600 text-white px-5 py-2 rounded hover:bg-orange-700",children:"Retour Ã  l'accueil"})]})})]},e)})};function Ew(r){return new Promise((e,t)=>{var n,a;try{const i=r;if(!i.waiting){e();return}let o=!1;const s=()=>{o||(o=!0,navigator.serviceWorker.removeEventListener("controllerchange",s),e())};navigator.serviceWorker.addEventListener("controllerchange",s);try{i.waiting.postMessage({type:"SKIP_WAITING"})}catch{try{(a=(n=i.waiting).skipWaiting)==null||a.call(n)}catch{}}setTimeout(()=>{o||(navigator.serviceWorker.removeEventListener("controllerchange",s),t(new Error("timeout waiting for controllerchange")))},1e4)}catch(i){t(i)}})}function Nw(){const[r,e]=N.useState(null);return N.useEffect(()=>{const t=n=>{var i;const a=((i=n==null?void 0:n.detail)==null?void 0:i.registration)||null;e(a)};return window.addEventListener("sw:updated",t),()=>window.removeEventListener("sw:updated",t)},[]),r?m("div",{className:"fixed right-5 bottom-5 z-50 max-w-xs rounded-lg shadow-lg p-3 flex flex-col gap-3 bg-orange-600 text-white",children:[u("div",{className:"font-semibold",children:"Nouvelle version disponible"}),m("div",{className:"flex items-center gap-2",children:[u("button",{onClick:()=>Ew(r),className:"flex-1 bg-white text-orange-600 font-semibold py-2 rounded-md",children:"Mettre Ã  jour"}),u("button",{onClick:()=>e(null),className:"px-3 py-2 rounded-md border border-white/30",children:"Ignorer"})]})]}):null}const Sw=()=>m(a0,{children:[u(_w,{}),u(Nw,{})]}),se=r=>typeof r=="string",Nn=()=>{let r,e;const t=new Promise((n,a)=>{r=n,e=a});return t.resolve=r,t.reject=e,t},Hc=r=>r==null?"":""+r,Iw=(r,e,t)=>{r.forEach(n=>{e[n]&&(t[n]=e[n])})},Tw=/###/g,Gc=r=>r&&r.indexOf("###")>-1?r.replace(Tw,"."):r,zc=r=>!r||se(r),kn=(r,e,t)=>{const n=se(e)?e.split("."):e;let a=0;for(;a<n.length-1;){if(zc(r))return{};const i=Gc(n[a]);!r[i]&&t&&(r[i]=new t),Object.prototype.hasOwnProperty.call(r,i)?r=r[i]:r={},++a}return zc(r)?{}:{obj:r,k:Gc(n[a])}},Wc=(r,e,t)=>{const{obj:n,k:a}=kn(r,e,Object);if(n!==void 0||e.length===1){n[a]=t;return}let i=e[e.length-1],o=e.slice(0,e.length-1),s=kn(r,o,Object);for(;s.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),s=kn(r,o,Object),s!=null&&s.obj&&typeof s.obj[`${s.k}.${i}`]<"u"&&(s.obj=void 0);s.obj[`${s.k}.${i}`]=t},Rw=(r,e,t,n)=>{const{obj:a,k:i}=kn(r,e,Object);a[i]=a[i]||[],a[i].push(t)},Fa=(r,e)=>{const{obj:t,k:n}=kn(r,e);if(t&&Object.prototype.hasOwnProperty.call(t,n))return t[n]},Ow=(r,e,t)=>{const n=Fa(r,t);return n!==void 0?n:Fa(e,t)},Lf=(r,e,t)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in r?se(r[n])||r[n]instanceof String||se(e[n])||e[n]instanceof String?t&&(r[n]=e[n]):Lf(r[n],e[n],t):r[n]=e[n]);return r},Gr=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Dw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Pw=r=>se(r)?r.replace(/[&<>"'\/]/g,e=>Dw[e]):r;class Mw{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const Lw=[" ",",","?","!",";"],kw=new Mw(20),Fw=(r,e,t)=>{e=e||"",t=t||"";const n=Lw.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(n.length===0)return!0;const a=kw.getRegExp(`(${n.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!a.test(r);if(!i){const o=r.indexOf(t);o>0&&!a.test(r.substring(0,o))&&(i=!0)}return i},_o=(r,e,t=".")=>{if(!r)return;if(r[e])return Object.prototype.hasOwnProperty.call(r,e)?r[e]:void 0;const n=e.split(t);let a=r;for(let i=0;i<n.length;){if(!a||typeof a!="object")return;let o,s="";for(let l=i;l<n.length;++l)if(l!==i&&(s+=t),s+=n[l],o=a[s],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<n.length-1)continue;i+=l-i+1;break}a=o}return a},Wn=r=>r==null?void 0:r.replace("_","-"),Bw={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,e){var t,n;(n=(t=console==null?void 0:console[r])==null?void 0:t.apply)==null||n.call(t,console,e)}};class Ba{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||Bw,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,a){return a&&!this.debug?null:(se(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Ba(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Ba(this.logger,e)}}var Kt=new Ba;class Ka{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const a=this.observers[n].get(t)||0;this.observers[n].set(t,a+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([a,i])=>{for(let o=0;o<i;o++)a(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,i])=>{for(let o=0;o<i;o++)a.apply(a,[e,...t])})}}class Xc extends Ka{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n,a={}){var c,d;const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,o=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,t],n&&(Array.isArray(n)?s.push(...n):se(n)&&i?s.push(...n.split(i)):s.push(n)));const l=Fa(this.data,s);return!l&&!t&&!n&&e.indexOf(".")>-1&&(e=s[0],t=s[1],n=s.slice(2).join(".")),l||!o||!se(n)?l:_o((d=(c=this.data)==null?void 0:c[e])==null?void 0:d[t],n,i)}addResource(e,t,n,a,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let s=[e,t];n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(s=e.split("."),a=t,t=s[1]),this.addNamespaces(t),Wc(this.data,s,a),i.silent||this.emit("added",e,t,n,a)}addResources(e,t,n,a={silent:!1}){for(const i in n)(se(n[i])||Array.isArray(n[i]))&&this.addResource(e,t,i,n[i],{silent:!0});a.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,a,i,o={silent:!1,skipCopy:!1}){let s=[e,t];e.indexOf(".")>-1&&(s=e.split("."),a=n,n=t,t=s[1]),this.addNamespaces(t);let l=Fa(this.data,s)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),a?Lf(l,n,i):l={...l,...n},Wc(this.data,s,l),o.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(a=>t[a]&&Object.keys(t[a]).length>0)}toJSON(){return this.data}}var kf={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,e,t,n,a){return r.forEach(i=>{var o;e=((o=this.processors[i])==null?void 0:o.process(e,t,n,a))??e}),e}};const Ff=Symbol("i18next/PATH_KEY");function Vw(){const r=[],e=Object.create(null);let t;return e.get=(n,a)=>{var i;return(i=t==null?void 0:t.revoke)==null||i.call(t),a===Ff?r:(r.push(a),t=Proxy.revocable(n,e),t.proxy)},Proxy.revocable(Object.create(null),e).proxy}function Eo(r,e){const{[Ff]:t}=r(Vw());return t.join((e==null?void 0:e.keySeparator)??".")}const qc={},Mi=r=>!se(r)&&typeof r!="boolean"&&typeof r!="number";class Va extends Ka{constructor(e,t={}){super(),Iw(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Kt.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const n={...t};if(e==null)return!1;const a=this.resolve(e,n);if((a==null?void 0:a.res)===void 0)return!1;const i=Mi(a.res);return!(n.returnObjects===!1&&i)}extractFromKey(e,t){let n=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const a=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let i=t.ns||this.options.defaultNS||[];const o=n&&e.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!Fw(e,n,a);if(o&&!s){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:se(i)?[i]:i};const c=e.split(n);(n!==a||n===a&&this.options.ns.indexOf(c[0])>-1)&&(i=c.shift()),e=c.join(a)}return{key:e,namespaces:se(i)?[i]:i}}translate(e,t,n){let a=typeof t=="object"?{...t}:t;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),e==null)return"";typeof e=="function"&&(e=Eo(e,{...this.options,...a})),Array.isArray(e)||(e=[String(e)]);const i=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:s,namespaces:l}=this.extractFromKey(e[e.length-1],a),c=l[l.length-1];let d=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const f=a.lng||this.language,h=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode")return h?i?{res:`${c}${d}${s}`,usedKey:s,exactUsedKey:s,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(a)}:`${c}${d}${s}`:i?{res:s,usedKey:s,exactUsedKey:s,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(a)}:s;const p=this.resolve(e,a);let g=p==null?void 0:p.res;const y=(p==null?void 0:p.usedKey)||s,x=(p==null?void 0:p.exactUsedKey)||s,v=["[object Number]","[object Function]","[object RegExp]"],b=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,_=!this.i18nFormat||this.i18nFormat.handleAsObject,w=a.count!==void 0&&!se(a.count),A=Va.hasDefaultValue(a),C=w?this.pluralResolver.getSuffix(f,a.count,a):"",I=a.ordinal&&w?this.pluralResolver.getSuffix(f,a.count,{ordinal:!1}):"",R=w&&!a.ordinal&&a.count===0,F=R&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${C}`]||a[`defaultValue${I}`]||a.defaultValue;let T=g;_&&!g&&A&&(T=F);const U=Mi(T),L=Object.prototype.toString.apply(T);if(_&&T&&U&&v.indexOf(L)<0&&!(se(b)&&Array.isArray(T))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const B=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,T,{...a,ns:l}):`key '${s} (${this.language})' returned an object instead of string.`;return i?(p.res=B,p.usedParams=this.getUsedParamsDetails(a),p):B}if(o){const B=Array.isArray(T),H=B?[]:{},Q=B?x:y;for(const ae in T)if(Object.prototype.hasOwnProperty.call(T,ae)){const W=`${Q}${o}${ae}`;A&&!g?H[ae]=this.translate(W,{...a,defaultValue:Mi(F)?F[ae]:void 0,joinArrays:!1,ns:l}):H[ae]=this.translate(W,{...a,joinArrays:!1,ns:l}),H[ae]===W&&(H[ae]=T[ae])}g=H}}else if(_&&se(b)&&Array.isArray(g))g=g.join(b),g&&(g=this.extendTranslation(g,e,a,n));else{let B=!1,H=!1;!this.isValidLookup(g)&&A&&(B=!0,g=F),this.isValidLookup(g)||(H=!0,g=s);const ae=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&H?void 0:g,W=A&&F!==g&&this.options.updateMissing;if(H||B||W){if(this.logger.log(W?"updateKey":"missingKey",f,c,s,W?F:g),o){const J=this.resolve(s,{...a,keySeparator:!1});J&&J.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let X=[];const z=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&z&&z[0])for(let J=0;J<z.length;J++)X.push(z[J]);else this.options.saveMissingTo==="all"?X=this.languageUtils.toResolveHierarchy(a.lng||this.language):X.push(a.lng||this.language);const ie=(J,K,pe)=>{var be;const Ue=A&&pe!==g?pe:ae;this.options.missingKeyHandler?this.options.missingKeyHandler(J,c,K,Ue,W,a):(be=this.backendConnector)!=null&&be.saveMissing&&this.backendConnector.saveMissing(J,c,K,Ue,W,a),this.emit("missingKey",J,c,K,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&w?X.forEach(J=>{const K=this.pluralResolver.getSuffixes(J,a);R&&a[`defaultValue${this.options.pluralSeparator}zero`]&&K.indexOf(`${this.options.pluralSeparator}zero`)<0&&K.push(`${this.options.pluralSeparator}zero`),K.forEach(pe=>{ie([J],s+pe,a[`defaultValue${pe}`]||F)})}):ie(X,s,F))}g=this.extendTranslation(g,e,a,p,n),H&&g===s&&this.options.appendNamespaceToMissingKey&&(g=`${c}${d}${s}`),(H||B)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${d}${s}`:s,B?g:void 0,a))}return i?(p.res=g,p.usedParams=this.getUsedParamsDetails(a),p):g}extendTranslation(e,t,n,a,i){var l,c;if((l=this.i18nFormat)!=null&&l.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const d=se(e)&&(((c=n==null?void 0:n.interpolation)==null?void 0:c.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(d){const p=e.match(this.interpolator.nestingRegexp);f=p&&p.length}let h=n.replace&&!se(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),e=this.interpolator.interpolate(e,h,n.lng||this.language||a.usedLng,n),d){const p=e.match(this.interpolator.nestingRegexp),g=p&&p.length;f<g&&(n.nest=!1)}!n.lng&&a&&a.res&&(n.lng=this.language||a.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,(...p)=>(i==null?void 0:i[0])===p[0]&&!n.context?(this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${t[0]}`),null):this.translate(...p,t),n)),n.interpolation&&this.interpolator.reset()}const o=n.postProcess||this.options.postProcess,s=se(o)?[o]:o;return e!=null&&(s!=null&&s.length)&&n.applyPostProcessor!==!1&&(e=kf.handle(s,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,t={}){let n,a,i,o,s;return se(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(n))return;const c=this.extractFromKey(l,t),d=c.key;a=d;let f=c.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const h=t.count!==void 0&&!se(t.count),p=h&&!t.ordinal&&t.count===0,g=t.context!==void 0&&(se(t.context)||typeof t.context=="number")&&t.context!=="",y=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);f.forEach(x=>{var v,b;this.isValidLookup(n)||(s=x,!qc[`${y[0]}-${x}`]&&((v=this.utils)!=null&&v.hasLoadedNamespace)&&!((b=this.utils)!=null&&b.hasLoadedNamespace(s))&&(qc[`${y[0]}-${x}`]=!0,this.logger.warn(`key "${a}" for languages "${y.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(_=>{var C;if(this.isValidLookup(n))return;o=_;const w=[d];if((C=this.i18nFormat)!=null&&C.addLookupKeys)this.i18nFormat.addLookupKeys(w,d,_,x,t);else{let I;h&&(I=this.pluralResolver.getSuffix(_,t.count,t));const R=`${this.options.pluralSeparator}zero`,F=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(t.ordinal&&I.indexOf(F)===0&&w.push(d+I.replace(F,this.options.pluralSeparator)),w.push(d+I),p&&w.push(d+R)),g){const T=`${d}${this.options.contextSeparator||"_"}${t.context}`;w.push(T),h&&(t.ordinal&&I.indexOf(F)===0&&w.push(T+I.replace(F,this.options.pluralSeparator)),w.push(T+I),p&&w.push(T+R))}}let A;for(;A=w.pop();)this.isValidLookup(n)||(i=A,n=this.getResource(_,x,A,t))}))})}),{res:n,usedKey:a,exactUsedKey:i,usedLng:o,usedNS:s}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,n,a={}){var i;return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(e,t,n,a):this.resourceStore.getResource(e,t,n,a)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!se(e.replace);let a=n?e.replace:e;if(n&&typeof e.count<"u"&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!n){a={...a};for(const i of t)delete a[i]}return a}static hasDefaultValue(e){const t="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&e[n]!==void 0)return!0;return!1}}class Yc{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Kt.create("languageUtils")}getScriptPartFromCode(e){if(e=Wn(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Wn(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(se(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(n=>{if(t)return;const a=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(a))&&(t=a)}),!t&&this.options.supportedLngs&&e.forEach(n=>{if(t)return;const a=this.getScriptPartFromCode(n);if(this.isSupportedCode(a))return t=a;const i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),se(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){const n=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),a=[],i=o=>{o&&(this.isSupportedCode(o)?a.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return se(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):se(e)&&i(this.formatLanguageCode(e)),n.forEach(o=>{a.indexOf(o)<0&&i(this.formatLanguageCode(o))}),a}}const Kc={zero:0,one:1,two:2,few:3,many:4,other:5},Zc={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class jw{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=Kt.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const n=Wn(e==="dev"?"en":e),a=t.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:n,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(n,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Zc;if(!e.match(/-|_/))return Zc;const l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,t)}return this.pluralRulesCache[i]=o,o}needsPlural(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,n={}){return this.getSuffixes(e,n).map(a=>`${t}${a}`)}getSuffixes(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?n.resolvedOptions().pluralCategories.sort((a,i)=>Kc[a]-Kc[i]).map(a=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(e,t,n={}){const a=this.getRule(e,n);return a?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}}const Qc=(r,e,t,n=".",a=!0)=>{let i=Ow(r,e,t);return!i&&a&&se(t)&&(i=_o(r,t,n),i===void 0&&(i=_o(e,t,n))),i},Li=r=>r.replace(/\$/g,"$$$$");class Uw{constructor(e={}){var t;this.logger=Kt.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(n=>n),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:n,useRawValueToEscape:a,prefix:i,prefixEscaped:o,suffix:s,suffixEscaped:l,formatSeparator:c,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:h,nestingPrefixEscaped:p,nestingSuffix:g,nestingSuffixEscaped:y,nestingOptionsSeparator:x,maxReplaces:v,alwaysFormat:b}=e.interpolation;this.escape=t!==void 0?t:Pw,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?Gr(i):o||"{{",this.suffix=s?Gr(s):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=h?Gr(h):p||Gr("$t("),this.nestingSuffix=g?Gr(g):y||Gr(")"),this.nestingOptionsSeparator=x||",",this.maxReplaces=v||1e3,this.alwaysFormat=b!==void 0?b:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,n)=>(t==null?void 0:t.source)===n?(t.lastIndex=0,t):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,n,a){var p;let i,o,s;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=g=>{if(g.indexOf(this.formatSeparator)<0){const b=Qc(t,l,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(b,void 0,n,{...a,...t,interpolationkey:g}):b}const y=g.split(this.formatSeparator),x=y.shift().trim(),v=y.join(this.formatSeparator).trim();return this.format(Qc(t,l,x,this.options.keySeparator,this.options.ignoreJSONStructure),v,n,{...a,...t,interpolationkey:x})};this.resetRegExp();const d=(a==null?void 0:a.missingInterpolationHandler)||this.options.missingInterpolationHandler,f=((p=a==null?void 0:a.interpolation)==null?void 0:p.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>Li(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?Li(this.escape(g)):Li(g)}].forEach(g=>{for(s=0;i=g.regex.exec(e);){const y=i[1].trim();if(o=c(y),o===void 0)if(typeof d=="function"){const v=d(e,i,a);o=se(v)?v:""}else if(a&&Object.prototype.hasOwnProperty.call(a,y))o="";else if(f){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),o="";else!se(o)&&!this.useRawValueToEscape&&(o=Hc(o));const x=g.safeValue(o);if(e=e.replace(i[0],x),f?(g.regex.lastIndex+=o.length,g.regex.lastIndex-=i[0].length):g.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,t,n={}){let a,i,o;const s=(l,c)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const f=l.split(new RegExp(`${d}[ ]*{`));let h=`{${f[1]}`;l=f[0],h=this.interpolate(h,o);const p=h.match(/'/g),g=h.match(/"/g);(((p==null?void 0:p.length)??0)%2===0&&!g||g.length%2!==0)&&(h=h.replace(/'/g,'"'));try{o=JSON.parse(h),c&&(o={...c,...o})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,y),`${l}${d}${h}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;a=this.nestingRegexp.exec(e);){let l=[];o={...n},o=o.replace&&!se(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const c=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(c!==-1&&(l=a[1].slice(c).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),a[1]=a[1].slice(0,c)),i=t(s.call(this,a[1].trim(),o),o),i&&a[0]===e&&!se(i))return i;se(i)||(i=Hc(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),i=""),l.length&&(i=l.reduce((d,f)=>this.format(d,f,n.lng,{...n,interpolationkey:a[1].trim()}),i.trim())),e=e.replace(a[0],i),this.regexp.lastIndex=0}return e}}const $w=r=>{let e=r.toLowerCase().trim();const t={};if(r.indexOf("(")>-1){const n=r.split("(");e=n[0].toLowerCase().trim();const a=n[1].substring(0,n[1].length-1);e==="currency"&&a.indexOf(":")<0?t.currency||(t.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?t.range||(t.range=a.trim()):a.split(";").forEach(o=>{if(o){const[s,...l]=o.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),d=s.trim();t[d]||(t[d]=c),c==="false"&&(t[d]=!1),c==="true"&&(t[d]=!0),isNaN(c)||(t[d]=parseInt(c,10))}})}return{formatName:e,formatOptions:t}},Jc=r=>{const e={};return(t,n,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const o=n+JSON.stringify(i);let s=e[o];return s||(s=r(Wn(n),a),e[o]=s),s(t)}},Hw=r=>(e,t,n)=>r(Wn(t),n)(e);class Gw{constructor(e={}){this.logger=Kt.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const n=t.cacheInBuiltFormats?Jc:Hw;this.formats={number:n((a,i)=>{const o=new Intl.NumberFormat(a,{...i});return s=>o.format(s)}),currency:n((a,i)=>{const o=new Intl.NumberFormat(a,{...i,style:"currency"});return s=>o.format(s)}),datetime:n((a,i)=>{const o=new Intl.DateTimeFormat(a,{...i});return s=>o.format(s)}),relativetime:n((a,i)=>{const o=new Intl.RelativeTimeFormat(a,{...i});return s=>o.format(s,i.range||"day")}),list:n((a,i)=>{const o=new Intl.ListFormat(a,{...i});return s=>o.format(s)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=Jc(t)}format(e,t,n,a={}){const i=t.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(s=>s.indexOf(")")>-1)){const s=i.findIndex(l=>l.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,s)].join(this.formatSeparator)}return i.reduce((s,l)=>{var f;const{formatName:c,formatOptions:d}=$w(l);if(this.formats[c]){let h=s;try{const p=((f=a==null?void 0:a.formatParams)==null?void 0:f[a.interpolationkey])||{},g=p.locale||p.lng||a.locale||a.lng||n;h=this.formats[c](s,g,{...d,...a,...p})}catch(p){this.logger.warn(p)}return h}else this.logger.warn(`there was no format function for ${c}`);return s},e)}}const zw=(r,e)=>{r.pending[e]!==void 0&&(delete r.pending[e],r.pendingCount--)};class Ww extends Ka{constructor(e,t,n,a={}){var i,o;super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=a,this.logger=Kt.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],(o=(i=this.backend)==null?void 0:i.init)==null||o.call(i,n,a.backend,a)}queueLoad(e,t,n,a){const i={},o={},s={},l={};return e.forEach(c=>{let d=!0;t.forEach(f=>{const h=`${c}|${f}`;!n.reload&&this.store.hasResourceBundle(c,f)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?o[h]===void 0&&(o[h]=!0):(this.state[h]=1,d=!1,o[h]===void 0&&(o[h]=!0),i[h]===void 0&&(i[h]=!0),l[f]===void 0&&(l[f]=!0)))}),d||(s[c]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,t,n){const a=e.split("|"),i=a[0],o=a[1];t&&this.emit("failedLoading",i,o,t),!t&&n&&this.store.addResourceBundle(i,o,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);const s={};this.queue.forEach(l=>{Rw(l.loaded,[i],o),zw(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{s[c]||(s[c]={});const d=l.loaded[c];d.length&&d.forEach(f=>{s[c][f]===void 0&&(s[c][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(e,t,n,a=0,i=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:n,tried:a,wait:i,callback:o});return}this.readingCalls++;const s=(c,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(c&&d&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,n,a+1,i*2,o)},i);return}o(c,d)},l=this.backend[n].bind(this.backend);if(l.length===2){try{const c=l(e,t);c&&typeof c.then=="function"?c.then(d=>s(null,d)).catch(s):s(null,c)}catch(c){s(c)}return}return l(e,t,s)}prepareLoading(e,t,n={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();se(e)&&(e=this.languageUtils.toResolveHierarchy(e)),se(t)&&(t=[t]);const i=this.queueLoad(e,t,n,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e,t=""){const n=e.split("|"),a=n[0],i=n[1];this.read(a,i,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${t}loading namespace ${i} for language ${a} failed`,o),!o&&s&&this.logger.log(`${t}loaded namespace ${i} for language ${a}`,s),this.loaded(e,o,s)})}saveMissing(e,t,n,a,i,o={},s=()=>{}){var l,c,d,f,h;if((c=(l=this.services)==null?void 0:l.utils)!=null&&c.hasLoadedNamespace&&!((f=(d=this.services)==null?void 0:d.utils)!=null&&f.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((h=this.backend)!=null&&h.create){const p={...o,isUpdate:i},g=this.backend.create.bind(this.backend);if(g.length<6)try{let y;g.length===5?y=g(e,t,n,a,p):y=g(e,t,n,a),y&&typeof y.then=="function"?y.then(x=>s(null,x)).catch(s):s(null,y)}catch(y){s(y)}else g(e,t,n,a,s,p)}!e||!e[0]||this.store.addResource(e[0],t,n,a)}}}const eu=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let e={};if(typeof r[1]=="object"&&(e=r[1]),se(r[1])&&(e.defaultValue=r[1]),se(r[2])&&(e.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){const t=r[3]||r[2];Object.keys(t).forEach(n=>{e[n]=t[n]})}return e},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),tu=r=>{var e,t;return se(r.ns)&&(r.ns=[r.ns]),se(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),se(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((t=(e=r.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},ma=()=>{},Xw=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(t=>{typeof r[t]=="function"&&(r[t]=r[t].bind(r))})};class Xn extends Ka{constructor(e={},t){if(super(),this.options=tu(e),this.services={},this.logger=Kt,this.modules={external:[]},Xw(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(se(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=eu();this.options={...n,...this.options,...tu(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const a=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?Kt.init(a(this.modules.logger),this.options):Kt.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=Gw;const d=new Yc(this.options);this.store=new Xc(this.options.resources,this.options);const f=this.services;f.logger=Kt,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new jw(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),c&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(f.formatter=a(c),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new Uw(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Ww(a(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(p,...g)=>{this.emit(p,...g)}),this.modules.languageDetector&&(f.languageDetector=a(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=a(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Va(this.services,this.options),this.translator.on("*",(p,...g)=>{this.emit(p,...g)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,t||(t=ma),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=(...d)=>this.store[c](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=(...d)=>(this.store[c](...d),this)});const s=Nn(),l=()=>{const c=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(f),t(d,f)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),s}loadResources(e,t=ma){var i,o;let n=t;const a=se(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if((a==null?void 0:a.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const s=[],l=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(f=>{f!=="cimode"&&s.indexOf(f)<0&&s.push(f)})};a?l(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>l(d)),(o=(i=this.options.preload)==null?void 0:i.forEach)==null||o.call(i,c=>l(c)),this.services.backendConnector.load(s,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(c)})}else n(null)}reloadResources(e,t,n){const a=Nn();return typeof e=="function"&&(n=e,e=void 0),typeof t=="function"&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=ma),this.services.backendConnector.reload(e,t,i=>{a.resolve(),n(i)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&kf.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const n=Nn();this.emit("languageChanging",e);const a=s=>{this.language=s,this.languages=this.services.languageUtils.toResolveHierarchy(s),this.resolvedLanguage=void 0,this.setResolvedLanguage(s)},i=(s,l)=>{l?this.isLanguageChangingTo===e&&(a(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,n.resolve((...c)=>this.t(...c)),t&&t(s,(...c)=>this.t(...c))},o=s=>{var d,f;!e&&!s&&this.services.languageDetector&&(s=[]);const l=se(s)?s:s&&s[0],c=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(se(s)?[s]:s);c&&(this.language||a(c),this.translator.language||this.translator.changeLanguage(c),(f=(d=this.services.languageDetector)==null?void 0:d.cacheUserLanguage)==null||f.call(d,c)),this.loadResources(c,h=>{i(h,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),n}getFixedT(e,t,n){const a=(i,o,...s)=>{let l;typeof o!="object"?l=this.options.overloadTranslationOptionHandler([i,o].concat(s)):l={...o},l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||a.keyPrefix);const c=this.options.keySeparator||".";let d;return l.keyPrefix&&Array.isArray(i)?d=i.map(f=>(typeof f=="function"&&(f=Eo(f,{...this.options,...o})),`${l.keyPrefix}${c}${f}`)):(typeof i=="function"&&(i=Eo(i,{...this.options,...o})),d=l.keyPrefix?`${l.keyPrefix}${c}${i}`:i),this.t(d,l)};return se(e)?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=n,a}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=t.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const o=(s,l)=>{const c=this.services.backendConnector.state[`${s}|${l}`];return c===-1||c===0||c===2};if(t.precheck){const s=t.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,e)&&(!a||o(i,e)))}loadNamespaces(e,t){const n=Nn();return this.options.ns?(se(e)&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{n.resolve(),t&&t(a)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){const n=Nn();se(e)&&(e=[e]);const a=this.options.preload||[],i=e.filter(o=>a.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=a.concat(i),this.loadResources(o=>{n.resolve(),t&&t(o)}),n):(t&&t(),Promise.resolve())}dir(e){var a,i;if(e||(e=this.resolvedLanguage||(((a=this.languages)==null?void 0:a.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const o=new Intl.Locale(e);if(o&&o.getTextInfo){const s=o.getTextInfo();if(s&&s.direction)return s.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((i=this.services)==null?void 0:i.languageUtils)||new Yc(eu());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new Xn(e,t)}cloneInstance(e={},t=ma){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},i=new Xn(a);if((e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(s=>{i[s]=this[s]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},n){const s=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},l[c]=Object.keys(l[c]).reduce((d,f)=>(d[f]={...l[c][f]},d),l[c]),l),{});i.store=new Xc(s,a),i.services.resourceStore=i.store}return i.translator=new Va(i.services,a),i.translator.on("*",(s,...l)=>{i.emit(s,...l)}),i.init(a,t),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ft=Xn.createInstance();ft.createInstance=Xn.createInstance;ft.createInstance;ft.dir;ft.init;ft.loadResources;ft.reloadResources;ft.use;ft.changeLanguage;ft.getFixedT;ft.t;ft.exists;ft.setDefaultNamespace;ft.hasLoadedNamespace;ft.loadNamespaces;ft.loadLanguages;const{slice:qw,forEach:Yw}=[];function Kw(r){return Yw.call(qw.call(arguments,1),e=>{if(e)for(const t in e)r[t]===void 0&&(r[t]=e[t])}),r}function Zw(r){return typeof r!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(t=>t.test(r))}const ru=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Qw=function(r,e){const n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},a=encodeURIComponent(e);let i=`${r}=${a}`;if(n.maxAge>0){const o=n.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(n.domain){if(!ru.test(n.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${n.domain}`}if(n.path){if(!ru.test(n.path))throw new TypeError("option path is invalid");i+=`; Path=${n.path}`}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${n.expires.toUTCString()}`}if(n.httpOnly&&(i+="; HttpOnly"),n.secure&&(i+="; Secure"),n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n.partitioned&&(i+="; Partitioned"),i},nu={create(r,e,t,n){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};t&&(a.expires=new Date,a.expires.setTime(a.expires.getTime()+t*60*1e3)),n&&(a.domain=n),document.cookie=Qw(r,e,a)},read(r){const e=`${r}=`,t=document.cookie.split(";");for(let n=0;n<t.length;n++){let a=t[n];for(;a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(e)===0)return a.substring(e.length,a.length)}return null},remove(r,e){this.create(r,"",-1,e)}};var Jw={name:"cookie",lookup(r){let{lookupCookie:e}=r;if(e&&typeof document<"u")return nu.read(e)||void 0},cacheUserLanguage(r,e){let{lookupCookie:t,cookieMinutes:n,cookieDomain:a,cookieOptions:i}=e;t&&typeof document<"u"&&nu.create(t,r,n,a,i)}},e3={name:"querystring",lookup(r){var n;let{lookupQuerystring:e}=r,t;if(typeof window<"u"){let{search:a}=window.location;!window.location.search&&((n=window.location.hash)==null?void 0:n.indexOf("?"))>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));const o=a.substring(1).split("&");for(let s=0;s<o.length;s++){const l=o[s].indexOf("=");l>0&&o[s].substring(0,l)===e&&(t=o[s].substring(l+1))}}return t}},t3={name:"hash",lookup(r){var a;let{lookupHash:e,lookupFromHashIndex:t}=r,n;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const o=i.substring(1);if(e){const s=o.split("&");for(let l=0;l<s.length;l++){const c=s[l].indexOf("=");c>0&&s[l].substring(0,c)===e&&(n=s[l].substring(c+1))}}if(n)return n;if(!n&&t>-1){const s=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(s)?(a=s[typeof t=="number"?t:0])==null?void 0:a.replace("/",""):void 0}}}return n}};let zr=null;const au=()=>{if(zr!==null)return zr;try{if(zr=typeof window<"u"&&window.localStorage!==null,!zr)return!1;const r="i18next.translate.boo";window.localStorage.setItem(r,"foo"),window.localStorage.removeItem(r)}catch{zr=!1}return zr};var r3={name:"localStorage",lookup(r){let{lookupLocalStorage:e}=r;if(e&&au())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(r,e){let{lookupLocalStorage:t}=e;t&&au()&&window.localStorage.setItem(t,r)}};let Wr=null;const iu=()=>{if(Wr!==null)return Wr;try{if(Wr=typeof window<"u"&&window.sessionStorage!==null,!Wr)return!1;const r="i18next.translate.boo";window.sessionStorage.setItem(r,"foo"),window.sessionStorage.removeItem(r)}catch{Wr=!1}return Wr};var n3={name:"sessionStorage",lookup(r){let{lookupSessionStorage:e}=r;if(e&&iu())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(r,e){let{lookupSessionStorage:t}=e;t&&iu()&&window.sessionStorage.setItem(t,r)}},a3={name:"navigator",lookup(r){const e=[];if(typeof navigator<"u"){const{languages:t,userLanguage:n,language:a}=navigator;if(t)for(let i=0;i<t.length;i++)e.push(t[i]);n&&e.push(n),a&&e.push(a)}return e.length>0?e:void 0}},i3={name:"htmlTag",lookup(r){let{htmlTag:e}=r,t;const n=e||(typeof document<"u"?document.documentElement:null);return n&&typeof n.getAttribute=="function"&&(t=n.getAttribute("lang")),t}},o3={name:"path",lookup(r){var a;let{lookupFromPathIndex:e}=r;if(typeof window>"u")return;const t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(t)?(a=t[typeof e=="number"?e:0])==null?void 0:a.replace("/",""):void 0}},s3={name:"subdomain",lookup(r){var a,i;let{lookupFromSubdomainIndex:e}=r;const t=typeof e=="number"?e+1:1,n=typeof window<"u"&&((i=(a=window.location)==null?void 0:a.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(n)return n[t]}};let Bf=!1;try{document.cookie,Bf=!0}catch{}const Vf=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];Bf||Vf.splice(1,1);const l3=()=>({order:Vf,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:r=>r});class jf{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=Kw(t,this.options||{},l3()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=a=>a.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(Jw),this.addDetector(e3),this.addDetector(r3),this.addDetector(n3),this.addDetector(a3),this.addDetector(i3),this.addDetector(o3),this.addDetector(s3),this.addDetector(t3)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,t=[];return e.forEach(n=>{if(this.detectors[n]){let a=this.detectors[n].lookup(this.options);a&&typeof a=="string"&&(a=[a]),a&&(t=t.concat(a))}}),t=t.filter(n=>n!=null&&!Zw(n)).map(n=>this.options.convertDetectedLanguage(n)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(n=>{this.detectors[n]&&this.detectors[n].cacheUserLanguage(e,this.options)}))}}jf.type="languageDetector";ft.use(jf).use(yh).init({fallbackLng:"fr",debug:!1,interpolation:{escapeValue:!1},resources:{fr:{translation:{searchTitle:"Trouvez votre trajet",departureCity:"Ville de dÃ©part",arrivalCity:"Ville dâ€™arrivÃ©e",searchTrip:"Rechercher",departurePlaceholder:"Ex: Bamako",arrivalPlaceholder:"Ex: Abidjan",companyNotFound:"Compagnie introuvable.",loadingError:"Erreur de chargement.",invalidCity:"Veuillez entrer des villes valides.",error:"Erreur",backToHome:"Retour Ã  lâ€™accueil",ourAgencies:"Nos agences",myBookings:"Mes rÃ©servations",contact:"Contact",login:"Connexion",about:"Ã€ propos",welcomeTransport:"Bienvenue sur notre plateforme de transport.",followUs:"Suivez-nous",customerReviews:"Avis clients",phone:"TÃ©lÃ©phone",country:"Pays",district:"Quartier",address:"Adresse",notSpecified:"Non spÃ©cifiÃ©e",close:"Fermer",legalMentions:"Mentions lÃ©gales",privacyPolicy:"Politique de confidentialitÃ©",ourCompany:"Notre compagnie",allRightsReserved:"Tous droits rÃ©servÃ©s",defaultSlogan:"Votre monde, plus rapide. Plus simple.",searchInstruction:"OÃ¹ souhaitez-vous partir aujourdâ€™hui ?",giveReview:"Donner votre avis",openingHours:"Horaires",legalTerms:"Conditions gÃ©nÃ©rales",cookiePolicy:"Politique des cookies",notFound:"Page introuvable.",backToCompany:"Retour Ã  la compagnie",language:"Langue",exclusiveServices:"Nos services exclusifs",popularDestinations:"Destinations populaires",bookNow:"RÃ©server",seeMore:"Voir plus",bookInOneClick:"RÃ©servez vos trajets en un seul clic",whatClientsSay:"Ce que nos clients disent",realExperiences:"Les expÃ©riences authentiques de nos voyageurs",legalNotice:"Mentions lÃ©gales",termsConditions:"Conditions gÃ©nÃ©rales",leaveReview:"Laisser un avis",serviceSecurityTitle:"SÃ©curitÃ©",serviceSecurityDesc:"Votre sÃ©curitÃ© est notre prioritÃ© Ã  chaque trajet.",servicePunctualityTitle:"PonctualitÃ©",servicePunctualityDesc:"Des dÃ©parts et arrivÃ©es toujours Ã  lâ€™heure.",serviceSupportTitle:"Support client",serviceSupportDesc:"Une assistance rÃ©active, oÃ¹ que vous soyez.",serviceComfortTitle:"Confort",serviceComfortDesc:"Des vÃ©hicules spacieux et climatisÃ©s pour votre confort."}},en:{translation:{searchTitle:"Find your trip",departureCity:"Departure city",arrivalCity:"Arrival city",searchTrip:"Search",departurePlaceholder:"Ex: Bamako",arrivalPlaceholder:"Ex: Abidjan",companyNotFound:"Company not found.",loadingError:"Loading error.",invalidCity:"Please enter valid cities.",error:"Error",backToHome:"Back to home",ourAgencies:"Our agencies",myBookings:"My bookings",contact:"Contact",login:"Login",about:"About",welcomeTransport:"Welcome to our transport platform.",followUs:"Follow us",customerReviews:"Customer reviews",phone:"Phone",country:"Country",district:"District",address:"Address",notSpecified:"Not specified",close:"Close",legalMentions:"Legal mentions",privacyPolicy:"Privacy policy",ourCompany:"Our company",allRightsReserved:"All rights reserved",defaultSlogan:"Your world, faster. Simpler.",searchInstruction:"Where do you want to go today?",giveReview:"Give your review",openingHours:"Opening hours",legalTerms:"Terms and Conditions",cookiePolicy:"Cookie Policy",notFound:"Page not found.",backToCompany:"Back to company",language:"Language",exclusiveServices:"Our exclusive services",popularDestinations:"Popular destinations",bookNow:"Book now",seeMore:"See more",bookInOneClick:"Book your trip in one click",whatClientsSay:"What our clients say",realExperiences:"Real experiences from our travelers",legalNotice:"Legal notice",termsConditions:"Terms and Conditions",leaveReview:"Leave a review",serviceSecurityTitle:"Security",serviceSecurityDesc:"Your safety is our top priority on every trip.",servicePunctualityTitle:"Punctuality",servicePunctualityDesc:"Departures and arrivals always on time.",serviceSupportTitle:"Customer support",serviceSupportDesc:"Responsive assistance, wherever you are.",serviceComfortTitle:"Comfort",serviceComfortDesc:"Spacious and air-conditioned vehicles for your comfort."}}}});const g3=Object.freeze(Object.defineProperty({__proto__:null,default:ft},Symbol.toStringTag,{value:"Module"}));let ou=0;function c3(r){const t=String((r==null?void 0:r.message)||(r==null?void 0:r.stack)||"").match(/https?:\/\/[^\s"]*indexes[^\s"]*/i);return t?t[0]:null}function ki(r){const e=Date.now();if(e-ou<2e3)return;ou=e;const t=c3(r),n="Cette requÃªte Firestore a besoin dâ€™un index (non crÃ©Ã©).",a=t?`

ðŸ‘‰ Cliquez sur "CrÃ©er lâ€™index" puis revenez sur lâ€™app.

Lien : ${t}`:`

ðŸ‘‰ Ouvrez la console Firebase > Firestore > Indexes > "Create index" (copiez la requÃªte si besoin).`;if(alert(`${n}${a}`),t)try{window.open(t,"_blank","noopener")}catch{}console.warn("[Firestore] Index requis â†’",t||"(aucun lien dÃ©tectÃ©)",r)}const su=window;if(!su.__teliya_boot_patched){su.__teliya_boot_patched=!0;const r=n=>{var o;const a=n==null?void 0:n.reason,i=String((a==null?void 0:a.message)??"");(a==null?void 0:a.code)==="failed-precondition"&&i.includes("create_index")&&(ki(a),(o=n.preventDefault)==null||o.call(n))};window.addEventListener("unhandledrejection",r);const e=n=>{const a=n==null?void 0:n.error,i=String((a==null?void 0:a.message)??"");(a==null?void 0:a.code)==="failed-precondition"&&i.includes("create_index")&&ki(a)};window.addEventListener("error",e);const t=console.error.bind(console);console.error=(...n)=>{const a=n==null?void 0:n[0],i=String((a==null?void 0:a.message)??"");(a==null?void 0:a.code)==="failed-precondition"&&i.includes("create_index")&&ki(a),t(...n)}}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(r=>{r.forEach(e=>e.unregister())});(async()=>{try{await Jh()}catch(e){console.warn("âš ï¸ initFirebase a Ã©chouÃ© â€” on continue :",e)}const r=document.getElementById("root");if(!r){console.error("âŒ Impossible de trouver #root");return}xh.createRoot(r).render(u(Lt.StrictMode,{children:u(bh,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:u(Sw,{})})}))})();export{zd as A,pb as I,S0 as P,ne as _,Ht as a,Zn as b,Nr as c,j as d,p3 as e,e0 as f,Yh as g,Mt as h,ft as i,qh as j,g3 as k,gr as m,Et as s,Tt as u};
