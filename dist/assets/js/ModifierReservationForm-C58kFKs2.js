import{r as p,j as r,aO as l}from"./react-BKlva80Y.js";import{d as g,m as x}from"./firebase-1zyXmG6H.js";import{d as b}from"../index-B9wHCq4m.js";const v=({reservation:a,onClose:d,onUpdated:c})=>{const[e,m]=p.useState({nomClient:a.nomClient||"",telephone:a.telephone||"",depart:a.depart||"",arrivee:a.arrivee||"",date:a.date||"",heure:a.heure||"",seatsGo:a.seatsGo||1,seatsReturn:a.seatsReturn||0,typeVoyage:a.seatsReturn>0?"aller-retour":"aller-simple"}),[n,u]=p.useState(!1),t=o=>{const{name:s,value:i}=o.target;m({...e,[s]:s.includes("seats")?Math.max(0,parseInt(i)):i})},h=async o=>{if(o.preventDefault(),!e.nomClient||!e.telephone||!e.depart||!e.arrivee||!e.date||!e.heure){l.error("Veuillez remplir tous les champs obligatoires.");return}if(e.seatsGo<=0){l.error("Le nombre de places aller doit être supérieur à zéro.");return}if(e.typeVoyage==="aller-retour"&&e.seatsReturn<=0){l.error("Le nombre de places retour doit être supérieur à zéro.");return}u(!0);try{const s=g(b,"reservations",a.id);await x(s,{nomClient:e.nomClient,telephone:e.telephone,depart:e.depart,arrivee:e.arrivee,date:e.date,heure:e.heure,seatsGo:e.seatsGo,seatsReturn:e.typeVoyage==="aller-retour"?e.seatsReturn:0,updatedAt:new Date().toISOString()}),l.success("Réservation mise à jour avec succès ✅"),c(),d()}catch(s){console.error(s),l.error("Erreur lors de la mise à jour.")}finally{u(!1)}};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("form",{onSubmit:h,className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-xl space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Modifier la réservation"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx("input",{name:"nomClient",value:e.nomClient,onChange:t,placeholder:"Nom",className:"border p-2 rounded",required:!0}),r.jsx("input",{name:"telephone",value:e.telephone,onChange:t,placeholder:"Téléphone",className:"border p-2 rounded",required:!0}),r.jsx("input",{name:"depart",value:e.depart,onChange:t,placeholder:"Départ",className:"border p-2 rounded",required:!0}),r.jsx("input",{name:"arrivee",value:e.arrivee,onChange:t,placeholder:"Arrivée",className:"border p-2 rounded",required:!0}),r.jsx("input",{name:"date",type:"date",value:e.date,onChange:t,className:"border p-2 rounded",required:!0}),r.jsx("input",{name:"heure",type:"time",value:e.heure,onChange:t,className:"border p-2 rounded",required:!0})]}),r.jsxs("div",{className:"flex gap-4 items-center",children:[r.jsxs("label",{children:[r.jsx("input",{type:"radio",name:"typeVoyage",value:"aller-simple",checked:e.typeVoyage==="aller-simple",onChange:t})," Aller simple"]}),r.jsxs("label",{children:[r.jsx("input",{type:"radio",name:"typeVoyage",value:"aller-retour",checked:e.typeVoyage==="aller-retour",onChange:t})," Aller-retour"]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx("input",{name:"seatsGo",type:"number",value:e.seatsGo,onChange:t,placeholder:"Places aller",className:"border p-2 rounded",min:1,required:!0}),e.typeVoyage==="aller-retour"&&r.jsx("input",{name:"seatsReturn",type:"number",value:e.seatsReturn,onChange:t,placeholder:"Places retour",className:"border p-2 rounded",min:1,required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-4",children:[r.jsx("button",{type:"button",onClick:d,disabled:n,className:"text-gray-500",children:"Annuler"}),r.jsx("button",{type:"submit",disabled:n,className:`px-4 py-2 rounded text-white ${n?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:n?"Enregistrement...":"Enregistrer"})]})]})})};export{v as M};
