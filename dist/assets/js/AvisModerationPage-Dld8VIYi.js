import{r as a,j as s}from"./react-BKlva80Y.js";import{q as b,B as g,C as y,w as o,j,D as E,k as I,m as S,d as v,z as M}from"./firebase-1zyXmG6H.js";import{u as k,d as r}from"../index-B9wHCq4m.js";import"./vendor-CZDa83Cj.js";const B=()=>{const{user:t}=k(),[d,u]=a.useState([]),[x,p]=a.useState(!0),[h,N]=a.useState(null),[w,A]=a.useState(!0),m=10,i=async(e=!1)=>{if(!(t!=null&&t.companyId))return;p(!0);let n=b(j(r,"avis"),o("companyId","==",t.companyId),o("visible","==",!1),y("nom"),g(m));e&&h&&(n=b(j(r,"avis"),o("companyId","==",t.companyId),o("visible","==",!1),y("nom"),E(h),g(m)));const l=await I(n),f=l.docs.map(c=>({id:c.id,...c.data()}));u(e?c=>[...c,...f]:f),N(l.docs[l.docs.length-1]||null),A(l.size===m),p(!1)};a.useEffect(()=>{i()},[t]);const D=async(e,n)=>{await S(v(r,"avis",e),{visible:!n}),i()},C=async e=>{await M(v(r,"avis",e)),i()};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Modération des avis clients"}),x&&d.length===0&&s.jsx("p",{children:"Chargement des avis..."}),d.length===0&&!x&&s.jsx("p",{children:"Aucun avis en attente pour l’instant ✅"}),s.jsx("ul",{className:"space-y-4",children:d.map(e=>s.jsxs("li",{className:"border p-4 rounded shadow-sm bg-white flex flex-col gap-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h4",{className:"font-semibold",children:[e.nom," — ⭐ ",e.note]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>D(e.id,e.visible),className:`text-sm px-3 py-1 rounded ${e.visible?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:e.visible?"Masquer":"Afficher"}),s.jsx("button",{onClick:()=>C(e.id),className:"text-sm bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded",children:"Supprimer"})]})]}),s.jsx("p",{className:"text-sm text-gray-600 italic",children:e.commentaire})]},e.id))}),w&&s.jsx("div",{className:"flex justify-center mt-6",children:s.jsx("button",{onClick:()=>i(!0),className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Charger plus"})})]})};export{B as default};
