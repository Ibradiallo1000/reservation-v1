import{n as V,j as e,e as T,M as C,S as J,A as B,aU as M,r as m,z as K,aV as _,w as ee,d as se,a1 as te,x as ae,u as L,I as re,aW as le,P as D,aX as ie,aY as q,aZ as ne,a_ as oe,a$ as ce,b0 as de,b1 as me,aB as H,q as U,b2 as xe,G as he,s as Y,b3 as ue,Y as W,b4 as G,t as fe,ac as ge,b as pe}from"./react-BKlva80Y.js";import{y as be,j as z,F as je,q as X,w as F,C as ye,B as ve,k as Z}from"./firebase-1zyXmG6H.js";import{m as h,h as Ne,d as P,s as we,f as Ce,E as ke}from"../index-DdVw6ij9.js";import{A as N}from"./index-DyTjc_nI.js";import{u as Se}from"./useCompanyTheme-DWKbV_iC.js";import"./vendor-CZDa83Cj.js";const $e=({company:s,onSearch:t})=>{const[a,d]=V.useState(""),[o,r]=V.useState(""),n=u=>{u.preventDefault(),t(a,o)};s.couleurSecondaire&&Ae(s.couleurSecondaire);const l="#ffffff",i="#1e293b",c="#334155";return e.jsxs("section",{className:"relative w-full min-h-[700px] md:min-h-[500px] flex items-center justify-center overflow-hidden",children:[s.banniereUrl&&e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx(T.LazyLoadImage,{src:s.banniereUrl,alt:`Bannière ${s.nom}`,className:"w-full h-full object-cover object-[center_60%]",effect:"opacity"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent"})]}),e.jsxs("div",{className:"relative z-10 w-full max-w-6xl px-5 text-center",children:[e.jsx(h.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.7},className:"mb-20 md:mb-10",children:e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-white leading-tight",children:s.accroche||"Réservez vos trajets facilement"})}),e.jsxs(h.form,{onSubmit:n,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.5},className:"flex flex-col items-center justify-center gap-4 border border-white/10 rounded-xl shadow-lg p-4 md:p-6 max-w-4xl mx-auto",style:{backgroundColor:s.couleurSecondaire||"#F8FAFC"},children:[s.instructionRecherche&&e.jsx("p",{className:"w-full text-base md:text-lg font-medium text-center mb-1 md:mb-2 text-white",children:s.instructionRecherche}),e.jsxs("div",{className:"flex flex-col md:flex-row w-full items-center gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"h-5 w-5",style:{color:c}})}),e.jsx("input",{type:"text",placeholder:"Ville de départ",value:a,onChange:u=>d(u.target.value),required:!0,className:"pl-10 pr-3 py-3 w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2",style:{backgroundColor:l,color:i}})]}),e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"h-5 w-5",style:{color:c}})}),e.jsx("input",{type:"text",placeholder:"Ville d'arrivée",value:o,onChange:u=>r(u.target.value),required:!0,className:"pl-10 pr-3 py-3 w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2",style:{backgroundColor:l,color:i}})]}),e.jsxs(h.button,{whileHover:{scale:1.03},whileTap:{scale:.97},type:"submit",className:"w-full md:w-auto px-6 py-3 rounded-lg font-bold text-white text-lg flex items-center justify-center gap-2",style:{backgroundColor:s.couleurPrimaire||"#3B82F6"},children:[e.jsx(J,{className:"h-5 w-5"}),"Rechercher",e.jsx(B,{className:"h-5 w-5"})]})]})]})]}),e.jsx(h.div,{animate:{y:[0,10,0]},transition:{repeat:1/0,duration:2},className:"absolute bottom-8 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"h-8 w-5 border-2 border-white rounded-full flex justify-center",children:e.jsx(h.div,{animate:{y:[0,6]},transition:{repeat:1/0,duration:1.5},className:"h-2 w-1 bg-white rounded-full mt-1"})})}),e.jsx("div",{className:"absolute bottom-0 w-full h-12 bg-gradient-to-t from-[#0f172a] to-transparent z-10 rounded-t-3xl"})]})};function Ae(s){if(!s)return!1;const t=s.substring(1),a=parseInt(t,16),d=a>>16&255,o=a>>8&255,r=a>>0&255;return .2126*d+.7152*o+.0722*r<140}const Ie=({trip:s,index:t,onClick:a,isActive:d=!1})=>{const o=t%2===0?"bg-white/10 hover:bg-white/15":"bg-white/5 hover:bg-white/10";return e.jsxs(h.div,{whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:d?1:.8,y:0,transition:{duration:.3}},className:`w-full p-4 rounded-xl shadow-md cursor-pointer flex items-center gap-4 backdrop-blur-md border border-white/20 transition-all duration-300 ${o}`,onClick:a,"aria-label":`Trajet de ${s.departure} à ${s.arrival} pour ${s.price} FCFA`,children:[e.jsx("div",{className:`p-2 rounded-lg ${t%2===0?"bg-white/20":"bg-white/10"}`,children:e.jsx(M,{className:"h-5 w-5 text-yellow-300"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-1 truncate",children:[s.departure," → ",s.arrival]}),e.jsxs("p",{className:"text-sm text-yellow-300",children:["à partir de ",s.price.toLocaleString()," FCFA"]})]}),e.jsx(B,{className:"h-5 w-5 text-white/50"})]})},Ee=({suggestedTrips:s,colors:t})=>{const[a,d]=m.useState(0),[o,r]=m.useState(!1),n=m.useRef(null);m.useEffect(()=>{if(s.length<=1)return;const i=setInterval(()=>{o||d(c=>(c+1)%s.length)},4e3);return()=>clearInterval(i)},[s.length,o]);const l=m.useCallback(i=>{console.log("Trajet sélectionné:",i)},[]);return e.jsx("div",{className:"relative h-[220px] overflow-hidden",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),ref:n,children:e.jsx(N,{mode:"wait",children:e.jsx(h.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},transition:{duration:.5},className:"absolute inset-0 flex flex-col gap-4",children:s.slice(a,a+3).map((i,c)=>e.jsx(Ie,{trip:i,index:a+c,onClick:()=>l(i),isActive:c===0},`${a}-${c}`))},a)})})},Fe=[{icon:K,title:"Sécurité maximale",description:"Véhicules contrôlés régulièrement et conducteurs professionnels pour votre sécurité."},{icon:_,title:"Ponctualité",description:"Départs et arrivées à l’heure grâce à notre système de gestion optimisée."},{icon:ee,title:"Support 24/7",description:"Notre équipe est disponible à tout moment pour répondre à vos questions."},{icon:M,title:"Confort premium",description:"Sièges spacieux, climatisation et WiFi à bord pour votre confort."}];function Le({services:s=Fe,colors:t,isMobile:a}){const[d,o]=m.useState(0),r=i=>{o(c=>i==="prev"?c===0?s.length-1:c-1:c===s.length-1?0:c+1)};m.useEffect(()=>{const i=setInterval(()=>r("next"),5e3);return()=>clearInterval(i)},[s.length]);const n=s[d],l=n.icon;return e.jsxs(h.section,{className:"px-4 py-16 bg-white relative overflow-hidden",initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{duration:.8},children:[e.jsx("div",{className:"absolute inset-0 bg-[url('/world-map.svg')] bg-center bg-cover opacity-5 pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-3 text-gray-900",children:"Nos services exclusifs"}),e.jsx("div",{className:"h-1 w-24 mx-auto rounded-full",style:{backgroundColor:t.primary}})]}),e.jsx("div",{className:"relative h-[200px] md:h-[220px] overflow-hidden rounded-2xl border border-gray-200 shadow bg-white",children:e.jsx(N,{mode:"wait",children:e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.6},className:"absolute inset-0 p-6 flex flex-col justify-center text-center",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-4 rounded-full",style:{background:Ne(t.primary,.1)},children:e.jsx(l,{className:"h-8 w-8",style:{color:t.primary}})}),e.jsx("h3",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:n.title})]}),e.jsx("p",{className:"text-gray-600 text-base md:text-lg max-w-2xl mx-auto",children:n.description})]},d)})}),e.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[e.jsx("button",{className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition",onClick:()=>r("prev"),"aria-label":"Précédent",children:e.jsx(se,{className:"h-5 w-5 text-gray-800"})}),e.jsx("div",{className:"flex items-center gap-2",children:s.map((i,c)=>e.jsx("button",{className:`h-3 rounded-full transition-all ${d===c?"bg-gray-800 w-6":"bg-gray-300 w-3"}`,onClick:()=>o(c),"aria-label":`Service ${c+1}`},c))}),e.jsx("button",{className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition",onClick:()=>r("next"),"aria-label":"Suivant",children:e.jsx(te,{className:"h-5 w-5 text-gray-800"})})]})]})]})}const ze=({companyId:s,onSuccess:t,primaryColor:a})=>{const[d,o]=m.useState(""),[r,n]=m.useState(0),[l,i]=m.useState(""),[c,u]=m.useState(null),[f,p]=m.useState(!1),y=async x=>{if(x.preventDefault(),!d.trim()||r<1||!l.trim()){u("Veuillez remplir tous les champs et choisir une note.");return}try{p(!0),await be(z(P,"avis"),{nom:d,note:r,commentaire:l,visible:!1,companyId:s,createdAt:je()}),u("Merci pour votre avis ! Il sera publié après validation."),o(""),n(0),i(""),t&&t()}catch(w){console.error(w),u("Erreur lors de l'envoi. Veuillez réessayer.")}finally{p(!1)}};return e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c&&e.jsx("p",{className:"text-sm text-gray-600 italic",children:c}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Votre nom"}),e.jsx("input",{type:"text",value:d,onChange:x=>o(x.target.value),className:"w-full border px-3 py-2 rounded",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Votre note"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(x=>e.jsx(ae,{onClick:()=>n(x),className:`h-6 w-6 cursor-pointer ${x<=r?"text-yellow-400":"text-gray-300"}`,fill:x<=r?"#facc15":"none"},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Votre avis"}),e.jsx("textarea",{value:l,onChange:x=>i(x.target.value),className:"w-full border px-3 py-2 rounded",rows:4,required:!0})]}),e.jsx("button",{type:"submit",disabled:f,className:"text-white px-4 py-2 rounded hover:opacity-90 transition",style:{backgroundColor:a},children:f?"Envoi en cours...":"Envoyer mon avis"})]})},Pe=({company:s})=>{const[t,a]=m.useState(!1);L();const d=new Date().getFullYear(),{id:o,slug:r,nom:n,couleurPrimaire:l,couleurSecondaire:i,description:c,email:u,telephone:f,adresse:p,horaires:y,socialMedia:x={},footerConfig:w={}}=s,{showAbout:A=!0,showContact:I=!0,showSocial:k=!0,showTestimonials:S=!0,showLegalLinks:$=!0,customLinks:j=[]}=w;return e.jsxs("footer",{className:"relative w-full overflow-hidden",style:{backgroundColor:i||"#f8fafc",color:"#1e293b"},children:[e.jsx("div",{className:"absolute inset-0 bg-[url('/world-map.svg')] bg-center bg-cover opacity-5 pointer-events-none"}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[A&&e.jsxs(h.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(re,{className:"h-5 w-5",style:{color:l}}),e.jsx("h3",{className:"text-lg font-semibold",children:"À propos"})]}),e.jsx("p",{className:"text-sm text-gray-700",children:c||"Votre compagnie de transport préférée, offrant des services de qualité."})]}),I&&e.jsxs(h.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(le,{className:"h-5 w-5",style:{color:l}}),e.jsx("h3",{className:"text-lg font-semibold",children:"Contact"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[f&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("a",{href:`tel:${f}`,className:"hover:underline",children:f})]}),u&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("a",{href:`mailto:${u}`,className:"hover:underline",children:u})]}),p&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx("span",{children:p})]}),y&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:y})]})]})]}),k&&Object.values(x).some(Boolean)&&e.jsxs(h.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(q,{className:"h-5 w-5",style:{color:l}}),e.jsx("h3",{className:"text-lg font-semibold",children:"Suivez-nous"})]}),e.jsxs("div",{className:"flex gap-4",children:[x.facebook&&e.jsx("a",{href:x.facebook,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ne,{className:"h-6 w-6 hover:opacity-80 transition"})}),x.instagram&&e.jsx("a",{href:x.instagram,target:"_blank",rel:"noopener noreferrer",children:e.jsx(oe,{className:"h-6 w-6 hover:opacity-80 transition"})}),x.twitter&&e.jsx("a",{href:x.twitter,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ce,{className:"h-6 w-6 hover:opacity-80 transition"})}),x.linkedin&&e.jsx("a",{href:x.linkedin,target:"_blank",rel:"noopener noreferrer",children:e.jsx(de,{className:"h-6 w-6 hover:opacity-80 transition"})}),x.youtube&&e.jsx("a",{href:x.youtube,target:"_blank",rel:"noopener noreferrer",children:e.jsx(me,{className:"h-6 w-6 hover:opacity-80 transition"})})]})]}),S&&e.jsx(h.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(q,{className:"h-5 w-5",style:{color:l}}),e.jsx("h3",{className:"text-lg font-semibold",children:"Avis clients"})]}),e.jsxs(h.button,{onClick:()=>a(!t),className:"flex items-center justify-between px-4 py-2 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:l||"#3B82F6",color:"white"},whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("span",{children:"Donner votre avis"}),t?e.jsx(H,{className:"h-4 w-4 ml-2"}):e.jsx(U,{className:"h-4 w-4 ml-2"})]}),t&&e.jsx(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"mt-4",children:e.jsx(ze,{companyId:o,primaryColor:l||"#3B82F6",onSuccess:()=>a(!1)})})})]})})]}),($||(j==null?void 0:j.length)>0)&&e.jsx("div",{className:"border-t py-6 text-center text-sm relative z-10",style:{borderColor:l?`${l}20`:"#e2e8f0"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-2",children:[$&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`/compagnie/${r}/mentions-legales`,className:"hover:underline",children:"Mentions légales"}),e.jsx("a",{href:`/compagnie/${r}/confidentialite`,className:"hover:underline",children:"Politique de confidentialité"}),e.jsx("a",{href:`/compagnie/${r}/cgu`,className:"hover:underline",children:"Conditions générales"}),e.jsx("a",{href:`/compagnie/${r}/cookies`,className:"hover:underline",children:"Politique des cookies"})]}),j==null?void 0:j.map((v,E)=>e.jsx("a",{href:v.url,className:"hover:underline",target:v.external?"_blank":"_self",rel:v.external?"noopener noreferrer":"",children:v.label},E))]}),e.jsxs("p",{children:["© ",d," ",n||"Notre Compagnie",". Tous droits réservés."]})]})})]})},Re=({agence:s,primaryColor:t})=>e.jsxs(h.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{duration:.2},className:"p-5 my-3 rounded-xl shadow-sm hover:shadow-md transition-all",style:{backgroundColor:"#ffffff",borderLeft:`4px solid ${t}`,boxShadow:"0 2px 12px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",style:{color:t},children:s.nomAgence}),s.latitude&&s.longitude&&e.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${s.latitude},${s.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{children:"Maps"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:e.jsx(he,{className:"h-4 w-4",style:{color:t}})}),e.jsx("span",{className:"text-gray-700",children:s.pays})]}),s.quartier&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:e.jsx(C,{className:"h-4 w-4",style:{color:t}})}),e.jsx("span",{className:"text-gray-700",children:s.quartier})]}),s.telephone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:e.jsx(D,{className:"h-4 w-4",style:{color:t}})}),e.jsx("a",{href:`tel:${s.telephone}`,className:"text-gray-700 hover:underline hover:text-gray-900 transition-colors",children:s.telephone})]})]})]}),Ve=({groupedByVille:s,openVilles:t,toggleVille:a,onClose:d,primaryColor:o,classes:r,t:n})=>e.jsx(h.section,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4",onClick:d,children:e.jsxs(h.div,{className:"relative w-full max-w-3xl max-h-[85vh] overflow-y-auto rounded-2xl",initial:{scale:.96,y:20},animate:{scale:1,y:0},exit:{scale:.96,y:20},transition:{type:"spring",damping:25},onClick:l=>l.stopPropagation(),style:{backgroundColor:"#ffffff",boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{className:"sticky top-0 p-5 flex justify-between items-center z-10 border-b border-gray-100",style:{backdropFilter:"blur(12px)",backgroundColor:"rgba(255,255,255,0.85)"},children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:o},children:n("ourAgencies")}),e.jsx("button",{onClick:d,className:"p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":n("close"),children:e.jsx(Y,{className:"h-6 w-6 text-gray-600"})})]}),e.jsx("div",{className:"p-5",children:Object.entries(s).map(([l,i])=>e.jsxs("div",{className:"mb-5",children:[e.jsxs(h.button,{onClick:()=>a(l),className:"w-full text-left py-4 px-5 rounded-xl flex justify-between items-center transition-colors",whileHover:{backgroundColor:"rgba(0,0,0,0.03)"},style:{backgroundColor:t[l]?"rgba(0,0,0,0.02)":"transparent",color:"#333"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-lg",children:l}),e.jsxs("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:`${o}20`,color:o},children:[i.length," ",i.length>1?n("agencies"):n("agency")]})]}),t[l]?e.jsx(H,{className:"h-5 w-5 text-gray-500"}):e.jsx(U,{className:"h-5 w-5 text-gray-500"})]}),e.jsx(N,{children:t[l]&&e.jsx(h.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut"},className:"overflow-hidden pl-5 ml-2 border-l-2",style:{borderColor:`${o}40`},children:i.map((c,u)=>e.jsx(Re,{agence:c,primaryColor:o},`${c.id}-${u}`))})})]},l))})]})}),qe=({companyId:s,primaryColor:t})=>{const[a,d]=m.useState([]),[o,r]=m.useState(0);if(m.useEffect(()=>{if(!s)return;(async()=>{try{const i=X(z(P,"avis"),F("companyId","==",s),F("visible","==",!0),ye("note","desc"),ve(10)),u=(await Z(i)).docs.map(f=>({id:f.id,...f.data()}));d(u)}catch(i){console.error("Erreur lors du chargement des avis:",i)}})()},[s]),m.useEffect(()=>{if(a.length<=1)return;const l=setInterval(()=>{r(i=>(i+1)%a.length)},5e3);return()=>clearInterval(l)},[a]),a.length===0)return null;const n=a[o];return e.jsxs("div",{className:"max-w-2xl mx-auto py-12 text-center",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",style:{color:t},children:"Ce que disent nos clients"}),e.jsx(N,{mode:"wait",children:e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5},className:"p-6 bg-white shadow rounded-lg",children:[e.jsxs("p",{className:"italic text-gray-700 mb-3",children:['"',n.commentaire,'"']}),e.jsxs("p",{className:"font-medium text-gray-900",children:[n.nom," — ⭐ ",n.note]})]},n.id)}),e.jsx("div",{className:"flex justify-center gap-2 mt-4",children:a.map((l,i)=>e.jsx("button",{onClick:()=>r(i),className:`w-3 h-3 rounded-full transition-all ${o===i?"bg-blue-600 scale-110":"bg-gray-300"}`},i))})]})},Te=({canvasRef:s})=>(m.useEffect(()=>{const t=s.current;if(!t)return;const a=t.getContext("2d");if(!a)return;t.width=t.offsetWidth,t.height=t.offsetHeight,a.fillStyle="rgba(10, 10, 20, 0.95)",a.fillRect(0,0,t.width,t.height);const d=100;for(let o=0;o<d;o++){const r=Math.random()*t.width,n=Math.random()*t.height,l=Math.random()*1.2,i=Math.random()*.8+.2;a.beginPath(),a.arc(r,n,l,0,Math.PI*2),a.fillStyle=`rgba(255, 255, 255, ${i})`,a.fill()}},[]),null),Be=({onClose:s,navigate:t,onShowAgencies:a,slug:d,colors:o,classes:r,config:n,t:l})=>{const i=m.useRef(null);return e.jsxs(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"fixed top-20 right-4 left-4 z-50 rounded-xl shadow-2xl overflow-hidden",children:[e.jsx("canvas",{ref:i,className:"absolute inset-0 w-full h-full"}),e.jsx(Te,{canvasRef:i}),e.jsx("div",{className:"relative z-10 p-4 text-white",children:e.jsxs("nav",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>{a(),s()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${r.button}`,"aria-label":l("ourAgencies"),children:[e.jsx(C,{className:"h-5 w-5 text-blue-300"}),e.jsx("span",{className:"font-medium",children:l("ourAgencies")})]}),e.jsxs("button",{onClick:()=>{t(`/compagnie/${d}/mes-reservations`),s()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${r.button}`,"aria-label":l("myBookings"),children:[e.jsx(ue,{className:"h-5 w-5 text-green-300"}),e.jsx("span",{className:"font-medium",children:l("myBookings")})]}),e.jsxs("button",{onClick:()=>{t("/login"),s()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${r.button}`,"aria-label":l("login"),children:[e.jsx(W,{className:"h-5 w-5 text-yellow-300"}),e.jsx("span",{className:"font-medium",children:l("login")})]})]})})]})},Me=()=>{const{i18n:s}=G(),t=a=>{s.changeLanguage(a)};return e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsx("button",{onClick:()=>t("fr"),className:"hover:underline",children:"🇫🇷"}),e.jsx("button",{onClick:()=>t("en"),className:"hover:underline",children:"🇬🇧"})]})},_e=({company:s,slug:t,colors:a,classes:d,config:o,menuOpen:r,setMenuOpen:n,setShowAgences:l,navigate:i,t:c})=>{const u="/default-logo.png",f="#ffffff";return we(a.primary||"#ffffff"),e.jsxs("header",{className:"relative z-50 w-full shadow-sm",style:{background:f},children:[e.jsx("svg",{viewBox:"0 0 1440 100",className:"absolute bottom-0 left-0 w-full h-20",preserveAspectRatio:"none",children:e.jsx("path",{fill:a.secondary||a.primary||"#facc15",d:"M0,0 C480,100 960,0 1440,100 L1440,0 L0,0 Z"})}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-white border border-gray-200 overflow-hidden shadow",children:e.jsx(T.LazyLoadImage,{src:s.logoUrl||u,alt:`Logo ${s.nom||"Compagnie"}`,className:"w-full h-full object-contain",onError:p=>p.target.src=u})}),e.jsx("h1",{className:"text-xl font-bold tracking-tight ml-2 text-slate-800",children:s.nom||c("ourCompany")}),e.jsx("div",{className:"ml-4 hidden md:block",children:e.jsx(Me,{})})]}),e.jsxs("nav",{className:"hidden md:flex gap-6 items-center text-sm",children:[e.jsx("button",{onClick:()=>l(!0),className:"font-medium text-slate-700 hover:text-slate-900 transition",children:c("ourAgencies")}),e.jsx("button",{onClick:()=>i(`/compagnie/${t}/mes-reservations`),className:"font-medium text-slate-700 hover:text-slate-900 transition",children:c("myBookings")}),e.jsx("button",{onClick:()=>i("/login"),className:"p-2 rounded-full bg-slate-100 hover:bg-slate-200 transition","aria-label":c("login"),children:e.jsx(W,{className:"h-5 w-5 text-slate-700"})})]}),e.jsx("div",{className:"md:hidden flex items-center",children:e.jsx("button",{onClick:()=>n(!r),className:"p-2 rounded-md border border-gray-300 bg-white shadow","aria-label":"Menu",children:r?e.jsx(Y,{className:"h-6 w-6 text-slate-800"}):e.jsx(fe,{className:"h-6 w-6 text-slate-800"})})})]}),e.jsx(N,{children:r&&e.jsx(Be,{onClose:()=>n(!1),navigate:p=>{i(p),n(!1)},onShowAgencies:()=>{l(!0),n(!1)},slug:t,colors:a,classes:d,config:o,t:c})})]})},De=({message:s="La page demandée est introuvable.",primaryColor:t,buttonLabel:a="Retour à l'accueil"})=>{const d=L();return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black text-white p-6",children:e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md",children:[e.jsx(ge,{className:"mx-auto mb-4 h-16 w-16 text-red-500"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Erreur 404"}),e.jsx("p",{className:"mb-6 text-gray-300",children:s}),e.jsx("button",{onClick:()=>d("/"),className:"px-6 py-3 rounded-lg font-semibold text-white transition shadow-lg",style:{backgroundColor:t},children:a})]})})},Ze=({company:s,isMobile:t=!1})=>{const{slug:a}=pe(),d=L(),{t:o}=G(),r=s,{colors:n,classes:l,config:i}=Se(r),[c,u]=m.useState([]),[f,p]=m.useState([]),[y,x]=m.useState(!1),[w,A]=m.useState(!1),[I,k]=m.useState(!r),[S,$]=m.useState(null),[j,v]=m.useState({}),E=b=>{v(g=>({...g,[b]:!g[b]}))},O=m.useMemo(()=>c.reduce((b,g)=>(b[g.ville]||(b[g.ville]=[]),b[g.ville].push(g),b),{}),[c]);return m.useEffect(()=>{r&&(async()=>{if(r!=null&&r.id)try{k(!0);const g=X(z(P,"agences"),F("companyId","==",r.id)),Q=await Z(g);u(Q.docs.map(R=>({id:R.id,...R.data()})))}catch(g){console.error("Erreur chargement agences",g),$(o("loadingError"))}finally{k(!1)}})()},[r,o]),I?e.jsx(Ce,{message:o("loading"),colors:{primary:n.primary,text:n.text,background:n.background}}):S?e.jsx(ke,{error:S,colors:n,classes:l,t:o,navigate:d,slug:a}):!r||!a?e.jsx(De,{primaryColor:n.primary}):e.jsxs("div",{className:`min-h-screen flex flex-col ${i.typography}`,style:{backgroundColor:n.background||"#ffffff",color:n.text},children:[e.jsx(_e,{company:r,colors:n,classes:l,config:i,menuOpen:w,setMenuOpen:A,setShowAgences:x,isMobile:t,t:o,slug:a,navigate:d}),e.jsxs("main",{className:"flex-grow",children:[e.jsx($e,{company:r,onSearch:(b,g)=>{d(`/${a}/resultats?departure=${encodeURIComponent(b)}&arrival=${encodeURIComponent(g)}`)},isMobile:t}),e.jsx(qe,{companyId:r.id,primaryColor:n.primary,isMobile:t}),f.length>0&&e.jsx(Ee,{suggestedTrips:f,colors:n,isMobile:t}),e.jsx(Le,{colors:n,isMobile:t}),e.jsx(N,{children:y&&e.jsx(Ve,{groupedByVille:O,openVilles:j,toggleVille:E,onClose:()=>x(!1),primaryColor:n.primary,classes:l,t:o,isMobile:t})})]}),e.jsx(Pe,{company:r,isMobile:t})]})};export{Ze as default};
