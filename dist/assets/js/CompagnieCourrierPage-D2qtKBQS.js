import{r as a,j as e}from"./react-BKlva80Y.js";import{q as N,w,j,k as C,y as A,T as D}from"./firebase-1zyXmG6H.js";import{u as I,d as y}from"../index-BlZmgUmn.js";import"./vendor-CZDa83Cj.js";const R=()=>{const{user:t}=I(),[n,v]=a.useState([]),[r,d]=a.useState(""),[l,c]=a.useState(""),[o,u]=a.useState(""),[i,p]=a.useState(""),[m,x]=a.useState(!1),h=async()=>{if(!(t!=null&&t.companyId))return;const s=N(j(y,"courriers"),w("companyId","==",t.companyId)),f=(await C(s)).docs.map(g=>({id:g.id,...g.data()}));v(f)},b=async()=>{if(!(!r||!l||!o||!i||!(t!=null&&t.companyId))){x(!0);try{await A(j(y,"courriers"),{companyId:t.companyId,description:r,receiver:l,departure:o,arrival:i,status:"En attente",createdAt:D.now()}),d(""),c(""),u(""),p(""),await h()}catch(s){console.error("Erreur ajout courrier :",s)}x(!1)}};return a.useEffect(()=>{h()},[t]),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Gestion des courriers"}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsx("h2",{className:"font-semibold text-lg mb-3",children:"Ajouter un courrier"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Description",value:r,onChange:s=>d(s.target.value),className:"border p-2 rounded w-full"}),e.jsx("input",{type:"text",placeholder:"Destinataire",value:l,onChange:s=>c(s.target.value),className:"border p-2 rounded w-full"}),e.jsx("input",{type:"text",placeholder:"Ville de départ",value:o,onChange:s=>u(s.target.value),className:"border p-2 rounded w-full"}),e.jsx("input",{type:"text",placeholder:"Ville d’arrivée",value:i,onChange:s=>p(s.target.value),className:"border p-2 rounded w-full"})]}),e.jsx("button",{onClick:b,disabled:m,className:"mt-4 bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700",children:m?"Ajout...":"Ajouter"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[e.jsx("h2",{className:"font-semibold text-lg mb-3",children:"Liste des courriers"}),n.length===0?e.jsx("p",{className:"text-gray-500",children:"Aucun courrier enregistré."}):e.jsx("ul",{className:"divide-y",children:n.map(s=>e.jsx("li",{className:"py-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.description}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.departure," → ",s.arrival," | Destinataire : ",s.receiver]})]}),e.jsx("span",{className:"text-sm text-gray-500 italic",children:s.status})]})},s.id))})]})]})};export{R as default};
