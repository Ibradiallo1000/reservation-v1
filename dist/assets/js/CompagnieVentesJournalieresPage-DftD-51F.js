import{r as s,a,j as e,F as j}from"./react-DgrrIcw2.js";import{q as g,w as m,k as u,l as b}from"./firebase-eGIzIftJ.js";import{u as q,d as N}from"../index-p6Te0bSg.js";import{J as D}from"./vendor-BHjJ2Hjk.js";const V=()=>{const{user:n}=q(),[y,f]=s.useState([]),[l,x]=s.useState(""),[d,w]=s.useState(()=>D(new Date,"yyyy-MM-dd")),[i,I]=s.useState([]),[v,h]=s.useState(!1),C=async()=>{if(!(n!=null&&n.companyId))return;const t=g(u(N,"agences"),m("companyId","==",n.companyId)),p=(await b(t)).docs.map(o=>({id:o.id,ville:o.data().ville}));f(p)},S=async()=>{if(!d||!(n!=null&&n.companyId))return;h(!0);const t=g(u(N,"reservations"),m("compagnieId","==",n.companyId),m("statut","==","payÃ©")),o=(await b(t)).docs.map(c=>({id:c.id,...c.data()})).filter(c=>c.date===d&&(!l||c.agencyId===l));I(o),h(!1)};s.useEffect(()=>{C()},[]),s.useEffect(()=>{S()},[d,l]);const A=i.reduce((t,r)=>t+(r.montant||0),0);return a("div",{className:"p-6 bg-white min-h-screen",children:[e("h1",{className:"text-2xl font-bold mb-6",children:"ðŸ“… Ventes journaliÃ¨res par agence"}),a("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e("input",{type:"date",value:d,onChange:t=>w(t.target.value),className:"border p-2 rounded"}),a("select",{value:l,onChange:t=>x(t.target.value),className:"border p-2 rounded",children:[e("option",{value:"",children:"Toutes les agences"}),y.map(t=>e("option",{value:t.id,children:t.ville},t.id))]}),e("button",{onClick:()=>window.print(),className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Imprimer"})]}),v?e("p",{className:"text-gray-600",children:"Chargement..."}):a(j,{children:[a("div",{className:"text-right mb-2 font-semibold text-green-700",children:["Total encaissÃ© : ",A.toLocaleString()," FCFA"]}),a("table",{className:"w-full text-sm border-collapse",children:[e("thead",{className:"bg-gray-100",children:a("tr",{children:[e("th",{className:"border p-2",children:"#"}),e("th",{className:"border p-2",children:"Client"}),e("th",{className:"border p-2",children:"TÃ©lÃ©phone"}),e("th",{className:"border p-2",children:"Trajet"}),e("th",{className:"border p-2",children:"Heure"}),e("th",{className:"border p-2",children:"Montant"}),e("th",{className:"border p-2",children:"Canal"})]})}),e("tbody",{children:i.length===0?e("tr",{children:e("td",{colSpan:7,className:"text-center text-gray-500 p-4",children:"Aucune vente trouvÃ©e."})}):i.map((t,r)=>a("tr",{children:[e("td",{className:"border p-2 text-center",children:r+1}),e("td",{className:"border p-2",children:t.nomClient}),e("td",{className:"border p-2",children:t.telephone}),a("td",{className:"border p-2",children:[t.depart," â†’ ",t.arrivee]}),e("td",{className:"border p-2 text-center",children:t.heure}),e("td",{className:"border p-2 text-right",children:t.montant.toLocaleString()}),e("td",{className:"border p-2 text-center",children:t.canal==="guichet"?"Guichet":"En ligne"})]},t.id))})]})]})]})};export{V as default};
