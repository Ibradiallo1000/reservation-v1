import{r as n,j as e,a,W as be,a$ as ve,D as Ne,Z as we,B as Ce,E as _,F,d as se,l as re,A as ne,aF as Se,aE as Ee,at as ke,b0 as Pe,aD as Ie,aC as Ae,b1 as Me}from"./react-KXT1Riez.js";import{q as I,o as P,y as T,r as J,w as Q,t as Y,u as ee,U as De,O as _e,v as oe,T as Te,G as je,f as Le,P as Ue,X as qe}from"./firebase-DYTOaTLw.js";import{u as j,I as $e,d as E,a as R,m as B,A as V,c as Fe,e as Re}from"../index-b0dmvJTQ.js";import Be from"./ParametresPlan-BRZYH72y.js";import"./vendor-B27hBV_J.js";const Ve=({companyId:N})=>{const{user:s}=j(),f=N??(s==null?void 0:s.companyId),[l,b]=n.useState({accroche:"",instructionRecherche:"",logoUrl:"",faviconUrl:"",banniereUrl:"",couleurPrimaire:"#3B82F6",couleurSecondaire:"#10B981",couleurAccent:"#FBBF24",couleurTertiaire:"#F472B6",themeStyle:"moderne"}),[p,u]=n.useState({text:"",type:""}),[m,v]=n.useState(null),[o,r]=n.useState(null);n.useEffect(()=>{if(!f)return;(async()=>{try{const d=await I(P(E,"companies",f));d.exists()&&b(g=>({...g,...d.data()}))}catch(d){console.error("Erreur chargement vitrine:",d)}})()},[f]);const y=async()=>{if(f){u({text:"Enregistrement...",type:"info"});try{await T(P(E,"companies",f),l),u({text:"Modifications enregistrÃ©es",type:"success"})}catch(i){console.error(i),u({text:"Erreur lors de l'enregistrement",type:"error"})}}},C=i=>{m&&(b(d=>({...d,...m==="logo"&&{logoUrl:i},...m==="favicon"&&{faviconUrl:i},...m==="banniereStatique"&&{banniereUrl:i}})),v(null))};return e("div",{className:"min-h-screen bg-gray-50 py-8 px-6",children:a("div",{className:"max-w-5xl mx-auto space-y-8",children:[a("div",{className:"bg-white rounded-xl shadow-md p-6 border-l-4 flex items-center gap-4",style:{borderLeftColor:l.couleurPrimaire},children:[e(be,{className:"h-8 w-8 text-gray-700"}),a("div",{children:[e("h1",{className:"text-2xl font-bold",children:"Personnalisation de la vitrine"}),e("p",{className:"text-gray-500",children:"Configuration de la page publique"})]})]}),a("div",{className:"bg-white rounded-xl p-6 border space-y-4",children:[a("h3",{className:"font-semibold flex items-center gap-2",children:[e(ve,{}),"Textes personnalisÃ©s"]}),e("input",{type:"text",placeholder:"Phrase d'accroche",value:l.accroche,onChange:i=>b({...l,accroche:i.target.value}),className:"w-full border rounded-lg px-4 py-2"}),e("input",{type:"text",placeholder:"Instruction de recherche",value:l.instructionRecherche,onChange:i=>b({...l,instructionRecherche:i.target.value}),className:"w-full border rounded-lg px-4 py-2"})]}),a("div",{className:"bg-white rounded-xl p-6 border",children:[a("h3",{className:"font-semibold flex items-center gap-2 mb-4",children:[e(Ne,{}),"Couleurs"]}),e("div",{className:"grid grid-cols-2 gap-6",children:["couleurPrimaire","couleurSecondaire","couleurAccent","couleurTertiaire"].map(i=>a("div",{children:[e("div",{className:"h-10 w-10 rounded border cursor-pointer",style:{backgroundColor:l[i]},onClick:()=>r(i)}),o===i&&e(we,{color:l[i],onChange:d=>b({...l,[i]:d})})]},i))})]}),a("div",{className:"bg-white rounded-xl p-6 border space-y-4",children:[a("h3",{className:"font-semibold flex items-center gap-2",children:[e(Ce,{}),"Images"]}),e("button",{onClick:()=>v("logo"),className:"px-4 py-2 bg-gray-100 rounded",children:"Modifier logo"}),e("button",{onClick:()=>v("favicon"),className:"px-4 py-2 bg-gray-100 rounded",children:"Modifier favicon"}),e("button",{onClick:()=>v("banniereStatique"),className:"px-4 py-2 bg-gray-100 rounded",children:"Modifier banniÃ¨re"})]}),e("div",{className:"flex justify-end",children:a("button",{onClick:y,className:"px-6 py-3 rounded text-white",style:{backgroundColor:l.couleurPrimaire},children:[e(_,{size:18,className:"inline mr-2"}),"Enregistrer"]})}),m&&f&&e($e,{companyId:f,onSelect:C,onClose:()=>v(null)})]})})},ze={admin_compagnie:"CEO / PropriÃ©taire",financial_director:"Directeur financier (DAF)",company_accountant:"Comptable (compagnie)",chef_agence:"Chef dâ€™agence",comptable_agence:"Comptable (agence)",guichetier:"Guichetier",agent_courrier:"Agent de courrier"},Oe=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,te=/^\d{8,15}$/,We=/^\d{6}$/,L=N=>N.trim().replace(/\s+/g," ").toLowerCase().replace(new RegExp("(^|\\s)\\p{L}","gu"),s=>s.toUpperCase()),D=N=>!N||N.trim()==="",Ge=({companyId:N})=>{const{user:s}=j(),[f,l]=n.useState([]),[b,p]=n.useState([]),[u,m]=n.useState(!1),[v,o]=n.useState(""),[r,y]=n.useState(""),[C,i]=n.useState(""),[d,g]=n.useState(""),[S,k]=n.useState(""),[z,O]=n.useState("company_accountant"),[A,q]=n.useState(null),[W,G]=n.useState(""),[M,H]=n.useState(""),[$,X]=n.useState("company_accountant"),ie=async()=>{if(!(s!=null&&s.companyId))return;const t=J(Y(E,"agences"),Q("companyId","==",s.companyId)),x=(await ee(t)).docs.map(c=>({id:c.id,nomAgence:c.data().nomAgence,companyId:c.data().companyId}));p(x)},Z=async()=>{if(s!=null&&s.companyId)try{const t=J(Y(E,"users"),Q("companyId","==",s.companyId)),x=(await ee(t)).docs.map(c=>({id:c.id,...c.data()})).filter(c=>c.role!=="admin_plateforme").sort((c,w)=>(c.displayName||"").localeCompare(w.displayName||""));l(x)}catch(t){console.error("loadStaff err:",t),o("âŒ Erreur lors du chargement du personnel.")}};n.useEffect(()=>{ie(),Z()},[s==null?void 0:s.companyId]);const ce=()=>{y(""),i(""),g(""),k(""),O("company_accountant")},le=()=>{const t=[];return D(r)&&t.push("le nom complet"),(D(C)||!Oe.test(C))&&t.push("un email valide"),(D(d)||!te.test(d))&&t.push("un tÃ©lÃ©phone composÃ© de 8 Ã  15 chiffres"),We.test(S)||t.push("un mot de passe de 6 chiffres"),t.length?(o("âš ï¸ Merci de renseigner "+t.join(", ")+"."),!1):!0},de=async()=>{if(!(s!=null&&s.companyId)){o("âš ï¸ Aucune compagnie associÃ©e.");return}if(le()){m(!0),o("");try{const t=L(r),h=await De(R,C.trim().toLowerCase(),S);await _e(h.user,{displayName:t});const x=h.user.uid,c=P(E,"users",x);await oe(c,{uid:x,email:C.trim().toLowerCase(),displayName:t,telephone:d.trim(),role:z,active:!0,companyId:s.companyId,agencyId:null,createdAt:Te.now()},{merge:!0}),o("âœ… Personnel ajoutÃ© avec succÃ¨s."),ce(),await Z()}catch(t){console.error("handleAdd err:",t),o((t==null?void 0:t.code)==="auth/email-already-in-use"?"âš ï¸ Cet email est dÃ©jÃ  utilisÃ©.":"âŒ Ajout impossible. Voir la console.")}finally{m(!1)}}},K=async(t,h)=>{m(!0),o("");try{const x=P(E,"users",t.uid);await T(x,{active:h}),l(c=>c.map(w=>w.uid===t.uid?{...w,active:h}:w))}catch(x){console.error("toggleActive err:",x),o("âŒ Erreur lors du changement de statut.")}finally{m(!1)}},ue=t=>{q(t.uid),G(t.displayName||""),H(t.telephone||""),X(t.role)},me=async()=>{if(!A)return;const t=L(W||"");if(D(t)){o("âš ï¸ Le nom est obligatoire.");return}if(D(M)||!te.test(M)){o("âš ï¸ TÃ©lÃ©phone invalide. 8â€“15 chiffres.");return}m(!0),o("");try{const h=P(E,"users",A);if(!(await I(h)).exists())throw new Error("User introuvable");await T(h,{displayName:t,telephone:M.trim(),role:$}),l(c=>c.map(w=>w.uid===A?{...w,displayName:t,telephone:M.trim(),role:$}:w)),q(null)}catch(h){console.error("edit save err:",h),o("âŒ Erreur lors de la modification.")}finally{m(!1)}},pe=async t=>{if(window.confirm(`Supprimer dÃ©finitivement "${t.displayName}" ?
Cette action effacera aussi son compte d'authentification.`)){m(!0),o("");try{const x=P(E,"users",t.uid);(await I(x)).exists()&&await je(x);const w=Le();await Ue(w,"adminDeleteUser")({uid:t.uid}),l(ye=>ye.filter(xe=>xe.uid!==t.uid)),o("âœ… Compte supprimÃ© partout.")}catch(x){console.error("delete err:",x),o("âŒ Suppression partielle. VÃ©rifie la console et la Cloud Function.")}finally{m(!1)}}},he=n.useMemo(()=>{const t=new Map;return b.forEach(h=>t.set(h.id,h.nomAgence)),t},[b]),ge=n.useMemo(()=>{const t={};for(const h of f){const x=h.agencyId?String(h.agencyId):"__company__";t[x]||(t[x]=[]),t[x].push(h)}return Object.values(t).forEach(h=>h.sort((x,c)=>(x.displayName||"").localeCompare(c.displayName||""))),t},[f]),fe=n.useMemo(()=>["__company__",...b.map(h=>h.id)],[b]);return a("div",{className:"p-6 max-w-6xl mx-auto",children:[e("h1",{className:"text-3xl font-extrabold mb-6",children:"ParamÃ¨tres de la compagnie â€” Personnel"}),a("div",{className:"mb-8 bg-white p-6 rounded-xl shadow-md border",children:[e("h2",{className:"text-lg font-semibold mb-4",children:"Ajouter un membre (niveau compagnie)"}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e("input",{value:r,onChange:t=>y(L(t.target.value)),placeholder:"Nom complet (Ex. Ayoub Diallo)",className:"border p-3 rounded focus:ring-2"}),e("input",{value:C,onChange:t=>i(t.target.value.trim().toLowerCase()),placeholder:"Email (ex. nom@domaine.com)",type:"email",className:"border p-3 rounded focus:ring-2"}),e("input",{value:d,onChange:t=>g(t.target.value.replace(/\D/g,"")),placeholder:"TÃ©lÃ©phone (ex. 78953098)",inputMode:"numeric",className:"border p-3 rounded focus:ring-2"}),a("select",{value:z,onChange:t=>O(t.target.value),className:"border p-3 rounded focus:ring-2",children:[e("option",{value:"company_accountant",children:"Comptable (compagnie)"}),e("option",{value:"financial_director",children:"Directeur financier (DAF)"})]}),e("input",{value:S,onChange:t=>k(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Mot de passe (6 chiffres)",type:"password",className:"border p-3 rounded focus:ring-2 md:col-span-2"})]}),e("button",{onClick:de,disabled:u,className:"w-full py-3 rounded font-semibold text-white transition disabled:opacity-60 bg-orange-600",children:u?"â³ Traitement...":"Ajouter lâ€™utilisateur"}),v&&e("p",{className:"mt-3 text-center text-sm text-gray-700",children:v})]}),fe.map(t=>{const h=ge[t]||[],x=t==="__company__"?"Niveau compagnie":`Agence : ${he.get(t)||t}`;return a("div",{className:"bg-white rounded-xl shadow-md border mb-6",children:[e("div",{className:"p-4 border-b",children:e("h2",{className:"text-lg font-semibold",children:x})}),h.length===0?e("p",{className:"p-6 text-gray-500",children:"Aucun personnel."}):e("div",{className:"divide-y",children:h.map(c=>a("div",{className:"p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e("div",{children:A===c.uid?a("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-2",children:[e("input",{value:W,onChange:w=>G(L(w.target.value)),className:"border p-2 rounded"}),e("input",{value:M,onChange:w=>H(w.target.value.replace(/\D/g,"")),placeholder:"TÃ©lÃ©phone",inputMode:"numeric",className:"border p-2 rounded"}),a("select",{value:$,onChange:w=>X(w.target.value),className:"border p-2 rounded",children:[e("option",{value:"company_accountant",children:"Comptable (compagnie)"}),e("option",{value:"financial_director",children:"Directeur financier (DAF)"}),e("option",{value:"chef_agence",children:"Chef dâ€™agence"}),e("option",{value:"comptable_agence",children:"Comptable (agence)"}),e("option",{value:"guichetier",children:"Guichetier"}),e("option",{value:"agent_courrier",children:"Agent de courrier"})]}),a("div",{className:"text-xs text-gray-500 flex items-center",children:["Statut:Â ",e("span",{className:c.active?"text-green-600":"text-red-600",children:c.active?"Actif":"DÃ©sactivÃ©"})]})]}):a(F,{children:[a("p",{className:"font-semibold text-gray-900",children:[c.displayName," ",a("span",{className:"text-gray-500 text-sm",children:["â€¢ ",ze[c.role]||c.role]})]}),a("p",{className:"text-sm text-gray-600",children:[c.email,c.telephone?` â€¢ ${c.telephone}`:""]}),a("p",{className:"text-xs",children:["Statut :"," ",e("span",{className:c.active?"text-green-600":"text-red-600",children:c.active?"Actif":"DÃ©sactivÃ©"})]})]})}),e("div",{className:"flex flex-wrap gap-2",children:A===c.uid?a(F,{children:[e("button",{onClick:me,disabled:u,className:"px-3 py-1 rounded text-white bg-green-600",children:"Enregistrer"}),e("button",{onClick:()=>q(null),className:"px-3 py-1 rounded border",children:"Annuler"})]}):a(F,{children:[e("button",{onClick:()=>ue(c),className:"px-3 py-1 rounded border",children:"Modifier"}),c.active?e("button",{onClick:()=>K(c,!1),disabled:u,className:"px-3 py-1 rounded text-white bg-amber-700",children:"DÃ©sactiver"}):e("button",{onClick:()=>K(c,!0),disabled:u,className:"px-3 py-1 rounded text-white bg-green-700",children:"Activer"}),e("button",{onClick:()=>pe(c),disabled:u,className:"px-3 py-1 rounded text-white bg-red-600",children:"Supprimer"})]})})]},c.uid))})]},t)})]})},He=({companyId:N})=>{const[s,f]=n.useState(""),[l,b]=n.useState(""),[p,u]=n.useState({text:"",type:""}),[m,v]=n.useState(!1);return a("div",{className:"bg-white rounded-xl border p-6 max-w-xl",children:[e("h2",{className:"text-xl font-bold mb-6",children:"SÃ©curitÃ©"}),a("div",{className:"space-y-4",children:[e("input",{type:"password",placeholder:"Nouveau mot de passe",value:s,onChange:r=>f(r.target.value),className:"w-full border rounded-lg px-4 py-2"}),e("input",{type:"password",placeholder:"Confirmer le mot de passe",value:l,onChange:r=>b(r.target.value),className:"w-full border rounded-lg px-4 py-2"}),e("button",{onClick:async()=>{if(u({text:"",type:""}),!s||!l){u({text:"Veuillez remplir les deux champs.",type:"error"});return}if(s.length<6){u({text:"Le mot de passe doit contenir au moins 6 caractÃ¨res.",type:"error"});return}if(s!==l){u({text:"Les mots de passe ne correspondent pas.",type:"error"});return}try{if(v(!0),!R.currentUser){u({text:"Utilisateur non authentifiÃ©.",type:"error"});return}await qe(R.currentUser,s),u({text:"Mot de passe mis Ã  jour avec succÃ¨s !",type:"success"}),f(""),b("")}catch(r){console.error(r),r.code==="auth/requires-recent-login"?u({text:"Veuillez vous reconnecter avant de modifier le mot de passe.",type:"error"}):u({text:"Erreur lors de la mise Ã  jour du mot de passe.",type:"error"})}finally{v(!1)}},disabled:m,className:"bg-orange-600 hover:bg-orange-700 text-white px-5 py-2 rounded-lg disabled:opacity-60",children:m?"Modification...":"Modifier le mot de passe"}),p.text&&e("p",{className:`text-sm mt-2 ${p.type==="success"?"text-green-600":"text-red-600"}`,children:p.text})]})]})},ae={facebook:"",instagram:"",whatsapp:"",tiktok:"",linkedin:"",youtube:""},Xe=({companyId:N})=>{const{user:s}=j(),{companyId:f}=se(),l=f??(s==null?void 0:s.companyId)??null,[b,p]=n.useState(ae),[u,m]=n.useState(!0),[v,o]=n.useState(!1),[r,y]=n.useState({text:"",type:""});n.useEffect(()=>{if(!l)return;(async()=>{var d;try{const g=P(E,"companies",l),S=await I(g);if(S.exists()){const k=S.data();p(k.socialMedia||ae),m(((d=k.footerConfig)==null?void 0:d.showSocialMedia)??!0)}}catch(g){console.error("Erreur chargement rÃ©seaux:",g)}})()},[l]);const C=async()=>{if(l){o(!0),y({text:"Enregistrement...",type:"info"});try{const i=P(E,"companies",l);await oe(i,{socialMedia:b,footerConfig:{showSocialMedia:u}},{merge:!0}),y({text:"Modifications enregistrÃ©es âœ…",type:"success"})}catch(i){console.error("Erreur enregistrement rÃ©seaux:",i),y({text:"Erreur lors de l'enregistrement âŒ",type:"error"})}finally{o(!1)}}};return l?a("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-xl shadow border",children:[e("h2",{className:"text-xl font-bold mb-6",children:"RÃ©seaux sociaux & affichage"}),e(V,{children:r.text&&e(B.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:`p-4 rounded mb-4 text-sm ${r.type==="success"?"bg-green-100 text-green-800":r.type==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:r.text})}),e("div",{className:"space-y-4",children:["facebook","instagram","whatsapp","tiktok","linkedin","youtube"].map(i=>a("div",{children:[a("label",{className:"block text-sm font-medium mb-1 capitalize",children:["Lien ",i]}),e("input",{type:"url",value:b[i],onChange:d=>p(g=>({...g,[i]:d.target.value})),placeholder:`https://${i}.com/...`,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500"})]},i))}),e("div",{className:"mt-6",children:a("label",{className:"inline-flex items-center text-sm",children:[e("input",{type:"checkbox",checked:u,onChange:i=>m(i.target.checked),className:"mr-2"}),"Afficher les icÃ´nes dans le pied de page"]})}),e("div",{className:"flex justify-end mt-6",children:a("button",{onClick:C,disabled:v,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-2 rounded-lg flex items-center gap-2 disabled:opacity-60",children:[e(_,{size:18}),v?"Enregistrement...":"Enregistrer"]})})]}):e("div",{className:"p-6 text-red-600",children:"Company ID introuvable."})},Ze=({companyId:N})=>{const{user:s}=j(),[f,l]=n.useState({fr:"",en:""}),[b,p]=n.useState({fr:"",en:""}),[u,m]=n.useState({fr:"",en:""}),[v,o]=n.useState({fr:"",en:""}),[r,y]=n.useState({text:"",type:"info"});n.useEffect(()=>{s!=null&&s.companyId&&(async()=>{const g=P(E,"companies",s.companyId),S=await I(g);if(S.exists()){const k=S.data();l(k.mentionsLegales||{fr:"",en:""}),p(k.politiqueConfidentialite||{fr:"",en:""}),m(k.conditionsUtilisation||{fr:"",en:""}),o(k.politiqueCookies||{fr:"",en:""})}})()},[s]);const C=async()=>{if(s!=null&&s.companyId){y({text:"Enregistrement en cours...",type:"info"});try{const d=P(E,"companies",s.companyId);await T(d,{mentionsLegales:f,politiqueConfidentialite:b,conditionsUtilisation:u,politiqueCookies:v}),y({text:"Mentions mises Ã  jour avec succÃ¨s.",type:"success"})}catch(d){console.error(d),y({text:"Erreur lors de l'enregistrement.",type:"error"})}}},i=(d,g,S)=>a("div",{children:[e("h3",{className:"text-lg font-semibold mb-2",children:d}),e("label",{className:"text-sm font-medium",children:"ðŸ‡«ðŸ‡· FranÃ§ais"}),e("textarea",{rows:4,className:"w-full mb-4 p-2 border rounded",value:g.fr,onChange:k=>S({...g,fr:k.target.value})}),e("label",{className:"text-sm font-medium",children:"ðŸ‡¬ðŸ‡§ English"}),e("textarea",{rows:4,className:"w-full p-2 border rounded",value:g.en,onChange:k=>S({...g,en:k.target.value})})]});return a("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded shadow",children:[e("h2",{className:"text-xl font-bold mb-6",children:"Mentions lÃ©gales & politiques multilingues"}),e(V,{children:r.text&&e(B.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded mb-4 ${r.type==="success"?"bg-green-100 text-green-800":r.type==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:a("div",{className:"flex justify-between items-center",children:[a("div",{className:"flex items-center gap-2",children:[r.type==="success"?e(re,{}):r.type==="error"?e(ne,{}):e(_,{}),e("span",{children:r.text})]}),r.type==="success"&&e("button",{onClick:()=>y({text:"",type:"info"}),className:"text-sm underline",children:"OK"})]})})}),a("div",{className:"space-y-8",children:[i("Mentions lÃ©gales",f,l),i("Politique de confidentialitÃ©",b,p),i("Conditions d'utilisation",u,m),i("Politique de cookies",v,o),e("div",{className:"flex justify-end",children:a("button",{onClick:C,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-2 rounded flex items-center gap-2",children:[e(_,{size:18})," Enregistrer"]})})]})]})},Ke=[{key:"wifi",label:"Wi-Fi Ã  bord",icon:e(Se,{className:"h-5 w-5"}),description:"Connexion Internet disponible pendant le trajet"},{key:"climatisation",label:"Climatisation",icon:e(Ee,{className:"h-5 w-5"}),description:"Bus climatisÃ©"},{key:"usb",label:"Prise USB",icon:e(ke,{className:"h-5 w-5"}),description:"Recharge tÃ©lÃ©phone disponible"},{key:"boisson",label:"Boisson offerte",icon:e(Pe,{className:"h-5 w-5"}),description:"Boisson incluse pendant le voyage"},{key:"sieges_confort",label:"SiÃ¨ges confort",icon:e(Ie,{className:"h-5 w-5"}),description:"SiÃ¨ges larges et confortables"},{key:"tv",label:"Ã‰cran / TV",icon:e(Ae,{className:"h-5 w-5"}),description:"Divertissement Ã  bord"},{key:"froid",label:"Eau fraÃ®che",icon:e(Me,{className:"h-5 w-5"}),description:"Eau fraÃ®che disponible"}],U=6,Je=({companyId:N})=>{const[s,f]=n.useState([]),[l,b]=n.useState(!0),[p,u]=n.useState({text:"",type:""});n.useEffect(()=>{if(!N)return;(async()=>{try{const r=P(E,"companies",N),y=await I(r);if(y.exists()){const C=y.data();f(C.services||[])}}catch(r){console.error("Erreur chargement services:",r)}finally{b(!1)}})()},[N]);const m=o=>{f(r=>r.includes(o)?r.filter(y=>y!==o):r.length>=U?r:[...r,o])},v=async()=>{if(N)try{await T(P(E,"companies",N),{services:s}),u({text:"Services enregistrÃ©s avec succÃ¨s",type:"success"})}catch(o){console.error(o),u({text:"Erreur lors de l'enregistrement",type:"error"})}};return a("div",{className:"bg-white rounded-xl border p-6",children:[e("h2",{className:"text-lg font-semibold mb-2",children:"Services proposÃ©s"}),a("p",{className:"text-sm text-gray-500 mb-6",children:["SÃ©lectionnez les services rÃ©ellement disponibles Ã  bord.",e("br",{}),a("span",{className:"font-medium",children:["Maximum ",U," services."]})]}),l?e("p",{className:"text-gray-500",children:"Chargementâ€¦"}):e("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Ke.map(o=>{const r=s.includes(o.key),y=!r&&s.length>=U;return a("button",{onClick:()=>m(o.key),disabled:y,className:`flex items-start gap-3 p-4 rounded-xl border transition-all text-left
                  ${r?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}
                  ${y?"opacity-50 cursor-not-allowed":""}
                `,children:[e("div",{className:`p-2 rounded-lg ${r?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:o.icon}),a("div",{children:[e("p",{className:"font-medium text-sm",children:o.label}),e("p",{className:"text-xs text-gray-500",children:o.description})]})]},o.key)})}),a("div",{className:"flex justify-between items-center mt-6",children:[a("p",{className:"text-xs text-gray-500",children:[s.length,"/",U," sÃ©lectionnÃ©s"]}),a("button",{onClick:v,className:"flex items-center gap-2 px-5 py-2.5 rounded-lg text-white font-medium",style:{backgroundColor:"#2563eb"},children:[e(_,{className:"h-4 w-4"}),"Enregistrer"]})]}),e(V,{children:p.text&&a(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:`mt-4 flex items-center gap-2 text-sm ${p.type==="success"?"text-green-600":"text-red-600"}`,children:[p.type==="success"?e(re,{className:"h-4 w-4"}):e(ne,{className:"h-4 w-4"}),p.text]})})]})},Qe=[{key:"plan",label:"Plan & abonnement"},{key:"vitrine",label:"Vitrine publique"},{key:"services",label:"Services proposÃ©s"},{key:"personnel",label:"Personnel"},{key:"securite",label:"SÃ©curitÃ©"},{key:"reseaux",label:"RÃ©seaux sociaux"},{key:"legaux",label:"Mentions & politique"}],nt=()=>{const[N,s]=n.useState("vitrine"),{user:f,company:l}=j(),{companyId:b}=se(),p=b??(f==null?void 0:f.companyId)??"",[u,m]=n.useState(null),[v,o]=n.useState(!0),r=Fe(u||l||void 0),{setHeader:y,resetHeader:C}=Re();n.useEffect(()=>{if(!p){m(null),o(!1);return}(async()=>{try{const g=P(E,"companies",p),S=await I(g);S.exists()?m({id:S.id,...S.data()}):m(null)}catch(g){console.error("Erreur chargement compagnie:",g),m(null)}finally{o(!1)}})()},[p]),n.useEffect(()=>(y({title:"ParamÃ¨tres de la compagnie",bg:`linear-gradient(90deg, ${r.colors.primary} 0%, ${r.colors.secondary} 100%)`,fg:"#fff"}),()=>C()),[y,C,r.colors.primary,r.colors.secondary]);const i=()=>{switch(N){case"plan":return e(Be,{companyId:p});case"vitrine":return e(Ve,{companyId:p});case"services":return e(Je,{companyId:p});case"personnel":return e(Ge,{companyId:p});case"securite":return e(He,{companyId:p});case"reseaux":return e(Xe,{companyId:p});case"legaux":return e(Ze,{companyId:p});default:return null}};return a("div",{className:"max-w-6xl mx-auto p-4 md:p-6",children:[e("div",{className:"flex flex-wrap gap-2 md:gap-3 mb-6",children:Qe.map(d=>{const g=N===d.key;return e("button",{onClick:()=>s(d.key),className:["px-4 py-2 rounded-full text-sm font-medium transition-all border",g?"shadow-sm":"hover:bg-gray-50"].join(" "),style:{backgroundColor:g?r.colors.primary:"#fff",color:g?"#fff":"#1f2937",borderColor:g?`${r.colors.primary}55`:"#e5e7eb"},children:d.label},d.key)})}),v?e("div",{className:"bg-white rounded-xl border p-8 text-center text-gray-600",children:"Chargementâ€¦"}):i()]})};export{nt as default};
