import{u as T,r as l,b as U,j as e}from"./react-BKlva80Y.js";import{q as C,j as L,w as f,k as z}from"./firebase-1zyXmG6H.js";import{u as V,d as R}from"../index-B9wHCq4m.js";import{M as $}from"./ModifierReservationForm-C58kFKs2.js";import{J as S}from"./vendor-CZDa83Cj.js";const d=15,J=()=>{const{user:s,company:n}=V(),E=T(),[b,j]=l.useState([]),[x,F]=l.useState(""),[m,H]=l.useState(""),[g,I]=l.useState(""),[p,A]=l.useState(""),[h,v]=l.useState(1),B=l.useRef(null),[y,u]=l.useState(null),[W,w]=l.useState(!0);l.useEffect(()=>{const t=document.createElement("canvas");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100vw",t.style.height="100vh",t.style.pointerEvents="none",t.style.zIndex="0",document.body.appendChild(t);const a=t.getContext("2d");if(!a)return;t.width=window.innerWidth,t.height=window.innerHeight;const o=Array(100).fill(0).map(()=>({x:Math.random()*t.width,y:Math.random()*t.height,size:Math.random()*3+1,speedX:(Math.random()-.5)*.5,speedY:(Math.random()-.5)*.5,color:`rgba(0, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.random()*.3+.1}`})),c=()=>{a.clearRect(0,0,t.width,t.height),o.forEach(r=>{r.x+=r.speedX,r.y+=r.speedY,(r.x<0||r.x>t.width)&&(r.speedX*=-1),(r.y<0||r.y>t.height)&&(r.speedY*=-1),a.beginPath(),a.arc(r.x,r.y,r.size,0,Math.PI*2),a.fillStyle=r.color,a.fill()}),requestAnimationFrame(c)};return c(),()=>{document.body.removeChild(t)}},[]);const{id:N}=U();l.useEffect(()=>{(async()=>{const a=N||(s==null?void 0:s.agencyId);if(a){w(!0);try{const o=C(L(R,"reservations"),f("agencyId","==",a),f("statut","==","payé")),r=(await z(o)).docs.map(M=>({id:M.id,...M.data()}));j(r)}catch(o){console.error("Erreur de chargement:",o)}finally{w(!1)}}})()},[s==null?void 0:s.agencyId,N]);const i=l.useMemo(()=>b.filter(t=>{const a=x?t.date===x:!0,o=m?t.heure===m:!0,c=g?`${t.depart.toLowerCase()}-${t.arrivee.toLowerCase()}`.includes(g.toLowerCase()):!0,r=p?t.canal===p:!0;return a&&o&&c&&r}),[b,x,m,g,p]),k=l.useMemo(()=>{const t=(h-1)*d;return i.slice(t,t+d)},[i,h]),D=()=>{E("impression-reservations",{state:{reservations:i,date:x,heure:m,trajet:g,agencyName:s==null?void 0:s.agencyName,logoUrl:n==null?void 0:n.logoUrl,companyName:n==null?void 0:n.nom}})},P=S(new Date,"dd/MM/yyyy");return e.jsxs("div",{className:"min-h-screen bg-gray-900 p-6 text-gray-100 relative overflow-hidden",children:[e.jsx("div",{className:"fixed inset-0 grid-lines pointer-events-none"}),e.jsxs("div",{className:"relative mb-8 p-6 rounded-xl bg-gray-800 bg-opacity-20 backdrop-blur-lg border border-cyan-400 border-opacity-30 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 holo-grid-effect"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500 neon-text",children:"Gestion des Réservations"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s==null?void 0:s.agencyName})]}),e.jsx("button",{onClick:D,className:"px-6 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-cyan-400/30 transition-all hover:scale-105 transform",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🖨️"}),e.jsx("span",{className:"text-shadow",children:"Imprimer la liste"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[[{value:x,setter:F,type:"date",placeholder:"",icon:"calendar"},{value:m,setter:H,type:"time",placeholder:"",icon:"clock"},{value:g,setter:I,type:"text",placeholder:"Rechercher un trajet...",icon:"search"}].map((t,a)=>e.jsxs("div",{className:"relative sci-fi-input-container",children:[e.jsx("input",{type:t.type,value:t.value,onChange:o=>t.setter(o.target.value),placeholder:t.placeholder,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"}),e.jsx("div",{className:"sci-fi-input-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[t.icon==="calendar"&&e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}),t.icon==="clock"&&e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}),t.icon==="search"&&e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]})})]},a)),e.jsxs("select",{value:p,onChange:t=>A(t.target.value),className:"bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent appearance-none sci-fi-select",children:[e.jsx("option",{value:"",children:"Tous les canaux"}),e.jsx("option",{value:"guichet",children:"Guichet"}),e.jsx("option",{value:"ligne",children:"En ligne"})]})]}),e.jsxs("div",{ref:B,className:"rounded-xl bg-gray-800 bg-opacity-20 backdrop-blur-lg border border-cyan-400 border-opacity-30 overflow-hidden mb-8 sci-fi-table-container",children:[e.jsxs("div",{className:"p-6 text-center border-b border-gray-700 relative",children:[e.jsx("div",{className:"absolute inset-0 holo-header-effect"}),(n==null?void 0:n.logoUrl)&&e.jsx("div",{className:"relative z-10",children:e.jsx("img",{src:n.logoUrl,alt:"logo",className:"h-16 mx-auto mb-4 filter drop-shadow-lg"})}),e.jsx("h2",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400 relative z-10 neon-text",children:(n==null?void 0:n.nom)||"Compagnie de Transport"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1 relative z-10",children:[s==null?void 0:s.agencyName," • ",P]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-700 bg-opacity-30 text-gray-300",children:[e.jsx("th",{className:"p-4 text-left font-medium",children:"#"}),e.jsx("th",{className:"p-4 text-left font-medium",children:"Client"}),e.jsx("th",{className:"p-4 text-left font-medium",children:"Contact"}),e.jsx("th",{className:"p-4 text-left font-medium",children:"Trajet"}),e.jsx("th",{className:"p-4 text-left font-medium",children:"Date"}),e.jsx("th",{className:"p-4 text-left font-medium",children:"Heure"}),e.jsx("th",{className:"p-4 text-left font-medium",children:"Canal"}),e.jsx("th",{className:"p-4 text-right font-medium",children:"Montant"}),e.jsx("th",{className:"p-4 text-center font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:W?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"p-8 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"h-8 w-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"})})})}):k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"p-8 text-center text-gray-400",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Aucune réservation trouvée"})]})})}):k.map((t,a)=>{var o;return e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/20 transition-colors duration-150",children:[e.jsx("td",{className:"p-4 text-gray-400",children:(h-1)*d+a+1}),e.jsx("td",{className:"p-4 font-medium",children:t.nomClient}),e.jsx("td",{className:"p-4 text-cyan-400",children:t.telephone}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"text-purple-400",children:t.depart}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mx-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})}),e.jsx("span",{className:"text-cyan-400",children:t.arrivee})]})}),e.jsx("td",{className:"p-4",children:S(new Date(t.date),"dd/MM/yyyy")}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-700 text-gray-200",children:t.heure})}),e.jsx("td",{className:"p-4",children:t.canal==="guichet"?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-900 text-yellow-200",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Guichet"]}):e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-900 text-blue-200",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),"En ligne"]})}),e.jsxs("td",{className:"p-4 text-right font-mono text-green-400",children:[(o=t.montant)==null?void 0:o.toLocaleString()," FCFA"]}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("button",{onClick:()=>u(t),className:"text-cyan-400 hover:text-cyan-300 transition-colors duration-200 flex items-center justify-center mx-auto",title:"Modifier",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})})]},t.id)})})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-700 text-right text-sm italic text-gray-400",children:[e.jsx("div",{className:"inline-block border-t-2 border-dashed border-cyan-400 w-32 mt-1"}),e.jsx("div",{className:"mt-2",children:"Signature et cachet de la compagnie"})]})]}),i.length>d&&e.jsxs("div",{className:"flex justify-center mt-6 space-x-2",children:[e.jsx("button",{onClick:()=>v(t=>Math.max(1,t-1)),disabled:h===1,className:"px-4 py-2 rounded-lg border border-gray-700 hover:bg-gray-700/50 disabled:opacity-30 disabled:cursor-not-allowed transition-all",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),Array.from({length:Math.ceil(i.length/d)},(t,a)=>e.jsx("button",{onClick:()=>v(a+1),className:`px-4 py-2 rounded-lg font-medium transition-all ${h===a+1?"bg-gradient-to-r from-cyan-600 to-blue-700 text-white shadow-lg":"bg-gray-800 hover:bg-gray-700 border border-gray-700"}`,children:a+1},a)),e.jsx("button",{onClick:()=>v(t=>Math.min(Math.ceil(i.length/d),t+1)),disabled:h===Math.ceil(i.length/d),className:"px-4 py-2 rounded-lg border border-gray-700 hover:bg-gray-700/50 disabled:opacity-30 disabled:cursor-not-allowed transition-all",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-cyan-400 border-opacity-30 max-w-2xl w-full max-h-[90vh] overflow-y-auto relative sci-fi-modal",children:[e.jsx("div",{className:"absolute inset-0 holo-modal-effect"}),e.jsxs("div",{className:"relative z-10 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400 neon-text",children:"Modifier Réservation"}),e.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx($,{reservation:y,onClose:()=>u(null),onUpdated:()=>{u(null),setTimeout(()=>{(async()=>{const a=C(L(R,"reservations"),f("agencyId","==",s==null?void 0:s.agencyId),f("statut","==","payé")),c=(await z(a)).docs.map(r=>({id:r.id,...r.data()}));j(c)})()},500)}})]})]})}),e.jsx("style",{children:`
        .grid-lines {
          background-image: 
            linear-gradient(rgba(0, 150, 255, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 150, 255, 0.05) 1px, transparent 1px);
          background-size: 50px 50px;
          z-index: 0;
        }

        .holo-grid-effect {
          background: linear-gradient(135deg, rgba(0, 200, 255, 0.03) 0%, transparent 50%, rgba(0, 200, 255, 0.03) 100%);
        }

        .holo-header-effect {
          background: linear-gradient(90deg, transparent, rgba(0, 200, 255, 0.1), transparent);
        }

        .holo-modal-effect {
          background: radial-gradient(circle at center, rgba(0, 200, 255, 0.05) 0%, transparent 70%);
        }

        .neon-text {
          text-shadow: 0 0 8px rgba(0, 200, 255, 0.7);
        }

        .sci-fi-input-container {
          position: relative;
        }

        .sci-fi-input-icon {
          position: absolute;
          right: 12px;
          top: 50%;
          transform: translateY(-50%);
          color: rgba(0, 200, 255, 0.7);
        }

        .sci-fi-select {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
          background-position: right 0.5rem center;
          background-repeat: no-repeat;
          background-size: 1.5em 1.5em;
          padding-right: 2.5rem;
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }

        .sci-fi-table-container {
          box-shadow: 0 0 30px rgba(0, 200, 255, 0.1);
        }

        .sci-fi-modal {
          box-shadow: 0 0 40px rgba(0, 200, 255, 0.2);
        }

        @keyframes pulse {
          0%, 100% { opacity: 0.8; }
          50% { opacity: 1; }
        }
      `})]})};export{J as default};
