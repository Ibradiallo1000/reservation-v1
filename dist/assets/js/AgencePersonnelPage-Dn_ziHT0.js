import{r as t,j as s}from"./react-Bg_vEni-.js";import{q as w,w as f,f as x,h as v,k as A,e as I,p as S,d as C}from"./firebase-C3aZpI0W.js";import{u as D,d as c,a as E}from"../index-Dgt8Lr4V.js";import"./vendor-D_4iK-Jm.js";const M=()=>{const{user:a}=D(),[l,g]=t.useState([]),[n,i]=t.useState(""),[r,u]=t.useState(""),[m,y]=t.useState("guichetier"),[d,p]=t.useState(""),o=async()=>{if(!(a!=null&&a.agencyId))return;const e=w(x(c,"users"),f("agencyId","==",a.agencyId)),N=(await v(e)).docs.map(h=>({id:h.id,...h.data()}));g(N)};t.useEffect(()=>{o()},[a]);const j=async()=>{if(!n||!d||!r||!(a!=null&&a.agencyId)||!(a!=null&&a.companyId))return;const e=await A(E,n,d);await I(x(c,"users"),{uid:e.user.uid,email:n,displayName:r,role:m,agencyId:a.agencyId,companyId:a.companyId,createdAt:new Date().toISOString()}),i(""),u(""),p(""),o()},b=async e=>{window.confirm("Supprimer cet agent ?")&&(await S(C(c,"users",e)),o())};return s.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Gestion du personnel"}),s.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx("input",{value:r,onChange:e=>u(e.target.value),placeholder:"Nom",className:"border p-2 rounded"}),s.jsx("input",{value:n,onChange:e=>i(e.target.value),placeholder:"Email",type:"email",className:"border p-2 rounded"}),s.jsx("input",{value:d,onChange:e=>p(e.target.value),placeholder:"Mot de passe",type:"password",className:"border p-2 rounded"}),s.jsxs("select",{value:m,onChange:e=>y(e.target.value),className:"border p-2 rounded",children:[s.jsx("option",{value:"guichetier",children:"Guichetier"}),s.jsx("option",{value:"agentCourrier",children:"Agent de courrier"})]})]}),s.jsx("button",{onClick:j,className:"bg-blue-600 text-white px-4 py-2 rounded mb-6",children:"Ajouter l’agent"}),s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Agents de cette agence"}),l.length===0?s.jsx("p",{className:"text-gray-500",children:"Aucun agent enregistré."}):s.jsx("ul",{className:"space-y-2",children:l.map(e=>s.jsxs("li",{className:"border p-3 rounded flex justify-between items-center bg-white shadow",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:e.displayName}),s.jsxs("p",{className:"text-sm text-gray-500",children:[e.email," • ",e.role]})]}),s.jsx("button",{onClick:()=>b(e.id),className:"text-red-600 text-sm hover:underline",children:"Supprimer"})]},e.id))})]})};export{M as default};
