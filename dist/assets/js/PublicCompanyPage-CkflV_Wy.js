import{j as e,a as t,M as D,r as m,$ as W,aW as E,aX as Y,aY as pe,_ as J,e as F,h as te,a1 as be,A as xe,C as ae,p as se,aZ as re,u as Q,I as ye,a_ as ve,aQ as le,aR as we,q as Ne,a$ as K,b0 as ke,b1 as Ce,b2 as Se,b3 as $e,b4 as Le,b5 as ne,F as ie,b6 as Ae,b7 as Ee,U as je,b8 as Ie,E as oe,b9 as ze,a0 as Fe,o as Pe,d as Re}from"./react-DgrrIcw2.js";import{l as j,k as $,q as ce,w as O,A as Ve,H as Me,E as Te,D as Be}from"./firebase-eGIzIftJ.js";import{m as x,A as I,i as X,d as L,b as De,L as _e,E as qe}from"../index-p6Te0bSg.js";import"./vendor-BHjJ2Hjk.js";const Ue=({suggestions:s,company:a,onSelect:o})=>{const n=a.couleurPrimaire||"#3b82f6",l=a.couleurSecondaire||"#e0f2fe";return e("div",{className:"px-4 md:px-8 mt-6",children:t("div",{className:"max-w-4xl mx-auto",children:[e("div",{className:"mb-4 text-center",children:t("h2",{className:"text-xl md:text-xl font-extrabold text-black flex justify-center items-center gap-2",children:[e(D,{style:{color:n},size:22}),e("span",{children:"Nos destination"})]})}),e("div",{className:"flex space-x-3 overflow-x-auto pb-3 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:s.slice(0,10).map((r,c)=>e(x.div,{whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},className:"min-w-[120px] bg-white rounded-lg shadow-md px-4 py-3 flex-shrink-0 cursor-pointer",style:{borderLeft:`8px solid ${l}`},onClick:()=>o(r.departure,r.arrival),children:t("div",{className:"text-center",children:[t("div",{className:"font-semibold text-gray-900 text-sm mb-1",children:[r.departure," → ",r.arrival]}),r.price!==void 0&&t("div",{className:"text-xs font-bold text-white inline-block px-3 py-1 rounded-full",style:{backgroundColor:n},children:[r.price.toLocaleString()," FCFA"]}),e("div",{className:"mt-2",children:e("button",{className:"text-xs font-medium px-3 py-1.5 rounded-md text-white",style:{backgroundColor:n},children:"Réserver"})})]})},c))})]})})},He=({onSelectLanguage:s,delayMs:a=5e3})=>{const[o,n]=m.useState(!0);m.useEffect(()=>{const r=setTimeout(()=>{n(!1)},a);return()=>clearTimeout(r)},[a]);const l=r=>{X.changeLanguage(r),s(r),n(!1)};return o?e(I,{children:t(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.4},className:"fixed top-5 right-5 z-50 bg-white border border-gray-200 shadow-xl rounded-lg p-4 w-[300px] max-w-full",children:[t("div",{className:"flex items-start justify-between mb-2",children:[e("h3",{className:"text-sm font-bold text-gray-800",children:"Choisissez votre langue"}),e("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700",children:e(W,{className:"w-4 h-4"})})]}),t("div",{className:"flex justify-end gap-2",children:[e("button",{onClick:()=>l("fr"),className:"px-4 py-1.5 rounded-full text-sm font-medium shadow-sm",style:{backgroundColor:"#facc15",color:"#000"},children:"Français"}),e("button",{onClick:()=>l("en"),className:"px-4 py-1.5 rounded-full text-sm font-medium shadow-sm",style:{backgroundColor:"#1e293b",color:"#fff"},children:"English"})]})]})}):null},ee=({label:s,placeholder:a="Choisissez une ville",value:o,onChange:n,highlightColor:l="#3B82F6"})=>{const[r,c]=m.useState(""),[i,d]=m.useState([]);m.useEffect(()=>{(async()=>{try{const u=(await j($(L,"villes"))).docs.map(w=>w.data().nom).filter(Boolean);d(u)}catch(b){console.error("Erreur chargement villes :",b)}})()},[]);const p=r===""?i:i.filter(h=>h.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").includes(r.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")));return e("div",{className:"w-full",children:t(E,{value:o,onChange:n,children:[e(E.Label,{className:"block text-sm font-medium text-white mb-1",children:s}),t("div",{className:"relative",children:[e(E.Input,{className:"w-full border border-gray-300 rounded-md py-2 pl-3 pr-10 text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-primary",displayValue:h=>h,value:o,onChange:h=>{c(h.target.value),n(h.target.value)},placeholder:a,autoComplete:"off"}),e(E.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e(Y,{className:"h-4 w-4 text-gray-400"})}),p.length>0&&e(E.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none sm:text-sm",children:p.map((h,b)=>e(E.Option,{value:h,className:({active:u})=>`relative cursor-pointer select-none py-2 pl-10 pr-4 ${u?"text-white":"text-gray-900"}`,children:({selected:u,active:w})=>t("div",{style:{backgroundColor:w?l:void 0},className:"w-full h-full",children:[e("span",{className:`block truncate ${u?"font-semibold":"font-normal"}`,children:h}),u&&e("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",style:{color:w?"white":l},children:e(pe,{className:"h-4 w-4","aria-hidden":"true"})})]})},b))})]})]})})},Oe=s=>{const[a,o]=m.useState([]);return m.useEffect(()=>{if(!s)return;(async()=>{const l=ce($(L,"weeklyTrips"),O("companyId","==",s)),c=(await j(l)).docs.map(h=>h.data()),i=c.map(h=>{var b,u;return(u=(b=h.departure)==null?void 0:b.toLowerCase())==null?void 0:u.trim()}),d=c.map(h=>{var b,u;return(u=(b=h.arrival)==null?void 0:b.toLowerCase())==null?void 0:u.trim()}),p=Array.from(new Set([...i,...d])).filter(Boolean);o(p)})()},[s]),a},We=({company:s,onSearch:a})=>{const[o,n]=J.useState(""),[l,r]=J.useState(""),{t:c}=F(),i=Oe(s.id),d=h=>{h.preventDefault(),a(o.trim().toLowerCase(),l.trim().toLowerCase())},p=s.couleurPrimaire||"#3B82F6";return t("section",{className:"relative w-full min-h-[600px] flex items-center justify-center overflow-hidden bg-gray-100",children:[s.banniereUrl&&t("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e(te.LazyLoadImage,{src:s.banniereUrl,alt:`Bannière ${s.nom}`,className:"w-full h-full object-cover object-center",effect:"opacity",width:"100%",height:"100%",style:{objectPosition:"center center",minHeight:"100%",minWidth:"100%"}}),e("div",{className:"absolute inset-0 bg-black/30"})]}),e(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"absolute top-8 left-1/2 transform -translate-x-1/2 z-10",children:e("div",{className:"text-white text-xl md:text-2xl font-semibold text-center",children:s.accroche||c("defaultSlogan")})}),e("div",{className:"relative z-10 w-full max-w-5xl px-5",children:t(x.form,{onSubmit:d,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"bg-transparent rounded-xl border border-white px-6 py-4 backdrop-blur-md",children:[e("p",{className:"text-sm md:text-base font-semibold mb-4 text-white",children:s.instructionRecherche||c("searchInstruction")}),t("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[e("div",{className:"w-full md:w-1/3",children:e(ee,{label:c("departureCity"),value:o,onChange:n,options:i})}),e("div",{className:"w-full md:w-1/3",children:e(ee,{label:c("arrivalCity"),value:l,onChange:r,options:i})}),t("button",{type:"submit",className:"w-full md:w-auto px-5 py-2 rounded-md text-white font-semibold flex items-center justify-center gap-2",style:{backgroundColor:p},children:[e(be,{className:"h-4 w-4"}),c("searchTrip"),e(xe,{className:"h-4 w-4"})]})]})]})})]})};function Ye({images:s,primaryColor:a}){const[o,n]=m.useState(0),l=r=>{n(c=>r==="prev"?c===0?s.length-1:c-1:c===s.length-1?0:c+1)};return m.useEffect(()=>{const r=setInterval(()=>l("next"),6e3);return()=>clearInterval(r)},[s]),!s||s.length===0?null:e("section",{className:"relative w-full max-w-6xl mx-auto my-10 rounded-xl overflow-hidden shadow border border-gray-200",children:t("div",{className:"relative h-64 md:h-96",children:[e(I,{mode:"wait",children:e(x.img,{src:s[o],alt:`Slide ${o}`,initial:{opacity:.6,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.02},transition:{duration:.5},className:"absolute inset-0 w-full h-full object-cover"},o)}),t("div",{className:"absolute inset-0 flex justify-between items-center px-4",children:[e("button",{onClick:()=>l("prev"),className:"p-2 rounded-full bg-white/80 hover:bg-white shadow",children:e(ae,{className:"h-5 w-5 text-gray-700"})}),e("button",{onClick:()=>l("next"),className:"p-2 rounded-full bg-white/80 hover:bg-white shadow",children:e(se,{className:"h-5 w-5 text-gray-700"})})]}),e("div",{className:"absolute bottom-3 w-full flex justify-center gap-2",children:s.map((r,c)=>e("div",{className:`h-2 w-2 rounded-full transition-all duration-300 ${c===o?"bg-white":"bg-gray-400"}`},c))})]})})}const Qe=({companyId:s,onSuccess:a,primaryColor:o})=>{const[n,l]=m.useState(""),[r,c]=m.useState(0),[i,d]=m.useState(""),[p,h]=m.useState(null),[b,u]=m.useState(!1);return t("form",{onSubmit:async f=>{if(f.preventDefault(),!n.trim()||r<1||!i.trim()){h("Veuillez remplir tous les champs et choisir une note.");return}try{u(!0),await Ve($(L,"avis"),{nom:n,note:r,commentaire:i,visible:!1,companyId:s,createdAt:Me()}),h("Merci pour votre avis ! Il sera publié après validation."),l(""),c(0),d(""),a&&a()}catch(g){console.error(g),h("Erreur lors de l'envoi. Veuillez réessayer.")}finally{u(!1)}},className:"space-y-4",children:[p&&e("p",{className:"text-sm text-gray-600 italic",children:p}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Votre nom"}),e("input",{type:"text",value:n,onChange:f=>l(f.target.value),className:"w-full border px-3 py-2 rounded",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Votre note"}),e("div",{className:"flex gap-1",children:[1,2,3,4,5].map(f=>e(re,{onClick:()=>c(f),className:`h-6 w-6 cursor-pointer ${f<=r?"text-yellow-400":"text-gray-300"}`,fill:f<=r?"#facc15":"none"},f))})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Votre avis"}),e("textarea",{value:i,onChange:f=>d(f.target.value),className:"w-full border px-3 py-2 rounded",rows:4,required:!0})]}),e("button",{type:"submit",disabled:b,className:"text-white px-4 py-2 rounded hover:opacity-90 transition",style:{backgroundColor:o},children:b?"Envoi en cours...":"Envoyer mon avis"})]})},Xe=({company:s})=>{const[a,o]=m.useState(!1);Q();const{t:n}=F(),l=new Date().getFullYear(),{id:r,slug:c,nom:i,couleurPrimaire:d,couleurSecondaire:p,description:h,email:b,telephone:u,adresse:w,horaires:f,socialMedia:g={},footerConfig:P={}}=s,{showAbout:z=!0,showContact:C=!0,showSocial:S=!0,showTestimonials:R=!0,showLegalLinks:V=!0,customLinks:N=[]}=P;return t("footer",{className:"relative w-full overflow-hidden",style:{backgroundColor:p||"#f8fafc",color:"#1e293b"},children:[e("div",{className:"absolute inset-0 bg-[url('/world-map.svg')] bg-center bg-cover opacity-5 pointer-events-none"}),t("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[z&&t(x.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e(ye,{className:"h-5 w-5",style:{color:d}}),e("h3",{className:"text-lg font-semibold",children:n("about")})]}),e("p",{className:"text-sm text-gray-700",children:h||n("defaultAbout")})]}),C&&t(x.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e(ve,{className:"h-5 w-5",style:{color:d}}),e("h3",{className:"text-lg font-semibold",children:n("contact")})]}),t("ul",{className:"space-y-2 text-sm",children:[u&&t("li",{className:"flex items-center gap-2",children:[e(le,{className:"h-4 w-4"}),e("a",{href:`tel:${u}`,className:"hover:underline",children:u})]}),b&&t("li",{className:"flex items-center gap-2",children:[e(we,{className:"h-4 w-4"}),e("a",{href:`mailto:${b}`,className:"hover:underline",children:b})]}),w&&t("li",{className:"flex items-center gap-2",children:[e(D,{className:"h-4 w-4"}),e("span",{children:w})]}),f&&t("li",{className:"flex items-center gap-2",children:[e(Ne,{className:"h-4 w-4"}),e("span",{children:f})]})]})]}),S&&Object.values(g).some(Boolean)&&t(x.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e(K,{className:"h-5 w-5",style:{color:d}}),e("h3",{className:"text-lg font-semibold",children:n("followUs")})]}),t("div",{className:"flex gap-4",children:[g.facebook&&e("a",{href:g.facebook,target:"_blank",rel:"noopener noreferrer",children:e(ke,{className:"h-6 w-6 hover:opacity-80 transition"})}),g.instagram&&e("a",{href:g.instagram,target:"_blank",rel:"noopener noreferrer",children:e(Ce,{className:"h-6 w-6 hover:opacity-80 transition"})}),g.twitter&&e("a",{href:g.twitter,target:"_blank",rel:"noopener noreferrer",children:e(Se,{className:"h-6 w-6 hover:opacity-80 transition"})}),g.linkedin&&e("a",{href:g.linkedin,target:"_blank",rel:"noopener noreferrer",children:e($e,{className:"h-6 w-6 hover:opacity-80 transition"})}),g.youtube&&e("a",{href:g.youtube,target:"_blank",rel:"noopener noreferrer",children:e(Le,{className:"h-6 w-6 hover:opacity-80 transition"})})]})]}),R&&e(x.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:t("div",{className:"flex flex-col gap-4",children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e(K,{className:"h-5 w-5",style:{color:d}}),e("h3",{className:"text-lg font-semibold",children:n("customerReviews")})]}),t(x.button,{onClick:()=>o(!a),className:"flex items-center justify-between px-4 py-2 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:d||"#3B82F6",color:"white"},whileHover:{scale:1.02},whileTap:{scale:.98},children:[e("span",{children:n("leaveReview")}),a?e(ne,{className:"h-4 w-4 ml-2"}):e(Y,{className:"h-4 w-4 ml-2"})]}),a&&e(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:e("div",{className:"mt-4",children:e(Qe,{companyId:r,primaryColor:d||"#3B82F6",onSuccess:()=>o(!1)})})})]})})]}),(V||(N==null?void 0:N.length)>0)&&e("div",{className:"border-t py-6 text-center text-sm relative z-10",style:{borderColor:d?`${d}20`:"#e2e8f0"},children:t("div",{className:"max-w-7xl mx-auto px-6",children:[t("div",{className:"flex flex-wrap justify-center gap-4 mb-2",children:[V&&t(ie,{children:[e("a",{href:`/${c}/mentions-legales`,className:"hover:underline",children:n("legalNotice")}),e("a",{href:`/${c}/confidentialite`,className:"hover:underline",children:n("privacyPolicy")}),e("a",{href:`/${c}/conditions`,className:"hover:underline",children:n("termsConditions")}),e("a",{href:`/${c}/cookies`,className:"hover:underline",children:n("cookiePolicy")})]}),N==null?void 0:N.map((A,_)=>e("a",{href:A.url,className:"hover:underline",target:A.external?"_blank":"_self",rel:A.external?"noopener noreferrer":"",children:A.label},_))]}),t("p",{children:["© ",l," ",i||n("ourCompany"),". ",n("allRightsReserved")]})]})})]})},Ze=({agence:s,primaryColor:a})=>t(x.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{duration:.2},className:"p-5 my-3 rounded-xl shadow-sm hover:shadow-md transition-all",style:{backgroundColor:"#ffffff",borderLeft:`4px solid ${a}`,boxShadow:"0 2px 12px rgba(0,0,0,0.05)"},children:[t("div",{className:"flex justify-between items-start",children:[e("h3",{className:"font-bold text-lg mb-2",style:{color:a},children:s.nomAgence}),s.latitude&&s.longitude&&t("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${s.latitude},${s.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:[e(Ae,{className:"h-3 w-3"}),e("span",{children:"Maps"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3 text-sm",children:[t("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 rounded-full bg-gray-100",children:e(Ee,{className:"h-4 w-4",style:{color:a}})}),e("span",{className:"text-gray-700",children:s.pays})]}),s.quartier&&t("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 rounded-full bg-gray-100",children:e(D,{className:"h-4 w-4",style:{color:a}})}),e("span",{className:"text-gray-700",children:s.quartier})]}),s.telephone&&t("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 rounded-full bg-gray-100",children:e(le,{className:"h-4 w-4",style:{color:a}})}),e("a",{href:`tel:${s.telephone}`,className:"text-gray-700 hover:underline hover:text-gray-900 transition-colors",children:s.telephone})]})]})]}),Ge=({groupedByVille:s,openVilles:a,toggleVille:o,onClose:n,primaryColor:l,classes:r,t:c})=>e(x.section,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4",onClick:n,children:t(x.div,{className:"relative w-full max-w-3xl max-h-[85vh] overflow-y-auto rounded-2xl",initial:{scale:.96,y:20},animate:{scale:1,y:0},exit:{scale:.96,y:20},transition:{type:"spring",damping:25},onClick:i=>i.stopPropagation(),style:{backgroundColor:"#ffffff",boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[t("div",{className:"sticky top-0 p-5 flex justify-between items-center z-10 border-b border-gray-100",style:{backdropFilter:"blur(12px)",backgroundColor:"rgba(255,255,255,0.85)"},children:[e("h2",{className:"text-2xl font-bold",style:{color:l},children:c("ourAgencies")}),e("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":c("close"),children:e(W,{className:"h-6 w-6 text-gray-600"})})]}),e("div",{className:"p-5",children:Object.entries(s).map(([i,d])=>t("div",{className:"mb-5",children:[t(x.button,{onClick:()=>o(i),className:"w-full text-left py-4 px-5 rounded-xl flex justify-between items-center transition-colors",whileHover:{backgroundColor:"rgba(0,0,0,0.03)"},style:{backgroundColor:a[i]?"rgba(0,0,0,0.02)":"transparent",color:"#333"},children:[t("div",{className:"flex items-center gap-3",children:[e("span",{className:"font-semibold text-lg",children:i}),t("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:`${l}20`,color:l},children:[d.length," ",d.length>1?c("agencies"):c("agency")]})]}),a[i]?e(ne,{className:"h-5 w-5 text-gray-500"}):e(Y,{className:"h-5 w-5 text-gray-500"})]}),e(I,{children:a[i]&&e(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut"},className:"overflow-hidden pl-5 ml-2 border-l-2",style:{borderColor:`${l}40`},children:d.map((p,h)=>e(Ze,{agence:p,primaryColor:l},`${p.id}-${h}`))})})]},i))})]})}),Je=({companyId:s,primaryColor:a,secondaryColor:o="#f8fafc"})=>{const{t:n}=F(),[l,r]=m.useState([]),[c,i]=m.useState(0),[d,p]=m.useState(!1);m.useEffect(()=>{if(!s)return;(async()=>{try{const g=ce($(L,"avis"),O("companyId","==",s),O("visible","==",!0),Te("note","desc"),Be(10)),z=(await j(g)).docs.map(C=>{var S;return{id:C.id,...C.data(),date:(S=C.data().date)==null?void 0:S.toDate().toLocaleDateString("fr-FR")}});r(z)}catch(g){console.error("Erreur chargement avis :",g)}})()},[s]),m.useEffect(()=>{if(l.length<=1||d)return;const f=setInterval(()=>{i(g=>(g+1)%l.length)},7e3);return()=>clearInterval(f)},[l,d]);const h=()=>i(f=>(f+1)%l.length),b=()=>i(f=>(f-1+l.length)%l.length);if(l.length===0)return null;const u=l[c],w=()=>Array(5).fill(0).map((f,g)=>e(re,{size:16,className:g<u.note?"fill-current":"",style:{color:g<u.note?a:"#d1d5db"}},g));return e("div",{className:"py-10 px-4 md:px-6",style:{backgroundColor:o},children:t("div",{className:"max-w-4xl mx-auto",children:[t("div",{className:"text-center mb-6",children:[e("h2",{className:"text-2xl font-bold mb-1",style:{color:a},children:n("whatClientsSay")}),e("p",{className:"text-gray-600 text-sm",children:n("realExperiences")})]}),t("div",{className:"relative",onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[e(I,{mode:"wait",children:e(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-md p-6",children:t("div",{className:"flex flex-col sm:flex-row gap-4 items-center sm:items-start",children:[e("div",{className:"w-12 h-12 flex items-center justify-center rounded-full",style:{backgroundColor:`${a}20`},children:e(je,{size:24,style:{color:a}})}),t("div",{className:"text-center sm:text-left",children:[e("div",{className:"flex justify-center sm:justify-start mb-2",children:w()}),t("p",{className:"text-sm italic text-gray-700 mb-2",children:['"',u.commentaire,'"']}),e("p",{className:"text-sm font-medium text-gray-900",children:u.nom}),u.date&&e("p",{className:"text-xs text-gray-500",children:u.date})]})]})},u.id)}),l.length>1&&t(ie,{children:[e("button",{onClick:b,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-white p-1 rounded-full shadow hover:bg-gray-50",children:e(ae,{size:20,style:{color:a}})}),e("button",{onClick:h,className:"absolute right-0 top-1/2 -translate-y-1/2 bg-white p-1 rounded-full shadow hover:bg-gray-50",children:e(se,{size:20,style:{color:a}})})]})]}),l.length>1&&e("div",{className:"flex justify-center gap-1 mt-4",children:l.map((f,g)=>e("button",{onClick:()=>i(g),className:`w-2 h-2 rounded-full transition-all ${c===g?"bg-gray-800 scale-110":"bg-gray-300"}`},g))})]})})},Ke=()=>{const{i18n:s}=F(),a=o=>{s.changeLanguage(o)};return t("div",{className:"flex gap-2 text-sm",children:[e("button",{onClick:()=>a("fr"),className:"hover:underline",children:"🇫🇷"}),e("button",{onClick:()=>a("en"),className:"hover:underline",children:"🇬🇧"})]})},et=({canvasRef:s})=>(m.useEffect(()=>{const a=s.current;if(!a)return;const o=a.getContext("2d");if(!o)return;a.width=a.offsetWidth,a.height=a.offsetHeight,o.fillStyle="rgba(10, 10, 20, 0.95)",o.fillRect(0,0,a.width,a.height);const n=100;for(let l=0;l<n;l++){const r=Math.random()*a.width,c=Math.random()*a.height,i=Math.random()*1.2,d=Math.random()*.8+.2;o.beginPath(),o.arc(r,c,i,0,Math.PI*2),o.fillStyle=`rgba(255, 255, 255, ${d})`,o.fill()}},[]),null),tt=({onClose:s,navigate:a,onShowAgencies:o,slug:n,colors:l,classes:r,config:c,t:i})=>{const d=m.useRef(null);return t(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"fixed top-20 right-4 left-4 z-50 rounded-xl shadow-2xl overflow-hidden",children:[e("canvas",{ref:d,className:"absolute inset-0 w-full h-full"}),e(et,{canvasRef:d}),e("div",{className:"relative z-10 p-4 text-white",children:t("nav",{className:"flex flex-col gap-2",children:[t("button",{onClick:()=>{o(),s()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${r.button}`,"aria-label":i("ourAgencies"),children:[e(D,{className:"h-5 w-5 text-blue-300"}),e("span",{className:"font-medium",children:i("ourAgencies")})]}),t("button",{onClick:()=>{a(`/compagnie/${n}/mes-reservations`),s()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${r.button}`,"aria-label":i("myBookings"),children:[e(Ie,{className:"h-5 w-5 text-green-300"}),e("span",{className:"font-medium",children:i("myBookings")})]}),t("button",{onClick:()=>{a("/login"),s()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${r.button}`,"aria-label":i("login"),children:[e(oe,{className:"h-5 w-5 text-yellow-300"}),e("span",{className:"font-medium",children:i("login")})]}),t("div",{className:"mt-4 pt-4 border-t border-white border-opacity-20",children:[t("div",{className:"flex items-center gap-2 mb-2 text-sm font-medium",children:[e(ze,{className:"h-4 w-4 text-white"}),e("span",{className:"text-white",children:i("language")||"Langue"})]}),e(Ke,{})]})]})})]})},at=()=>{const s=a=>{X.changeLanguage(a)};return t("div",{className:"flex gap-2",children:[e("button",{onClick:()=>s("fr"),className:"text-sm hover:underline",children:"FR"}),e("span",{className:"text-gray-400",children:"|"}),e("button",{onClick:()=>s("en"),className:"text-sm hover:underline",children:"EN"})]})},st=s=>{const a=s.replace("#",""),o=parseInt(a.substring(0,2),16),n=parseInt(a.substring(2,4),16),l=parseInt(a.substring(4,6),16);return(o*299+n*587+l*114)/1e3<128},rt=({company:s,slug:a,colors:o,classes:n,config:l,menuOpen:r,setMenuOpen:c,setShowAgences:i,navigate:d,t:p})=>{const h="/default-logo.png",b=o.primary||"#facc15",u=o.secondary||"#e2e8f0",w=st(b)?b:u;return t("header",{className:"sticky top-0 z-50 w-full backdrop-blur-md bg-transparent border-b border-white/10",children:[e("div",{className:"absolute top-0 left-0 w-full h-[80px] bg-transparent overflow-hidden",children:e("svg",{viewBox:"0 0 1440 120",preserveAspectRatio:"none",className:"w-full h-full",children:e("path",{d:"M0,0 C480,60 960,0 1440,70 L1440,0 L0,0 Z",fill:u})})}),t("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-3 flex justify-between items-center",children:[t("div",{className:"flex items-center gap-3",children:[e("button",{onClick:()=>c(!r),className:"md:hidden p-2 rounded-md border border-gray-300 bg-white shadow","aria-label":"Menu",children:r?e(W,{className:"h-6 w-6 text-slate-800"}):e(Fe,{className:"h-6 w-6 text-slate-800"})}),e("div",{className:"h-10 w-10 rounded-full bg-white border border-gray-200 overflow-hidden shadow-sm flex-shrink-0",children:e(te.LazyLoadImage,{src:s.logoUrl||h,alt:`Logo ${s.nom||"Compagnie"}`,className:"w-full h-full object-contain",onError:f=>f.target.src=h})}),e("span",{className:"text-xl font-bold whitespace-normal break-words leading-tight",style:{color:w,maxWidth:"250px"},title:s.nom||p("ourCompany"),children:s.nom||p("ourCompany")})]}),e("div",{className:"hidden md:block",children:e(at,{})}),t("div",{className:"hidden md:flex items-center gap-4",children:[e("button",{onClick:()=>d(`/${a}/mes-reservations`),className:"text-sm font-medium text-gray-700 hover:text-black transition",children:p("myBookings")||"Mes réservations"}),e("button",{onClick:()=>i(!0),className:"text-sm font-medium text-gray-700 hover:text-black transition",children:p("ourAgencies")||"Nos agences"}),e("button",{onClick:()=>d("/login"),className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition","aria-label":p("login"),children:e(oe,{className:"h-5 w-5 text-gray-700"})})]})]}),e(I,{children:r&&e(tt,{onClose:()=>c(!1),navigate:f=>{d(f),c(!1)},onShowAgencies:()=>{i(!0),c(!1)},slug:a,colors:o,classes:n,config:l,t:p})})]})},lt=({message:s="La page demandée est introuvable.",primaryColor:a,buttonLabel:o="Retour à l'accueil"})=>{const n=Q();return e("div",{className:"min-h-screen flex items-center justify-center bg-black text-white p-6",children:t(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md",children:[e(Pe,{className:"mx-auto mb-4 h-16 w-16 text-red-500"}),e("h1",{className:"text-3xl font-bold mb-2",children:"Erreur 404"}),e("p",{className:"mb-6 text-gray-300",children:s}),e("button",{onClick:()=>n("/"),className:"px-6 py-3 rounded-lg font-semibold text-white transition shadow-lg",style:{backgroundColor:a},children:o})]})})},dt=({company:s,isMobile:a=!1})=>{const{slug:o}=Re(),n=Q(),{t:l}=F(),[r,c]=m.useState(s),{colors:i,classes:d,config:p}=De(r),[h,b]=m.useState([]),[u,w]=m.useState([]),[f,g]=m.useState(!1),[P,z]=m.useState(!1),[C,S]=m.useState(!r),[R,V]=m.useState(null),[N,A]=m.useState({}),[_,Z]=m.useState(!1),de=v=>{A(y=>({...y,[v]:!y[v]}))},me=m.useMemo(()=>h.reduce((v,y)=>(v[y.ville]||(v[y.ville]=[]),v[y.ville].push(y),v),{}),[h]);return m.useEffect(()=>{const v=setTimeout(()=>Z(!0),4e3);return()=>clearTimeout(v)},[]),m.useEffect(()=>{(async()=>{var y;if(r!=null&&r.id)try{const T=(await j($(L,"companies",r.id,"agences"))).docs.map(B=>({id:B.id,...B.data()})),q=new Map;for(const B of T){const ue=await j($(L,"companies",r.id,"agences",B.id,"weeklyTrips"));for(const ge of ue.docs){const k=ge.data(),U=k.depart||k.departure,H=k.arrivee||k.arrival,fe=k.price??k.prix??0;if(!U||!H)continue;const G=`${U}__${H}`;q.has(G)||q.set(G,{departure:U,arrival:H,price:fe,frequency:((y=k.days)==null?void 0:y.length)>0?`${k.days.length} jours / semaine`:"Départs réguliers",imageUrl:void 0})}}const he=Array.from(q.values()).slice(0,6);w(he)}catch(M){console.error("Erreur chargement suggestions :",M)}})()},[r]),m.useEffect(()=>{r&&(async()=>{if(r!=null&&r.id)try{S(!0);const y=$(L,"companies",r.id,"agences"),M=await j(y);b(M.docs.map(T=>({id:T.id,...T.data()})))}catch(y){console.error("Erreur chargement agences",y),V(l("loadingError"))}finally{S(!1)}})()},[r,l]),C?e(_e,{message:l("loading"),colors:{primary:i.primary,text:i.text,background:i.background}}):R?e(qe,{error:R,colors:i,classes:d,t:l,navigate:n,slug:o}):!r||!o?e(lt,{primaryColor:i.primary}):t("div",{className:`min-h-screen flex flex-col ${p.typography}`,style:{backgroundColor:i.background||"#ffffff",color:i.text},children:[e(rt,{company:r,colors:i,classes:d,config:p,menuOpen:P,setMenuOpen:z,setShowAgences:g,isMobile:a,t:l,slug:o,navigate:n}),t("main",{className:"flex-grow",children:[e(We,{company:r,onSearch:(v,y)=>{n(`/${o}/booking?departure=${encodeURIComponent(v)}&arrival=${encodeURIComponent(y)}`)},isMobile:a}),e(Ue,{suggestions:u,company:r,onSelect:(v,y)=>{n(`/${o}/booking?departure=${encodeURIComponent(v)}&arrival=${encodeURIComponent(y)}`)}}),e(Ye,{images:r.imagesSlider||[],primaryColor:i.primary}),e(Je,{companyId:r.id,primaryColor:i.primary,isMobile:a}),e(I,{children:f&&e(Ge,{groupedByVille:me,openVilles:N,toggleVille:de,onClose:()=>g(!1),primaryColor:i.primary,classes:d,t:l,isMobile:a})}),_&&e(He,{onSelectLanguage:v=>{X.changeLanguage(v),Z(!1)},delayMs:8e3})]}),e(Xe,{company:r,isMobile:a})]})};export{dt as default};
