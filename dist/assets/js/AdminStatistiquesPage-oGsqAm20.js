import{r as c,a as s,j as t}from"./react-DgrrIcw2.js";import{l as m,k as h}from"./firebase-eGIzIftJ.js";import{d as p}from"../index-p6Te0bSg.js";import{L,a as j}from"./LineChart-Cmjn5Xlf.js";import{C as x}from"./CartesianGrid-Baa3W_b2.js";import{X as f,Y as g,T as b,L as u,R as v,B as k,a as B}from"./BarChart-CrYhCjc_.js";import{J as E}from"./vendor-BHjJ2Hjk.js";const Y=()=>{const[i,y]=c.useState([]),[N,C]=c.useState([]);c.useEffect(()=>{(async()=>{const a=await m(h(p,"reservations")),o=await m(h(p,"compagnies"));y(a.docs.map(n=>n.data())),C(o.docs.map(n=>n.data()))})()},[]);const w=i.length,S=i.reduce((e,a)=>e+(a.total||0),0),D=N.filter(e=>e.status==="actif").length,l={};i.forEach(e=>{var n,d;const a=((d=(n=e.createdAt)==null?void 0:n.toDate)==null?void 0:d.call(n))||new Date,o=E(a,"yyyy-MM");l[o]||(l[o]={total:0}),l[o].total+=e.total||0});const R=Object.entries(l).map(([e,a])=>({month:e,total:a.total})).sort((e,a)=>e.month.localeCompare(a.month)),r={};i.forEach(e=>{var o;const a=((o=e.trip)==null?void 0:o.company)||"Inconnue";r[a]=(r[a]||0)+(e.total||0)});const A=Object.entries(r).map(([e,a])=>({name:e,total:a})).sort((e,a)=>a.total-e.total).slice(0,5);return s("div",{className:"p-6",children:[t("h1",{className:"text-2xl font-bold mb-4",children:"Statistiques générales"}),s("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8",children:[s("div",{className:"bg-white rounded shadow p-4 text-center",children:[t("h2",{className:"text-xl font-semibold",children:"Réservations"}),t("p",{className:"text-3xl font-bold text-blue-600",children:w})]}),s("div",{className:"bg-white rounded shadow p-4 text-center",children:[t("h2",{className:"text-xl font-semibold",children:"Revenus totaux"}),s("p",{className:"text-3xl font-bold text-green-600",children:[S.toLocaleString()," FCFA"]})]}),s("div",{className:"bg-white rounded shadow p-4 text-center",children:[t("h2",{className:"text-xl font-semibold",children:"Compagnies actives"}),t("p",{className:"text-3xl font-bold text-indigo-600",children:D})]})]}),s("div",{className:"mb-10",children:[t("h2",{className:"text-lg font-semibold mb-2",children:"Évolution des revenus par mois"}),t(v,{width:"100%",height:300,children:s(L,{data:R,children:[t(x,{strokeDasharray:"3 3"}),t(f,{dataKey:"month"}),t(g,{}),t(b,{}),t(u,{}),t(j,{type:"monotone",dataKey:"total",stroke:"#10B981",name:"Revenus"})]})})]}),s("div",{children:[t("h2",{className:"text-lg font-semibold mb-2",children:"Top 5 compagnies par revenus"}),t(v,{width:"100%",height:300,children:s(k,{data:A,children:[t(x,{strokeDasharray:"3 3"}),t(f,{dataKey:"name"}),t(g,{}),t(b,{}),t(u,{}),t(B,{dataKey:"total",fill:"#6366F1",name:"CA total"})]})})]})]})};export{Y as default};
