import{r as c,a as s,j as t}from"./react-DB_4kGOy.js";import{z as m,x as h}from"./firebase-lLzYRzUk.js";import{d as p}from"../index-Bkmir__O.js";import{L as A,a as B}from"./LineChart-Q1TCdBKb.js";import{C as f}from"./CartesianGrid-D4v3AkFP.js";import{X as x,Y as g,T as b,j as u,R as v,B as L}from"./generateCategoricalChart-B2qQXPfN.js";import{B as E}from"./BarChart-CgOoYHZJ.js";import{f as K}from"./vendor-C-DAJou6.js";const z=()=>{const[i,y]=c.useState([]),[N,C]=c.useState([]);c.useEffect(()=>{(async()=>{const a=await m(h(p,"reservations")),o=await m(h(p,"compagnies"));y(a.docs.map(n=>n.data())),C(o.docs.map(n=>n.data()))})()},[]);const w=i.length,S=i.reduce((e,a)=>e+(a.total||0),0),D=N.filter(e=>e.status==="actif").length,r={};i.forEach(e=>{var n,d;const a=((d=(n=e.createdAt)==null?void 0:n.toDate)==null?void 0:d.call(n))||new Date,o=K(a,"yyyy-MM");r[o]||(r[o]={total:0}),r[o].total+=e.total||0});const R=Object.entries(r).map(([e,a])=>({month:e,total:a.total})).sort((e,a)=>e.month.localeCompare(a.month)),l={};i.forEach(e=>{var o;const a=((o=e.trip)==null?void 0:o.company)||"Inconnue";l[a]=(l[a]||0)+(e.total||0)});const j=Object.entries(l).map(([e,a])=>({name:e,total:a})).sort((e,a)=>a.total-e.total).slice(0,5);return s("div",{className:"p-6",children:[t("h1",{className:"text-2xl font-bold mb-4",children:"Statistiques générales"}),s("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8",children:[s("div",{className:"bg-white rounded shadow p-4 text-center",children:[t("h2",{className:"text-xl font-semibold",children:"Réservations"}),t("p",{className:"text-3xl font-bold text-blue-600",children:w})]}),s("div",{className:"bg-white rounded shadow p-4 text-center",children:[t("h2",{className:"text-xl font-semibold",children:"Revenus totaux"}),s("p",{className:"text-3xl font-bold text-green-600",children:[S.toLocaleString()," FCFA"]})]}),s("div",{className:"bg-white rounded shadow p-4 text-center",children:[t("h2",{className:"text-xl font-semibold",children:"Compagnies actives"}),t("p",{className:"text-3xl font-bold text-indigo-600",children:D})]})]}),s("div",{className:"mb-10",children:[t("h2",{className:"text-lg font-semibold mb-2",children:"Évolution des revenus par mois"}),t(v,{width:"100%",height:300,children:s(A,{data:R,children:[t(f,{strokeDasharray:"3 3"}),t(x,{dataKey:"month"}),t(g,{}),t(b,{}),t(u,{}),t(B,{type:"monotone",dataKey:"total",stroke:"#10B981",name:"Revenus"})]})})]}),s("div",{children:[t("h2",{className:"text-lg font-semibold mb-2",children:"Top 5 compagnies par revenus"}),t(v,{width:"100%",height:300,children:s(E,{data:j,children:[t(f,{strokeDasharray:"3 3"}),t(x,{dataKey:"name"}),t(g,{}),t(b,{}),t(u,{}),t(L,{dataKey:"total",fill:"#6366F1",name:"CA total"})]})})]})]})};export{z as default};
