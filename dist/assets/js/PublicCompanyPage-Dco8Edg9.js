import{j as e,M as B,r as d,W as O,aT as $,aU as W,aV as ue,Q as G,d as z,f as ee,_ as ge,A as fe,C as se,n as te,aW as ae,u as Y,I as pe,aX as be,aN as re,aO as je,o as ye,aY as J,aZ as ve,a_ as we,a$ as Ne,b0 as ke,b1 as Ce,b2 as le,b3 as Se,b4 as Le,U as $e,b5 as Ae,z as ne,b6 as Ee,Y as Ie,m as ze,b as Fe}from"./react-PtMwKKf1.js";import{l as A,k as C,q as ie,w as H,A as Ve,H as Pe,E as Re,D as Te}from"./firebase-eGIzIftJ.js";import{m as p,A as E,i as Q,d as S,b as Me,L as Be,E as De}from"../index-C4y8wfzK.js";import"./vendor-B5FTF_2c.js";const _e=({suggestions:t,company:s,onSelect:i})=>{const l=s.couleurPrimaire||"#3b82f6",r=s.couleurSecondaire||"#e0f2fe";return e.jsx("div",{className:"px-4 md:px-8 mt-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-4 text-center",children:e.jsxs("h2",{className:"text-xl md:text-xl font-extrabold text-black flex justify-center items-center gap-2",children:[e.jsx(B,{style:{color:l},size:22}),e.jsx("span",{children:"Nos destination"})]})}),e.jsx("div",{className:"flex space-x-3 overflow-x-auto pb-3 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:t.slice(0,10).map((a,o)=>e.jsx(p.div,{whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},className:"min-w-[120px] bg-white rounded-lg shadow-md px-4 py-3 flex-shrink-0 cursor-pointer",style:{borderLeft:`8px solid ${r}`},onClick:()=>i(a.departure,a.arrival),children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-semibold text-gray-900 text-sm mb-1",children:[a.departure," â†’ ",a.arrival]}),a.price!==void 0&&e.jsxs("div",{className:"text-xs font-bold text-white inline-block px-3 py-1 rounded-full",style:{backgroundColor:l},children:[a.price.toLocaleString()," FCFA"]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{className:"text-xs font-medium px-3 py-1.5 rounded-md text-white",style:{backgroundColor:l},children:"RÃ©server"})})]})},o))})]})})},Ue=({onSelectLanguage:t,delayMs:s=5e3})=>{const[i,l]=d.useState(!0);d.useEffect(()=>{const a=setTimeout(()=>{l(!1)},s);return()=>clearTimeout(a)},[s]);const r=a=>{Q.changeLanguage(a),t(a),l(!1)};return i?e.jsx(E,{children:e.jsxs(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.4},className:"fixed top-5 right-5 z-50 bg-white border border-gray-200 shadow-xl rounded-lg p-4 w-[300px] max-w-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-800",children:"Choisissez votre langue"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(O,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>r("fr"),className:"px-4 py-1.5 rounded-full text-sm font-medium shadow-sm",style:{backgroundColor:"#facc15",color:"#000"},children:"FranÃ§ais"}),e.jsx("button",{onClick:()=>r("en"),className:"px-4 py-1.5 rounded-full text-sm font-medium shadow-sm",style:{backgroundColor:"#1e293b",color:"#fff"},children:"English"})]})]})}):null},K=({label:t,placeholder:s="Choisissez une ville",value:i,onChange:l,highlightColor:r="#3B82F6"})=>{const[a,o]=d.useState(""),[n,c]=d.useState([]);d.useEffect(()=>{(async()=>{try{const x=(await A(C(S,"villes"))).docs.map(y=>y.data().nom).filter(Boolean);c(x)}catch(f){console.error("Erreur chargement villes :",f)}})()},[]);const g=a===""?n:n.filter(m=>m.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").includes(a.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")));return e.jsx("div",{className:"w-full",children:e.jsxs($,{value:i,onChange:l,children:[e.jsx($.Label,{className:"block text-sm font-medium text-white mb-1",children:t}),e.jsxs("div",{className:"relative",children:[e.jsx($.Input,{className:"w-full border border-gray-300 rounded-md py-2 pl-3 pr-10 text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-primary",displayValue:m=>m,value:i,onChange:m=>{o(m.target.value),l(m.target.value)},placeholder:s,autoComplete:"off"}),e.jsx($.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx(W,{className:"h-4 w-4 text-gray-400"})}),g.length>0&&e.jsx($.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none sm:text-sm",children:g.map((m,f)=>e.jsx($.Option,{value:m,className:({active:x})=>`relative cursor-pointer select-none py-2 pl-10 pr-4 ${x?"text-white":"text-gray-900"}`,children:({selected:x,active:y})=>e.jsxs("div",{style:{backgroundColor:y?r:void 0},className:"w-full h-full",children:[e.jsx("span",{className:`block truncate ${x?"font-semibold":"font-normal"}`,children:m}),x&&e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",style:{color:y?"white":r},children:e.jsx(ue,{className:"h-4 w-4","aria-hidden":"true"})})]})},f))})]})]})})},qe=t=>{const[s,i]=d.useState([]);return d.useEffect(()=>{if(!t)return;(async()=>{const r=ie(C(S,"weeklyTrips"),H("companyId","==",t)),o=(await A(r)).docs.map(m=>m.data()),n=o.map(m=>{var f,x;return(x=(f=m.departure)==null?void 0:f.toLowerCase())==null?void 0:x.trim()}),c=o.map(m=>{var f,x;return(x=(f=m.arrival)==null?void 0:f.toLowerCase())==null?void 0:x.trim()}),g=Array.from(new Set([...n,...c])).filter(Boolean);i(g)})()},[t]),s},He=({company:t,onSearch:s})=>{const[i,l]=G.useState(""),[r,a]=G.useState(""),{t:o}=z(),n=qe(t.id),c=m=>{m.preventDefault(),s(i.trim().toLowerCase(),r.trim().toLowerCase())},g=t.couleurPrimaire||"#3B82F6";return e.jsxs("section",{className:"relative w-full min-h-[600px] flex items-center justify-center overflow-hidden bg-gray-100",children:[t.banniereUrl&&e.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e.jsx(ee.LazyLoadImage,{src:t.banniereUrl,alt:`BanniÃ¨re ${t.nom}`,className:"w-full h-full object-cover object-center",effect:"opacity",width:"100%",height:"100%",style:{objectPosition:"center center",minHeight:"100%",minWidth:"100%"}}),e.jsx("div",{className:"absolute inset-0 bg-black/30"})]}),e.jsx(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"absolute top-8 left-1/2 transform -translate-x-1/2 z-10",children:e.jsx("div",{className:"text-white text-xl md:text-2xl font-semibold text-center",children:t.accroche||o("defaultSlogan")})}),e.jsx("div",{className:"relative z-10 w-full max-w-5xl px-5",children:e.jsxs(p.form,{onSubmit:c,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"bg-transparent rounded-xl border border-white px-6 py-4 backdrop-blur-md",children:[e.jsx("p",{className:"text-sm md:text-base font-semibold mb-4 text-white",children:t.instructionRecherche||o("searchInstruction")}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[e.jsx("div",{className:"w-full md:w-1/3",children:e.jsx(K,{label:o("departureCity"),value:i,onChange:l,options:n})}),e.jsx("div",{className:"w-full md:w-1/3",children:e.jsx(K,{label:o("arrivalCity"),value:r,onChange:a,options:n})}),e.jsxs("button",{type:"submit",className:"w-full md:w-auto px-5 py-2 rounded-md text-white font-semibold flex items-center justify-center gap-2",style:{backgroundColor:g},children:[e.jsx(ge,{className:"h-4 w-4"}),o("searchTrip"),e.jsx(fe,{className:"h-4 w-4"})]})]})]})})]})};function Oe({images:t,primaryColor:s}){const[i,l]=d.useState(0),r=a=>{l(o=>a==="prev"?o===0?t.length-1:o-1:o===t.length-1?0:o+1)};return d.useEffect(()=>{const a=setInterval(()=>r("next"),6e3);return()=>clearInterval(a)},[t]),!t||t.length===0?null:e.jsx("section",{className:"relative w-full max-w-6xl mx-auto my-10 rounded-xl overflow-hidden shadow border border-gray-200",children:e.jsxs("div",{className:"relative h-64 md:h-96",children:[e.jsx(E,{mode:"wait",children:e.jsx(p.img,{src:t[i],alt:`Slide ${i}`,initial:{opacity:.6,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.02},transition:{duration:.5},className:"absolute inset-0 w-full h-full object-cover"},i)}),e.jsxs("div",{className:"absolute inset-0 flex justify-between items-center px-4",children:[e.jsx("button",{onClick:()=>r("prev"),className:"p-2 rounded-full bg-white/80 hover:bg-white shadow",children:e.jsx(se,{className:"h-5 w-5 text-gray-700"})}),e.jsx("button",{onClick:()=>r("next"),className:"p-2 rounded-full bg-white/80 hover:bg-white shadow",children:e.jsx(te,{className:"h-5 w-5 text-gray-700"})})]}),e.jsx("div",{className:"absolute bottom-3 w-full flex justify-center gap-2",children:t.map((a,o)=>e.jsx("div",{className:`h-2 w-2 rounded-full transition-all duration-300 ${o===i?"bg-white":"bg-gray-400"}`},o))})]})})}const We=({companyId:t,onSuccess:s,primaryColor:i})=>{const[l,r]=d.useState(""),[a,o]=d.useState(0),[n,c]=d.useState(""),[g,m]=d.useState(null),[f,x]=d.useState(!1),y=async u=>{if(u.preventDefault(),!l.trim()||a<1||!n.trim()){m("Veuillez remplir tous les champs et choisir une note.");return}try{x(!0),await Ve(C(S,"avis"),{nom:l,note:a,commentaire:n,visible:!1,companyId:t,createdAt:Pe()}),m("Merci pour votre avis ! Il sera publiÃ© aprÃ¨s validation."),r(""),o(0),c(""),s&&s()}catch(h){console.error(h),m("Erreur lors de l'envoi. Veuillez rÃ©essayer.")}finally{x(!1)}};return e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[g&&e.jsx("p",{className:"text-sm text-gray-600 italic",children:g}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Votre nom"}),e.jsx("input",{type:"text",value:l,onChange:u=>r(u.target.value),className:"w-full border px-3 py-2 rounded",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Votre note"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(u=>e.jsx(ae,{onClick:()=>o(u),className:`h-6 w-6 cursor-pointer ${u<=a?"text-yellow-400":"text-gray-300"}`,fill:u<=a?"#facc15":"none"},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Votre avis"}),e.jsx("textarea",{value:n,onChange:u=>c(u.target.value),className:"w-full border px-3 py-2 rounded",rows:4,required:!0})]}),e.jsx("button",{type:"submit",disabled:f,className:"text-white px-4 py-2 rounded hover:opacity-90 transition",style:{backgroundColor:i},children:f?"Envoi en cours...":"Envoyer mon avis"})]})},Ye=({company:t})=>{const[s,i]=d.useState(!1);Y();const{t:l}=z(),r=new Date().getFullYear(),{id:a,slug:o,nom:n,couleurPrimaire:c,couleurSecondaire:g,description:m,email:f,telephone:x,adresse:y,horaires:u,socialMedia:h={},footerConfig:F={}}=t,{showAbout:I=!0,showContact:N=!0,showSocial:k=!0,showTestimonials:V=!0,showLegalLinks:P=!0,customLinks:v=[]}=F;return e.jsxs("footer",{className:"relative w-full overflow-hidden",style:{backgroundColor:g||"#f8fafc",color:"#1e293b"},children:[e.jsx("div",{className:"absolute inset-0 bg-[url('/world-map.svg')] bg-center bg-cover opacity-5 pointer-events-none"}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[I&&e.jsxs(p.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(pe,{className:"h-5 w-5",style:{color:c}}),e.jsx("h3",{className:"text-lg font-semibold",children:l("about")})]}),e.jsx("p",{className:"text-sm text-gray-700",children:m||l("defaultAbout")})]}),N&&e.jsxs(p.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(be,{className:"h-5 w-5",style:{color:c}}),e.jsx("h3",{className:"text-lg font-semibold",children:l("contact")})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[x&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("a",{href:`tel:${x}`,className:"hover:underline",children:x})]}),f&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsx("a",{href:`mailto:${f}`,className:"hover:underline",children:f})]}),y&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:y})]}),u&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{children:u})]})]})]}),k&&Object.values(h).some(Boolean)&&e.jsxs(p.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(J,{className:"h-5 w-5",style:{color:c}}),e.jsx("h3",{className:"text-lg font-semibold",children:l("followUs")})]}),e.jsxs("div",{className:"flex gap-4",children:[h.facebook&&e.jsx("a",{href:h.facebook,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ve,{className:"h-6 w-6 hover:opacity-80 transition"})}),h.instagram&&e.jsx("a",{href:h.instagram,target:"_blank",rel:"noopener noreferrer",children:e.jsx(we,{className:"h-6 w-6 hover:opacity-80 transition"})}),h.twitter&&e.jsx("a",{href:h.twitter,target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ne,{className:"h-6 w-6 hover:opacity-80 transition"})}),h.linkedin&&e.jsx("a",{href:h.linkedin,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ke,{className:"h-6 w-6 hover:opacity-80 transition"})}),h.youtube&&e.jsx("a",{href:h.youtube,target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ce,{className:"h-6 w-6 hover:opacity-80 transition"})})]})]}),V&&e.jsx(p.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(J,{className:"h-5 w-5",style:{color:c}}),e.jsx("h3",{className:"text-lg font-semibold",children:l("customerReviews")})]}),e.jsxs(p.button,{onClick:()=>i(!s),className:"flex items-center justify-between px-4 py-2 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:c||"#3B82F6",color:"white"},whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("span",{children:l("leaveReview")}),s?e.jsx(le,{className:"h-4 w-4 ml-2"}):e.jsx(W,{className:"h-4 w-4 ml-2"})]}),s&&e.jsx(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"mt-4",children:e.jsx(We,{companyId:a,primaryColor:c||"#3B82F6",onSuccess:()=>i(!1)})})})]})})]}),(P||(v==null?void 0:v.length)>0)&&e.jsx("div",{className:"border-t py-6 text-center text-sm relative z-10",style:{borderColor:c?`${c}20`:"#e2e8f0"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-2",children:[P&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`/${o}/mentions-legales`,className:"hover:underline",children:l("legalNotice")}),e.jsx("a",{href:`/${o}/confidentialite`,className:"hover:underline",children:l("privacyPolicy")}),e.jsx("a",{href:`/${o}/conditions`,className:"hover:underline",children:l("termsConditions")}),e.jsx("a",{href:`/${o}/cookies`,className:"hover:underline",children:l("cookiePolicy")})]}),v==null?void 0:v.map((L,D)=>e.jsx("a",{href:L.url,className:"hover:underline",target:L.external?"_blank":"_self",rel:L.external?"noopener noreferrer":"",children:L.label},D))]}),e.jsxs("p",{children:["Â© ",r," ",n||l("ourCompany"),". ",l("allRightsReserved")]})]})})]})},Qe=({agence:t,primaryColor:s})=>e.jsxs(p.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{duration:.2},className:"p-5 my-3 rounded-xl shadow-sm hover:shadow-md transition-all",style:{backgroundColor:"#ffffff",borderLeft:`4px solid ${s}`,boxShadow:"0 2px 12px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",style:{color:s},children:t.nomAgence}),t.latitude&&t.longitude&&e.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${t.latitude},${t.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:[e.jsx(Se,{className:"h-3 w-3"}),e.jsx("span",{children:"Maps"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:e.jsx(Le,{className:"h-4 w-4",style:{color:s}})}),e.jsx("span",{className:"text-gray-700",children:t.pays})]}),t.quartier&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:e.jsx(B,{className:"h-4 w-4",style:{color:s}})}),e.jsx("span",{className:"text-gray-700",children:t.quartier})]}),t.telephone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-gray-100",children:e.jsx(re,{className:"h-4 w-4",style:{color:s}})}),e.jsx("a",{href:`tel:${t.telephone}`,className:"text-gray-700 hover:underline hover:text-gray-900 transition-colors",children:t.telephone})]})]})]}),Xe=({groupedByVille:t,openVilles:s,toggleVille:i,onClose:l,primaryColor:r,classes:a,t:o})=>e.jsx(p.section,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4",onClick:l,children:e.jsxs(p.div,{className:"relative w-full max-w-3xl max-h-[85vh] overflow-y-auto rounded-2xl",initial:{scale:.96,y:20},animate:{scale:1,y:0},exit:{scale:.96,y:20},transition:{type:"spring",damping:25},onClick:n=>n.stopPropagation(),style:{backgroundColor:"#ffffff",boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{className:"sticky top-0 p-5 flex justify-between items-center z-10 border-b border-gray-100",style:{backdropFilter:"blur(12px)",backgroundColor:"rgba(255,255,255,0.85)"},children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:r},children:o("ourAgencies")}),e.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":o("close"),children:e.jsx(O,{className:"h-6 w-6 text-gray-600"})})]}),e.jsx("div",{className:"p-5",children:Object.entries(t).map(([n,c])=>e.jsxs("div",{className:"mb-5",children:[e.jsxs(p.button,{onClick:()=>i(n),className:"w-full text-left py-4 px-5 rounded-xl flex justify-between items-center transition-colors",whileHover:{backgroundColor:"rgba(0,0,0,0.03)"},style:{backgroundColor:s[n]?"rgba(0,0,0,0.02)":"transparent",color:"#333"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-lg",children:n}),e.jsxs("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:`${r}20`,color:r},children:[c.length," ",c.length>1?o("agencies"):o("agency")]})]}),s[n]?e.jsx(le,{className:"h-5 w-5 text-gray-500"}):e.jsx(W,{className:"h-5 w-5 text-gray-500"})]}),e.jsx(E,{children:s[n]&&e.jsx(p.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut"},className:"overflow-hidden pl-5 ml-2 border-l-2",style:{borderColor:`${r}40`},children:c.map((g,m)=>e.jsx(Qe,{agence:g,primaryColor:r},`${g.id}-${m}`))})})]},n))})]})}),Ze=({companyId:t,primaryColor:s,secondaryColor:i="#f8fafc"})=>{const{t:l}=z(),[r,a]=d.useState([]),[o,n]=d.useState(0),[c,g]=d.useState(!1);d.useEffect(()=>{if(!t)return;(async()=>{try{const h=ie(C(S,"avis"),H("companyId","==",t),H("visible","==",!0),Re("note","desc"),Te(10)),I=(await A(h)).docs.map(N=>{var k;return{id:N.id,...N.data(),date:(k=N.data().date)==null?void 0:k.toDate().toLocaleDateString("fr-FR")}});a(I)}catch(h){console.error("Erreur chargement avis :",h)}})()},[t]),d.useEffect(()=>{if(r.length<=1||c)return;const u=setInterval(()=>{n(h=>(h+1)%r.length)},7e3);return()=>clearInterval(u)},[r,c]);const m=()=>n(u=>(u+1)%r.length),f=()=>n(u=>(u-1+r.length)%r.length);if(r.length===0)return null;const x=r[o],y=()=>Array(5).fill(0).map((u,h)=>e.jsx(ae,{size:16,className:h<x.note?"fill-current":"",style:{color:h<x.note?s:"#d1d5db"}},h));return e.jsx("div",{className:"py-10 px-4 md:px-6",style:{backgroundColor:i},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",style:{color:s},children:l("whatClientsSay")}),e.jsx("p",{className:"text-gray-600 text-sm",children:l("realExperiences")})]}),e.jsxs("div",{className:"relative",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[e.jsx(E,{mode:"wait",children:e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center sm:items-start",children:[e.jsx("div",{className:"w-12 h-12 flex items-center justify-center rounded-full",style:{backgroundColor:`${s}20`},children:e.jsx($e,{size:24,style:{color:s}})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("div",{className:"flex justify-center sm:justify-start mb-2",children:y()}),e.jsxs("p",{className:"text-sm italic text-gray-700 mb-2",children:['"',x.commentaire,'"']}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:x.nom}),x.date&&e.jsx("p",{className:"text-xs text-gray-500",children:x.date})]})]})},x.id)}),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:f,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-white p-1 rounded-full shadow hover:bg-gray-50",children:e.jsx(se,{size:20,style:{color:s}})}),e.jsx("button",{onClick:m,className:"absolute right-0 top-1/2 -translate-y-1/2 bg-white p-1 rounded-full shadow hover:bg-gray-50",children:e.jsx(te,{size:20,style:{color:s}})})]})]}),r.length>1&&e.jsx("div",{className:"flex justify-center gap-1 mt-4",children:r.map((u,h)=>e.jsx("button",{onClick:()=>n(h),className:`w-2 h-2 rounded-full transition-all ${o===h?"bg-gray-800 scale-110":"bg-gray-300"}`},h))})]})})},Ge=()=>{const{i18n:t}=z(),s=i=>{t.changeLanguage(i)};return e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsx("button",{onClick:()=>s("fr"),className:"hover:underline",children:"ðŸ‡«ðŸ‡·"}),e.jsx("button",{onClick:()=>s("en"),className:"hover:underline",children:"ðŸ‡¬ðŸ‡§"})]})},Je=({canvasRef:t})=>(d.useEffect(()=>{const s=t.current;if(!s)return;const i=s.getContext("2d");if(!i)return;s.width=s.offsetWidth,s.height=s.offsetHeight,i.fillStyle="rgba(10, 10, 20, 0.95)",i.fillRect(0,0,s.width,s.height);const l=100;for(let r=0;r<l;r++){const a=Math.random()*s.width,o=Math.random()*s.height,n=Math.random()*1.2,c=Math.random()*.8+.2;i.beginPath(),i.arc(a,o,n,0,Math.PI*2),i.fillStyle=`rgba(255, 255, 255, ${c})`,i.fill()}},[]),null),Ke=({onClose:t,navigate:s,onShowAgencies:i,slug:l,colors:r,classes:a,config:o,t:n})=>{const c=d.useRef(null);return e.jsxs(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"fixed top-20 right-4 left-4 z-50 rounded-xl shadow-2xl overflow-hidden",children:[e.jsx("canvas",{ref:c,className:"absolute inset-0 w-full h-full"}),e.jsx(Je,{canvasRef:c}),e.jsx("div",{className:"relative z-10 p-4 text-white",children:e.jsxs("nav",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>{i(),t()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${a.button}`,"aria-label":n("ourAgencies"),children:[e.jsx(B,{className:"h-5 w-5 text-blue-300"}),e.jsx("span",{className:"font-medium",children:n("ourAgencies")})]}),e.jsxs("button",{onClick:()=>{s(`/compagnie/${l}/mes-reservations`),t()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${a.button}`,"aria-label":n("myBookings"),children:[e.jsx(Ae,{className:"h-5 w-5 text-green-300"}),e.jsx("span",{className:"font-medium",children:n("myBookings")})]}),e.jsxs("button",{onClick:()=>{s("/login"),t()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white hover:bg-opacity-10 ${a.button}`,"aria-label":n("login"),children:[e.jsx(ne,{className:"h-5 w-5 text-yellow-300"}),e.jsx("span",{className:"font-medium",children:n("login")})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white border-opacity-20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-sm font-medium",children:[e.jsx(Ee,{className:"h-4 w-4 text-white"}),e.jsx("span",{className:"text-white",children:n("language")||"Langue"})]}),e.jsx(Ge,{})]})]})})]})},es=()=>{const t=s=>{Q.changeLanguage(s)};return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t("fr"),className:"text-sm hover:underline",children:"FR"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("button",{onClick:()=>t("en"),className:"text-sm hover:underline",children:"EN"})]})},ss=t=>{const s=t.replace("#",""),i=parseInt(s.substring(0,2),16),l=parseInt(s.substring(2,4),16),r=parseInt(s.substring(4,6),16);return(i*299+l*587+r*114)/1e3<128},ts=({company:t,slug:s,colors:i,classes:l,config:r,menuOpen:a,setMenuOpen:o,setShowAgences:n,navigate:c,t:g})=>{const m="/default-logo.png",f=i.primary||"#facc15",x=i.secondary||"#e2e8f0",y=ss(f)?f:x;return e.jsxs("header",{className:"sticky top-0 z-50 w-full backdrop-blur-md bg-transparent border-b border-white/10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-[80px] bg-transparent overflow-hidden",children:e.jsx("svg",{viewBox:"0 0 1440 120",preserveAspectRatio:"none",className:"w-full h-full",children:e.jsx("path",{d:"M0,0 C480,60 960,0 1440,70 L1440,0 L0,0 Z",fill:x})})}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>o(!a),className:"md:hidden p-2 rounded-md border border-gray-300 bg-white shadow","aria-label":"Menu",children:a?e.jsx(O,{className:"h-6 w-6 text-slate-800"}):e.jsx(Ie,{className:"h-6 w-6 text-slate-800"})}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-white border border-gray-200 overflow-hidden shadow-sm flex-shrink-0",children:e.jsx(ee.LazyLoadImage,{src:t.logoUrl||m,alt:`Logo ${t.nom||"Compagnie"}`,className:"w-full h-full object-contain",onError:u=>u.target.src=m})}),e.jsx("span",{className:"text-xl font-bold whitespace-normal break-words leading-tight",style:{color:y,maxWidth:"250px"},title:t.nom||g("ourCompany"),children:t.nom||g("ourCompany")})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx(es,{})}),e.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[e.jsx("button",{onClick:()=>c(`/${s}/mes-reservations`),className:"text-sm font-medium text-gray-700 hover:text-black transition",children:g("myBookings")||"Mes rÃ©servations"}),e.jsx("button",{onClick:()=>n(!0),className:"text-sm font-medium text-gray-700 hover:text-black transition",children:g("ourAgencies")||"Nos agences"}),e.jsx("button",{onClick:()=>c("/login"),className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition","aria-label":g("login"),children:e.jsx(ne,{className:"h-5 w-5 text-gray-700"})})]})]}),e.jsx(E,{children:a&&e.jsx(Ke,{onClose:()=>o(!1),navigate:u=>{c(u),o(!1)},onShowAgencies:()=>{n(!0),o(!1)},slug:s,colors:i,classes:l,config:r,t:g})})]})},as=({message:t="La page demandÃ©e est introuvable.",primaryColor:s,buttonLabel:i="Retour Ã  l'accueil"})=>{const l=Y();return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black text-white p-6",children:e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md",children:[e.jsx(ze,{className:"mx-auto mb-4 h-16 w-16 text-red-500"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Erreur 404"}),e.jsx("p",{className:"mb-6 text-gray-300",children:t}),e.jsx("button",{onClick:()=>l("/"),className:"px-6 py-3 rounded-lg font-semibold text-white transition shadow-lg",style:{backgroundColor:s},children:i})]})})},os=({company:t,isMobile:s=!1})=>{const{slug:i}=Fe(),l=Y(),{t:r}=z(),[a,o]=d.useState(t),{colors:n,classes:c,config:g}=Me(a),[m,f]=d.useState([]),[x,y]=d.useState([]),[u,h]=d.useState(!1),[F,I]=d.useState(!1),[N,k]=d.useState(!a),[V,P]=d.useState(null),[v,L]=d.useState({}),[D,X]=d.useState(!1),oe=j=>{L(b=>({...b,[j]:!b[j]}))},ce=d.useMemo(()=>m.reduce((j,b)=>(j[b.ville]||(j[b.ville]=[]),j[b.ville].push(b),j),{}),[m]);return d.useEffect(()=>{const j=setTimeout(()=>X(!0),4e3);return()=>clearTimeout(j)},[]),d.useEffect(()=>{(async()=>{var b;if(a!=null&&a.id)try{const T=(await A(C(S,"companies",a.id,"agences"))).docs.map(M=>({id:M.id,...M.data()})),_=new Map;for(const M of T){const me=await A(C(S,"companies",a.id,"agences",M.id,"weeklyTrips"));for(const xe of me.docs){const w=xe.data(),U=w.depart||w.departure,q=w.arrivee||w.arrival,he=w.price??w.prix??0;if(!U||!q)continue;const Z=`${U}__${q}`;_.has(Z)||_.set(Z,{departure:U,arrival:q,price:he,frequency:((b=w.days)==null?void 0:b.length)>0?`${w.days.length} jours / semaine`:"DÃ©parts rÃ©guliers",imageUrl:void 0})}}const de=Array.from(_.values()).slice(0,6);y(de)}catch(R){console.error("Erreur chargement suggestions :",R)}})()},[a]),d.useEffect(()=>{a&&(async()=>{if(a!=null&&a.id)try{k(!0);const b=C(S,"companies",a.id,"agences"),R=await A(b);f(R.docs.map(T=>({id:T.id,...T.data()})))}catch(b){console.error("Erreur chargement agences",b),P(r("loadingError"))}finally{k(!1)}})()},[a,r]),N?e.jsx(Be,{message:r("loading"),colors:{primary:n.primary,text:n.text,background:n.background}}):V?e.jsx(De,{error:V,colors:n,classes:c,t:r,navigate:l,slug:i}):!a||!i?e.jsx(as,{primaryColor:n.primary}):e.jsxs("div",{className:`min-h-screen flex flex-col ${g.typography}`,style:{backgroundColor:n.background||"#ffffff",color:n.text},children:[e.jsx(ts,{company:a,colors:n,classes:c,config:g,menuOpen:F,setMenuOpen:I,setShowAgences:h,isMobile:s,t:r,slug:i,navigate:l}),e.jsxs("main",{className:"flex-grow",children:[e.jsx(He,{company:a,onSearch:(j,b)=>{l(`/${i}/booking?departure=${encodeURIComponent(j)}&arrival=${encodeURIComponent(b)}`)},isMobile:s}),e.jsx(_e,{suggestions:x,company:a,onSelect:(j,b)=>{l(`/${i}/booking?departure=${encodeURIComponent(j)}&arrival=${encodeURIComponent(b)}`)}}),e.jsx(Oe,{images:a.imagesSlider||[],primaryColor:n.primary}),e.jsx(Ze,{companyId:a.id,primaryColor:n.primary,isMobile:s}),e.jsx(E,{children:u&&e.jsx(Xe,{groupedByVille:ce,openVilles:v,toggleVille:oe,onClose:()=>h(!1),primaryColor:n.primary,classes:c,t:r,isMobile:s})}),D&&e.jsx(Ue,{onSelectLanguage:j=>{Q.changeLanguage(j),X(!1)},delayMs:8e3})]}),e.jsx(Ye,{company:a,isMobile:s})]})};export{os as default};
