import{d as A,r as c,a as o,j as a}from"./react-KXT1Riez.js";import{r as C,w as j,t as D,D as E,o as f,y as I,G as P}from"./firebase-DYTOaTLw.js";import{u as S,c as H,e as L,d as m}from"../index-b0dmvJTQ.js";import"./vendor-B27hBV_J.js";const G=()=>{const{user:l,company:g}=S(),{companyId:h}=A(),s=h??(l==null?void 0:l.companyId),i=H(g),{setHeader:y,resetHeader:b}=L(),[t,x]=c.useState([]),[u,d]=c.useState(!0);c.useEffect(()=>{if(!s)return;d(!0);const e=C(D(m,"companies",s,"avis"),j("visible","==",!1)),n=E(e,r=>{const w=r.docs.map(p=>({id:p.id,...p.data()}));x(w),d(!1)},r=>{console.error("Erreur écoute avis:",r),d(!1)});return()=>n()},[s]),c.useEffect(()=>(y({title:"Avis clients",subtitle:t.length?`${t.length} avis en attente`:"Aucun avis en attente",bg:`linear-gradient(90deg, ${i.colors.primary} 0%, ${i.colors.secondary} 100%)`,fg:"#fff"}),()=>b()),[t.length,i.colors.primary,i.colors.secondary]);const v=async(e,n)=>{if(!s)return;const r=f(m,"companies",s,"avis",e);await I(r,{visible:!n})},N=async e=>{if(!s)return;const n=f(m,"companies",s,"avis",e);await P(n)};return o("div",{className:"max-w-4xl mx-auto p-6",children:[u&&t.length===0&&a("p",{children:"Chargement des avis..."}),!u&&t.length===0&&a("p",{children:"Aucun avis en attente pour l’instant ✅"}),a("ul",{className:"space-y-4",children:t.map(e=>o("li",{className:"border p-4 rounded shadow-sm bg-white flex flex-col gap-2",children:[o("div",{className:"flex justify-between items-center",children:[o("h4",{className:"font-semibold",children:[e.nom," — ⭐ ",e.note]}),o("div",{className:"flex gap-2",children:[a("button",{onClick:()=>v(e.id,e.visible),className:"text-sm px-3 py-1 rounded bg-green-100 text-green-700",children:"Publier"}),a("button",{onClick:()=>N(e.id),className:"text-sm bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded",children:"Supprimer"})]})]}),a("p",{className:"text-sm text-gray-600 italic",children:e.commentaire})]},e.id))})]})};export{G as default};
