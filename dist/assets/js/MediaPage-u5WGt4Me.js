import{r as o,j as e}from"./react-PtMwKKf1.js";import{l as b,k as x,A as N,T as w,B as y,d as v}from"./firebase-eGIzIftJ.js";import{d as l}from"../index-C4y8wfzK.js";import{U as A}from"./UploadImageCloudinary-DHCcIilu.js";import"./vendor-B5FTF_2c.js";import"./v4-C6aID195.js";const U=()=>{const[i,h]=o.useState([]),[g,c]=o.useState(!1),[n,m]=o.useState(null),d=async()=>{c(!0),m(null);try{const t=(await b(x(l,"mediaPlatform"))).docs.map(a=>{var s;return{id:a.id,...a.data(),createdAt:(s=a.data().createdAt)==null?void 0:s.toDate()}});t.sort((a,s)=>{var u,p;return(((u=s.createdAt)==null?void 0:u.getTime())||0)-(((p=a.createdAt)==null?void 0:p.getTime())||0)}),h(t)}catch(r){console.error("Erreur chargement médias:",r),m("Erreur lors du chargement des images")}finally{c(!1)}};o.useEffect(()=>{d()},[]);const f=async r=>{if(!(!r.id||!window.confirm(`Supprimer l'image "${r.nom}" ?`)))try{await y(v(l,"mediaPlatform",r.id)),d()}catch(a){console.error("Erreur de suppression:",a),alert("Erreur lors de la suppression")}},j=async(r,t,a)=>{try{await N(x(l,"mediaPlatform"),{url:r,type:t,nom:a,createdAt:w.now()}),d()}catch(s){console.error("Erreur ajout média:",s)}};return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Bibliothèque globale de médias"}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:e.jsx(A,{label:"Ajouter une image",dossier:"platform",collectionName:"mediaPlatform",onUpload:r=>j(r,"autre","Nouvelle image"),className:"w-full"})}),n&&e.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4",children:e.jsx("p",{children:n})}),g?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-orange-500"})}):i.length===0?e.jsx("div",{className:"bg-orange-50 p-4 rounded-lg text-orange-800",children:e.jsx("p",{children:"Aucune image enregistrée pour la plateforme."})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:i.map(r=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow duration-200 bg-white",children:[e.jsx("div",{className:"relative h-40 mb-2",children:e.jsx("img",{src:r.url,alt:r.nom,className:"h-full w-full object-cover rounded-md",loading:"lazy"})}),e.jsxs("div",{className:"mb-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:r.nom}),e.jsx("span",{className:"text-xs text-gray-500",children:r.type})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[r.createdAt&&e.jsx("span",{children:new Date(r.createdAt).toLocaleDateString()}),e.jsx("button",{onClick:()=>f(r),className:"text-red-600 hover:text-red-800 hover:underline",children:"Supprimer"})]})]},r.id))})]})};export{U as default};
