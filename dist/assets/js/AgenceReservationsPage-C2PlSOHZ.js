import{u as M,r as n,b as q,j as e}from"./react-PtMwKKf1.js";import{q as A,w as R,k as L,m as k}from"./firebase-eGIzIftJ.js";import{u as P,d as $}from"../index-C4y8wfzK.js";import{J as v}from"./vendor-B5FTF_2c.js";const p=15,K=()=>{const{user:s,company:a}=P(),f=M(),[j,w]=n.useState([]),[o,D]=n.useState(""),[c,T]=n.useState(""),[i,U]=n.useState(""),[m,H]=n.useState(""),[x,G]=n.useState(1),[_,C]=n.useState(null),[S,E]=n.useState(!0),{id:b}=q();n.useEffect(()=>{if(!(s!=null&&s.companyId))return;const t=b||(s==null?void 0:s.agencyId);if(!t)return;const l=A(L($,"companies",s.companyId,"agences",t,"reservations"),R("statut","==","payé")),r=k(l,u=>{const g=u.docs.map(N=>({id:N.id,...N.data()}));w(g),E(!1)});return()=>r()},[s==null?void 0:s.companyId,s==null?void 0:s.agencyId,b]);const h=n.useMemo(()=>j.filter(t=>{const l=o?t.date===o:!0,r=c?t.heure===c:!0,u=i?`${t.depart.toLowerCase()}-${t.arrivee.toLowerCase()}`.includes(i.toLowerCase()):!0,g=m?t.canal===m:!0;return l&&r&&u&&g}),[j,o,c,i,m]),y=n.useMemo(()=>{const t=(x-1)*p;return h.slice(t,t+p)},[h,x]),F=()=>{f("impression-reservations",{state:{reservations:h,date:o,heure:c,trajet:i,agencyName:s==null?void 0:s.agencyName,logoUrl:a==null?void 0:a.logoUrl,companyName:a==null?void 0:a.nom}})},I=v(new Date,"dd/MM/yyyy"),d={primary:(a==null?void 0:a.couleurPrimaire)||"#06b6d4",secondary:(a==null?void 0:a.couleurSecondaire)||"#8b5cf6"};return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6 text-gray-800",children:[e.jsx("div",{className:"mb-8 p-6 rounded-xl bg-white shadow-md border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[(a==null?void 0:a.logoUrl)&&e.jsx("img",{src:a.logoUrl,alt:"logo",className:"h-12 w-12 rounded-full object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",style:{color:d.primary},children:(a==null?void 0:a.nom)||"Compagnie de Transport"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s==null?void 0:s.agencyName," • ",I]})]})]}),e.jsx("button",{onClick:F,className:"mt-4 md:mt-0 px-6 py-2 text-white font-semibold rounded-lg shadow-md hover:opacity-90 transition-all",style:{background:`linear-gradient(to right, ${d.primary}, ${d.secondary})`},children:"🖨️ Imprimer la liste"})]})}),e.jsx("div",{className:"rounded-xl bg-white shadow-md border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:d.secondary,color:"#fff"},children:[e.jsx("th",{className:"p-4 text-left font-semibold",children:"#"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Client"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Contact"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Trajet"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Date"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Heure"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Canal"}),e.jsx("th",{className:"p-4 text-left font-semibold",children:"Statut Embarquement"}),e.jsx("th",{className:"p-4 text-right font-semibold",children:"Montant"}),e.jsx("th",{className:"p-4 text-center font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:S?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"p-8 text-center",children:"Chargement..."})}):y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"p-8 text-center text-gray-400",children:"Aucune réservation trouvée"})}):y.map((t,l)=>{var r;return e.jsxs("tr",{className:"border-t border-gray-200 hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-4",children:(x-1)*p+l+1}),e.jsx("td",{className:"p-4",children:t.nomClient}),e.jsx("td",{className:"p-4 text-cyan-600",children:t.telephone}),e.jsxs("td",{className:"p-4",children:[t.depart," → ",t.arrivee]}),e.jsx("td",{className:"p-4",children:v(new Date(t.date),"dd/MM/yyyy")}),e.jsx("td",{className:"p-4",children:t.heure}),e.jsx("td",{className:"p-4",children:t.canal==="guichet"?e.jsx("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Guichet"}):e.jsx("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"En ligne"})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.statutEmbarquement==="embarqué"?"bg-green-100 text-green-700":t.statutEmbarquement==="absent"?"bg-red-100 text-red-700":t.statutEmbarquement==="reporté"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-500"}`,children:t.statutEmbarquement||"En attente"})}),e.jsxs("td",{className:"p-4 text-right",children:[(r=t.montant)==null?void 0:r.toLocaleString()," FCFA"]}),e.jsxs("td",{className:"p-4 text-center flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>f(`/agence/receipt/${t.id}`),className:"text-green-600 hover:text-green-500 font-medium",children:"Voir"}),e.jsx("button",{onClick:()=>C(t),className:"text-cyan-600 hover:text-cyan-500 font-medium",children:"Modifier"})]})]},t.id)})})]})})})]})};export{K as default};
