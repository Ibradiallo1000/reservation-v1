import{a as U,j as p}from"./react-DB_4kGOy.js";import{G as x}from"./vendor-C-DAJou6.js";import{F as w,x as D}from"./firebase-lLzYRzUk.js";import{u as I,d as j}from"../index-Bkmir__O.js";const t=[];for(let e=0;e<256;++e)t.push((e+256).toString(16).slice(1));function v(e,n=0){return(t[e[n+0]]+t[e[n+1]]+t[e[n+2]]+t[e[n+3]]+"-"+t[e[n+4]]+t[e[n+5]]+"-"+t[e[n+6]]+t[e[n+7]]+"-"+t[e[n+8]]+t[e[n+9]]+"-"+t[e[n+10]]+t[e[n+11]]+t[e[n+12]]+t[e[n+13]]+t[e[n+14]]+t[e[n+15]]).toLowerCase()}let d;const C=new Uint8Array(16);function R(){if(!d){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");d=crypto.getRandomValues.bind(crypto)}return d(C)}const _=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),g={randomUUID:_};function V(e,n,i){var o;if(g.randomUUID&&!e)return g.randomUUID();e=e||{};const a=e.random??((o=e.rng)==null?void 0:o.call(e))??R();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,v(a)}const S=({label:e,onUpload:n,dossier:i,className:a,collectionName:o="imagesBibliotheque"})=>{const{user:c}=I(),y=async h=>{var l;const u=(l=h.target.files)==null?void 0:l[0];if(!u)return;const r=new FormData;r.append("file",u),r.append("upload_preset","ml_default"),r.append("public_id",`${i}/${V()}`);try{const s=(await x.post("https://api.cloudinary.com/v1_1/dj697honl/image/upload",r)).data.secure_url,b=prompt("Nom de l'image (ex: logo, bannière, etc.)")||"image";await w(D(j,o),{companyId:(c==null?void 0:c.companyId)||null,url:s,type:"autre",nom:b,createdAt:new Date}),n&&n(s),alert("✅ Image ajoutée avec succès !")}catch(m){console.error("Erreur Cloudinary:",m),alert("❌ Upload échoué.")}};return U("div",{className:`mb-4 ${a||""}`,children:[p("label",{className:"font-semibold block mb-1",children:e}),p("input",{type:"file",accept:"image/*",onChange:y})]})};export{S as U};
