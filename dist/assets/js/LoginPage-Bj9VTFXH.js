import{r as l,u as h,j as e,a as f}from"./react-DgrrIcw2.js";import{x as b,f as x,d as w}from"./firebase-eGIzIftJ.js";import{a as v,d as y}from"../index-p6Te0bSg.js";import"./vendor-BHjJ2Hjk.js";const j=()=>{const[s,p]=l.useState(""),[u,g]=l.useState(""),[d,t]=l.useState(""),r=h();return e("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:f("form",{onSubmit:async a=>{a.preventDefault(),t("");try{console.log("Tentative de connexion avec :",s);const o=(await b(v,s,u)).user.uid;console.log("✅ Authentification Firebase réussie, UID :",o);const m=await x(w(y,"users",o));if(!m.exists()){console.error("❌ Aucune donnée utilisateur trouvée dans Firestore pour UID :",o),t("Aucune information utilisateur trouvée.");return}const i=m.data();console.log("✅ Données Firestore récupérées :",i);const c=i.role;switch(localStorage.setItem("user",JSON.stringify({uid:o,email:s,role:c,...i})),c){case"admin_platforme":r("/dashboard");break;case"admin_compagnie":r("/compagnie/dashboard");break;case"chefAgence":r("/agence/dashboard");break;default:console.error("❌ Rôle inconnu ou non autorisé :",c),t("Rôle utilisateur inconnu ou non autorisé.")}}catch(n){console.error("❌ Erreur de connexion :",n),t("Erreur de connexion : "+n.message)}},className:"bg-white p-6 rounded shadow w-full max-w-sm space-y-4",children:[e("h2",{className:"text-xl font-bold",children:"Rapport"}),e("input",{type:"email",placeholder:"Email",value:s,onChange:a=>p(a.target.value),className:"w-full border rounded p-2"}),e("input",{type:"password",placeholder:"Mot de passe",value:u,onChange:a=>g(a.target.value),className:"w-full border rounded p-2"}),e("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded",children:"Se connecter"}),d&&e("p",{className:"text-red-600 text-sm text-center",children:d})]})})};export{j as default};
