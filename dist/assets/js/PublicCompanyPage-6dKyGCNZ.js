const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bkmir__O.js","assets/js/react-DB_4kGOy.js","assets/css/react-DOfe2hmq.css","assets/js/firebase-lLzYRzUk.js","assets/js/vendor-C-DAJou6.js","assets/css/index-BEm8-PrT.css"])))=>i.map(i=>d[i]);
import{m as v,A as R,i as ee,d as k,b as be,_ as xe}from"../index-Bkmir__O.js";import{j as e,a,M as B,r as h,E as D,bf as P,av as G,bg as ye,R as W,e as I,J as ve,_ as we,C as te,m as ae,bh as re,b as U,aw as Ne,bi as ke,a6 as se,a0 as Ce,o as Se,bj as K,bk as $e,bl as Ae,bm as Le,bn as Ee,bo as Re,bp as le,F as Y,aO as je,Q as Fe,a5 as Pe,bq as ze,af as ne,br as Me,G as Ie,A as Te,T as Ve,d as _e}from"./react-DB_4kGOy.js";import{z as A,x as C,F as Be,D as De,w as ie,y as oe,B as Ue,J as ce}from"./firebase-lLzYRzUk.js";import{E as qe}from"./ErrorScreen-Ckorlj77.js";import"./vendor-C-DAJou6.js";const Oe=({suggestions:t,company:r,onSelect:i})=>{const l=r.couleurPrimaire||"#3b82f6",n=r.couleurSecondaire||"#e0f2fe";return e("div",{className:"px-4 md:px-8 mt-6",children:a("div",{className:"max-w-4xl mx-auto",children:[e("div",{className:"mb-4 text-center",children:a("h2",{className:"text-xl md:text-xl font-extrabold text-black flex justify-center items-center gap-2",children:[e(B,{style:{color:l},size:22}),e("span",{children:"Nos destination"})]})}),e("div",{className:"flex space-x-3 overflow-x-auto pb-3 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:t.slice(0,10).map((o,s)=>e(v.div,{whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},className:"min-w-[120px] bg-white rounded-lg shadow-md px-4 py-3 flex-shrink-0 cursor-pointer",style:{borderLeft:`8px solid ${n}`},onClick:()=>i(o.departure,o.arrival),children:a("div",{className:"text-center",children:[a("div",{className:"font-semibold text-gray-900 text-sm mb-1",children:[o.departure," → ",o.arrival]}),o.price!==void 0&&a("div",{className:"text-xs font-bold text-white inline-block px-3 py-1 rounded-full",style:{backgroundColor:l},children:[o.price.toLocaleString()," FCFA"]}),e("div",{className:"mt-2",children:e("button",{className:"text-xs font-medium px-3 py-1.5 rounded-md text-white",style:{backgroundColor:l},children:"Réserver"})})]})},s))})]})})},He=({onSelectLanguage:t,delayMs:r=5e3})=>{const[i,l]=h.useState(!0);h.useEffect(()=>{const o=setTimeout(()=>{l(!1)},r);return()=>clearTimeout(o)},[r]);const n=o=>{ee.changeLanguage(o),t(o),l(!1)};return i?e(R,{children:a(v.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.4},className:"fixed top-5 right-5 z-50 bg-white border border-gray-200 shadow-xl rounded-lg p-4 w-[300px] max-w-full",children:[a("div",{className:"flex items-start justify-between mb-2",children:[e("h3",{className:"text-sm font-bold text-gray-800",children:"Choisissez votre langue"}),e("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700",children:e(D,{className:"w-4 h-4"})})]}),a("div",{className:"flex justify-end gap-2",children:[e("button",{onClick:()=>n("fr"),className:"px-4 py-1.5 rounded-full text-sm font-medium shadow-sm",style:{backgroundColor:"#facc15",color:"#000"},children:"Français"}),e("button",{onClick:()=>n("en"),className:"px-4 py-1.5 rounded-full text-sm font-medium shadow-sm",style:{backgroundColor:"#1e293b",color:"#fff"},children:"English"})]})]})}):null},X=({label:t,placeholder:r="Choisissez une ville",value:i,onChange:l,highlightColor:n="#3B82F6"})=>{const[o,s]=h.useState(""),[m,c]=h.useState([]);h.useEffect(()=>{(async()=>{try{const f=(await A(C(k,"villes"))).docs.map(N=>N.data().nom).filter(Boolean);c(f)}catch(b){console.error("Erreur chargement villes :",b)}})()},[]);const p=o===""?m:m.filter(u=>u.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").includes(o.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")));return e("div",{className:"w-full",children:a(P,{value:i,onChange:l,children:[e(P.Label,{className:"block text-sm font-medium text-white mb-1",children:t}),a("div",{className:"relative",children:[e(P.Input,{className:"w-full border border-gray-300 rounded-md py-2 pl-3 pr-10 text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-primary",displayValue:u=>u,value:i,onChange:u=>{s(u.target.value),l(u.target.value)},placeholder:r,autoComplete:"off"}),e(P.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e(G,{className:"h-4 w-4 text-gray-400"})}),p.length>0&&e(P.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none sm:text-sm",children:p.map((u,b)=>e(P.Option,{value:u,className:({active:f})=>`relative cursor-pointer select-none py-2 pl-10 pr-4 ${f?"text-white":"text-gray-900"}`,children:({selected:f,active:N})=>a("div",{style:{backgroundColor:N?n:void 0},className:"w-full h-full",children:[e("span",{className:`block truncate ${f?"font-semibold":"font-normal"}`,children:u}),f&&e("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",style:{color:N?"white":n},children:e(ye,{className:"h-4 w-4","aria-hidden":"true"})})]})},b))})]})]})})},Ge=t=>{const[r,i]=h.useState([]);return h.useEffect(()=>{if(!t)return;(async()=>{try{const n=await A(C(k,`companies/${t}/agences`)),s=(await Promise.all(n.docs.map(async u=>(await A(C(k,`companies/${t}/agences/${u.id}/weeklyTrips`))).docs.map(f=>f.data())))).flat(),m=s.map(u=>{var b,f;return(f=(b=u==null?void 0:u.departure)==null?void 0:b.toLowerCase())==null?void 0:f.trim()}),c=s.map(u=>{var b,f;return(f=(b=u==null?void 0:u.arrival)==null?void 0:b.toLowerCase())==null?void 0:f.trim()}),p=Array.from(new Set([...m,...c])).filter(Boolean);i(p)}catch(n){console.error("useVilleOptions ► lecture weeklyTrips échouée :",n),i([])}})()},[t]),r},Ye=({company:t,onSearch:r})=>{const[i,l]=W.useState(""),[n,o]=W.useState(""),{t:s}=I(),m=Ge(t.id),c=h.useRef(null);h.useEffect(()=>{if(c.current)try{c.current.setAttribute("fetchpriority","high")}catch{}},[t==null?void 0:t.banniereUrl]);const p=b=>{b.preventDefault(),r(i.trim().toLowerCase(),n.trim().toLowerCase())},u=t.couleurPrimaire||"#3B82F6";return a("section",{className:"relative w-full min-h-[600px] flex items-center justify-center overflow-hidden bg-gray-100",children:[t.banniereUrl&&a("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e("img",{ref:c,src:t.banniereUrl,alt:`Bannière ${t.nom}`,className:"w-full h-full object-cover object-center img-fade is-loaded",width:"100%",height:"100%",decoding:"async",loading:"eager",style:{objectPosition:"center center",minHeight:"100%",minWidth:"100%"},fetchpriority:"high"}),e("div",{className:"absolute inset-0 bg-black/30"})]}),e(v.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"absolute top-8 left-1/2 transform -translate-x-1/2 z-10",children:e("div",{className:"text-white text-xl md:text-2xl font-semibold text-center",children:t.accroche||s("defaultSlogan")})}),e("div",{className:"relative z-10 w-full max-w-5xl px-5",children:a(v.form,{onSubmit:p,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"bg-transparent rounded-xl border border-white px-6 py-4 backdrop-blur-md",children:[e("p",{className:"text-sm md:text-base font-semibold mb-4 text-white",children:t.instructionRecherche||s("searchInstruction")}),a("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[e("div",{className:"w-full md:w-1/3",children:e(X,{label:s("departureCity"),value:i,onChange:l,options:m})}),e("div",{className:"w-full md:w-1/3",children:e(X,{label:s("arrivalCity"),value:n,onChange:o,options:m})}),a("button",{type:"submit",className:"w-full md:w-auto px-5 py-2 rounded-md text-white font-semibold flex items-center justify-center gap-2",style:{backgroundColor:u},children:[e(ve,{className:"h-4 w-4"}),s("searchTrip"),e(we,{className:"h-4 w-4"})]})]})]})})]})};function Je({images:t,primaryColor:r}){const[i,l]=h.useState(0),n=o=>{l(s=>o==="prev"?s===0?t.length-1:s-1:s===t.length-1?0:s+1)};return h.useEffect(()=>{const o=setInterval(()=>n("next"),6e3);return()=>clearInterval(o)},[t]),!t||t.length===0?null:e("section",{className:"relative w-full max-w-6xl mx-auto my-10 rounded-xl overflow-hidden shadow border border-gray-200",children:a("div",{className:"relative h-64 md:h-96",children:[e(R,{mode:"wait",children:e(v.img,{src:t[i],alt:`Slide ${i}`,initial:{opacity:.6,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.02},transition:{duration:.5},className:"absolute inset-0 w-full h-full object-cover"},i)}),a("div",{className:"absolute inset-0 flex justify-between items-center px-4",children:[e("button",{onClick:()=>n("prev"),className:"p-2 rounded-full bg-white/80 hover:bg-white shadow",children:e(te,{className:"h-5 w-5 text-gray-700"})}),e("button",{onClick:()=>n("next"),className:"p-2 rounded-full bg-white/80 hover:bg-white shadow",children:e(ae,{className:"h-5 w-5 text-gray-700"})})]}),e("div",{className:"absolute bottom-3 w-full flex justify-center gap-2",children:t.map((o,s)=>e("div",{className:`h-2 w-2 rounded-full transition-all duration-300 ${s===i?"bg-white":"bg-gray-400"}`},s))})]})})}const Qe=({companyId:t,onSuccess:r,primaryColor:i})=>{const[l,n]=h.useState(""),[o,s]=h.useState(0),[m,c]=h.useState(""),[p,u]=h.useState(null),[b,f]=h.useState(!1);return a("form",{onSubmit:async g=>{if(g.preventDefault(),!l.trim()||o<1||!m.trim()){u("Veuillez remplir tous les champs et choisir une note.");return}try{f(!0),await Be(C(k,"avis"),{nom:l,note:o,commentaire:m,visible:!1,companyId:t,createdAt:De()}),u("Merci pour votre avis ! Il sera publié après validation."),n(""),s(0),c(""),r&&r()}catch(d){console.error(d),u("Erreur lors de l'envoi. Veuillez réessayer.")}finally{f(!1)}},className:"space-y-4",children:[p&&e("p",{className:"text-sm text-gray-600 italic",children:p}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Votre nom"}),e("input",{type:"text",value:l,onChange:g=>n(g.target.value),className:"w-full border px-3 py-2 rounded",required:!0})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Votre note"}),e("div",{className:"flex gap-1",children:[1,2,3,4,5].map(g=>e(re,{onClick:()=>s(g),className:`h-6 w-6 cursor-pointer ${g<=o?"text-yellow-400":"text-gray-300"}`,fill:g<=o?"#facc15":"none"},g))})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Votre avis"}),e("textarea",{value:m,onChange:g=>c(g.target.value),className:"w-full border px-3 py-2 rounded",rows:4,required:!0})]}),e("button",{type:"submit",disabled:b,className:"text-white px-4 py-2 rounded hover:opacity-90 transition",style:{backgroundColor:i},children:b?"Envoi en cours...":"Envoyer mon avis"})]})},We=({company:t})=>{const[r,i]=h.useState(!1);U();const{t:l}=I(),n=new Date().getFullYear(),{id:o,slug:s,nom:m,couleurPrimaire:c,couleurSecondaire:p,description:u,email:b,telephone:f,adresse:N,horaires:g,socialMedia:d={},footerConfig:L={}}=t,{showAbout:z=!0,showContact:j=!0,showSocial:w=!0,showTestimonials:M=!0,showLegalLinks:T=!0,customLinks:S=[]}=L;return a("footer",{className:"relative w-full overflow-hidden",style:{backgroundColor:p||"#f8fafc",color:"#1e293b"},children:[e("div",{className:"absolute inset-0 bg-[url('/world-map.svg')] bg-center bg-cover opacity-5 pointer-events-none"}),a("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[z&&a(v.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},children:[a("div",{className:"flex items-center gap-2 mb-4",children:[e(Ne,{className:"h-5 w-5",style:{color:c}}),e("h3",{className:"text-lg font-semibold",children:l("about")})]}),e("p",{className:"text-sm text-gray-700",children:u||l("defaultAbout")})]}),j&&a(v.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[a("div",{className:"flex items-center gap-2 mb-4",children:[e(ke,{className:"h-5 w-5",style:{color:c}}),e("h3",{className:"text-lg font-semibold",children:l("contact")})]}),a("ul",{className:"space-y-2 text-sm",children:[f&&a("li",{className:"flex items-center gap-2",children:[e(se,{className:"h-4 w-4"}),e("a",{href:`tel:${f}`,className:"hover:underline",children:f})]}),b&&a("li",{className:"flex items-center gap-2",children:[e(Ce,{className:"h-4 w-4"}),e("a",{href:`mailto:${b}`,className:"hover:underline",children:b})]}),N&&a("li",{className:"flex items-center gap-2",children:[e(B,{className:"h-4 w-4"}),e("span",{children:N})]}),g&&a("li",{className:"flex items-center gap-2",children:[e(Se,{className:"h-4 w-4"}),e("span",{children:g})]})]})]}),w&&Object.values(d).some(Boolean)&&a(v.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[a("div",{className:"flex items-center gap-2 mb-4",children:[e(K,{className:"h-5 w-5",style:{color:c}}),e("h3",{className:"text-lg font-semibold",children:l("followUs")})]}),a("div",{className:"flex gap-4",children:[d.facebook&&e("a",{href:d.facebook,target:"_blank",rel:"noopener noreferrer",children:e($e,{className:"h-6 w-6 hover:opacity-80 transition"})}),d.instagram&&e("a",{href:d.instagram,target:"_blank",rel:"noopener noreferrer",children:e(Ae,{className:"h-6 w-6 hover:opacity-80 transition"})}),d.twitter&&e("a",{href:d.twitter,target:"_blank",rel:"noopener noreferrer",children:e(Le,{className:"h-6 w-6 hover:opacity-80 transition"})}),d.linkedin&&e("a",{href:d.linkedin,target:"_blank",rel:"noopener noreferrer",children:e(Ee,{className:"h-6 w-6 hover:opacity-80 transition"})}),d.youtube&&e("a",{href:d.youtube,target:"_blank",rel:"noopener noreferrer",children:e(Re,{className:"h-6 w-6 hover:opacity-80 transition"})})]})]}),M&&e(v.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:a("div",{className:"flex flex-col gap-4",children:[a("div",{className:"flex items-center gap-2 mb-4",children:[e(K,{className:"h-5 w-5",style:{color:c}}),e("h3",{className:"text-lg font-semibold",children:l("customerReviews")})]}),a(v.button,{onClick:()=>i(!r),className:"flex items-center justify-between px-4 py-2 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:c||"#3B82F6",color:"white"},whileHover:{scale:1.02},whileTap:{scale:.98},children:[e("span",{children:l("leaveReview")}),r?e(le,{className:"h-4 w-4 ml-2"}):e(G,{className:"h-4 w-4 ml-2"})]}),r&&e(v.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:e("div",{className:"mt-4",children:e(Qe,{companyId:o,primaryColor:c||"#3B82F6",onSuccess:()=>i(!1)})})})]})})]}),(T||(S==null?void 0:S.length)>0)&&e("div",{className:"border-t py-6 text-center text-sm relative z-10",style:{borderColor:c?`${c}20`:"#e2e8f0"},children:a("div",{className:"max-w-7xl mx-auto px-6",children:[a("div",{className:"flex flex-wrap justify-center gap-4 mb-2",children:[T&&a(Y,{children:[e("a",{href:`/${s}/mentions-legales`,className:"hover:underline",children:l("legalNotice")}),e("a",{href:`/${s}/confidentialite`,className:"hover:underline",children:l("privacyPolicy")}),e("a",{href:`/${s}/conditions`,className:"hover:underline",children:l("termsConditions")}),e("a",{href:`/${s}/cookies`,className:"hover:underline",children:l("cookiePolicy")})]}),S==null?void 0:S.map((F,V)=>e("a",{href:F.url,className:"hover:underline",target:F.external?"_blank":"_self",rel:F.external?"noopener noreferrer":"",children:F.label},V))]}),a("p",{children:["© ",n," ",m||l("ourCompany"),". ",l("allRightsReserved")]})]})})]})},Ke=({agence:t,primaryColor:r})=>a(v.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{duration:.2},className:"p-5 my-3 rounded-xl shadow-sm hover:shadow-md transition-all",style:{backgroundColor:"#ffffff",borderLeft:`4px solid ${r}`,boxShadow:"0 2px 12px rgba(0,0,0,0.05)"},children:[a("div",{className:"flex justify-between items-start",children:[e("h3",{className:"font-bold text-lg mb-2",style:{color:r},children:t.nomAgence}),t.latitude&&t.longitude&&a("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${t.latitude},${t.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:[e(je,{className:"h-3 w-3"}),e("span",{children:"Maps"})]})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3 text-sm",children:[a("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 rounded-full bg-gray-100",children:e(Fe,{className:"h-4 w-4",style:{color:r}})}),e("span",{className:"text-gray-700",children:t.pays})]}),t.quartier&&a("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 rounded-full bg-gray-100",children:e(B,{className:"h-4 w-4",style:{color:r}})}),e("span",{className:"text-gray-700",children:t.quartier})]}),t.telephone&&a("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 rounded-full bg-gray-100",children:e(se,{className:"h-4 w-4",style:{color:r}})}),e("a",{href:`tel:${t.telephone}`,className:"text-gray-700 hover:underline hover:text-gray-900 transition-colors",children:t.telephone})]})]})]}),Xe=({groupedByVille:t,openVilles:r,toggleVille:i,onClose:l,primaryColor:n,classes:o,t:s})=>e(v.section,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4",onClick:l,children:a(v.div,{className:"relative w-full max-w-3xl max-h-[85vh] overflow-y-auto rounded-2xl",initial:{scale:.96,y:20},animate:{scale:1,y:0},exit:{scale:.96,y:20},transition:{type:"spring",damping:25},onClick:m=>m.stopPropagation(),style:{backgroundColor:"#ffffff",boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[a("div",{className:"sticky top-0 p-5 flex justify-between items-center z-10 border-b border-gray-100",style:{backdropFilter:"blur(12px)",backgroundColor:"rgba(255,255,255,0.85)"},children:[e("h2",{className:"text-2xl font-bold",style:{color:n},children:s("ourAgencies")}),e("button",{onClick:l,className:"p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":s("close"),children:e(D,{className:"h-6 w-6 text-gray-600"})})]}),e("div",{className:"p-5",children:Object.entries(t).map(([m,c])=>a("div",{className:"mb-5",children:[a(v.button,{onClick:()=>i(m),className:"w-full text-left py-4 px-5 rounded-xl flex justify-between items-center transition-colors",whileHover:{backgroundColor:"rgba(0,0,0,0.03)"},style:{backgroundColor:r[m]?"rgba(0,0,0,0.02)":"transparent",color:"#333"},children:[a("div",{className:"flex items-center gap-3",children:[e("span",{className:"font-semibold text-lg",children:m}),a("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:`${n}20`,color:n},children:[c.length," ",c.length>1?s("agencies"):s("agency")]})]}),r[m]?e(le,{className:"h-5 w-5 text-gray-500"}):e(G,{className:"h-5 w-5 text-gray-500"})]}),e(R,{children:r[m]&&e(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut"},className:"overflow-hidden pl-5 ml-2 border-l-2",style:{borderColor:`${n}40`},children:c.map((p,u)=>e(Ke,{agence:p,primaryColor:n},`${p.id}-${u}`))})})]},m))})]})}),Ze=t=>{try{if(!t)return;if(typeof t=="string")return t;const r=t;return typeof(r==null?void 0:r.toDate)=="function"?r.toDate().toLocaleDateString("fr-FR"):void 0}catch{return}},et=({companyId:t,primaryColor:r,secondaryColor:i="#f8fafc"})=>{const{t:l}=I(),[n,o]=h.useState([]),[s,m]=h.useState(0),[c,p]=h.useState(!1);h.useEffect(()=>{if(!t)return;(async()=>{try{const d=ie(C(k,`companies/${t}/avis`),oe("visible","==",!0),Ue("note","desc"),ce(10)),z=(await A(d)).docs.map(j=>{const w=j.data();return{id:j.id,nom:(w==null?void 0:w.nom)??"Client",note:Number((w==null?void 0:w.note)??0),commentaire:String((w==null?void 0:w.commentaire)??""),date:Ze(w==null?void 0:w.date)}});o(z)}catch(d){console.error("🔴 Erreur chargement avis (companies/{companyId}/avis):",d),o([])}})()},[t]),h.useEffect(()=>{if(n.length<=1||c)return;const g=setInterval(()=>{m(d=>(d+1)%n.length)},7e3);return()=>clearInterval(g)},[n,c]);const u=()=>m(g=>(g+1)%n.length),b=()=>m(g=>(g-1+n.length)%n.length);if(n.length===0)return null;const f=n[s],N=()=>Array.from({length:5}).map((g,d)=>e(re,{size:16,className:d<f.note?"fill-current":"",style:{color:d<f.note?r:"#d1d5db"}},d));return e("div",{className:"py-10 px-4 md:px-6",style:{backgroundColor:i},children:a("div",{className:"max-w-4xl mx-auto",children:[a("div",{className:"text-center mb-6",children:[e("h2",{className:"text-2xl font-bold mb-1",style:{color:r},children:l("whatClientsSay")}),e("p",{className:"text-gray-600 text-sm",children:l("realExperiences")})]}),a("div",{className:"relative",onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[e(R,{mode:"wait",children:e(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-md p-6",children:a("div",{className:"flex flex-col sm:flex-row gap-4 items-center sm:items-start",children:[e("div",{className:"w-12 h-12 flex items-center justify-center rounded-full",style:{backgroundColor:`${r}20`},children:e(Pe,{size:24,style:{color:r}})}),a("div",{className:"text-center sm:text-left",children:[e("div",{className:"flex justify-center sm:justify-start mb-2",children:N()}),a("p",{className:"text-sm italic text-gray-700 mb-2",children:["“",f.commentaire,"”"]}),e("p",{className:"text-sm font-medium text-gray-900",children:f.nom}),f.date&&e("p",{className:"text-xs text-gray-500",children:f.date})]})]})},f.id)}),n.length>1&&a(Y,{children:[e("button",{onClick:b,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-white p-1 rounded-full shadow hover:bg-gray-50","aria-label":"Avis précédent",children:e(te,{size:20,style:{color:r}})}),e("button",{onClick:u,className:"absolute right-0 top-1/2 -translate-y-1/2 bg-white p-1 rounded-full shadow hover:bg-gray-50","aria-label":"Avis suivant",children:e(ae,{size:20,style:{color:r}})})]})]}),n.length>1&&e("div",{className:"flex justify-center gap-1 mt-4",children:n.map((g,d)=>e("button",{onClick:()=>m(d),className:`w-2 h-2 rounded-full transition-all ${s===d?"bg-gray-800 scale-110":"bg-gray-300"}`,"aria-label":`Aller à l’avis ${d+1}`},d))})]})})},tt=()=>{const{i18n:t}=I(),r=i=>{t.changeLanguage(i)};return a("div",{className:"flex gap-2 text-sm",children:[e("button",{onClick:()=>r("fr"),className:"hover:underline",children:"🇫🇷"}),e("button",{onClick:()=>r("en"),className:"hover:underline",children:"🇬🇧"})]})},at=t=>{const r=t.getContext("2d");if(!r)return;const{width:i,height:l}=t.getBoundingClientRect(),n=window.devicePixelRatio||1;t.width=Math.round(i*n),t.height=Math.round(l*n),r.scale(n,n),r.fillStyle="rgba(10, 10, 20, 0.95)",r.fillRect(0,0,i,l);const o=100;for(let s=0;s<o;s++){const m=Math.random()*i,c=Math.random()*l,p=Math.random()*1.2,u=Math.random()*.8+.2;r.beginPath(),r.arc(m,c,p,0,Math.PI*2),r.fillStyle=`rgba(255, 255, 255, ${u})`,r.fill()}},rt=({onClose:t,navigate:r,onShowAgencies:i,slug:l,colors:n,classes:o,config:s,t:m,open:c=!0})=>{const p=h.useRef(null),u=h.useRef(null),b=h.useCallback(()=>{p.current&&at(p.current)},[]);h.useEffect(()=>{b();const g=new ResizeObserver(b);u.current&&g.observe(u.current);const d=()=>b();return window.addEventListener("resize",d),()=>{g.disconnect(),window.removeEventListener("resize",d)}},[b]),h.useEffect(()=>{const g=d=>{d.key==="Escape"&&t()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[t]);const f=g=>{g.target===g.currentTarget&&t()},N=a(v.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.25},className:"fixed top-16 right-4 left-4 z-50 rounded-xl shadow-2xl overflow-hidden",role:"dialog","aria-modal":"true","aria-label":m("menu")||"Menu",ref:u,children:[e("canvas",{ref:p,className:"absolute inset-0 w-full h-full"}),a("div",{className:"relative z-10 p-4 text-white",children:[a("div",{className:"flex items-center justify-between mb-2",children:[e("div",{className:"text-sm opacity-80",children:"MALI TRANS"}),e("button",{onClick:t,"aria-label":m("close")||"Fermer",className:"p-2 rounded-lg hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/30",children:e(D,{className:"h-5 w-5"})})]}),a("nav",{className:"flex flex-col gap-2",children:[a("button",{onClick:()=>{i(),t()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white/10 ${(o==null?void 0:o.button)||""}`,"aria-label":m("ourAgencies"),children:[e(B,{className:"h-5 w-5 text-blue-300"}),e("span",{className:"font-medium",children:m("ourAgencies")})]}),a("button",{onClick:()=>{r(l?`/${l}/mes-reservations`:"/mes-reservations"),t()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white/10 ${(o==null?void 0:o.button)||""}`,"aria-label":m("myBookings"),children:[e(ze,{className:"h-5 w-5 text-green-300"}),e("span",{className:"font-medium",children:m("myBookings")})]}),a("button",{onClick:()=>{r("/login"),t()},className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-white/10 ${(o==null?void 0:o.button)||""}`,"aria-label":m("login"),children:[e(ne,{className:"h-5 w-5 text-yellow-300"}),e("span",{className:"font-medium",children:m("login")})]}),a("div",{className:"mt-4 pt-4 border-t border-white/20",children:[a("div",{className:"flex items-center gap-2 mb-2 text-sm font-medium",children:[e(Me,{className:"h-4 w-4 text-white"}),e("span",{className:"text-white",children:m("language")||"Langue"})]}),e(tt,{})]})]})]})]});return e(R,{children:c&&e(v.div,{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onMouseDown:f,children:N})})},st=()=>{const t=r=>{ee.changeLanguage(r)};return a("div",{className:"flex gap-2",children:[e("button",{onClick:()=>t("fr"),className:"text-sm hover:underline",children:"FR"}),e("span",{className:"text-gray-400",children:"|"}),e("button",{onClick:()=>t("en"),className:"text-sm hover:underline",children:"EN"})]})},lt="#FF6600",nt=({company:t,slug:r,colors:i,classes:l,config:n,menuOpen:o,setMenuOpen:s,setShowAgences:m,navigate:c,t:p})=>{const u=i.primary||lt,b=i.secondary||"#e5e7eb",[f,N]=h.useState(!1);h.useEffect(()=>{if(!(t!=null&&t.logoUrl))return;const d=document.createElement("link");return d.rel="preload",d.as="image",d.href=t.logoUrl,d.setAttribute("fetchpriority","high"),document.head.appendChild(d),()=>{try{document.head.removeChild(d)}catch{}}},[t==null?void 0:t.logoUrl]);const g=({name:d})=>{const L=(d||"C").trim().charAt(0).toUpperCase();return e("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-bold",style:{backgroundColor:u},children:L})};return a("header",{className:"sticky top-0 z-50 w-full bg-white/95 backdrop-blur border-b border-gray-100",children:[e("div",{className:"absolute top-0 left-0 w-full h-[80px] overflow-hidden pointer-events-none",children:e("svg",{viewBox:"0 0 1440 120",preserveAspectRatio:"none",className:"w-full h-full",children:e("path",{d:"M0,0 C480,60 960,0 1440,70 L1440,0 L0,0 Z",fill:b})})}),a("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-2 flex items-center justify-between",children:[a("div",{className:"flex items-center gap-3 min-w-0",children:[e("button",{onClick:()=>s(!o),className:"md:hidden p-2 rounded-md border border-gray-300 bg-white","aria-label":"Menu",children:o?e(D,{className:"h-6 w-6 text-slate-800"}):e(Ie,{className:"h-6 w-6 text-slate-800"})}),a("button",{onClick:()=>c("/"),className:"flex items-center gap-2 select-none","aria-label":(t==null?void 0:t.nom)||"Accueil",children:[a("div",{className:"h-10 w-10 rounded-full bg-white border border-gray-200 overflow-hidden shadow-sm flex items-center justify-center",children:[!f&&(t==null?void 0:t.logoUrl)&&e("div",{className:"w-6 h-6 rounded-full bg-gray-200 animate-pulse"}),t!=null&&t.logoUrl?e("img",{src:t.logoUrl,alt:`Logo ${t.nom||"Compagnie"}`,width:40,height:40,className:`w-full h-full object-contain ${f?"":"opacity-0"}`,loading:"eager",decoding:"async",fetchpriority:"high",onLoad:()=>N(!0)}):e(g,{name:t==null?void 0:t.nom})]}),e("span",{className:"text-xl font-bold leading-tight break-words",style:{color:u,maxWidth:"240px"},title:(t==null?void 0:t.nom)||p("ourCompany"),children:(t==null?void 0:t.nom)||p("ourCompany")})]})]}),e("div",{className:"hidden md:block",children:e(st,{})}),a("div",{className:"hidden md:flex items-center gap-4",children:[e("button",{onClick:()=>c(`/${r}/mes-reservations`),className:"text-sm font-medium text-gray-700 hover:text-black transition",children:p("myBookings")||"Mes réservations"}),e("button",{onClick:()=>m(!0),className:"text-sm font-medium text-gray-700 hover:text-black transition",children:p("ourAgencies")||"Nos agences"}),e("button",{onClick:()=>c("/login"),className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition","aria-label":p("login"),children:e(ne,{className:"h-5 w-5 text-gray-700"})})]})]}),e(R,{children:o&&e(rt,{onClose:()=>s(!1),navigate:d=>{c(d),s(!1)},onShowAgencies:()=>{m(!0),s(!1)},slug:r,colors:{...i,primary:u},classes:l,config:n,t:p})})]})},Z=({message:t="La page demandée est introuvable.",primaryColor:r,buttonLabel:i="Retour à l'accueil"})=>{const l=U();return e("div",{className:"min-h-screen flex items-center justify-center bg-black text-white p-6",children:a(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md",children:[e(Te,{className:"mx-auto mb-4 h-16 w-16 text-red-500"}),e("h1",{className:"text-3xl font-bold mb-2",children:"Erreur 404"}),e("p",{className:"mb-6 text-gray-300",children:t}),e("button",{onClick:()=>l("/"),className:"px-6 py-3 rounded-lg font-semibold text-white transition shadow-lg",style:{backgroundColor:r},children:i})]})})},it=new Map;function ot(t){return it.get(t)}const ct=({onlyForSlug:t,primaryColor:r="#ea580c",secondaryColor:i="#f97316"})=>{const l=U();return e("div",{className:"w-full text-center",children:a("button",{onClick:()=>{l(t?`/${t}/mes-reservations`:"/mes-reservations")},className:"inline-flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-white shadow-md transition",style:{background:`linear-gradient(90deg, ${r} 0%, ${i} 100%)`,boxShadow:`0 6px 14px -4px ${r}55`},children:[e(Ve,{className:"w-5 h-5"}),"Voir mes réservations"]})})},gt=({company:t,isMobile:r=!1})=>{const{slug:i=""}=_e(),l=U(),{t:n}=I(),o=ot(i),[s,m]=h.useState(t||o),{colors:c,classes:p,config:u}=be(s),[b,f]=h.useState([]),[N,g]=h.useState([]),[d,L]=h.useState(!1),[z,j]=h.useState(!1),[w,M]=h.useState(null),[T,S]=h.useState({}),[F,V]=h.useState(!1),de=y=>{S(x=>({...x,[y]:!x[y]}))},ue=h.useMemo(()=>b.reduce((y,x)=>(y[x.ville]||(y[x.ville]=[]),y[x.ville].push(x),y),{}),[b]);h.useEffect(()=>{s||!i||(async()=>{try{const y=ie(C(k,"companies"),oe("slug","==",i),ce(1)),x=await A(y);x.empty?M("notFound"):m({id:x.docs[0].id,...x.docs[0].data()})}catch(y){console.warn("PublicCompanyPage ► fetch company by slug",y),M(n("loadingError"))}})()},[i]),h.useEffect(()=>{const y=setTimeout(()=>V(!0),4e3);return()=>clearTimeout(y)},[]),h.useEffect(()=>{(async()=>{var x;if(s!=null&&s.id)try{const he=(await A(C(k,"companies",s.id,"agences"))).docs.map(_=>({id:_.id,..._.data()})),q=new Map;for(const _ of he){const fe=await A(C(k,"companies",s.id,"agences",_.id,"weeklyTrips"));for(const ge of fe.docs){const $=ge.data(),O=$.depart||$.departure,H=$.arrivee||$.arrival,pe=$.price??$.prix??0;if(!O||!H)continue;const Q=`${O}__${H}`;q.has(Q)||q.set(Q,{departure:O,arrival:H,price:pe,frequency:((x=$.days)==null?void 0:x.length)>0?`${$.days.length} jours / semaine`:"Départs réguliers",imageUrl:void 0})}}g(Array.from(q.values()).slice(0,6))}catch(E){console.warn("PublicCompanyPage ► suggestions",E)}})()},[s]),h.useEffect(()=>{(async()=>{if(s!=null&&s.id)try{const x=await A(C(k,"companies",s.id,"agences"));f(x.docs.map(E=>({id:E.id,...E.data()})))}catch(x){console.warn("PublicCompanyPage ► agences",x),M(n("loadingError"))}})()},[s,n]);const J=!!(s!=null&&s.publicPageEnabled),me=J&&!!(s!=null&&s.onlineBookingEnabled);return w==="notFound"?e(Z,{primaryColor:c.primary||"#FF6600"}):w&&w!=="notFound"?e(qe,{error:w,colors:c,classes:p,t:n,navigate:l,slug:i}):s?J?a("div",{className:`min-h-screen flex flex-col ${u.typography}`,style:{backgroundColor:c.background||"#ffffff",color:c.text},children:[e(nt,{company:s,colors:c,classes:p,config:u,menuOpen:z,setMenuOpen:j,setShowAgences:L,isMobile:r,t:n,slug:i,navigate:l}),a("main",{className:"flex-grow",children:[me&&a(Y,{children:[e(Ye,{company:s,onSearch:(y,x)=>{l(`/${i}/booking?departure=${encodeURIComponent(y)}&arrival=${encodeURIComponent(x)}`)},isMobile:r}),e("section",{"aria-label":"Retrouver ma réservation pour cette compagnie",className:"max-w-5xl mx-auto px-4 sm:px-6",children:e("div",{className:"pt-4 sm:pt-6",children:e(ct,{onlyForSlug:i,primaryColor:c.primary,secondaryColor:c.secondary})})}),e(Oe,{suggestions:N,company:s,onSelect:(y,x)=>{l(`/${i}/booking?departure=${encodeURIComponent(y)}&arrival=${encodeURIComponent(x)}`)}})]}),e(Je,{images:s.imagesSlider||[],primaryColor:c.primary}),e(et,{companyId:s.id,primaryColor:c.primary,isMobile:r}),e(R,{children:d&&e(Xe,{groupedByVille:ue,openVilles:T,toggleVille:de,onClose:()=>L(!1),primaryColor:c.primary,classes:p,t:n,isMobile:r})}),F&&e(He,{onSelectLanguage:y=>{xe(async()=>{const{default:x}=await import("../index-Bkmir__O.js").then(E=>E.g);return{default:x}},__vite__mapDeps([0,1,2,3,4,5])).then(({default:x})=>x.changeLanguage(y)),V(!1)},delayMs:8e3})]}),e(We,{company:s,isMobile:r})]}):e(Z,{primaryColor:c.primary||"#FF6600"}):e("div",{className:"min-h-screen bg-white",children:e("div",{className:"h-14 border-b"})})};export{gt as default};
