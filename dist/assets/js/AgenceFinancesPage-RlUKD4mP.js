import{r as o,a as s,j as a}from"./react-DgrrIcw2.js";import{q as N,w as i,k as w,l as y,T as v}from"./firebase-eGIzIftJ.js";import{u as j,d as D}from"../index-p6Te0bSg.js";import"./vendor-BHjJ2Hjk.js";const I=()=>{const{user:e}=j(),[n,r]=o.useState("jour"),[d,l]=o.useState(0),[m,u]=o.useState(0),p=()=>{const t=new Date;switch(n){case"semaine":t.setDate(t.getDate()-7);break;case"mois":t.setDate(t.getDate()-30);break;default:t.setHours(0,0,0,0)}return v.fromDate(t)},b=async()=>{if(!(e!=null&&e.companyId)||!(e!=null&&e.agencyId))return;const t=p(),g=N(w(D,"companies",e.companyId,"agences",e.agencyId,"reservations"),i("createdAt",">=",t),i("statut","==","payé")),c=await y(g),h=c.docs.reduce((x,f)=>x+(f.data().montant||0),0);l(h),u(c.size)};return o.useEffect(()=>{b()},[n,e]),s("div",{className:"p-6",children:[a("h2",{className:"text-xl font-bold mb-4",children:"État financier de l’agence"}),s("div",{className:"flex gap-4 mb-4",children:[a("button",{className:`px-4 py-2 rounded ${n==="jour"?"bg-blue-600 text-white":"bg-gray-200"}`,onClick:()=>r("jour"),children:"Aujourd’hui"}),a("button",{className:`px-4 py-2 rounded ${n==="semaine"?"bg-blue-600 text-white":"bg-gray-200"}`,onClick:()=>r("semaine"),children:"7 derniers jours"}),a("button",{className:`px-4 py-2 rounded ${n==="mois"?"bg-blue-600 text-white":"bg-gray-200"}`,onClick:()=>r("mois"),children:"Ce mois-ci"})]}),s("div",{className:"bg-white p-6 rounded shadow border",children:[s("p",{className:"text-lg",children:["Revenu total : ",s("span",{className:"font-bold text-green-700",children:[d.toLocaleString()," FCFA"]})]}),s("p",{className:"text-lg",children:["Nombre de réservations : ",a("span",{className:"font-bold text-blue-700",children:m})]})]}),a("div",{className:"mt-4",children:a("button",{onClick:()=>window.print(),className:"bg-indigo-600 text-white px-4 py-2 rounded",children:"Imprimer le résumé"})})]})};export{I as default};
