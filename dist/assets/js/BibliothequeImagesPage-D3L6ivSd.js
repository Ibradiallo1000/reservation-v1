import{d as y,r as m,j as e,a as o,B as h,z as v}from"./react-KXT1Riez.js";import{t as N,r as w,E as I,D as j,G as q,o as A}from"./firebase-DYTOaTLw.js";import{u as B,d as g}from"../index-b0dmvJTQ.js";import{U as E}from"./UploadImageCloudinary-DhOnNA4G.js";import"./vendor-B27hBV_J.js";const $=()=>{const{user:a}=B(),{companyId:r}=y(),t=(a==null?void 0:a.companyId)||r,s=!!((a==null?void 0:a.role)==="admin_platforme"&&r),[l,u]=m.useState([]),[b,n]=m.useState(!0);if(!t)return e("div",{className:"p-6",children:o("div",{className:"rounded-lg border p-6 bg-yellow-50 text-yellow-800",children:[e("p",{className:"font-medium",children:"AccÃ¨s non autorisÃ©"}),e("p",{className:"text-sm mt-1",children:"Aucune compagnie associÃ©e Ã  votre compte ou Ã  l'URL."})]})});m.useEffect(()=>{n(!0);const i=N(g,"companies",t,"imagesBibliotheque"),c=w(i,I("createdAt","desc")),x=j(c,d=>{u(d.docs.map(p=>({id:p.id,...p.data()}))),n(!1)},d=>{console.error("Erreur chargement images compagnie:",d),u([]),n(!1)});return()=>x()},[t]);const f=async i=>{if(s){alert("Mode lecture seule : vous ne pouvez pas supprimer d'images.");return}if(window.confirm(`Supprimer lâ€™image Â« ${i.nom||"image"} Â» ?`))try{await q(A(g,"companies",t,"imagesBibliotheque",i.id))}catch(c){console.error("Erreur suppression image:",c),alert("Erreur lors de la suppression")}};return o("div",{className:"p-6",children:[o("div",{className:"mb-6 flex items-center gap-3 flex-wrap",children:[e(h,{className:"text-orange-600"}),e("h1",{className:"text-2xl font-bold",children:"BibliothÃ¨que dâ€™images de la compagnie"}),s&&e("span",{className:"ml-2 px-2.5 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full",children:"Mode inspection â€¢ Lecture seule"})]}),!s&&e("div",{className:"mb-6 max-w-sm",children:e(E,{label:"Ajouter une image",dossier:`companies/${t}`,collectionName:`companies/${t}/imagesBibliotheque`,onUpload:()=>{}})}),s&&l.length>0&&o("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-700 flex items-center gap-2",children:[e("span",{children:"ðŸ”"}),e("span",{children:"Vous Ãªtes en mode consultation. Les actions de suppression sont dÃ©sactivÃ©es."})]}),b?e(S,{}):l.length===0?e(z,{isInspectionMode:s}):e(C,{items:l,onDelete:f,isReadOnly:s})]})},S=()=>e("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:Array.from({length:8}).map((a,r)=>e("div",{className:"h-32 w-full rounded-lg bg-gray-100 animate-pulse"},r))}),z=({isInspectionMode:a})=>o("div",{className:"border rounded-lg p-10 bg-white text-center text-gray-600",children:[e("div",{className:"flex items-center justify-center mb-3 text-gray-400",children:e(h,{size:32})}),e("div",{className:"font-semibold",children:"Aucune image"}),e("div",{className:"text-sm text-gray-500 mt-1",children:a?"Cette compagnie n'a pas encore d'images dans sa bibliothÃ¨que.":"Ajoutez votre premiÃ¨re image avec le bouton ci-dessus."})]}),C=({items:a,onDelete:r,isReadOnly:t})=>e("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:a.map(s=>o("figure",{className:"relative rounded-lg overflow-hidden border bg-white hover:shadow-md transition group",children:[e("img",{src:s.url,alt:s.nom||"image",className:"h-32 w-full object-cover",loading:"lazy"}),!t&&e("button",{onClick:()=>r(s),className:`absolute top-2 right-2 hidden group-hover:flex items-center justify-center\r
                       bg-red-600 text-white rounded-full p-1.5 shadow hover:bg-red-700 transition`,title:"Supprimer",children:e(v,{size:14})}),t&&e("div",{className:"absolute top-2 right-2 bg-gray-800/70 text-white text-xs px-2 py-1 rounded-full",children:"Lecture seule"}),s.nom&&e("figcaption",{className:"text-xs px-2 py-1.5 border-t text-gray-600 truncate bg-gray-50",children:s.nom})]},s.id))});export{$ as default};
