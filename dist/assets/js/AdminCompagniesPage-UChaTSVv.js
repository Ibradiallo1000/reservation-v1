import{r as i,j as a,a as t}from"./vendor-Bq-8_m9i.js";import{u as b,r as N,t as C,I as S,y as w,x as j,o as k}from"./firebase-CURBI7X6.js";import{m as A,d as p,P as E,w as P,G as $,B as r}from"./agence-Bsj2lp2X.js";import{a as z}from"./router-DoGdw-3y.js";import"./compagnie-DiuZFnHS.js";import"./icons-C0JHUK9Z.js";import"./courier-CoQgRaHG.js";const q=()=>{const n=A(),[u,o]=i.useState([]),[f,c]=i.useState(!0),[m,g]=i.useState(null),[h,x]=i.useState(0),d=z();i.useEffect(()=>{(async()=>{c(!0),g(null);try{const e=await b(N(C(p,"companies"),S("nom","asc")));o(e.docs.map(s=>({id:s.id,...s.data()})))}catch(e){console.error(e),o([]),g(n?"Erreur lors du chargement des compagnies.":"Connexion indisponible. Impossible de charger les compagnies.")}finally{c(!1)}})()},[n,h]);async function y(e){const s=e.status==="inactif"?"actif":"inactif";await w(k(p,"companies",e.id),{status:s,updatedAt:j()}),o(v=>v.map(l=>l.id===e.id?{...l,status:s}:l))}return f?a(E,{}):t("div",{className:"p-6 space-y-6",children:[!n&&a(P,{message:"Connexion instable: la liste peut être incomplète."}),m&&a($,{message:m,onRetry:()=>x(e=>e+1)}),t("div",{className:"flex justify-between items-center",children:[a("h1",{className:"text-2xl font-bold text-gray-900",children:"Compagnies"}),a(r,{onClick:()=>d("/admin/compagnies/ajouter"),variant:"primary",children:"+ Ajouter une compagnie"})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:u.map(e=>t("div",{className:"bg-white border rounded-xl p-5 space-y-4",children:[t("div",{children:[a("div",{className:"font-semibold text-lg",children:e.nom}),t("div",{className:"text-sm text-gray-600",children:[e.email||"—"," • ",e.telephone||"—"]})]}),a("span",{className:`inline-block px-2 py-1 text-xs rounded ${e.status==="actif"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.status==="actif"?"Active":"Inactive"}),t("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[a(r,{onClick:()=>d(`/admin/compagnies/${e.id}/configurer`),variant:"primary",size:"sm",children:"Configurer"}),a(r,{onClick:()=>d(`/admin/compagnies/${e.id}/modifier`),variant:"primary",size:"sm",children:"Modifier"}),e.slug&&a("a",{href:`/${e.slug}`,target:"_blank",rel:"noreferrer",className:"bg-gray-600 hover:bg-gray-700 text-white px-3 py-2 rounded text-center",children:"Voir site"}),a(r,{onClick:()=>y(e),variant:"danger",size:"sm",children:e.status==="actif"?"Désactiver":"Activer"})]})]},e.id))})]})};export{q as default};
