import{r as d,j as t}from"./react-A-4nP3fl.js";import{q as N,w as x,f as v,e as M}from"./firebase-CbfwkGbo.js";import{u as S,d as w}from"../index-ChphXJpr.js";import{R as C,B as A,X as R,Y as F,T as q,a as P}from"./BarChart-Du4jb2s5.js";import{C as D}from"./CartesianGrid-Dm8rhQDL.js";import"./vendor-CCJV4Wg0.js";const J=()=>{const{user:e}=S(),[m,p]=d.useState([]),[j,u]=d.useState(!0),g=["Jan","FÃ©v","Mar","Avr","Mai","Juin","Juil","AoÃ»t","Sep","Oct","Nov","DÃ©c"];return d.useEffect(()=>{(async()=>{if(!(e!=null&&e.companyId))return;const c=N(v(w,"reservations"),x("compagnieId","==",e.companyId),x("statut","==","payÃ©")),b=await M(c),s={};b.docs.forEach(r=>{var i,h;const o=r.data(),n=(h=(i=o.createdAt)==null?void 0:i.toDate)==null?void 0:h.call(i);if(!n)return;const l=`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}`,y=`${g[n.getMonth()]} ${n.getFullYear()}`;s[l]||(s[l]={month:y,totalReservations:0,totalPassagers:0,totalMontant:0}),s[l].totalReservations+=1,s[l].totalPassagers+=o.seatsGo||1,s[l].totalMontant+=o.montant||0});const f=Object.entries(s).sort(([r],[o])=>r.localeCompare(o)).map(([,r])=>r);p(f),u(!1)})()},[e]),t.jsxs("div",{className:"p-6 bg-white min-h-screen",children:[t.jsx("h1",{className:"text-2xl font-bold mb-6",children:"ðŸ“… Statistiques mensuelles"}),j?t.jsx("p",{children:"Chargement des donnÃ©es..."}):t.jsxs(t.Fragment,{children:[t.jsxs("table",{className:"w-full border text-sm mb-8",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border px-3 py-2",children:"Mois"}),t.jsx("th",{className:"border px-3 py-2",children:"RÃ©servations"}),t.jsx("th",{className:"border px-3 py-2",children:"Passagers"}),t.jsx("th",{className:"border px-3 py-2",children:"Montant encaissÃ© (FCFA)"})]})}),t.jsx("tbody",{children:m.map((a,c)=>t.jsxs("tr",{className:"text-center",children:[t.jsx("td",{className:"border px-3 py-2",children:a.month}),t.jsx("td",{className:"border px-3 py-2",children:a.totalReservations}),t.jsx("td",{className:"border px-3 py-2",children:a.totalPassagers}),t.jsx("td",{className:"border px-3 py-2 text-green-600 font-semibold",children:a.totalMontant.toLocaleString()})]},c))})]}),t.jsxs("div",{className:"bg-white shadow p-4 rounded-lg",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"ðŸ“Š Graphique des revenus par mois"}),t.jsx(C,{width:"100%",height:300,children:t.jsxs(A,{data:m,children:[t.jsx(D,{strokeDasharray:"3 3"}),t.jsx(R,{dataKey:"month"}),t.jsx(F,{}),t.jsx(q,{}),t.jsx(P,{dataKey:"totalMontant",fill:"#34d399",name:"Montant encaissÃ©"})]})})]})]})]})};export{J as default};
