import{r as l,j as t}from"./react-PtMwKKf1.js";import{l as d,k as m}from"./firebase-eGIzIftJ.js";import{d as x}from"../index-C4y8wfzK.js";import{R as h,X as p,Y as j,T as f,L as g,B as D,a as A}from"./BarChart-B1M1C7N-.js";import{L,a as E}from"./LineChart-noy9A-wH.js";import{C as u}from"./CartesianGrid-Xzbg7DSv.js";import{J as k}from"./vendor-B5FTF_2c.js";const X=()=>{const[n,b]=l.useState([]),[v,y]=l.useState([]);l.useEffect(()=>{(async()=>{const e=await d(m(x,"reservations")),a=await d(m(x,"compagnies"));b(e.docs.map(o=>o.data())),y(a.docs.map(o=>o.data()))})()},[]);const N=n.length,C=n.reduce((s,e)=>s+(e.total||0),0),w=v.filter(s=>s.status==="actif").length,i={};n.forEach(s=>{var o,c;const e=((c=(o=s.createdAt)==null?void 0:o.toDate)==null?void 0:c.call(o))||new Date,a=k(e,"yyyy-MM");i[a]||(i[a]={total:0}),i[a].total+=s.total||0});const R=Object.entries(i).map(([s,e])=>({month:s,total:e.total})).sort((s,e)=>s.month.localeCompare(e.month)),r={};n.forEach(s=>{var a;const e=((a=s.trip)==null?void 0:a.company)||"Inconnue";r[e]=(r[e]||0)+(s.total||0)});const S=Object.entries(r).map(([s,e])=>({name:s,total:e})).sort((s,e)=>e.total-s.total).slice(0,5);return t.jsxs("div",{className:"p-6",children:[t.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Statistiques générales"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white rounded shadow p-4 text-center",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Réservations"}),t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:N})]}),t.jsxs("div",{className:"bg-white rounded shadow p-4 text-center",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Revenus totaux"}),t.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[C.toLocaleString()," FCFA"]})]}),t.jsxs("div",{className:"bg-white rounded shadow p-4 text-center",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Compagnies actives"}),t.jsx("p",{className:"text-3xl font-bold text-indigo-600",children:w})]})]}),t.jsxs("div",{className:"mb-10",children:[t.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Évolution des revenus par mois"}),t.jsx(h,{width:"100%",height:300,children:t.jsxs(L,{data:R,children:[t.jsx(u,{strokeDasharray:"3 3"}),t.jsx(p,{dataKey:"month"}),t.jsx(j,{}),t.jsx(f,{}),t.jsx(g,{}),t.jsx(E,{type:"monotone",dataKey:"total",stroke:"#10B981",name:"Revenus"})]})})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Top 5 compagnies par revenus"}),t.jsx(h,{width:"100%",height:300,children:t.jsxs(D,{data:S,children:[t.jsx(u,{strokeDasharray:"3 3"}),t.jsx(p,{dataKey:"name"}),t.jsx(j,{}),t.jsx(f,{}),t.jsx(g,{}),t.jsx(A,{dataKey:"total",fill:"#6366F1",name:"CA total"})]})})]})]})};export{X as default};
