import{r as u,u as x,j as e}from"./react-PtMwKKf1.js";import{x as f,f as b,d as w}from"./firebase-eGIzIftJ.js";import{a as v,d as j}from"../index-C4y8wfzK.js";import"./vendor-B5FTF_2c.js";const S=()=>{const[a,p]=u.useState(""),[l,g]=u.useState(""),[d,t]=u.useState(""),r=x(),h=async s=>{s.preventDefault(),t("");try{console.log("Tentative de connexion avec :",a);const o=(await f(v,a,l)).user.uid;console.log("✅ Authentification Firebase réussie, UID :",o);const m=await b(w(j,"users",o));if(!m.exists()){console.error("❌ Aucune donnée utilisateur trouvée dans Firestore pour UID :",o),t("Aucune information utilisateur trouvée.");return}const i=m.data();console.log("✅ Données Firestore récupérées :",i);const c=i.role;switch(localStorage.setItem("user",JSON.stringify({uid:o,email:a,role:c,...i})),c){case"admin_platforme":r("/dashboard");break;case"admin_compagnie":r("/compagnie/dashboard");break;case"chefAgence":r("/agence/dashboard");break;default:console.error("❌ Rôle inconnu ou non autorisé :",c),t("Rôle utilisateur inconnu ou non autorisé.")}}catch(n){console.error("❌ Erreur de connexion :",n),t("Erreur de connexion : "+n.message)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("form",{onSubmit:h,className:"bg-white p-6 rounded shadow w-full max-w-sm space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Rapport"}),e.jsx("input",{type:"email",placeholder:"Email",value:a,onChange:s=>p(s.target.value),className:"w-full border rounded p-2"}),e.jsx("input",{type:"password",placeholder:"Mot de passe",value:l,onChange:s=>g(s.target.value),className:"w-full border rounded p-2"}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded",children:"Se connecter"}),d&&e.jsx("p",{className:"text-red-600 text-sm text-center",children:d})]})})};export{S as default};
