import{r as m,a as e,j as t,F as M}from"./react-DgrrIcw2.js";import{q as S,w as g,k as w,l as C}from"./firebase-eGIzIftJ.js";import{u as A,d as F}from"../index-p6Te0bSg.js";import{B as R,X as q,Y as P,T as j,a as D,R as Y}from"./BarChart-CrYhCjc_.js";import{C as $}from"./CartesianGrid-Baa3W_b2.js";import"./vendor-BHjJ2Hjk.js";const k=()=>{const{user:s}=A(),[h,u]=m.useState([]),[b,f]=m.useState(!0),x=["Jan","FÃ©v","Mar","Avr","Mai","Juin","Juil","AoÃ»t","Sep","Oct","Nov","DÃ©c"];return m.useEffect(()=>{(async()=>{if(!(s!=null&&s.companyId))return;const d=S(w(F,"reservations"),g("compagnieId","==",s.companyId),g("statut","==","payÃ©")),y=await C(d),a={};y.docs.forEach(o=>{var c,p;const n=o.data(),l=(p=(c=n.createdAt)==null?void 0:c.toDate)==null?void 0:p.call(c);if(!l)return;const i=`${l.getFullYear()}-${(l.getMonth()+1).toString().padStart(2,"0")}`,v=`${x[l.getMonth()]} ${l.getFullYear()}`;a[i]||(a[i]={month:v,totalReservations:0,totalPassagers:0,totalMontant:0}),a[i].totalReservations+=1,a[i].totalPassagers+=n.seatsGo||1,a[i].totalMontant+=n.montant||0});const N=Object.entries(a).sort(([o],[n])=>o.localeCompare(n)).map(([,o])=>o);u(N),f(!1)})()},[s]),e("div",{className:"p-6 bg-white min-h-screen",children:[t("h1",{className:"text-2xl font-bold mb-6",children:"ðŸ“… Statistiques mensuelles"}),b?t("p",{children:"Chargement des donnÃ©es..."}):e(M,{children:[e("table",{className:"w-full border text-sm mb-8",children:[t("thead",{className:"bg-gray-100",children:e("tr",{children:[t("th",{className:"border px-3 py-2",children:"Mois"}),t("th",{className:"border px-3 py-2",children:"RÃ©servations"}),t("th",{className:"border px-3 py-2",children:"Passagers"}),t("th",{className:"border px-3 py-2",children:"Montant encaissÃ© (FCFA)"})]})}),t("tbody",{children:h.map((r,d)=>e("tr",{className:"text-center",children:[t("td",{className:"border px-3 py-2",children:r.month}),t("td",{className:"border px-3 py-2",children:r.totalReservations}),t("td",{className:"border px-3 py-2",children:r.totalPassagers}),t("td",{className:"border px-3 py-2 text-green-600 font-semibold",children:r.totalMontant.toLocaleString()})]},d))})]}),e("div",{className:"bg-white shadow p-4 rounded-lg",children:[t("h2",{className:"text-lg font-semibold mb-4",children:"ðŸ“Š Graphique des revenus par mois"}),t(Y,{width:"100%",height:300,children:e(R,{data:h,children:[t($,{strokeDasharray:"3 3"}),t(q,{dataKey:"month"}),t(P,{}),t(j,{}),t(D,{dataKey:"totalMontant",fill:"#34d399",name:"Montant encaissÃ©"})]})})]})]})]})};export{k as default};
